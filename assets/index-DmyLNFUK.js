(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function S0(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var ly={exports:{}},Vu={};var PE;function $R(){if(PE)return Vu;PE=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var p in a)p!=="key"&&(l[p]=a[p])}else l=a;return a=l.ref,{$$typeof:s,type:r,key:u,ref:a!==void 0?a:null,props:l}}return Vu.Fragment=e,Vu.jsx=t,Vu.jsxs=t,Vu}var jE;function YR(){return jE||(jE=1,ly.exports=$R()),ly.exports}var h=YR(),cy={exports:{}},Ve={};var VE;function WR(){if(VE)return Ve;VE=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),T=Symbol.iterator;function N(V){return V===null||typeof V!="object"?null:(V=T&&V[T]||V["@@iterator"],typeof V=="function"?V:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G=Object.assign,te={};function I(V,O,q){this.props=V,this.context=O,this.refs=te,this.updater=q||B}I.prototype.isReactComponent={},I.prototype.setState=function(V,O){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,O,"setState")},I.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function X(){}X.prototype=I.prototype;function se(V,O,q){this.props=V,this.context=O,this.refs=te,this.updater=q||B}var fe=se.prototype=new X;fe.constructor=se,G(fe,I.prototype),fe.isPureReactComponent=!0;var H=Array.isArray;function ae(){}var A={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function k(V,O,q){var ne=q.ref;return{$$typeof:s,type:V,key:O,ref:ne!==void 0?ne:null,props:q}}function j(V,O){return k(V.type,O,V.props)}function P(V){return typeof V=="object"&&V!==null&&V.$$typeof===s}function L(V){var O={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(q){return O[q]})}var C=/\/+/g;function Me(V,O){return typeof V=="object"&&V!==null&&V.key!=null?L(""+V.key):O.toString(36)}function Pe(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(ae,ae):(V.status="pending",V.then(function(O){V.status==="pending"&&(V.status="fulfilled",V.value=O)},function(O){V.status==="pending"&&(V.status="rejected",V.reason=O)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function Z(V,O,q,ne,de){var me=typeof V;(me==="undefined"||me==="boolean")&&(V=null);var _e=!1;if(V===null)_e=!0;else switch(me){case"bigint":case"string":case"number":_e=!0;break;case"object":switch(V.$$typeof){case s:case e:_e=!0;break;case b:return _e=V._init,Z(_e(V._payload),O,q,ne,de)}}if(_e)return de=de(V),_e=ne===""?"."+Me(V,0):ne,H(de)?(q="",_e!=null&&(q=_e.replace(C,"$&/")+"/"),Z(de,O,q,"",function(ar){return ar})):de!=null&&(P(de)&&(de=j(de,q+(de.key==null||V&&V.key===de.key?"":(""+de.key).replace(C,"$&/")+"/")+_e)),O.push(de)),1;_e=0;var it=ne===""?".":ne+":";if(H(V))for(var tt=0;tt<V.length;tt++)ne=V[tt],me=it+Me(ne,tt),_e+=Z(ne,O,q,me,de);else if(tt=N(V),typeof tt=="function")for(V=tt.call(V),tt=0;!(ne=V.next()).done;)ne=ne.value,me=it+Me(ne,tt++),_e+=Z(ne,O,q,me,de);else if(me==="object"){if(typeof V.then=="function")return Z(Pe(V),O,q,ne,de);throw O=String(V),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return _e}function pe(V,O,q){if(V==null)return V;var ne=[],de=0;return Z(V,ne,"","",function(me){return O.call(q,me,de++)}),ne}function Ee(V){if(V._status===-1){var O=V._result;O=O(),O.then(function(q){(V._status===0||V._status===-1)&&(V._status=1,V._result=q)},function(q){(V._status===0||V._status===-1)&&(V._status=2,V._result=q)}),V._status===-1&&(V._status=0,V._result=O)}if(V._status===1)return V._result.default;throw V._result}var Ne=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},Le={map:pe,forEach:function(V,O,q){pe(V,function(){O.apply(this,arguments)},q)},count:function(V){var O=0;return pe(V,function(){O++}),O},toArray:function(V){return pe(V,function(O){return O})||[]},only:function(V){if(!P(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Ve.Activity=E,Ve.Children=Le,Ve.Component=I,Ve.Fragment=t,Ve.Profiler=a,Ve.PureComponent=se,Ve.StrictMode=r,Ve.Suspense=f,Ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,Ve.__COMPILER_RUNTIME={__proto__:null,c:function(V){return A.H.useMemoCache(V)}},Ve.cache=function(V){return function(){return V.apply(null,arguments)}},Ve.cacheSignal=function(){return null},Ve.cloneElement=function(V,O,q){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var ne=G({},V.props),de=V.key;if(O!=null)for(me in O.key!==void 0&&(de=""+O.key),O)!R.call(O,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&O.ref===void 0||(ne[me]=O[me]);var me=arguments.length-2;if(me===1)ne.children=q;else if(1<me){for(var _e=Array(me),it=0;it<me;it++)_e[it]=arguments[it+2];ne.children=_e}return k(V.type,de,ne)},Ve.createContext=function(V){return V={$$typeof:u,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:l,_context:V},V},Ve.createElement=function(V,O,q){var ne,de={},me=null;if(O!=null)for(ne in O.key!==void 0&&(me=""+O.key),O)R.call(O,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(de[ne]=O[ne]);var _e=arguments.length-2;if(_e===1)de.children=q;else if(1<_e){for(var it=Array(_e),tt=0;tt<_e;tt++)it[tt]=arguments[tt+2];de.children=it}if(V&&V.defaultProps)for(ne in _e=V.defaultProps,_e)de[ne]===void 0&&(de[ne]=_e[ne]);return k(V,me,de)},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(V){return{$$typeof:p,render:V}},Ve.isValidElement=P,Ve.lazy=function(V){return{$$typeof:b,_payload:{_status:-1,_result:V},_init:Ee}},Ve.memo=function(V,O){return{$$typeof:y,type:V,compare:O===void 0?null:O}},Ve.startTransition=function(V){var O=A.T,q={};A.T=q;try{var ne=V(),de=A.S;de!==null&&de(q,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(ae,Ne)}catch(me){Ne(me)}finally{O!==null&&q.types!==null&&(O.types=q.types),A.T=O}},Ve.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},Ve.use=function(V){return A.H.use(V)},Ve.useActionState=function(V,O,q){return A.H.useActionState(V,O,q)},Ve.useCallback=function(V,O){return A.H.useCallback(V,O)},Ve.useContext=function(V){return A.H.useContext(V)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(V,O){return A.H.useDeferredValue(V,O)},Ve.useEffect=function(V,O){return A.H.useEffect(V,O)},Ve.useEffectEvent=function(V){return A.H.useEffectEvent(V)},Ve.useId=function(){return A.H.useId()},Ve.useImperativeHandle=function(V,O,q){return A.H.useImperativeHandle(V,O,q)},Ve.useInsertionEffect=function(V,O){return A.H.useInsertionEffect(V,O)},Ve.useLayoutEffect=function(V,O){return A.H.useLayoutEffect(V,O)},Ve.useMemo=function(V,O){return A.H.useMemo(V,O)},Ve.useOptimistic=function(V,O){return A.H.useOptimistic(V,O)},Ve.useReducer=function(V,O,q){return A.H.useReducer(V,O,q)},Ve.useRef=function(V){return A.H.useRef(V)},Ve.useState=function(V){return A.H.useState(V)},Ve.useSyncExternalStore=function(V,O,q){return A.H.useSyncExternalStore(V,O,q)},Ve.useTransition=function(){return A.H.useTransition()},Ve.version="19.2.3",Ve}var OE;function A0(){return OE||(OE=1,cy.exports=WR()),cy.exports}var mn=A0();const sn=S0(mn);var uy={exports:{}},Ou={},dy={exports:{}},hy={};var ME;function XR(){return ME||(ME=1,(function(s){function e(Z,pe){var Ee=Z.length;Z.push(pe);e:for(;0<Ee;){var Ne=Ee-1>>>1,Le=Z[Ne];if(0<a(Le,pe))Z[Ne]=pe,Z[Ee]=Le,Ee=Ne;else break e}}function t(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var pe=Z[0],Ee=Z.pop();if(Ee!==pe){Z[0]=Ee;e:for(var Ne=0,Le=Z.length,V=Le>>>1;Ne<V;){var O=2*(Ne+1)-1,q=Z[O],ne=O+1,de=Z[ne];if(0>a(q,Ee))ne<Le&&0>a(de,q)?(Z[Ne]=de,Z[ne]=Ee,Ne=ne):(Z[Ne]=q,Z[O]=Ee,Ne=O);else if(ne<Le&&0>a(de,Ee))Z[Ne]=de,Z[ne]=Ee,Ne=ne;else break e}}return pe}function a(Z,pe){var Ee=Z.sortIndex-pe.sortIndex;return Ee!==0?Ee:Z.id-pe.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var u=Date,p=u.now();s.unstable_now=function(){return u.now()-p}}var f=[],y=[],b=1,E=null,T=3,N=!1,B=!1,G=!1,te=!1,I=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,se=typeof setImmediate<"u"?setImmediate:null;function fe(Z){for(var pe=t(y);pe!==null;){if(pe.callback===null)r(y);else if(pe.startTime<=Z)r(y),pe.sortIndex=pe.expirationTime,e(f,pe);else break;pe=t(y)}}function H(Z){if(G=!1,fe(Z),!B)if(t(f)!==null)B=!0,ae||(ae=!0,L());else{var pe=t(y);pe!==null&&Pe(H,pe.startTime-Z)}}var ae=!1,A=-1,R=5,k=-1;function j(){return te?!0:!(s.unstable_now()-k<R)}function P(){if(te=!1,ae){var Z=s.unstable_now();k=Z;var pe=!0;try{e:{B=!1,G&&(G=!1,X(A),A=-1),N=!0;var Ee=T;try{t:{for(fe(Z),E=t(f);E!==null&&!(E.expirationTime>Z&&j());){var Ne=E.callback;if(typeof Ne=="function"){E.callback=null,T=E.priorityLevel;var Le=Ne(E.expirationTime<=Z);if(Z=s.unstable_now(),typeof Le=="function"){E.callback=Le,fe(Z),pe=!0;break t}E===t(f)&&r(f),fe(Z)}else r(f);E=t(f)}if(E!==null)pe=!0;else{var V=t(y);V!==null&&Pe(H,V.startTime-Z),pe=!1}}break e}finally{E=null,T=Ee,N=!1}pe=void 0}}finally{pe?L():ae=!1}}}var L;if(typeof se=="function")L=function(){se(P)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,Me=C.port2;C.port1.onmessage=P,L=function(){Me.postMessage(null)}}else L=function(){I(P,0)};function Pe(Z,pe){A=I(function(){Z(s.unstable_now())},pe)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Z){Z.callback=null},s.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<Z?Math.floor(1e3/Z):5},s.unstable_getCurrentPriorityLevel=function(){return T},s.unstable_next=function(Z){switch(T){case 1:case 2:case 3:var pe=3;break;default:pe=T}var Ee=T;T=pe;try{return Z()}finally{T=Ee}},s.unstable_requestPaint=function(){te=!0},s.unstable_runWithPriority=function(Z,pe){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var Ee=T;T=Z;try{return pe()}finally{T=Ee}},s.unstable_scheduleCallback=function(Z,pe,Ee){var Ne=s.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?Ne+Ee:Ne):Ee=Ne,Z){case 1:var Le=-1;break;case 2:Le=250;break;case 5:Le=1073741823;break;case 4:Le=1e4;break;default:Le=5e3}return Le=Ee+Le,Z={id:b++,callback:pe,priorityLevel:Z,startTime:Ee,expirationTime:Le,sortIndex:-1},Ee>Ne?(Z.sortIndex=Ee,e(y,Z),t(f)===null&&Z===t(y)&&(G?(X(A),A=-1):G=!0,Pe(H,Ee-Ne))):(Z.sortIndex=Le,e(f,Z),B||N||(B=!0,ae||(ae=!0,L()))),Z},s.unstable_shouldYield=j,s.unstable_wrapCallback=function(Z){var pe=T;return function(){var Ee=T;T=pe;try{return Z.apply(this,arguments)}finally{T=Ee}}}})(hy)),hy}var LE;function JR(){return LE||(LE=1,dy.exports=XR()),dy.exports}var fy={exports:{}},Dn={};var UE;function ZR(){if(UE)return Dn;UE=1;var s=A0();function e(f){var y="https://react.dev/errors/"+f;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)y+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+f+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(f,y,b){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:E==null?null:""+E,children:f,containerInfo:y,implementation:b}}var u=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(f,y){if(f==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Dn.createPortal=function(f,y){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(f,y,null,b)},Dn.flushSync=function(f){var y=u.T,b=r.p;try{if(u.T=null,r.p=2,f)return f()}finally{u.T=y,r.p=b,r.d.f()}},Dn.preconnect=function(f,y){typeof f=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,r.d.C(f,y))},Dn.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Dn.preinit=function(f,y){if(typeof f=="string"&&y&&typeof y.as=="string"){var b=y.as,E=p(b,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,N=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;b==="style"?r.d.S(f,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:E,integrity:T,fetchPriority:N}):b==="script"&&r.d.X(f,{crossOrigin:E,integrity:T,fetchPriority:N,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Dn.preinitModule=function(f,y){if(typeof f=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var b=p(y.as,y.crossOrigin);r.d.M(f,{crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&r.d.M(f)},Dn.preload=function(f,y){if(typeof f=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var b=y.as,E=p(b,y.crossOrigin);r.d.L(f,b,{crossOrigin:E,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Dn.preloadModule=function(f,y){if(typeof f=="string")if(y){var b=p(y.as,y.crossOrigin);r.d.m(f,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:b,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else r.d.m(f)},Dn.requestFormReset=function(f){r.d.r(f)},Dn.unstable_batchedUpdates=function(f,y){return f(y)},Dn.useFormState=function(f,y,b){return u.H.useFormState(f,y,b)},Dn.useFormStatus=function(){return u.H.useHostTransitionStatus()},Dn.version="19.2.3",Dn}var zE;function eI(){if(zE)return fy.exports;zE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),fy.exports=ZR(),fy.exports}var BE;function eC(){if(BE)return Ou;BE=1;var s=JR(),e=A0(),t=eI();function r(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,o=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(o=i.return),n=i.return;while(n)}return i.tag===3?o:null}function u(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function p(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function f(n){if(l(n)!==n)throw Error(r(188))}function y(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(r(188));return i!==n?null:n}for(var o=n,c=i;;){var m=o.return;if(m===null)break;var g=m.alternate;if(g===null){if(c=m.return,c!==null){o=c;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===o)return f(m),n;if(g===c)return f(m),i;g=g.sibling}throw Error(r(188))}if(o.return!==c.return)o=m,c=g;else{for(var v=!1,w=m.child;w;){if(w===o){v=!0,o=m,c=g;break}if(w===c){v=!0,c=m,o=g;break}w=w.sibling}if(!v){for(w=g.child;w;){if(w===o){v=!0,o=g,c=m;break}if(w===c){v=!0,c=g,o=m;break}w=w.sibling}if(!v)throw Error(r(189))}}if(o.alternate!==c)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?n:i}function b(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=b(n),i!==null)return i;n=n.sibling}return null}var E=Object.assign,T=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),B=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),te=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),X=Symbol.for("react.consumer"),se=Symbol.for("react.context"),fe=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),j=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function L(n){return n===null||typeof n!="object"?null:(n=P&&n[P]||n["@@iterator"],typeof n=="function"?n:null)}var C=Symbol.for("react.client.reference");function Me(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===C?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case G:return"Fragment";case I:return"Profiler";case te:return"StrictMode";case H:return"Suspense";case ae:return"SuspenseList";case k:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case B:return"Portal";case se:return n.displayName||"Context";case X:return(n._context.displayName||"Context")+".Consumer";case fe:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case A:return i=n.displayName||null,i!==null?i:Me(n.type)||"Memo";case R:i=n._payload,n=n._init;try{return Me(n(i))}catch{}}return null}var Pe=Array.isArray,Z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ee={pending:!1,data:null,method:null,action:null},Ne=[],Le=-1;function V(n){return{current:n}}function O(n){0>Le||(n.current=Ne[Le],Ne[Le]=null,Le--)}function q(n,i){Le++,Ne[Le]=n.current,n.current=i}var ne=V(null),de=V(null),me=V(null),_e=V(null);function it(n,i){switch(q(me,i),q(de,n),q(ne,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?nE(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=nE(i),n=rE(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}O(ne),q(ne,n)}function tt(){O(ne),O(de),O(me)}function ar(n){n.memoizedState!==null&&q(_e,n);var i=ne.current,o=rE(i,n.type);i!==o&&(q(de,n),q(ne,o))}function zt(n){de.current===n&&(O(ne),O(de)),_e.current===n&&(O(_e),ku._currentValue=Ee)}var _n,xr;function on(n){if(_n===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);_n=i&&i[1]||"",xr=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+_n+n+xr}var Qn=!1;function Cn(n,i){if(!n||Qn)return"";Qn=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(i){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(ee){var $=ee}Reflect.construct(n,[],oe)}else{try{oe.call()}catch(ee){$=ee}n.call(oe.prototype)}}else{try{throw Error()}catch(ee){$=ee}(oe=n())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(ee){if(ee&&$&&typeof ee.stack=="string")return[ee.stack,$.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),v=g[0],w=g[1];if(v&&w){var D=v.split(`
`),K=w.split(`
`);for(m=c=0;c<D.length&&!D[c].includes("DetermineComponentFrameRoot");)c++;for(;m<K.length&&!K[m].includes("DetermineComponentFrameRoot");)m++;if(c===D.length||m===K.length)for(c=D.length-1,m=K.length-1;1<=c&&0<=m&&D[c]!==K[m];)m--;for(;1<=c&&0<=m;c--,m--)if(D[c]!==K[m]){if(c!==1||m!==1)do if(c--,m--,0>m||D[c]!==K[m]){var re=`
`+D[c].replace(" at new "," at ");return n.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",n.displayName)),re}while(1<=c&&0<=m);break}}}finally{Qn=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?on(o):""}function Kn(n,i){switch(n.tag){case 26:case 27:case 5:return on(n.type);case 16:return on("Lazy");case 13:return n.child!==i&&i!==null?on("Suspense Fallback"):on("Suspense");case 19:return on("SuspenseList");case 0:case 15:return Cn(n.type,!1);case 11:return Cn(n.type.render,!1);case 1:return Cn(n.type,!0);case 31:return on("Activity");default:return""}}function $n(n){try{var i="",o=null;do i+=Kn(n,o),o=n,n=n.return;while(n);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var $e=Object.prototype.hasOwnProperty,xt=s.unstable_scheduleCallback,kn=s.unstable_cancelCallback,Y=s.unstable_shouldYield,Ie=s.unstable_requestPaint,qe=s.unstable_now,ce=s.unstable_getCurrentPriorityLevel,kt=s.unstable_ImmediatePriority,vn=s.unstable_UserBlockingPriority,Kt=s.unstable_NormalPriority,ka=s.unstable_LowPriority,qs=s.unstable_IdlePriority,Vc=s.log,Lr=s.unstable_setDisableYieldValue,Ln=null,be=null;function je(n){if(typeof Vc=="function"&&Lr(n),be&&typeof be.setStrictMode=="function")try{be.setStrictMode(Ln,n)}catch{}}var Je=Math.clz32?Math.clz32:oh,rs=Math.log,Qo=Math.LN2;function oh(n){return n>>>=0,n===0?32:31-(rs(n)/Qo|0)|0}var ss=256,Da=262144,$t=4194304;function is(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function as(n,i,o){var c=n.pendingLanes;if(c===0)return 0;var m=0,g=n.suspendedLanes,v=n.pingedLanes;n=n.warmLanes;var w=c&134217727;return w!==0?(c=w&~g,c!==0?m=is(c):(v&=w,v!==0?m=is(v):o||(o=w&~n,o!==0&&(m=is(o))))):(w=c&~g,w!==0?m=is(w):v!==0?m=is(v):o||(o=c&~n,o!==0&&(m=is(o)))),m===0?0:i!==0&&i!==m&&(i&g)===0&&(g=m&-m,o=i&-i,g>=o||g===32&&(o&4194048)!==0)?i:m}function Ur(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function hp(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lh(){var n=$t;return $t<<=1,($t&62914560)===0&&($t=4194304),n}function os(n){for(var i=[],o=0;31>o;o++)i.push(n);return i}function Pa(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function fp(n,i,o,c,m,g){var v=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var w=n.entanglements,D=n.expirationTimes,K=n.hiddenUpdates;for(o=v&~o;0<o;){var re=31-Je(o),oe=1<<re;w[re]=0,D[re]=-1;var $=K[re];if($!==null)for(K[re]=null,re=0;re<$.length;re++){var ee=$[re];ee!==null&&(ee.lane&=-536870913)}o&=~oe}c!==0&&ja(n,c,0),g!==0&&m===0&&n.tag!==0&&(n.suspendedLanes|=g&~(v&~i))}function ja(n,i,o){n.pendingLanes|=i,n.suspendedLanes&=~i;var c=31-Je(i);n.entangledLanes|=i,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function Oc(n,i){var o=n.entangledLanes|=i;for(n=n.entanglements;o;){var c=31-Je(o),m=1<<c;m&i|n[c]&i&&(n[c]|=i),o&=~m}}function Mc(n,i){var o=i&-i;return o=(o&42)!==0?1:Va(o),(o&(n.suspendedLanes|i))!==0?0:o}function Va(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Fs(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function ch(){var n=pe.p;return n!==0?n:(n=window.event,n===void 0?32:SE(n.type))}function zr(n,i){var o=pe.p;try{return pe.p=n,i()}finally{pe.p=o}}var Br=Math.random().toString(36).slice(2),Yt="__reactFiber$"+Br,dn="__reactProps$"+Br,ls="__reactContainer$"+Br,Ko="__reactEvents$"+Br,mp="__reactListeners$"+Br,uh="__reactHandles$"+Br,dh="__reactResources$"+Br,cs="__reactMarker$"+Br;function $o(n){delete n[Yt],delete n[dn],delete n[Ko],delete n[mp],delete n[uh]}function us(n){var i=n[Yt];if(i)return i;for(var o=n.parentNode;o;){if(i=o[ls]||o[Yt]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(n=uE(n);n!==null;){if(o=n[Yt])return o;n=uE(n)}return i}n=o,o=n.parentNode}return null}function Er(n){if(n=n[Yt]||n[ls]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function or(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(r(33))}function ds(n){var i=n[dh];return i||(i=n[dh]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Wt(n){n[cs]=!0}var Lc=new Set,Uc={};function hs(n,i){fs(n,i),fs(n+"Capture",i)}function fs(n,i){for(Uc[n]=i,n=0;n<i.length;n++)Lc.add(i[n])}var zc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Bc={},qc={};function hh(n){return $e.call(qc,n)?!0:$e.call(Bc,n)?!1:zc.test(n)?qc[n]=!0:(Bc[n]=!0,!1)}function Yo(n,i,o){if(hh(i))if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var c=i.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+o)}}function lr(n,i,o){if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+o)}}function Xt(n,i,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(i,o,""+c)}}function hn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ei(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Fc(n,i,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,g=c.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return m.call(this)},set:function(v){o=""+v,g.call(this,v)}}),Object.defineProperty(n,i,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(v){o=""+v},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function ct(n){if(!n._valueTracker){var i=Ei(n)?"checked":"value";n._valueTracker=Fc(n,i,""+n[i])}}function Oa(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var o=i.getValue(),c="";return n&&(c=Ei(n)?n.checked?"true":"false":n.value),n=c,n!==o?(i.setValue(n),!0):!1}function ms(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Ma=/[\n"\\]/g;function Yn(n){return n.replace(Ma,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Wo(n,i,o,c,m,g,v,w){n.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?n.type=v:n.removeAttribute("type"),i!=null?v==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+hn(i)):n.value!==""+hn(i)&&(n.value=""+hn(i)):v!=="submit"&&v!=="reset"||n.removeAttribute("value"),i!=null?Hc(n,v,hn(i)):o!=null?Hc(n,v,hn(o)):c!=null&&n.removeAttribute("value"),m==null&&g!=null&&(n.defaultChecked=!!g),m!=null&&(n.checked=m&&typeof m!="function"&&typeof m!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?n.name=""+hn(w):n.removeAttribute("name")}function fh(n,i,o,c,m,g,v,w){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(n.type=g),i!=null||o!=null){if(!(g!=="submit"&&g!=="reset"||i!=null)){ct(n);return}o=o!=null?""+hn(o):"",i=i!=null?""+hn(i):o,w||i===n.value||(n.value=i),n.defaultValue=i}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=w?n.checked:!!c,n.defaultChecked=!!c,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(n.name=v),ct(n)}function Hc(n,i,o){i==="number"&&ms(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Ti(n,i,o,c){if(n=n.options,i){i={};for(var m=0;m<o.length;m++)i["$"+o[m]]=!0;for(o=0;o<n.length;o++)m=i.hasOwnProperty("$"+n[o].value),n[o].selected!==m&&(n[o].selected=m),m&&c&&(n[o].defaultSelected=!0)}else{for(o=""+hn(o),i=null,m=0;m<n.length;m++){if(n[m].value===o){n[m].selected=!0,c&&(n[m].defaultSelected=!0);return}i!==null||n[m].disabled||(i=n[m])}i!==null&&(i.selected=!0)}}function mh(n,i,o){if(i!=null&&(i=""+hn(i),i!==n.value&&(n.value=i),o==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=o!=null?""+hn(o):""}function wi(n,i,o,c){if(i==null){if(c!=null){if(o!=null)throw Error(r(92));if(Pe(c)){if(1<c.length)throw Error(r(93));c=c[0]}o=c}o==null&&(o=""),i=o}o=hn(i),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),ct(n)}function Wn(n,i){if(i){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=i;return}}n.textContent=i}var ph=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Gc(n,i,o){var c=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":c?n.setProperty(i,o):typeof o!="number"||o===0||ph.has(i)?i==="float"?n.cssFloat=o:n[i]=(""+o).trim():n[i]=o+"px"}function Qc(n,i,o){if(i!=null&&typeof i!="object")throw Error(r(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||i!=null&&i.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var m in i)c=i[m],i.hasOwnProperty(m)&&o[m]!==c&&Gc(n,m,c)}else for(var g in i)i.hasOwnProperty(g)&&Gc(n,g,i[g])}function Xo(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ii=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Jo(n){return Ii.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function qr(){}var Kc=null;function Tr(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Si=null,ps=null;function La(n){var i=Er(n);if(i&&(n=i.stateNode)){var o=n[dn]||null;e:switch(n=i.stateNode,i.type){case"input":if(Wo(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Yn(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var c=o[i];if(c!==n&&c.form===n.form){var m=c[dn]||null;if(!m)throw Error(r(90));Wo(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(i=0;i<o.length;i++)c=o[i],c.form===n.form&&Oa(c)}break e;case"textarea":mh(n,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&Ti(n,!!o.multiple,i,!1)}}}var Zo=!1;function Ai(n,i,o){if(Zo)return n(i,o);Zo=!0;try{var c=n(i);return c}finally{if(Zo=!1,(Si!==null||ps!==null)&&(uf(),Si&&(i=Si,n=ps,ps=Si=null,La(i),n)))for(i=0;i<n.length;i++)La(n[i])}}function Fr(n,i){var o=n.stateNode;if(o===null)return null;var c=o[dn]||null;if(c===null)return null;o=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(r(231,i,typeof o));return o}var wr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ua=!1;if(wr)try{var mt={};Object.defineProperty(mt,"passive",{get:function(){Ua=!0}}),window.addEventListener("test",mt,mt),window.removeEventListener("test",mt,mt)}catch{Ua=!1}var gs=null,$c=null,za=null;function Yc(){if(za)return za;var n,i=$c,o=i.length,c,m="value"in gs?gs.value:gs.textContent,g=m.length;for(n=0;n<o&&i[n]===m[n];n++);var v=o-n;for(c=1;c<=v&&i[o-c]===m[g-c];c++);return za=m.slice(n,1<c?1-c:void 0)}function Ba(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Hs(){return!0}function Hr(){return!1}function bn(n){function i(o,c,m,g,v){this._reactName=o,this._targetInst=m,this.type=c,this.nativeEvent=g,this.target=v,this.currentTarget=null;for(var w in n)n.hasOwnProperty(w)&&(o=n[w],this[w]=o?o(g):g[w]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Hs:Hr,this.isPropagationStopped=Hr,this}return E(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Hs)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Hs)},persist:function(){},isPersistent:Hs}),i}var Gs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ys=bn(Gs),Ni=E({},Gs,{view:0,detail:0}),Wc=bn(Ni),Ri,el,_s,tl=E({},Ni,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ci,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==_s&&(_s&&n.type==="mousemove"?(Ri=n.screenX-_s.screenX,el=n.screenY-_s.screenY):el=Ri=0,_s=n),Ri)},movementY:function(n){return"movementY"in n?n.movementY:el}}),Xc=bn(tl),qa=E({},tl,{dataTransfer:0}),yh=bn(qa),_h=E({},Ni,{relatedTarget:0}),Fa=bn(_h),Jc=E({},Gs,{animationName:0,elapsedTime:0,pseudoElement:0}),vh=bn(Jc),nl=E({},Gs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),bh=bn(nl),xh=E({},Gs,{data:0}),vs=bn(xh),Eh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Th={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ih(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=wh[n])?!!i[n]:!1}function Ci(){return Ih}var Un=E({},Ni,{key:function(n){if(n.key){var i=Eh[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Ba(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Th[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ci,charCode:function(n){return n.type==="keypress"?Ba(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ba(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Sh=bn(Un),Ah=E({},tl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qs=bn(Ah),d=E({},Ni,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ci}),_=bn(d),x=E({},Gs,{propertyName:0,elapsedTime:0,pseudoElement:0}),S=bn(x),F=E({},tl,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),J=bn(F),ge=E({},Gs,{newState:0,oldState:0}),Ue=bn(ge),Bt=[9,13,27,32],at=wr&&"CompositionEvent"in window,It=null;wr&&"documentMode"in document&&(It=document.documentMode);var Ir=wr&&"TextEvent"in window&&!It,bs=wr&&(!at||It&&8<It&&11>=It),Gr=" ",Qr=!1;function Ha(n,i){switch(n){case"keyup":return Bt.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rl(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var sl=!1;function _N(n,i){switch(n){case"compositionend":return rl(i);case"keypress":return i.which!==32?null:(Qr=!0,Gr);case"textInput":return n=i.data,n===Gr&&Qr?null:n;default:return null}}function vN(n,i){if(sl)return n==="compositionend"||!at&&Ha(n,i)?(n=Yc(),za=$c=gs=null,sl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return bs&&i.locale!=="ko"?null:i.data;default:return null}}var bN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fv(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!bN[n.type]:i==="textarea"}function mv(n,i,o,c){Si?ps?ps.push(c):ps=[c]:Si=c,i=yf(i,"onChange"),0<i.length&&(o=new ys("onChange","change",null,o,c),n.push({event:o,listeners:i}))}var Zc=null,eu=null;function xN(n){Wx(n,0)}function Nh(n){var i=or(n);if(Oa(i))return n}function pv(n,i){if(n==="change")return i}var gv=!1;if(wr){var pp;if(wr){var gp="oninput"in document;if(!gp){var yv=document.createElement("div");yv.setAttribute("oninput","return;"),gp=typeof yv.oninput=="function"}pp=gp}else pp=!1;gv=pp&&(!document.documentMode||9<document.documentMode)}function _v(){Zc&&(Zc.detachEvent("onpropertychange",vv),eu=Zc=null)}function vv(n){if(n.propertyName==="value"&&Nh(eu)){var i=[];mv(i,eu,n,Tr(n)),Ai(xN,i)}}function EN(n,i,o){n==="focusin"?(_v(),Zc=i,eu=o,Zc.attachEvent("onpropertychange",vv)):n==="focusout"&&_v()}function TN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Nh(eu)}function wN(n,i){if(n==="click")return Nh(i)}function IN(n,i){if(n==="input"||n==="change")return Nh(i)}function SN(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var cr=typeof Object.is=="function"?Object.is:SN;function tu(n,i){if(cr(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var o=Object.keys(n),c=Object.keys(i);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var m=o[c];if(!$e.call(i,m)||!cr(n[m],i[m]))return!1}return!0}function bv(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function xv(n,i){var o=bv(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=i&&c>=i)return{node:o,offset:i-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=bv(o)}}function Ev(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?Ev(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Tv(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=ms(n.document);i instanceof n.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)n=i.contentWindow;else break;i=ms(n.document)}return i}function yp(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var AN=wr&&"documentMode"in document&&11>=document.documentMode,il=null,_p=null,nu=null,vp=!1;function wv(n,i,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;vp||il==null||il!==ms(c)||(c=il,"selectionStart"in c&&yp(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),nu&&tu(nu,c)||(nu=c,c=yf(_p,"onSelect"),0<c.length&&(i=new ys("onSelect","select",null,i,o),n.push({event:i,listeners:c}),i.target=il)))}function Ga(n,i){var o={};return o[n.toLowerCase()]=i.toLowerCase(),o["Webkit"+n]="webkit"+i,o["Moz"+n]="moz"+i,o}var al={animationend:Ga("Animation","AnimationEnd"),animationiteration:Ga("Animation","AnimationIteration"),animationstart:Ga("Animation","AnimationStart"),transitionrun:Ga("Transition","TransitionRun"),transitionstart:Ga("Transition","TransitionStart"),transitioncancel:Ga("Transition","TransitionCancel"),transitionend:Ga("Transition","TransitionEnd")},bp={},Iv={};wr&&(Iv=document.createElement("div").style,"AnimationEvent"in window||(delete al.animationend.animation,delete al.animationiteration.animation,delete al.animationstart.animation),"TransitionEvent"in window||delete al.transitionend.transition);function Qa(n){if(bp[n])return bp[n];if(!al[n])return n;var i=al[n],o;for(o in i)if(i.hasOwnProperty(o)&&o in Iv)return bp[n]=i[o];return n}var Sv=Qa("animationend"),Av=Qa("animationiteration"),Nv=Qa("animationstart"),NN=Qa("transitionrun"),RN=Qa("transitionstart"),CN=Qa("transitioncancel"),Rv=Qa("transitionend"),Cv=new Map,xp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xp.push("scrollEnd");function Kr(n,i){Cv.set(n,i),hs(i,[n])}var Rh=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Sr=[],ol=0,Ep=0;function Ch(){for(var n=ol,i=Ep=ol=0;i<n;){var o=Sr[i];Sr[i++]=null;var c=Sr[i];Sr[i++]=null;var m=Sr[i];Sr[i++]=null;var g=Sr[i];if(Sr[i++]=null,c!==null&&m!==null){var v=c.pending;v===null?m.next=m:(m.next=v.next,v.next=m),c.pending=m}g!==0&&kv(o,m,g)}}function kh(n,i,o,c){Sr[ol++]=n,Sr[ol++]=i,Sr[ol++]=o,Sr[ol++]=c,Ep|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Tp(n,i,o,c){return kh(n,i,o,c),Dh(n)}function Ka(n,i){return kh(n,null,null,i),Dh(n)}function kv(n,i,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var m=!1,g=n.return;g!==null;)g.childLanes|=o,c=g.alternate,c!==null&&(c.childLanes|=o),g.tag===22&&(n=g.stateNode,n===null||n._visibility&1||(m=!0)),n=g,g=g.return;return n.tag===3?(g=n.stateNode,m&&i!==null&&(m=31-Je(o),n=g.hiddenUpdates,c=n[m],c===null?n[m]=[i]:c.push(i),i.lane=o|536870912),g):null}function Dh(n){if(50<wu)throw wu=0,Dg=null,Error(r(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var ll={};function kN(n,i,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ur(n,i,o,c){return new kN(n,i,o,c)}function wp(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ks(n,i){var o=n.alternate;return o===null?(o=ur(n.tag,i,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=i,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,i=n.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Dv(n,i){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function Ph(n,i,o,c,m,g){var v=0;if(c=n,typeof n=="function")wp(n)&&(v=1);else if(typeof n=="string")v=OR(n,o,ne.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case k:return n=ur(31,o,i,m),n.elementType=k,n.lanes=g,n;case G:return $a(o.children,m,g,i);case te:v=8,m|=24;break;case I:return n=ur(12,o,i,m|2),n.elementType=I,n.lanes=g,n;case H:return n=ur(13,o,i,m),n.elementType=H,n.lanes=g,n;case ae:return n=ur(19,o,i,m),n.elementType=ae,n.lanes=g,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case se:v=10;break e;case X:v=9;break e;case fe:v=11;break e;case A:v=14;break e;case R:v=16,c=null;break e}v=29,o=Error(r(130,n===null?"null":typeof n,"")),c=null}return i=ur(v,o,i,m),i.elementType=n,i.type=c,i.lanes=g,i}function $a(n,i,o,c){return n=ur(7,n,c,i),n.lanes=o,n}function Ip(n,i,o){return n=ur(6,n,null,i),n.lanes=o,n}function Pv(n){var i=ur(18,null,null,0);return i.stateNode=n,i}function Sp(n,i,o){return i=ur(4,n.children!==null?n.children:[],n.key,i),i.lanes=o,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var jv=new WeakMap;function Ar(n,i){if(typeof n=="object"&&n!==null){var o=jv.get(n);return o!==void 0?o:(i={value:n,source:i,stack:$n(i)},jv.set(n,i),i)}return{value:n,source:i,stack:$n(i)}}var cl=[],ul=0,jh=null,ru=0,Nr=[],Rr=0,ki=null,xs=1,Es="";function $s(n,i){cl[ul++]=ru,cl[ul++]=jh,jh=n,ru=i}function Vv(n,i,o){Nr[Rr++]=xs,Nr[Rr++]=Es,Nr[Rr++]=ki,ki=n;var c=xs;n=Es;var m=32-Je(c)-1;c&=~(1<<m),o+=1;var g=32-Je(i)+m;if(30<g){var v=m-m%5;g=(c&(1<<v)-1).toString(32),c>>=v,m-=v,xs=1<<32-Je(i)+m|o<<m|c,Es=g+n}else xs=1<<g|o<<m|c,Es=n}function Ap(n){n.return!==null&&($s(n,1),Vv(n,1,0))}function Np(n){for(;n===jh;)jh=cl[--ul],cl[ul]=null,ru=cl[--ul],cl[ul]=null;for(;n===ki;)ki=Nr[--Rr],Nr[Rr]=null,Es=Nr[--Rr],Nr[Rr]=null,xs=Nr[--Rr],Nr[Rr]=null}function Ov(n,i){Nr[Rr++]=xs,Nr[Rr++]=Es,Nr[Rr++]=ki,xs=i.id,Es=i.overflow,ki=n}var xn=null,Et=null,Ze=!1,Di=null,Cr=!1,Rp=Error(r(519));function Pi(n){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw su(Ar(i,n)),Rp}function Mv(n){var i=n.stateNode,o=n.type,c=n.memoizedProps;switch(i[Yt]=n,i[dn]=c,o){case"dialog":Ge("cancel",i),Ge("close",i);break;case"iframe":case"object":case"embed":Ge("load",i);break;case"video":case"audio":for(o=0;o<Su.length;o++)Ge(Su[o],i);break;case"source":Ge("error",i);break;case"img":case"image":case"link":Ge("error",i),Ge("load",i);break;case"details":Ge("toggle",i);break;case"input":Ge("invalid",i),fh(i,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ge("invalid",i);break;case"textarea":Ge("invalid",i),wi(i,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||c.suppressHydrationWarning===!0||eE(i.textContent,o)?(c.popover!=null&&(Ge("beforetoggle",i),Ge("toggle",i)),c.onScroll!=null&&Ge("scroll",i),c.onScrollEnd!=null&&Ge("scrollend",i),c.onClick!=null&&(i.onclick=qr),i=!0):i=!1,i||Pi(n,!0)}function Lv(n){for(xn=n.return;xn;)switch(xn.tag){case 5:case 31:case 13:Cr=!1;return;case 27:case 3:Cr=!0;return;default:xn=xn.return}}function dl(n){if(n!==xn)return!1;if(!Ze)return Lv(n),Ze=!0,!1;var i=n.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Kg(n.type,n.memoizedProps)),o=!o),o&&Et&&Pi(n),Lv(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Et=cE(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Et=cE(n)}else i===27?(i=Et,Ki(n.type)?(n=Jg,Jg=null,Et=n):Et=i):Et=xn?Dr(n.stateNode.nextSibling):null;return!0}function Ya(){Et=xn=null,Ze=!1}function Cp(){var n=Di;return n!==null&&(er===null?er=n:er.push.apply(er,n),Di=null),n}function su(n){Di===null?Di=[n]:Di.push(n)}var kp=V(null),Wa=null,Ys=null;function ji(n,i,o){q(kp,i._currentValue),i._currentValue=o}function Ws(n){n._currentValue=kp.current,O(kp)}function Dp(n,i,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),n===o)break;n=n.return}}function Pp(n,i,o,c){var m=n.child;for(m!==null&&(m.return=n);m!==null;){var g=m.dependencies;if(g!==null){var v=m.child;g=g.firstContext;e:for(;g!==null;){var w=g;g=m;for(var D=0;D<i.length;D++)if(w.context===i[D]){g.lanes|=o,w=g.alternate,w!==null&&(w.lanes|=o),Dp(g.return,o,n),c||(v=null);break e}g=w.next}}else if(m.tag===18){if(v=m.return,v===null)throw Error(r(341));v.lanes|=o,g=v.alternate,g!==null&&(g.lanes|=o),Dp(v,o,n),v=null}else v=m.child;if(v!==null)v.return=m;else for(v=m;v!==null;){if(v===n){v=null;break}if(m=v.sibling,m!==null){m.return=v.return,v=m;break}v=v.return}m=v}}function hl(n,i,o,c){n=null;for(var m=i,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var v=m.alternate;if(v===null)throw Error(r(387));if(v=v.memoizedProps,v!==null){var w=m.type;cr(m.pendingProps.value,v.value)||(n!==null?n.push(w):n=[w])}}else if(m===_e.current){if(v=m.alternate,v===null)throw Error(r(387));v.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(n!==null?n.push(ku):n=[ku])}m=m.return}n!==null&&Pp(i,n,o,c),i.flags|=262144}function Vh(n){for(n=n.firstContext;n!==null;){if(!cr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Xa(n){Wa=n,Ys=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function En(n){return Uv(Wa,n)}function Oh(n,i){return Wa===null&&Xa(n),Uv(n,i)}function Uv(n,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Ys===null){if(n===null)throw Error(r(308));Ys=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else Ys=Ys.next=i;return o}var DN=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){i.aborted=!0,n.forEach(function(o){return o()})}},PN=s.unstable_scheduleCallback,jN=s.unstable_NormalPriority,Jt={$$typeof:se,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jp(){return{controller:new DN,data:new Map,refCount:0}}function iu(n){n.refCount--,n.refCount===0&&PN(jN,function(){n.controller.abort()})}var au=null,Vp=0,fl=0,ml=null;function VN(n,i){if(au===null){var o=au=[];Vp=0,fl=Lg(),ml={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Vp++,i.then(zv,zv),i}function zv(){if(--Vp===0&&au!==null){ml!==null&&(ml.status="fulfilled");var n=au;au=null,fl=0,ml=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function ON(n,i){var o=[],c={status:"pending",value:null,reason:null,then:function(m){o.push(m)}};return n.then(function(){c.status="fulfilled",c.value=i;for(var m=0;m<o.length;m++)(0,o[m])(i)},function(m){for(c.status="rejected",c.reason=m,m=0;m<o.length;m++)(0,o[m])(void 0)}),c}var Bv=Z.S;Z.S=function(n,i){wx=qe(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&VN(n,i),Bv!==null&&Bv(n,i)};var Ja=V(null);function Op(){var n=Ja.current;return n!==null?n:_t.pooledCache}function Mh(n,i){i===null?q(Ja,Ja.current):q(Ja,i.pool)}function qv(){var n=Op();return n===null?null:{parent:Jt._currentValue,pool:n}}var pl=Error(r(460)),Mp=Error(r(474)),Lh=Error(r(542)),Uh={then:function(){}};function Fv(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Hv(n,i,o){switch(o=n[o],o===void 0?n.push(i):o!==i&&(i.then(qr,qr),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Qv(n),n;default:if(typeof i.status=="string")i.then(qr,qr);else{if(n=_t,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=i,n.status="pending",n.then(function(c){if(i.status==="pending"){var m=i;m.status="fulfilled",m.value=c}},function(c){if(i.status==="pending"){var m=i;m.status="rejected",m.reason=c}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Qv(n),n}throw eo=i,pl}}function Za(n){try{var i=n._init;return i(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(eo=o,pl):o}}var eo=null;function Gv(){if(eo===null)throw Error(r(459));var n=eo;return eo=null,n}function Qv(n){if(n===pl||n===Lh)throw Error(r(483))}var gl=null,ou=0;function zh(n){var i=ou;return ou+=1,gl===null&&(gl=[]),Hv(gl,n,i)}function lu(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function Bh(n,i){throw i.$$typeof===T?Error(r(525)):(n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Kv(n){function i(U,M){if(n){var Q=U.deletions;Q===null?(U.deletions=[M],U.flags|=16):Q.push(M)}}function o(U,M){if(!n)return null;for(;M!==null;)i(U,M),M=M.sibling;return null}function c(U){for(var M=new Map;U!==null;)U.key!==null?M.set(U.key,U):M.set(U.index,U),U=U.sibling;return M}function m(U,M){return U=Ks(U,M),U.index=0,U.sibling=null,U}function g(U,M,Q){return U.index=Q,n?(Q=U.alternate,Q!==null?(Q=Q.index,Q<M?(U.flags|=67108866,M):Q):(U.flags|=67108866,M)):(U.flags|=1048576,M)}function v(U){return n&&U.alternate===null&&(U.flags|=67108866),U}function w(U,M,Q,ie){return M===null||M.tag!==6?(M=Ip(Q,U.mode,ie),M.return=U,M):(M=m(M,Q),M.return=U,M)}function D(U,M,Q,ie){var Re=Q.type;return Re===G?re(U,M,Q.props.children,ie,Q.key):M!==null&&(M.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===R&&Za(Re)===M.type)?(M=m(M,Q.props),lu(M,Q),M.return=U,M):(M=Ph(Q.type,Q.key,Q.props,null,U.mode,ie),lu(M,Q),M.return=U,M)}function K(U,M,Q,ie){return M===null||M.tag!==4||M.stateNode.containerInfo!==Q.containerInfo||M.stateNode.implementation!==Q.implementation?(M=Sp(Q,U.mode,ie),M.return=U,M):(M=m(M,Q.children||[]),M.return=U,M)}function re(U,M,Q,ie,Re){return M===null||M.tag!==7?(M=$a(Q,U.mode,ie,Re),M.return=U,M):(M=m(M,Q),M.return=U,M)}function oe(U,M,Q){if(typeof M=="string"&&M!==""||typeof M=="number"||typeof M=="bigint")return M=Ip(""+M,U.mode,Q),M.return=U,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case N:return Q=Ph(M.type,M.key,M.props,null,U.mode,Q),lu(Q,M),Q.return=U,Q;case B:return M=Sp(M,U.mode,Q),M.return=U,M;case R:return M=Za(M),oe(U,M,Q)}if(Pe(M)||L(M))return M=$a(M,U.mode,Q,null),M.return=U,M;if(typeof M.then=="function")return oe(U,zh(M),Q);if(M.$$typeof===se)return oe(U,Oh(U,M),Q);Bh(U,M)}return null}function $(U,M,Q,ie){var Re=M!==null?M.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Re!==null?null:w(U,M,""+Q,ie);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case N:return Q.key===Re?D(U,M,Q,ie):null;case B:return Q.key===Re?K(U,M,Q,ie):null;case R:return Q=Za(Q),$(U,M,Q,ie)}if(Pe(Q)||L(Q))return Re!==null?null:re(U,M,Q,ie,null);if(typeof Q.then=="function")return $(U,M,zh(Q),ie);if(Q.$$typeof===se)return $(U,M,Oh(U,Q),ie);Bh(U,Q)}return null}function ee(U,M,Q,ie,Re){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return U=U.get(Q)||null,w(M,U,""+ie,Re);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case N:return U=U.get(ie.key===null?Q:ie.key)||null,D(M,U,ie,Re);case B:return U=U.get(ie.key===null?Q:ie.key)||null,K(M,U,ie,Re);case R:return ie=Za(ie),ee(U,M,Q,ie,Re)}if(Pe(ie)||L(ie))return U=U.get(Q)||null,re(M,U,ie,Re,null);if(typeof ie.then=="function")return ee(U,M,Q,zh(ie),Re);if(ie.$$typeof===se)return ee(U,M,Q,Oh(M,ie),Re);Bh(M,ie)}return null}function Te(U,M,Q,ie){for(var Re=null,nt=null,Se=M,Fe=M=0,We=null;Se!==null&&Fe<Q.length;Fe++){Se.index>Fe?(We=Se,Se=null):We=Se.sibling;var rt=$(U,Se,Q[Fe],ie);if(rt===null){Se===null&&(Se=We);break}n&&Se&&rt.alternate===null&&i(U,Se),M=g(rt,M,Fe),nt===null?Re=rt:nt.sibling=rt,nt=rt,Se=We}if(Fe===Q.length)return o(U,Se),Ze&&$s(U,Fe),Re;if(Se===null){for(;Fe<Q.length;Fe++)Se=oe(U,Q[Fe],ie),Se!==null&&(M=g(Se,M,Fe),nt===null?Re=Se:nt.sibling=Se,nt=Se);return Ze&&$s(U,Fe),Re}for(Se=c(Se);Fe<Q.length;Fe++)We=ee(Se,U,Fe,Q[Fe],ie),We!==null&&(n&&We.alternate!==null&&Se.delete(We.key===null?Fe:We.key),M=g(We,M,Fe),nt===null?Re=We:nt.sibling=We,nt=We);return n&&Se.forEach(function(Ji){return i(U,Ji)}),Ze&&$s(U,Fe),Re}function ke(U,M,Q,ie){if(Q==null)throw Error(r(151));for(var Re=null,nt=null,Se=M,Fe=M=0,We=null,rt=Q.next();Se!==null&&!rt.done;Fe++,rt=Q.next()){Se.index>Fe?(We=Se,Se=null):We=Se.sibling;var Ji=$(U,Se,rt.value,ie);if(Ji===null){Se===null&&(Se=We);break}n&&Se&&Ji.alternate===null&&i(U,Se),M=g(Ji,M,Fe),nt===null?Re=Ji:nt.sibling=Ji,nt=Ji,Se=We}if(rt.done)return o(U,Se),Ze&&$s(U,Fe),Re;if(Se===null){for(;!rt.done;Fe++,rt=Q.next())rt=oe(U,rt.value,ie),rt!==null&&(M=g(rt,M,Fe),nt===null?Re=rt:nt.sibling=rt,nt=rt);return Ze&&$s(U,Fe),Re}for(Se=c(Se);!rt.done;Fe++,rt=Q.next())rt=ee(Se,U,Fe,rt.value,ie),rt!==null&&(n&&rt.alternate!==null&&Se.delete(rt.key===null?Fe:rt.key),M=g(rt,M,Fe),nt===null?Re=rt:nt.sibling=rt,nt=rt);return n&&Se.forEach(function(KR){return i(U,KR)}),Ze&&$s(U,Fe),Re}function yt(U,M,Q,ie){if(typeof Q=="object"&&Q!==null&&Q.type===G&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case N:e:{for(var Re=Q.key;M!==null;){if(M.key===Re){if(Re=Q.type,Re===G){if(M.tag===7){o(U,M.sibling),ie=m(M,Q.props.children),ie.return=U,U=ie;break e}}else if(M.elementType===Re||typeof Re=="object"&&Re!==null&&Re.$$typeof===R&&Za(Re)===M.type){o(U,M.sibling),ie=m(M,Q.props),lu(ie,Q),ie.return=U,U=ie;break e}o(U,M);break}else i(U,M);M=M.sibling}Q.type===G?(ie=$a(Q.props.children,U.mode,ie,Q.key),ie.return=U,U=ie):(ie=Ph(Q.type,Q.key,Q.props,null,U.mode,ie),lu(ie,Q),ie.return=U,U=ie)}return v(U);case B:e:{for(Re=Q.key;M!==null;){if(M.key===Re)if(M.tag===4&&M.stateNode.containerInfo===Q.containerInfo&&M.stateNode.implementation===Q.implementation){o(U,M.sibling),ie=m(M,Q.children||[]),ie.return=U,U=ie;break e}else{o(U,M);break}else i(U,M);M=M.sibling}ie=Sp(Q,U.mode,ie),ie.return=U,U=ie}return v(U);case R:return Q=Za(Q),yt(U,M,Q,ie)}if(Pe(Q))return Te(U,M,Q,ie);if(L(Q)){if(Re=L(Q),typeof Re!="function")throw Error(r(150));return Q=Re.call(Q),ke(U,M,Q,ie)}if(typeof Q.then=="function")return yt(U,M,zh(Q),ie);if(Q.$$typeof===se)return yt(U,M,Oh(U,Q),ie);Bh(U,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,M!==null&&M.tag===6?(o(U,M.sibling),ie=m(M,Q),ie.return=U,U=ie):(o(U,M),ie=Ip(Q,U.mode,ie),ie.return=U,U=ie),v(U)):o(U,M)}return function(U,M,Q,ie){try{ou=0;var Re=yt(U,M,Q,ie);return gl=null,Re}catch(Se){if(Se===pl||Se===Lh)throw Se;var nt=ur(29,Se,null,U.mode);return nt.lanes=ie,nt.return=U,nt}}}var to=Kv(!0),$v=Kv(!1),Vi=!1;function Lp(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Up(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Oi(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Mi(n,i,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(ot&2)!==0){var m=c.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),c.pending=i,i=Dh(n),kv(n,null,o),i}return kh(n,c,i,o),Dh(n)}function cu(n,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var c=i.lanes;c&=n.pendingLanes,o|=c,i.lanes=o,Oc(n,o)}}function zp(n,i){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var m=null,g=null;if(o=o.firstBaseUpdate,o!==null){do{var v={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};g===null?m=g=v:g=g.next=v,o=o.next}while(o!==null);g===null?m=g=i:g=g.next=i}else m=g=i;o={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=i:n.next=i,o.lastBaseUpdate=i}var Bp=!1;function uu(){if(Bp){var n=ml;if(n!==null)throw n}}function du(n,i,o,c){Bp=!1;var m=n.updateQueue;Vi=!1;var g=m.firstBaseUpdate,v=m.lastBaseUpdate,w=m.shared.pending;if(w!==null){m.shared.pending=null;var D=w,K=D.next;D.next=null,v===null?g=K:v.next=K,v=D;var re=n.alternate;re!==null&&(re=re.updateQueue,w=re.lastBaseUpdate,w!==v&&(w===null?re.firstBaseUpdate=K:w.next=K,re.lastBaseUpdate=D))}if(g!==null){var oe=m.baseState;v=0,re=K=D=null,w=g;do{var $=w.lane&-536870913,ee=$!==w.lane;if(ee?(Ye&$)===$:(c&$)===$){$!==0&&$===fl&&(Bp=!0),re!==null&&(re=re.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var Te=n,ke=w;$=i;var yt=o;switch(ke.tag){case 1:if(Te=ke.payload,typeof Te=="function"){oe=Te.call(yt,oe,$);break e}oe=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=ke.payload,$=typeof Te=="function"?Te.call(yt,oe,$):Te,$==null)break e;oe=E({},oe,$);break e;case 2:Vi=!0}}$=w.callback,$!==null&&(n.flags|=64,ee&&(n.flags|=8192),ee=m.callbacks,ee===null?m.callbacks=[$]:ee.push($))}else ee={lane:$,tag:w.tag,payload:w.payload,callback:w.callback,next:null},re===null?(K=re=ee,D=oe):re=re.next=ee,v|=$;if(w=w.next,w===null){if(w=m.shared.pending,w===null)break;ee=w,w=ee.next,ee.next=null,m.lastBaseUpdate=ee,m.shared.pending=null}}while(!0);re===null&&(D=oe),m.baseState=D,m.firstBaseUpdate=K,m.lastBaseUpdate=re,g===null&&(m.shared.lanes=0),qi|=v,n.lanes=v,n.memoizedState=oe}}function Yv(n,i){if(typeof n!="function")throw Error(r(191,n));n.call(i)}function Wv(n,i){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)Yv(o[n],i)}var yl=V(null),qh=V(0);function Xv(n,i){n=ii,q(qh,n),q(yl,i),ii=n|i.baseLanes}function qp(){q(qh,ii),q(yl,yl.current)}function Fp(){ii=qh.current,O(yl),O(qh)}var dr=V(null),kr=null;function Li(n){var i=n.alternate;q(qt,qt.current&1),q(dr,n),kr===null&&(i===null||yl.current!==null||i.memoizedState!==null)&&(kr=n)}function Hp(n){q(qt,qt.current),q(dr,n),kr===null&&(kr=n)}function Jv(n){n.tag===22?(q(qt,qt.current),q(dr,n),kr===null&&(kr=n)):Ui()}function Ui(){q(qt,qt.current),q(dr,dr.current)}function hr(n){O(dr),kr===n&&(kr=null),O(qt)}var qt=V(0);function Fh(n){for(var i=n;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Wg(o)||Xg(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Xs=0,ze=null,pt=null,Zt=null,Hh=!1,_l=!1,no=!1,Gh=0,hu=0,vl=null,MN=0;function Vt(){throw Error(r(321))}function Gp(n,i){if(i===null)return!1;for(var o=0;o<i.length&&o<n.length;o++)if(!cr(n[o],i[o]))return!1;return!0}function Qp(n,i,o,c,m,g){return Xs=g,ze=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Z.H=n===null||n.memoizedState===null?Vb:og,no=!1,g=o(c,m),no=!1,_l&&(g=eb(i,o,c,m)),Zv(n),g}function Zv(n){Z.H=pu;var i=pt!==null&&pt.next!==null;if(Xs=0,Zt=pt=ze=null,Hh=!1,hu=0,vl=null,i)throw Error(r(300));n===null||en||(n=n.dependencies,n!==null&&Vh(n)&&(en=!0))}function eb(n,i,o,c){ze=n;var m=0;do{if(_l&&(vl=null),hu=0,_l=!1,25<=m)throw Error(r(301));if(m+=1,Zt=pt=null,n.updateQueue!=null){var g=n.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}Z.H=Ob,g=i(o,c)}while(_l);return g}function LN(){var n=Z.H,i=n.useState()[0];return i=typeof i.then=="function"?fu(i):i,n=n.useState()[0],(pt!==null?pt.memoizedState:null)!==n&&(ze.flags|=1024),i}function Kp(){var n=Gh!==0;return Gh=0,n}function $p(n,i,o){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~o}function Yp(n){if(Hh){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Hh=!1}Xs=0,Zt=pt=ze=null,_l=!1,hu=Gh=0,vl=null}function zn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?ze.memoizedState=Zt=n:Zt=Zt.next=n,Zt}function Ft(){if(pt===null){var n=ze.alternate;n=n!==null?n.memoizedState:null}else n=pt.next;var i=Zt===null?ze.memoizedState:Zt.next;if(i!==null)Zt=i,pt=n;else{if(n===null)throw ze.alternate===null?Error(r(467)):Error(r(310));pt=n,n={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},Zt===null?ze.memoizedState=Zt=n:Zt=Zt.next=n}return Zt}function Qh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function fu(n){var i=hu;return hu+=1,vl===null&&(vl=[]),n=Hv(vl,n,i),i=ze,(Zt===null?i.memoizedState:Zt.next)===null&&(i=i.alternate,Z.H=i===null||i.memoizedState===null?Vb:og),n}function Kh(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return fu(n);if(n.$$typeof===se)return En(n)}throw Error(r(438,String(n)))}function Wp(n){var i=null,o=ze.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var c=ze.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(i={data:c.data.map(function(m){return m.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Qh(),ze.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(n),c=0;c<n;c++)o[c]=j;return i.index++,o}function Js(n,i){return typeof i=="function"?i(n):i}function $h(n){var i=Ft();return Xp(i,pt,n)}function Xp(n,i,o){var c=n.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=o;var m=n.baseQueue,g=c.pending;if(g!==null){if(m!==null){var v=m.next;m.next=g.next,g.next=v}i.baseQueue=m=g,c.pending=null}if(g=n.baseState,m===null)n.memoizedState=g;else{i=m.next;var w=v=null,D=null,K=i,re=!1;do{var oe=K.lane&-536870913;if(oe!==K.lane?(Ye&oe)===oe:(Xs&oe)===oe){var $=K.revertLane;if($===0)D!==null&&(D=D.next={lane:0,revertLane:0,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),oe===fl&&(re=!0);else if((Xs&$)===$){K=K.next,$===fl&&(re=!0);continue}else oe={lane:0,revertLane:K.revertLane,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},D===null?(w=D=oe,v=g):D=D.next=oe,ze.lanes|=$,qi|=$;oe=K.action,no&&o(g,oe),g=K.hasEagerState?K.eagerState:o(g,oe)}else $={lane:oe,revertLane:K.revertLane,gesture:K.gesture,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},D===null?(w=D=$,v=g):D=D.next=$,ze.lanes|=oe,qi|=oe;K=K.next}while(K!==null&&K!==i);if(D===null?v=g:D.next=w,!cr(g,n.memoizedState)&&(en=!0,re&&(o=ml,o!==null)))throw o;n.memoizedState=g,n.baseState=v,n.baseQueue=D,c.lastRenderedState=g}return m===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function Jp(n){var i=Ft(),o=i.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=n;var c=o.dispatch,m=o.pending,g=i.memoizedState;if(m!==null){o.pending=null;var v=m=m.next;do g=n(g,v.action),v=v.next;while(v!==m);cr(g,i.memoizedState)||(en=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),o.lastRenderedState=g}return[g,c]}function tb(n,i,o){var c=ze,m=Ft(),g=Ze;if(g){if(o===void 0)throw Error(r(407));o=o()}else o=i();var v=!cr((pt||m).memoizedState,o);if(v&&(m.memoizedState=o,en=!0),m=m.queue,tg(sb.bind(null,c,m,n),[n]),m.getSnapshot!==i||v||Zt!==null&&Zt.memoizedState.tag&1){if(c.flags|=2048,bl(9,{destroy:void 0},rb.bind(null,c,m,o,i),null),_t===null)throw Error(r(349));g||(Xs&127)!==0||nb(c,i,o)}return o}function nb(n,i,o){n.flags|=16384,n={getSnapshot:i,value:o},i=ze.updateQueue,i===null?(i=Qh(),ze.updateQueue=i,i.stores=[n]):(o=i.stores,o===null?i.stores=[n]:o.push(n))}function rb(n,i,o,c){i.value=o,i.getSnapshot=c,ib(i)&&ab(n)}function sb(n,i,o){return o(function(){ib(i)&&ab(n)})}function ib(n){var i=n.getSnapshot;n=n.value;try{var o=i();return!cr(n,o)}catch{return!0}}function ab(n){var i=Ka(n,2);i!==null&&tr(i,n,2)}function Zp(n){var i=zn();if(typeof n=="function"){var o=n;if(n=o(),no){je(!0);try{o()}finally{je(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Js,lastRenderedState:n},i}function ob(n,i,o,c){return n.baseState=o,Xp(n,pt,typeof c=="function"?c:Js)}function UN(n,i,o,c,m){if(Xh(n))throw Error(r(485));if(n=i.action,n!==null){var g={payload:m,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){g.listeners.push(v)}};Z.T!==null?o(!0):g.isTransition=!1,c(g),o=i.pending,o===null?(g.next=i.pending=g,lb(i,g)):(g.next=o.next,i.pending=o.next=g)}}function lb(n,i){var o=i.action,c=i.payload,m=n.state;if(i.isTransition){var g=Z.T,v={};Z.T=v;try{var w=o(m,c),D=Z.S;D!==null&&D(v,w),cb(n,i,w)}catch(K){eg(n,i,K)}finally{g!==null&&v.types!==null&&(g.types=v.types),Z.T=g}}else try{g=o(m,c),cb(n,i,g)}catch(K){eg(n,i,K)}}function cb(n,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){ub(n,i,c)},function(c){return eg(n,i,c)}):ub(n,i,o)}function ub(n,i,o){i.status="fulfilled",i.value=o,db(i),n.state=o,i=n.pending,i!==null&&(o=i.next,o===i?n.pending=null:(o=o.next,i.next=o,lb(n,o)))}function eg(n,i,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do i.status="rejected",i.reason=o,db(i),i=i.next;while(i!==c)}n.action=null}function db(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function hb(n,i){return i}function fb(n,i){if(Ze){var o=_t.formState;if(o!==null){e:{var c=ze;if(Ze){if(Et){t:{for(var m=Et,g=Cr;m.nodeType!==8;){if(!g){m=null;break t}if(m=Dr(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){Et=Dr(m.nextSibling),c=m.data==="F!";break e}}Pi(c)}c=!1}c&&(i=o[0])}}return o=zn(),o.memoizedState=o.baseState=i,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hb,lastRenderedState:i},o.queue=c,o=Db.bind(null,ze,c),c.dispatch=o,c=Zp(!1),g=ag.bind(null,ze,!1,c.queue),c=zn(),m={state:i,dispatch:null,action:n,pending:null},c.queue=m,o=UN.bind(null,ze,m,g,o),m.dispatch=o,c.memoizedState=n,[i,o,!1]}function mb(n){var i=Ft();return pb(i,pt,n)}function pb(n,i,o){if(i=Xp(n,i,hb)[0],n=$h(Js)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var c=fu(i)}catch(v){throw v===pl?Lh:v}else c=i;i=Ft();var m=i.queue,g=m.dispatch;return o!==i.memoizedState&&(ze.flags|=2048,bl(9,{destroy:void 0},zN.bind(null,m,o),null)),[c,g,n]}function zN(n,i){n.action=i}function gb(n){var i=Ft(),o=pt;if(o!==null)return pb(i,o,n);Ft(),i=i.memoizedState,o=Ft();var c=o.queue.dispatch;return o.memoizedState=n,[i,c,!1]}function bl(n,i,o,c){return n={tag:n,create:o,deps:c,inst:i,next:null},i=ze.updateQueue,i===null&&(i=Qh(),ze.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,i.lastEffect=n),n}function yb(){return Ft().memoizedState}function Yh(n,i,o,c){var m=zn();ze.flags|=n,m.memoizedState=bl(1|i,{destroy:void 0},o,c===void 0?null:c)}function Wh(n,i,o,c){var m=Ft();c=c===void 0?null:c;var g=m.memoizedState.inst;pt!==null&&c!==null&&Gp(c,pt.memoizedState.deps)?m.memoizedState=bl(i,g,o,c):(ze.flags|=n,m.memoizedState=bl(1|i,g,o,c))}function _b(n,i){Yh(8390656,8,n,i)}function tg(n,i){Wh(2048,8,n,i)}function BN(n){ze.flags|=4;var i=ze.updateQueue;if(i===null)i=Qh(),ze.updateQueue=i,i.events=[n];else{var o=i.events;o===null?i.events=[n]:o.push(n)}}function vb(n){var i=Ft().memoizedState;return BN({ref:i,nextImpl:n}),function(){if((ot&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function bb(n,i){return Wh(4,2,n,i)}function xb(n,i){return Wh(4,4,n,i)}function Eb(n,i){if(typeof i=="function"){n=n();var o=i(n);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Tb(n,i,o){o=o!=null?o.concat([n]):null,Wh(4,4,Eb.bind(null,i,n),o)}function ng(){}function wb(n,i){var o=Ft();i=i===void 0?null:i;var c=o.memoizedState;return i!==null&&Gp(i,c[1])?c[0]:(o.memoizedState=[n,i],n)}function Ib(n,i){var o=Ft();i=i===void 0?null:i;var c=o.memoizedState;if(i!==null&&Gp(i,c[1]))return c[0];if(c=n(),no){je(!0);try{n()}finally{je(!1)}}return o.memoizedState=[c,i],c}function rg(n,i,o){return o===void 0||(Xs&1073741824)!==0&&(Ye&261930)===0?n.memoizedState=i:(n.memoizedState=o,n=Sx(),ze.lanes|=n,qi|=n,o)}function Sb(n,i,o,c){return cr(o,i)?o:yl.current!==null?(n=rg(n,o,c),cr(n,i)||(en=!0),n):(Xs&42)===0||(Xs&1073741824)!==0&&(Ye&261930)===0?(en=!0,n.memoizedState=o):(n=Sx(),ze.lanes|=n,qi|=n,i)}function Ab(n,i,o,c,m){var g=pe.p;pe.p=g!==0&&8>g?g:8;var v=Z.T,w={};Z.T=w,ag(n,!1,i,o);try{var D=m(),K=Z.S;if(K!==null&&K(w,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var re=ON(D,c);mu(n,i,re,pr(n))}else mu(n,i,c,pr(n))}catch(oe){mu(n,i,{then:function(){},status:"rejected",reason:oe},pr())}finally{pe.p=g,v!==null&&w.types!==null&&(v.types=w.types),Z.T=v}}function qN(){}function sg(n,i,o,c){if(n.tag!==5)throw Error(r(476));var m=Nb(n).queue;Ab(n,m,i,Ee,o===null?qN:function(){return Rb(n),o(c)})}function Nb(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:Ee,baseState:Ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Js,lastRenderedState:Ee},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Js,lastRenderedState:o},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function Rb(n){var i=Nb(n);i.next===null&&(i=n.alternate.memoizedState),mu(n,i.next.queue,{},pr())}function ig(){return En(ku)}function Cb(){return Ft().memoizedState}function kb(){return Ft().memoizedState}function FN(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var o=pr();n=Oi(o);var c=Mi(i,n,o);c!==null&&(tr(c,i,o),cu(c,i,o)),i={cache:jp()},n.payload=i;return}i=i.return}}function HN(n,i,o){var c=pr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Xh(n)?Pb(i,o):(o=Tp(n,i,o,c),o!==null&&(tr(o,n,c),jb(o,i,c)))}function Db(n,i,o){var c=pr();mu(n,i,o,c)}function mu(n,i,o,c){var m={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Xh(n))Pb(i,m);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var v=i.lastRenderedState,w=g(v,o);if(m.hasEagerState=!0,m.eagerState=w,cr(w,v))return kh(n,i,m,0),_t===null&&Ch(),!1}catch{}if(o=Tp(n,i,m,c),o!==null)return tr(o,n,c),jb(o,i,c),!0}return!1}function ag(n,i,o,c){if(c={lane:2,revertLane:Lg(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Xh(n)){if(i)throw Error(r(479))}else i=Tp(n,o,c,2),i!==null&&tr(i,n,2)}function Xh(n){var i=n.alternate;return n===ze||i!==null&&i===ze}function Pb(n,i){_l=Hh=!0;var o=n.pending;o===null?i.next=i:(i.next=o.next,o.next=i),n.pending=i}function jb(n,i,o){if((o&4194048)!==0){var c=i.lanes;c&=n.pendingLanes,o|=c,i.lanes=o,Oc(n,o)}}var pu={readContext:En,use:Kh,useCallback:Vt,useContext:Vt,useEffect:Vt,useImperativeHandle:Vt,useLayoutEffect:Vt,useInsertionEffect:Vt,useMemo:Vt,useReducer:Vt,useRef:Vt,useState:Vt,useDebugValue:Vt,useDeferredValue:Vt,useTransition:Vt,useSyncExternalStore:Vt,useId:Vt,useHostTransitionStatus:Vt,useFormState:Vt,useActionState:Vt,useOptimistic:Vt,useMemoCache:Vt,useCacheRefresh:Vt};pu.useEffectEvent=Vt;var Vb={readContext:En,use:Kh,useCallback:function(n,i){return zn().memoizedState=[n,i===void 0?null:i],n},useContext:En,useEffect:_b,useImperativeHandle:function(n,i,o){o=o!=null?o.concat([n]):null,Yh(4194308,4,Eb.bind(null,i,n),o)},useLayoutEffect:function(n,i){return Yh(4194308,4,n,i)},useInsertionEffect:function(n,i){Yh(4,2,n,i)},useMemo:function(n,i){var o=zn();i=i===void 0?null:i;var c=n();if(no){je(!0);try{n()}finally{je(!1)}}return o.memoizedState=[c,i],c},useReducer:function(n,i,o){var c=zn();if(o!==void 0){var m=o(i);if(no){je(!0);try{o(i)}finally{je(!1)}}}else m=i;return c.memoizedState=c.baseState=m,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:m},c.queue=n,n=n.dispatch=HN.bind(null,ze,n),[c.memoizedState,n]},useRef:function(n){var i=zn();return n={current:n},i.memoizedState=n},useState:function(n){n=Zp(n);var i=n.queue,o=Db.bind(null,ze,i);return i.dispatch=o,[n.memoizedState,o]},useDebugValue:ng,useDeferredValue:function(n,i){var o=zn();return rg(o,n,i)},useTransition:function(){var n=Zp(!1);return n=Ab.bind(null,ze,n.queue,!0,!1),zn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,o){var c=ze,m=zn();if(Ze){if(o===void 0)throw Error(r(407));o=o()}else{if(o=i(),_t===null)throw Error(r(349));(Ye&127)!==0||nb(c,i,o)}m.memoizedState=o;var g={value:o,getSnapshot:i};return m.queue=g,_b(sb.bind(null,c,g,n),[n]),c.flags|=2048,bl(9,{destroy:void 0},rb.bind(null,c,g,o,i),null),o},useId:function(){var n=zn(),i=_t.identifierPrefix;if(Ze){var o=Es,c=xs;o=(c&~(1<<32-Je(c)-1)).toString(32)+o,i="_"+i+"R_"+o,o=Gh++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=MN++,i="_"+i+"r_"+o.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:ig,useFormState:fb,useActionState:fb,useOptimistic:function(n){var i=zn();i.memoizedState=i.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=ag.bind(null,ze,!0,o),o.dispatch=i,[n,i]},useMemoCache:Wp,useCacheRefresh:function(){return zn().memoizedState=FN.bind(null,ze)},useEffectEvent:function(n){var i=zn(),o={impl:n};return i.memoizedState=o,function(){if((ot&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}},og={readContext:En,use:Kh,useCallback:wb,useContext:En,useEffect:tg,useImperativeHandle:Tb,useInsertionEffect:bb,useLayoutEffect:xb,useMemo:Ib,useReducer:$h,useRef:yb,useState:function(){return $h(Js)},useDebugValue:ng,useDeferredValue:function(n,i){var o=Ft();return Sb(o,pt.memoizedState,n,i)},useTransition:function(){var n=$h(Js)[0],i=Ft().memoizedState;return[typeof n=="boolean"?n:fu(n),i]},useSyncExternalStore:tb,useId:Cb,useHostTransitionStatus:ig,useFormState:mb,useActionState:mb,useOptimistic:function(n,i){var o=Ft();return ob(o,pt,n,i)},useMemoCache:Wp,useCacheRefresh:kb};og.useEffectEvent=vb;var Ob={readContext:En,use:Kh,useCallback:wb,useContext:En,useEffect:tg,useImperativeHandle:Tb,useInsertionEffect:bb,useLayoutEffect:xb,useMemo:Ib,useReducer:Jp,useRef:yb,useState:function(){return Jp(Js)},useDebugValue:ng,useDeferredValue:function(n,i){var o=Ft();return pt===null?rg(o,n,i):Sb(o,pt.memoizedState,n,i)},useTransition:function(){var n=Jp(Js)[0],i=Ft().memoizedState;return[typeof n=="boolean"?n:fu(n),i]},useSyncExternalStore:tb,useId:Cb,useHostTransitionStatus:ig,useFormState:gb,useActionState:gb,useOptimistic:function(n,i){var o=Ft();return pt!==null?ob(o,pt,n,i):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:Wp,useCacheRefresh:kb};Ob.useEffectEvent=vb;function lg(n,i,o,c){i=n.memoizedState,o=o(c,i),o=o==null?i:E({},i,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var cg={enqueueSetState:function(n,i,o){n=n._reactInternals;var c=pr(),m=Oi(c);m.payload=i,o!=null&&(m.callback=o),i=Mi(n,m,c),i!==null&&(tr(i,n,c),cu(i,n,c))},enqueueReplaceState:function(n,i,o){n=n._reactInternals;var c=pr(),m=Oi(c);m.tag=1,m.payload=i,o!=null&&(m.callback=o),i=Mi(n,m,c),i!==null&&(tr(i,n,c),cu(i,n,c))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var o=pr(),c=Oi(o);c.tag=2,i!=null&&(c.callback=i),i=Mi(n,c,o),i!==null&&(tr(i,n,o),cu(i,n,o))}};function Mb(n,i,o,c,m,g,v){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,g,v):i.prototype&&i.prototype.isPureReactComponent?!tu(o,c)||!tu(m,g):!0}function Lb(n,i,o,c){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,c),i.state!==n&&cg.enqueueReplaceState(i,i.state,null)}function ro(n,i){var o=i;if("ref"in i){o={};for(var c in i)c!=="ref"&&(o[c]=i[c])}if(n=n.defaultProps){o===i&&(o=E({},o));for(var m in n)o[m]===void 0&&(o[m]=n[m])}return o}function Ub(n){Rh(n)}function zb(n){console.error(n)}function Bb(n){Rh(n)}function Jh(n,i){try{var o=n.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(c){setTimeout(function(){throw c})}}function qb(n,i,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function ug(n,i,o){return o=Oi(o),o.tag=3,o.payload={element:null},o.callback=function(){Jh(n,i)},o}function Fb(n){return n=Oi(n),n.tag=3,n}function Hb(n,i,o,c){var m=o.type.getDerivedStateFromError;if(typeof m=="function"){var g=c.value;n.payload=function(){return m(g)},n.callback=function(){qb(i,o,c)}}var v=o.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(n.callback=function(){qb(i,o,c),typeof m!="function"&&(Fi===null?Fi=new Set([this]):Fi.add(this));var w=c.stack;this.componentDidCatch(c.value,{componentStack:w!==null?w:""})})}function GN(n,i,o,c,m){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(i=o.alternate,i!==null&&hl(i,o,m,!0),o=dr.current,o!==null){switch(o.tag){case 31:case 13:return kr===null?df():o.alternate===null&&Ot===0&&(Ot=3),o.flags&=-257,o.flags|=65536,o.lanes=m,c===Uh?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([c]):i.add(c),Vg(n,c,m)),!1;case 22:return o.flags|=65536,c===Uh?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([c]):o.add(c)),Vg(n,c,m)),!1}throw Error(r(435,o.tag))}return Vg(n,c,m),df(),!1}if(Ze)return i=dr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=m,c!==Rp&&(n=Error(r(422),{cause:c}),su(Ar(n,o)))):(c!==Rp&&(i=Error(r(423),{cause:c}),su(Ar(i,o))),n=n.current.alternate,n.flags|=65536,m&=-m,n.lanes|=m,c=Ar(c,o),m=ug(n.stateNode,c,m),zp(n,m),Ot!==4&&(Ot=2)),!1;var g=Error(r(520),{cause:c});if(g=Ar(g,o),Tu===null?Tu=[g]:Tu.push(g),Ot!==4&&(Ot=2),i===null)return!0;c=Ar(c,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,n=m&-m,o.lanes|=n,n=ug(o.stateNode,c,n),zp(o,n),!1;case 1:if(i=o.type,g=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Fi===null||!Fi.has(g))))return o.flags|=65536,m&=-m,o.lanes|=m,m=Fb(m),Hb(m,n,o,c),zp(o,m),!1}o=o.return}while(o!==null);return!1}var dg=Error(r(461)),en=!1;function Tn(n,i,o,c){i.child=n===null?$v(i,null,o,c):to(i,n.child,o,c)}function Gb(n,i,o,c,m){o=o.render;var g=i.ref;if("ref"in c){var v={};for(var w in c)w!=="ref"&&(v[w]=c[w])}else v=c;return Xa(i),c=Qp(n,i,o,v,g,m),w=Kp(),n!==null&&!en?($p(n,i,m),Zs(n,i,m)):(Ze&&w&&Ap(i),i.flags|=1,Tn(n,i,c,m),i.child)}function Qb(n,i,o,c,m){if(n===null){var g=o.type;return typeof g=="function"&&!wp(g)&&g.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=g,Kb(n,i,g,c,m)):(n=Ph(o.type,null,c,i,i.mode,m),n.ref=i.ref,n.return=i,i.child=n)}if(g=n.child,!vg(n,m)){var v=g.memoizedProps;if(o=o.compare,o=o!==null?o:tu,o(v,c)&&n.ref===i.ref)return Zs(n,i,m)}return i.flags|=1,n=Ks(g,c),n.ref=i.ref,n.return=i,i.child=n}function Kb(n,i,o,c,m){if(n!==null){var g=n.memoizedProps;if(tu(g,c)&&n.ref===i.ref)if(en=!1,i.pendingProps=c=g,vg(n,m))(n.flags&131072)!==0&&(en=!0);else return i.lanes=n.lanes,Zs(n,i,m)}return hg(n,i,o,c,m)}function $b(n,i,o,c){var m=c.children,g=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((i.flags&128)!==0){if(g=g!==null?g.baseLanes|o:o,n!==null){for(c=i.child=n.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~g}else c=0,i.child=null;return Yb(n,i,g,o,c)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&Mh(i,g!==null?g.cachePool:null),g!==null?Xv(i,g):qp(),Jv(i);else return c=i.lanes=536870912,Yb(n,i,g!==null?g.baseLanes|o:o,o,c)}else g!==null?(Mh(i,g.cachePool),Xv(i,g),Ui(),i.memoizedState=null):(n!==null&&Mh(i,null),qp(),Ui());return Tn(n,i,m,o),i.child}function gu(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Yb(n,i,o,c,m){var g=Op();return g=g===null?null:{parent:Jt._currentValue,pool:g},i.memoizedState={baseLanes:o,cachePool:g},n!==null&&Mh(i,null),qp(),Jv(i),n!==null&&hl(n,i,c,!0),i.childLanes=m,null}function Zh(n,i){return i=tf({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function Wb(n,i,o){return to(i,n.child,null,o),n=Zh(i,i.pendingProps),n.flags|=2,hr(i),i.memoizedState=null,n}function QN(n,i,o){var c=i.pendingProps,m=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(Ze){if(c.mode==="hidden")return n=Zh(i,c),i.lanes=536870912,gu(null,n);if(Hp(i),(n=Et)?(n=lE(n,Cr),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:ki!==null?{id:xs,overflow:Es}:null,retryLane:536870912,hydrationErrors:null},o=Pv(n),o.return=i,i.child=o,xn=i,Et=null)):n=null,n===null)throw Pi(i);return i.lanes=536870912,null}return Zh(i,c)}var g=n.memoizedState;if(g!==null){var v=g.dehydrated;if(Hp(i),m)if(i.flags&256)i.flags&=-257,i=Wb(n,i,o);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(r(558));else if(en||hl(n,i,o,!1),m=(o&n.childLanes)!==0,en||m){if(c=_t,c!==null&&(v=Mc(c,o),v!==0&&v!==g.retryLane))throw g.retryLane=v,Ka(n,v),tr(c,n,v),dg;df(),i=Wb(n,i,o)}else n=g.treeContext,Et=Dr(v.nextSibling),xn=i,Ze=!0,Di=null,Cr=!1,n!==null&&Ov(i,n),i=Zh(i,c),i.flags|=4096;return i}return n=Ks(n.child,{mode:c.mode,children:c.children}),n.ref=i.ref,i.child=n,n.return=i,n}function ef(n,i){var o=i.ref;if(o===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(n===null||n.ref!==o)&&(i.flags|=4194816)}}function hg(n,i,o,c,m){return Xa(i),o=Qp(n,i,o,c,void 0,m),c=Kp(),n!==null&&!en?($p(n,i,m),Zs(n,i,m)):(Ze&&c&&Ap(i),i.flags|=1,Tn(n,i,o,m),i.child)}function Xb(n,i,o,c,m,g){return Xa(i),i.updateQueue=null,o=eb(i,c,o,m),Zv(n),c=Kp(),n!==null&&!en?($p(n,i,g),Zs(n,i,g)):(Ze&&c&&Ap(i),i.flags|=1,Tn(n,i,o,g),i.child)}function Jb(n,i,o,c,m){if(Xa(i),i.stateNode===null){var g=ll,v=o.contextType;typeof v=="object"&&v!==null&&(g=En(v)),g=new o(c,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=cg,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=c,g.state=i.memoizedState,g.refs={},Lp(i),v=o.contextType,g.context=typeof v=="object"&&v!==null?En(v):ll,g.state=i.memoizedState,v=o.getDerivedStateFromProps,typeof v=="function"&&(lg(i,o,v,c),g.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(v=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),v!==g.state&&cg.enqueueReplaceState(g,g.state,null),du(i,c,g,m),uu(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),c=!0}else if(n===null){g=i.stateNode;var w=i.memoizedProps,D=ro(o,w);g.props=D;var K=g.context,re=o.contextType;v=ll,typeof re=="object"&&re!==null&&(v=En(re));var oe=o.getDerivedStateFromProps;re=typeof oe=="function"||typeof g.getSnapshotBeforeUpdate=="function",w=i.pendingProps!==w,re||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(w||K!==v)&&Lb(i,g,c,v),Vi=!1;var $=i.memoizedState;g.state=$,du(i,c,g,m),uu(),K=i.memoizedState,w||$!==K||Vi?(typeof oe=="function"&&(lg(i,o,oe,c),K=i.memoizedState),(D=Vi||Mb(i,o,D,c,$,K,v))?(re||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=K),g.props=c,g.state=K,g.context=v,c=D):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{g=i.stateNode,Up(n,i),v=i.memoizedProps,re=ro(o,v),g.props=re,oe=i.pendingProps,$=g.context,K=o.contextType,D=ll,typeof K=="object"&&K!==null&&(D=En(K)),w=o.getDerivedStateFromProps,(K=typeof w=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(v!==oe||$!==D)&&Lb(i,g,c,D),Vi=!1,$=i.memoizedState,g.state=$,du(i,c,g,m),uu();var ee=i.memoizedState;v!==oe||$!==ee||Vi||n!==null&&n.dependencies!==null&&Vh(n.dependencies)?(typeof w=="function"&&(lg(i,o,w,c),ee=i.memoizedState),(re=Vi||Mb(i,o,re,c,$,ee,D)||n!==null&&n.dependencies!==null&&Vh(n.dependencies))?(K||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,ee,D),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,ee,D)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||v===n.memoizedProps&&$===n.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&$===n.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=ee),g.props=c,g.state=ee,g.context=D,c=re):(typeof g.componentDidUpdate!="function"||v===n.memoizedProps&&$===n.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&$===n.memoizedState||(i.flags|=1024),c=!1)}return g=c,ef(n,i),c=(i.flags&128)!==0,g||c?(g=i.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,n!==null&&c?(i.child=to(i,n.child,null,m),i.child=to(i,null,o,m)):Tn(n,i,o,m),i.memoizedState=g.state,n=i.child):n=Zs(n,i,m),n}function Zb(n,i,o,c){return Ya(),i.flags|=256,Tn(n,i,o,c),i.child}var fg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function mg(n){return{baseLanes:n,cachePool:qv()}}function pg(n,i,o){return n=n!==null?n.childLanes&~o:0,i&&(n|=mr),n}function ex(n,i,o){var c=i.pendingProps,m=!1,g=(i.flags&128)!==0,v;if((v=g)||(v=n!==null&&n.memoizedState===null?!1:(qt.current&2)!==0),v&&(m=!0,i.flags&=-129),v=(i.flags&32)!==0,i.flags&=-33,n===null){if(Ze){if(m?Li(i):Ui(),(n=Et)?(n=lE(n,Cr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:ki!==null?{id:xs,overflow:Es}:null,retryLane:536870912,hydrationErrors:null},o=Pv(n),o.return=i,i.child=o,xn=i,Et=null)):n=null,n===null)throw Pi(i);return Xg(n)?i.lanes=32:i.lanes=536870912,null}var w=c.children;return c=c.fallback,m?(Ui(),m=i.mode,w=tf({mode:"hidden",children:w},m),c=$a(c,m,o,null),w.return=i,c.return=i,w.sibling=c,i.child=w,c=i.child,c.memoizedState=mg(o),c.childLanes=pg(n,v,o),i.memoizedState=fg,gu(null,c)):(Li(i),gg(i,w))}var D=n.memoizedState;if(D!==null&&(w=D.dehydrated,w!==null)){if(g)i.flags&256?(Li(i),i.flags&=-257,i=yg(n,i,o)):i.memoizedState!==null?(Ui(),i.child=n.child,i.flags|=128,i=null):(Ui(),w=c.fallback,m=i.mode,c=tf({mode:"visible",children:c.children},m),w=$a(w,m,o,null),w.flags|=2,c.return=i,w.return=i,c.sibling=w,i.child=c,to(i,n.child,null,o),c=i.child,c.memoizedState=mg(o),c.childLanes=pg(n,v,o),i.memoizedState=fg,i=gu(null,c));else if(Li(i),Xg(w)){if(v=w.nextSibling&&w.nextSibling.dataset,v)var K=v.dgst;v=K,c=Error(r(419)),c.stack="",c.digest=v,su({value:c,source:null,stack:null}),i=yg(n,i,o)}else if(en||hl(n,i,o,!1),v=(o&n.childLanes)!==0,en||v){if(v=_t,v!==null&&(c=Mc(v,o),c!==0&&c!==D.retryLane))throw D.retryLane=c,Ka(n,c),tr(v,n,c),dg;Wg(w)||df(),i=yg(n,i,o)}else Wg(w)?(i.flags|=192,i.child=n.child,i=null):(n=D.treeContext,Et=Dr(w.nextSibling),xn=i,Ze=!0,Di=null,Cr=!1,n!==null&&Ov(i,n),i=gg(i,c.children),i.flags|=4096);return i}return m?(Ui(),w=c.fallback,m=i.mode,D=n.child,K=D.sibling,c=Ks(D,{mode:"hidden",children:c.children}),c.subtreeFlags=D.subtreeFlags&65011712,K!==null?w=Ks(K,w):(w=$a(w,m,o,null),w.flags|=2),w.return=i,c.return=i,c.sibling=w,i.child=c,gu(null,c),c=i.child,w=n.child.memoizedState,w===null?w=mg(o):(m=w.cachePool,m!==null?(D=Jt._currentValue,m=m.parent!==D?{parent:D,pool:D}:m):m=qv(),w={baseLanes:w.baseLanes|o,cachePool:m}),c.memoizedState=w,c.childLanes=pg(n,v,o),i.memoizedState=fg,gu(n.child,c)):(Li(i),o=n.child,n=o.sibling,o=Ks(o,{mode:"visible",children:c.children}),o.return=i,o.sibling=null,n!==null&&(v=i.deletions,v===null?(i.deletions=[n],i.flags|=16):v.push(n)),i.child=o,i.memoizedState=null,o)}function gg(n,i){return i=tf({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function tf(n,i){return n=ur(22,n,null,i),n.lanes=0,n}function yg(n,i,o){return to(i,n.child,null,o),n=gg(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function tx(n,i,o){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i),Dp(n.return,i,o)}function _g(n,i,o,c,m,g){var v=n.memoizedState;v===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:m,treeForkCount:g}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=o,v.tailMode=m,v.treeForkCount=g)}function nx(n,i,o){var c=i.pendingProps,m=c.revealOrder,g=c.tail;c=c.children;var v=qt.current,w=(v&2)!==0;if(w?(v=v&1|2,i.flags|=128):v&=1,q(qt,v),Tn(n,i,c,o),c=Ze?ru:0,!w&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&tx(n,o,i);else if(n.tag===19)tx(n,o,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(m){case"forwards":for(o=i.child,m=null;o!==null;)n=o.alternate,n!==null&&Fh(n)===null&&(m=o),o=o.sibling;o=m,o===null?(m=i.child,i.child=null):(m=o.sibling,o.sibling=null),_g(i,!1,m,o,g,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,m=i.child,i.child=null;m!==null;){if(n=m.alternate,n!==null&&Fh(n)===null){i.child=m;break}n=m.sibling,m.sibling=o,o=m,m=n}_g(i,!0,o,null,g,c);break;case"together":_g(i,!1,null,null,void 0,c);break;default:i.memoizedState=null}return i.child}function Zs(n,i,o){if(n!==null&&(i.dependencies=n.dependencies),qi|=i.lanes,(o&i.childLanes)===0)if(n!==null){if(hl(n,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,o=Ks(n,n.pendingProps),i.child=o,o.return=i;n.sibling!==null;)n=n.sibling,o=o.sibling=Ks(n,n.pendingProps),o.return=i;o.sibling=null}return i.child}function vg(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&Vh(n)))}function KN(n,i,o){switch(i.tag){case 3:it(i,i.stateNode.containerInfo),ji(i,Jt,n.memoizedState.cache),Ya();break;case 27:case 5:ar(i);break;case 4:it(i,i.stateNode.containerInfo);break;case 10:ji(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Hp(i),null;break;case 13:var c=i.memoizedState;if(c!==null)return c.dehydrated!==null?(Li(i),i.flags|=128,null):(o&i.child.childLanes)!==0?ex(n,i,o):(Li(i),n=Zs(n,i,o),n!==null?n.sibling:null);Li(i);break;case 19:var m=(n.flags&128)!==0;if(c=(o&i.childLanes)!==0,c||(hl(n,i,o,!1),c=(o&i.childLanes)!==0),m){if(c)return nx(n,i,o);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),q(qt,qt.current),c)break;return null;case 22:return i.lanes=0,$b(n,i,o,i.pendingProps);case 24:ji(i,Jt,n.memoizedState.cache)}return Zs(n,i,o)}function rx(n,i,o){if(n!==null)if(n.memoizedProps!==i.pendingProps)en=!0;else{if(!vg(n,o)&&(i.flags&128)===0)return en=!1,KN(n,i,o);en=(n.flags&131072)!==0}else en=!1,Ze&&(i.flags&1048576)!==0&&Vv(i,ru,i.index);switch(i.lanes=0,i.tag){case 16:e:{var c=i.pendingProps;if(n=Za(i.elementType),i.type=n,typeof n=="function")wp(n)?(c=ro(n,c),i.tag=1,i=Jb(null,i,n,c,o)):(i.tag=0,i=hg(null,i,n,c,o));else{if(n!=null){var m=n.$$typeof;if(m===fe){i.tag=11,i=Gb(null,i,n,c,o);break e}else if(m===A){i.tag=14,i=Qb(null,i,n,c,o);break e}}throw i=Me(n)||n,Error(r(306,i,""))}}return i;case 0:return hg(n,i,i.type,i.pendingProps,o);case 1:return c=i.type,m=ro(c,i.pendingProps),Jb(n,i,c,m,o);case 3:e:{if(it(i,i.stateNode.containerInfo),n===null)throw Error(r(387));c=i.pendingProps;var g=i.memoizedState;m=g.element,Up(n,i),du(i,c,null,o);var v=i.memoizedState;if(c=v.cache,ji(i,Jt,c),c!==g.cache&&Pp(i,[Jt],o,!0),uu(),c=v.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:v.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=Zb(n,i,c,o);break e}else if(c!==m){m=Ar(Error(r(424)),i),su(m),i=Zb(n,i,c,o);break e}else for(n=i.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Et=Dr(n.firstChild),xn=i,Ze=!0,Di=null,Cr=!0,o=$v(i,null,c,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ya(),c===m){i=Zs(n,i,o);break e}Tn(n,i,c,o)}i=i.child}return i;case 26:return ef(n,i),n===null?(o=mE(i.type,null,i.pendingProps,null))?i.memoizedState=o:Ze||(o=i.type,n=i.pendingProps,c=_f(me.current).createElement(o),c[Yt]=i,c[dn]=n,wn(c,o,n),Wt(c),i.stateNode=c):i.memoizedState=mE(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return ar(i),n===null&&Ze&&(c=i.stateNode=dE(i.type,i.pendingProps,me.current),xn=i,Cr=!0,m=Et,Ki(i.type)?(Jg=m,Et=Dr(c.firstChild)):Et=m),Tn(n,i,i.pendingProps.children,o),ef(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&Ze&&((m=c=Et)&&(c=TR(c,i.type,i.pendingProps,Cr),c!==null?(i.stateNode=c,xn=i,Et=Dr(c.firstChild),Cr=!1,m=!0):m=!1),m||Pi(i)),ar(i),m=i.type,g=i.pendingProps,v=n!==null?n.memoizedProps:null,c=g.children,Kg(m,g)?c=null:v!==null&&Kg(m,v)&&(i.flags|=32),i.memoizedState!==null&&(m=Qp(n,i,LN,null,null,o),ku._currentValue=m),ef(n,i),Tn(n,i,c,o),i.child;case 6:return n===null&&Ze&&((n=o=Et)&&(o=wR(o,i.pendingProps,Cr),o!==null?(i.stateNode=o,xn=i,Et=null,n=!0):n=!1),n||Pi(i)),null;case 13:return ex(n,i,o);case 4:return it(i,i.stateNode.containerInfo),c=i.pendingProps,n===null?i.child=to(i,null,c,o):Tn(n,i,c,o),i.child;case 11:return Gb(n,i,i.type,i.pendingProps,o);case 7:return Tn(n,i,i.pendingProps,o),i.child;case 8:return Tn(n,i,i.pendingProps.children,o),i.child;case 12:return Tn(n,i,i.pendingProps.children,o),i.child;case 10:return c=i.pendingProps,ji(i,i.type,c.value),Tn(n,i,c.children,o),i.child;case 9:return m=i.type._context,c=i.pendingProps.children,Xa(i),m=En(m),c=c(m),i.flags|=1,Tn(n,i,c,o),i.child;case 14:return Qb(n,i,i.type,i.pendingProps,o);case 15:return Kb(n,i,i.type,i.pendingProps,o);case 19:return nx(n,i,o);case 31:return QN(n,i,o);case 22:return $b(n,i,o,i.pendingProps);case 24:return Xa(i),c=En(Jt),n===null?(m=Op(),m===null&&(m=_t,g=jp(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=o),m=g),i.memoizedState={parent:c,cache:m},Lp(i),ji(i,Jt,m)):((n.lanes&o)!==0&&(Up(n,i),du(i,null,null,o),uu()),m=n.memoizedState,g=i.memoizedState,m.parent!==c?(m={parent:c,cache:c},i.memoizedState=m,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=m),ji(i,Jt,c)):(c=g.cache,ji(i,Jt,c),c!==m.cache&&Pp(i,[Jt],o,!0))),Tn(n,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function ei(n){n.flags|=4}function bg(n,i,o,c,m){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(m&335544128)===m)if(n.stateNode.complete)n.flags|=8192;else if(Cx())n.flags|=8192;else throw eo=Uh,Mp}else n.flags&=-16777217}function sx(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!vE(i))if(Cx())n.flags|=8192;else throw eo=Uh,Mp}function nf(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?lh():536870912,n.lanes|=i,wl|=i)}function yu(n,i){if(!Ze)switch(n.tailMode){case"hidden":i=n.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Tt(n){var i=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(i)for(var m=n.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)o|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=c,n.childLanes=o,i}function $N(n,i,o){var c=i.pendingProps;switch(Np(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(i),null;case 1:return Tt(i),null;case 3:return o=i.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Ws(Jt),tt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(dl(i)?ei(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Cp())),Tt(i),null;case 26:var m=i.type,g=i.memoizedState;return n===null?(ei(i),g!==null?(Tt(i),sx(i,g)):(Tt(i),bg(i,m,null,c,o))):g?g!==n.memoizedState?(ei(i),Tt(i),sx(i,g)):(Tt(i),i.flags&=-16777217):(n=n.memoizedProps,n!==c&&ei(i),Tt(i),bg(i,m,n,c,o)),null;case 27:if(zt(i),o=me.current,m=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==c&&ei(i);else{if(!c){if(i.stateNode===null)throw Error(r(166));return Tt(i),null}n=ne.current,dl(i)?Mv(i):(n=dE(m,c,o),i.stateNode=n,ei(i))}return Tt(i),null;case 5:if(zt(i),m=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==c&&ei(i);else{if(!c){if(i.stateNode===null)throw Error(r(166));return Tt(i),null}if(g=ne.current,dl(i))Mv(i);else{var v=_f(me.current);switch(g){case 1:g=v.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:g=v.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":g=v.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":g=v.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":g=v.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?v.createElement("select",{is:c.is}):v.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?v.createElement(m,{is:c.is}):v.createElement(m)}}g[Yt]=i,g[dn]=c;e:for(v=i.child;v!==null;){if(v.tag===5||v.tag===6)g.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===i)break e;for(;v.sibling===null;){if(v.return===null||v.return===i)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}i.stateNode=g;e:switch(wn(g,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ei(i)}}return Tt(i),bg(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,o),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==c&&ei(i);else{if(typeof c!="string"&&i.stateNode===null)throw Error(r(166));if(n=me.current,dl(i)){if(n=i.stateNode,o=i.memoizedProps,c=null,m=xn,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}n[Yt]=i,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||eE(n.nodeValue,o)),n||Pi(i,!0)}else n=_f(n).createTextNode(c),n[Yt]=i,i.stateNode=n}return Tt(i),null;case 31:if(o=i.memoizedState,n===null||n.memoizedState!==null){if(c=dl(i),o!==null){if(n===null){if(!c)throw Error(r(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(557));n[Yt]=i}else Ya(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Tt(i),n=!1}else o=Cp(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return i.flags&256?(hr(i),i):(hr(i),null);if((i.flags&128)!==0)throw Error(r(558))}return Tt(i),null;case 13:if(c=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(m=dl(i),c!==null&&c.dehydrated!==null){if(n===null){if(!m)throw Error(r(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));m[Yt]=i}else Ya(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Tt(i),m=!1}else m=Cp(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=m),m=!0;if(!m)return i.flags&256?(hr(i),i):(hr(i),null)}return hr(i),(i.flags&128)!==0?(i.lanes=o,i):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=i.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==m&&(c.flags|=2048)),o!==n&&o&&(i.child.flags|=8192),nf(i,i.updateQueue),Tt(i),null);case 4:return tt(),n===null&&qg(i.stateNode.containerInfo),Tt(i),null;case 10:return Ws(i.type),Tt(i),null;case 19:if(O(qt),c=i.memoizedState,c===null)return Tt(i),null;if(m=(i.flags&128)!==0,g=c.rendering,g===null)if(m)yu(c,!1);else{if(Ot!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(g=Fh(n),g!==null){for(i.flags|=128,yu(c,!1),n=g.updateQueue,i.updateQueue=n,nf(i,n),i.subtreeFlags=0,n=o,o=i.child;o!==null;)Dv(o,n),o=o.sibling;return q(qt,qt.current&1|2),Ze&&$s(i,c.treeForkCount),i.child}n=n.sibling}c.tail!==null&&qe()>lf&&(i.flags|=128,m=!0,yu(c,!1),i.lanes=4194304)}else{if(!m)if(n=Fh(g),n!==null){if(i.flags|=128,m=!0,n=n.updateQueue,i.updateQueue=n,nf(i,n),yu(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!Ze)return Tt(i),null}else 2*qe()-c.renderingStartTime>lf&&o!==536870912&&(i.flags|=128,m=!0,yu(c,!1),i.lanes=4194304);c.isBackwards?(g.sibling=i.child,i.child=g):(n=c.last,n!==null?n.sibling=g:i.child=g,c.last=g)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=qe(),n.sibling=null,o=qt.current,q(qt,m?o&1|2:o&1),Ze&&$s(i,c.treeForkCount),n):(Tt(i),null);case 22:case 23:return hr(i),Fp(),c=i.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(i.flags|=8192):c&&(i.flags|=8192),c?(o&536870912)!==0&&(i.flags&128)===0&&(Tt(i),i.subtreeFlags&6&&(i.flags|=8192)):Tt(i),o=i.updateQueue,o!==null&&nf(i,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),c!==o&&(i.flags|=2048),n!==null&&O(Ja),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Ws(Jt),Tt(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function YN(n,i){switch(Np(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Ws(Jt),tt(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return zt(i),null;case 31:if(i.memoizedState!==null){if(hr(i),i.alternate===null)throw Error(r(340));Ya()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(hr(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Ya()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return O(qt),null;case 4:return tt(),null;case 10:return Ws(i.type),null;case 22:case 23:return hr(i),Fp(),n!==null&&O(Ja),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Ws(Jt),null;case 25:return null;default:return null}}function ix(n,i){switch(Np(i),i.tag){case 3:Ws(Jt),tt();break;case 26:case 27:case 5:zt(i);break;case 4:tt();break;case 31:i.memoizedState!==null&&hr(i);break;case 13:hr(i);break;case 19:O(qt);break;case 10:Ws(i.type);break;case 22:case 23:hr(i),Fp(),n!==null&&O(Ja);break;case 24:Ws(Jt)}}function _u(n,i){try{var o=i.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var m=c.next;o=m;do{if((o.tag&n)===n){c=void 0;var g=o.create,v=o.inst;c=g(),v.destroy=c}o=o.next}while(o!==m)}}catch(w){dt(i,i.return,w)}}function zi(n,i,o){try{var c=i.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var g=m.next;c=g;do{if((c.tag&n)===n){var v=c.inst,w=v.destroy;if(w!==void 0){v.destroy=void 0,m=i;var D=o,K=w;try{K()}catch(re){dt(m,D,re)}}}c=c.next}while(c!==g)}}catch(re){dt(i,i.return,re)}}function ax(n){var i=n.updateQueue;if(i!==null){var o=n.stateNode;try{Wv(i,o)}catch(c){dt(n,n.return,c)}}}function ox(n,i,o){o.props=ro(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){dt(n,i,c)}}function vu(n,i){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(m){dt(n,i,m)}}function Ts(n,i){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(m){dt(n,i,m)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(m){dt(n,i,m)}else o.current=null}function lx(n){var i=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(m){dt(n,n.return,m)}}function xg(n,i,o){try{var c=n.stateNode;yR(c,n.type,o,i),c[dn]=i}catch(m){dt(n,n.return,m)}}function cx(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Ki(n.type)||n.tag===4}function Eg(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||cx(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Ki(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Tg(n,i,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(n),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=qr));else if(c!==4&&(c===27&&Ki(n.type)&&(o=n.stateNode,i=null),n=n.child,n!==null))for(Tg(n,i,o),n=n.sibling;n!==null;)Tg(n,i,o),n=n.sibling}function rf(n,i,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?o.insertBefore(n,i):o.appendChild(n);else if(c!==4&&(c===27&&Ki(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(rf(n,i,o),n=n.sibling;n!==null;)rf(n,i,o),n=n.sibling}function ux(n){var i=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,m=i.attributes;m.length;)i.removeAttributeNode(m[0]);wn(i,c,o),i[Yt]=n,i[dn]=o}catch(g){dt(n,n.return,g)}}var ti=!1,tn=!1,wg=!1,dx=typeof WeakSet=="function"?WeakSet:Set,fn=null;function WN(n,i){if(n=n.containerInfo,Gg=If,n=Tv(n),yp(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var m=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{o.nodeType,g.nodeType}catch{o=null;break e}var v=0,w=-1,D=-1,K=0,re=0,oe=n,$=null;t:for(;;){for(var ee;oe!==o||m!==0&&oe.nodeType!==3||(w=v+m),oe!==g||c!==0&&oe.nodeType!==3||(D=v+c),oe.nodeType===3&&(v+=oe.nodeValue.length),(ee=oe.firstChild)!==null;)$=oe,oe=ee;for(;;){if(oe===n)break t;if($===o&&++K===m&&(w=v),$===g&&++re===c&&(D=v),(ee=oe.nextSibling)!==null)break;oe=$,$=oe.parentNode}oe=ee}o=w===-1||D===-1?null:{start:w,end:D}}else o=null}o=o||{start:0,end:0}}else o=null;for(Qg={focusedElem:n,selectionRange:o},If=!1,fn=i;fn!==null;)if(i=fn,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,fn=n;else for(;fn!==null;){switch(i=fn,g=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)m=n[o],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&g!==null){n=void 0,o=i,m=g.memoizedProps,g=g.memoizedState,c=o.stateNode;try{var Te=ro(o.type,m);n=c.getSnapshotBeforeUpdate(Te,g),c.__reactInternalSnapshotBeforeUpdate=n}catch(ke){dt(o,o.return,ke)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,o=n.nodeType,o===9)Yg(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Yg(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=i.sibling,n!==null){n.return=i.return,fn=n;break}fn=i.return}}function hx(n,i,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:ri(n,o),c&4&&_u(5,o);break;case 1:if(ri(n,o),c&4)if(n=o.stateNode,i===null)try{n.componentDidMount()}catch(v){dt(o,o.return,v)}else{var m=ro(o.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(m,i,n.__reactInternalSnapshotBeforeUpdate)}catch(v){dt(o,o.return,v)}}c&64&&ax(o),c&512&&vu(o,o.return);break;case 3:if(ri(n,o),c&64&&(n=o.updateQueue,n!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{Wv(n,i)}catch(v){dt(o,o.return,v)}}break;case 27:i===null&&c&4&&ux(o);case 26:case 5:ri(n,o),i===null&&c&4&&lx(o),c&512&&vu(o,o.return);break;case 12:ri(n,o);break;case 31:ri(n,o),c&4&&px(n,o);break;case 13:ri(n,o),c&4&&gx(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=iR.bind(null,o),IR(n,o))));break;case 22:if(c=o.memoizedState!==null||ti,!c){i=i!==null&&i.memoizedState!==null||tn,m=ti;var g=tn;ti=c,(tn=i)&&!g?si(n,o,(o.subtreeFlags&8772)!==0):ri(n,o),ti=m,tn=g}break;case 30:break;default:ri(n,o)}}function fx(n){var i=n.alternate;i!==null&&(n.alternate=null,fx(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&$o(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var St=null,Xn=!1;function ni(n,i,o){for(o=o.child;o!==null;)mx(n,i,o),o=o.sibling}function mx(n,i,o){if(be&&typeof be.onCommitFiberUnmount=="function")try{be.onCommitFiberUnmount(Ln,o)}catch{}switch(o.tag){case 26:tn||Ts(o,i),ni(n,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:tn||Ts(o,i);var c=St,m=Xn;Ki(o.type)&&(St=o.stateNode,Xn=!1),ni(n,i,o),Nu(o.stateNode),St=c,Xn=m;break;case 5:tn||Ts(o,i);case 6:if(c=St,m=Xn,St=null,ni(n,i,o),St=c,Xn=m,St!==null)if(Xn)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(o.stateNode)}catch(g){dt(o,i,g)}else try{St.removeChild(o.stateNode)}catch(g){dt(o,i,g)}break;case 18:St!==null&&(Xn?(n=St,aE(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Dl(n)):aE(St,o.stateNode));break;case 4:c=St,m=Xn,St=o.stateNode.containerInfo,Xn=!0,ni(n,i,o),St=c,Xn=m;break;case 0:case 11:case 14:case 15:zi(2,o,i),tn||zi(4,o,i),ni(n,i,o);break;case 1:tn||(Ts(o,i),c=o.stateNode,typeof c.componentWillUnmount=="function"&&ox(o,i,c)),ni(n,i,o);break;case 21:ni(n,i,o);break;case 22:tn=(c=tn)||o.memoizedState!==null,ni(n,i,o),tn=c;break;default:ni(n,i,o)}}function px(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Dl(n)}catch(o){dt(i,i.return,o)}}}function gx(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Dl(n)}catch(o){dt(i,i.return,o)}}function XN(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new dx),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new dx),i;default:throw Error(r(435,n.tag))}}function sf(n,i){var o=XN(n);i.forEach(function(c){if(!o.has(c)){o.add(c);var m=aR.bind(null,n,c);c.then(m,m)}})}function Jn(n,i){var o=i.deletions;if(o!==null)for(var c=0;c<o.length;c++){var m=o[c],g=n,v=i,w=v;e:for(;w!==null;){switch(w.tag){case 27:if(Ki(w.type)){St=w.stateNode,Xn=!1;break e}break;case 5:St=w.stateNode,Xn=!1;break e;case 3:case 4:St=w.stateNode.containerInfo,Xn=!0;break e}w=w.return}if(St===null)throw Error(r(160));mx(g,v,m),St=null,Xn=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)yx(i,n),i=i.sibling}var $r=null;function yx(n,i){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Jn(i,n),Zn(n),c&4&&(zi(3,n,n.return),_u(3,n),zi(5,n,n.return));break;case 1:Jn(i,n),Zn(n),c&512&&(tn||o===null||Ts(o,o.return)),c&64&&ti&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var m=$r;if(Jn(i,n),Zn(n),c&512&&(tn||o===null||Ts(o,o.return)),c&4){var g=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,m=m.ownerDocument||m;t:switch(c){case"title":g=m.getElementsByTagName("title")[0],(!g||g[cs]||g[Yt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(c),m.head.insertBefore(g,m.querySelector("head > title"))),wn(g,c,o),g[Yt]=n,Wt(g),c=g;break e;case"link":var v=yE("link","href",m).get(c+(o.href||""));if(v){for(var w=0;w<v.length;w++)if(g=v[w],g.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&g.getAttribute("rel")===(o.rel==null?null:o.rel)&&g.getAttribute("title")===(o.title==null?null:o.title)&&g.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){v.splice(w,1);break t}}g=m.createElement(c),wn(g,c,o),m.head.appendChild(g);break;case"meta":if(v=yE("meta","content",m).get(c+(o.content||""))){for(w=0;w<v.length;w++)if(g=v[w],g.getAttribute("content")===(o.content==null?null:""+o.content)&&g.getAttribute("name")===(o.name==null?null:o.name)&&g.getAttribute("property")===(o.property==null?null:o.property)&&g.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&g.getAttribute("charset")===(o.charSet==null?null:o.charSet)){v.splice(w,1);break t}}g=m.createElement(c),wn(g,c,o),m.head.appendChild(g);break;default:throw Error(r(468,c))}g[Yt]=n,Wt(g),c=g}n.stateNode=c}else _E(m,n.type,n.stateNode);else n.stateNode=gE(m,c,n.memoizedProps);else g!==c?(g===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):g.count--,c===null?_E(m,n.type,n.stateNode):gE(m,c,n.memoizedProps)):c===null&&n.stateNode!==null&&xg(n,n.memoizedProps,o.memoizedProps)}break;case 27:Jn(i,n),Zn(n),c&512&&(tn||o===null||Ts(o,o.return)),o!==null&&c&4&&xg(n,n.memoizedProps,o.memoizedProps);break;case 5:if(Jn(i,n),Zn(n),c&512&&(tn||o===null||Ts(o,o.return)),n.flags&32){m=n.stateNode;try{Wn(m,"")}catch(Te){dt(n,n.return,Te)}}c&4&&n.stateNode!=null&&(m=n.memoizedProps,xg(n,m,o!==null?o.memoizedProps:m)),c&1024&&(wg=!0);break;case 6:if(Jn(i,n),Zn(n),c&4){if(n.stateNode===null)throw Error(r(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(Te){dt(n,n.return,Te)}}break;case 3:if(xf=null,m=$r,$r=vf(i.containerInfo),Jn(i,n),$r=m,Zn(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Dl(i.containerInfo)}catch(Te){dt(n,n.return,Te)}wg&&(wg=!1,_x(n));break;case 4:c=$r,$r=vf(n.stateNode.containerInfo),Jn(i,n),Zn(n),$r=c;break;case 12:Jn(i,n),Zn(n);break;case 31:Jn(i,n),Zn(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,sf(n,c)));break;case 13:Jn(i,n),Zn(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(of=qe()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,sf(n,c)));break;case 22:m=n.memoizedState!==null;var D=o!==null&&o.memoizedState!==null,K=ti,re=tn;if(ti=K||m,tn=re||D,Jn(i,n),tn=re,ti=K,Zn(n),c&8192)e:for(i=n.stateNode,i._visibility=m?i._visibility&-2:i._visibility|1,m&&(o===null||D||ti||tn||so(n)),o=null,i=n;;){if(i.tag===5||i.tag===26){if(o===null){D=o=i;try{if(g=D.stateNode,m)v=g.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{w=D.stateNode;var oe=D.memoizedProps.style,$=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;w.style.display=$==null||typeof $=="boolean"?"":(""+$).trim()}}catch(Te){dt(D,D.return,Te)}}}else if(i.tag===6){if(o===null){D=i;try{D.stateNode.nodeValue=m?"":D.memoizedProps}catch(Te){dt(D,D.return,Te)}}}else if(i.tag===18){if(o===null){D=i;try{var ee=D.stateNode;m?oE(ee,!0):oE(D.stateNode,!1)}catch(Te){dt(D,D.return,Te)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,sf(n,o))));break;case 19:Jn(i,n),Zn(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,sf(n,c)));break;case 30:break;case 21:break;default:Jn(i,n),Zn(n)}}function Zn(n){var i=n.flags;if(i&2){try{for(var o,c=n.return;c!==null;){if(cx(c)){o=c;break}c=c.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var m=o.stateNode,g=Eg(n);rf(n,g,m);break;case 5:var v=o.stateNode;o.flags&32&&(Wn(v,""),o.flags&=-33);var w=Eg(n);rf(n,w,v);break;case 3:case 4:var D=o.stateNode.containerInfo,K=Eg(n);Tg(n,K,D);break;default:throw Error(r(161))}}catch(re){dt(n,n.return,re)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function _x(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;_x(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function ri(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)hx(n,i.alternate,i),i=i.sibling}function so(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:zi(4,i,i.return),so(i);break;case 1:Ts(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&ox(i,i.return,o),so(i);break;case 27:Nu(i.stateNode);case 26:case 5:Ts(i,i.return),so(i);break;case 22:i.memoizedState===null&&so(i);break;case 30:so(i);break;default:so(i)}n=n.sibling}}function si(n,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var c=i.alternate,m=n,g=i,v=g.flags;switch(g.tag){case 0:case 11:case 15:si(m,g,o),_u(4,g);break;case 1:if(si(m,g,o),c=g,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(K){dt(c,c.return,K)}if(c=g,m=c.updateQueue,m!==null){var w=c.stateNode;try{var D=m.shared.hiddenCallbacks;if(D!==null)for(m.shared.hiddenCallbacks=null,m=0;m<D.length;m++)Yv(D[m],w)}catch(K){dt(c,c.return,K)}}o&&v&64&&ax(g),vu(g,g.return);break;case 27:ux(g);case 26:case 5:si(m,g,o),o&&c===null&&v&4&&lx(g),vu(g,g.return);break;case 12:si(m,g,o);break;case 31:si(m,g,o),o&&v&4&&px(m,g);break;case 13:si(m,g,o),o&&v&4&&gx(m,g);break;case 22:g.memoizedState===null&&si(m,g,o),vu(g,g.return);break;case 30:break;default:si(m,g,o)}i=i.sibling}}function Ig(n,i){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&iu(o))}function Sg(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&iu(n))}function Yr(n,i,o,c){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)vx(n,i,o,c),i=i.sibling}function vx(n,i,o,c){var m=i.flags;switch(i.tag){case 0:case 11:case 15:Yr(n,i,o,c),m&2048&&_u(9,i);break;case 1:Yr(n,i,o,c);break;case 3:Yr(n,i,o,c),m&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&iu(n)));break;case 12:if(m&2048){Yr(n,i,o,c),n=i.stateNode;try{var g=i.memoizedProps,v=g.id,w=g.onPostCommit;typeof w=="function"&&w(v,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(D){dt(i,i.return,D)}}else Yr(n,i,o,c);break;case 31:Yr(n,i,o,c);break;case 13:Yr(n,i,o,c);break;case 23:break;case 22:g=i.stateNode,v=i.alternate,i.memoizedState!==null?g._visibility&2?Yr(n,i,o,c):bu(n,i):g._visibility&2?Yr(n,i,o,c):(g._visibility|=2,xl(n,i,o,c,(i.subtreeFlags&10256)!==0||!1)),m&2048&&Ig(v,i);break;case 24:Yr(n,i,o,c),m&2048&&Sg(i.alternate,i);break;default:Yr(n,i,o,c)}}function xl(n,i,o,c,m){for(m=m&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var g=n,v=i,w=o,D=c,K=v.flags;switch(v.tag){case 0:case 11:case 15:xl(g,v,w,D,m),_u(8,v);break;case 23:break;case 22:var re=v.stateNode;v.memoizedState!==null?re._visibility&2?xl(g,v,w,D,m):bu(g,v):(re._visibility|=2,xl(g,v,w,D,m)),m&&K&2048&&Ig(v.alternate,v);break;case 24:xl(g,v,w,D,m),m&&K&2048&&Sg(v.alternate,v);break;default:xl(g,v,w,D,m)}i=i.sibling}}function bu(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=n,c=i,m=c.flags;switch(c.tag){case 22:bu(o,c),m&2048&&Ig(c.alternate,c);break;case 24:bu(o,c),m&2048&&Sg(c.alternate,c);break;default:bu(o,c)}i=i.sibling}}var xu=8192;function El(n,i,o){if(n.subtreeFlags&xu)for(n=n.child;n!==null;)bx(n,i,o),n=n.sibling}function bx(n,i,o){switch(n.tag){case 26:El(n,i,o),n.flags&xu&&n.memoizedState!==null&&MR(o,$r,n.memoizedState,n.memoizedProps);break;case 5:El(n,i,o);break;case 3:case 4:var c=$r;$r=vf(n.stateNode.containerInfo),El(n,i,o),$r=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=xu,xu=16777216,El(n,i,o),xu=c):El(n,i,o));break;default:El(n,i,o)}}function xx(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Eu(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var c=i[o];fn=c,Tx(c,n)}xx(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Ex(n),n=n.sibling}function Ex(n){switch(n.tag){case 0:case 11:case 15:Eu(n),n.flags&2048&&zi(9,n,n.return);break;case 3:Eu(n);break;case 12:Eu(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,af(n)):Eu(n);break;default:Eu(n)}}function af(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var c=i[o];fn=c,Tx(c,n)}xx(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:zi(8,i,i.return),af(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,af(i));break;default:af(i)}n=n.sibling}}function Tx(n,i){for(;fn!==null;){var o=fn;switch(o.tag){case 0:case 11:case 15:zi(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:iu(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,fn=c;else e:for(o=n;fn!==null;){c=fn;var m=c.sibling,g=c.return;if(fx(c),c===o){fn=null;break e}if(m!==null){m.return=g,fn=m;break e}fn=g}}}var JN={getCacheForType:function(n){var i=En(Jt),o=i.data.get(n);return o===void 0&&(o=n(),i.data.set(n,o)),o},cacheSignal:function(){return En(Jt).controller.signal}},ZN=typeof WeakMap=="function"?WeakMap:Map,ot=0,_t=null,He=null,Ye=0,ut=0,fr=null,Bi=!1,Tl=!1,Ag=!1,ii=0,Ot=0,qi=0,io=0,Ng=0,mr=0,wl=0,Tu=null,er=null,Rg=!1,of=0,wx=0,lf=1/0,cf=null,Fi=null,ln=0,Hi=null,Il=null,ai=0,Cg=0,kg=null,Ix=null,wu=0,Dg=null;function pr(){return(ot&2)!==0&&Ye!==0?Ye&-Ye:Z.T!==null?Lg():ch()}function Sx(){if(mr===0)if((Ye&536870912)===0||Ze){var n=Da;Da<<=1,(Da&3932160)===0&&(Da=262144),mr=n}else mr=536870912;return n=dr.current,n!==null&&(n.flags|=32),mr}function tr(n,i,o){(n===_t&&(ut===2||ut===9)||n.cancelPendingCommit!==null)&&(Sl(n,0),Gi(n,Ye,mr,!1)),Pa(n,o),((ot&2)===0||n!==_t)&&(n===_t&&((ot&2)===0&&(io|=o),Ot===4&&Gi(n,Ye,mr,!1)),ws(n))}function Ax(n,i,o){if((ot&6)!==0)throw Error(r(327));var c=!o&&(i&127)===0&&(i&n.expiredLanes)===0||Ur(n,i),m=c?nR(n,i):jg(n,i,!0),g=c;do{if(m===0){Tl&&!c&&Gi(n,i,0,!1);break}else{if(o=n.current.alternate,g&&!eR(o)){m=jg(n,i,!1),g=!1;continue}if(m===2){if(g=i,n.errorRecoveryDisabledLanes&g)var v=0;else v=n.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){i=v;e:{var w=n;m=Tu;var D=w.current.memoizedState.isDehydrated;if(D&&(Sl(w,v).flags|=256),v=jg(w,v,!1),v!==2){if(Ag&&!D){w.errorRecoveryDisabledLanes|=g,io|=g,m=4;break e}g=er,er=m,g!==null&&(er===null?er=g:er.push.apply(er,g))}m=v}if(g=!1,m!==2)continue}}if(m===1){Sl(n,0),Gi(n,i,0,!0);break}e:{switch(c=n,g=m,g){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:Gi(c,i,mr,!Bi);break e;case 2:er=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(m=of+300-qe(),10<m)){if(Gi(c,i,mr,!Bi),as(c,0,!0)!==0)break e;ai=i,c.timeoutHandle=sE(Nx.bind(null,c,o,er,cf,Rg,i,mr,io,wl,Bi,g,"Throttled",-0,0),m);break e}Nx(c,o,er,cf,Rg,i,mr,io,wl,Bi,g,null,-0,0)}}break}while(!0);ws(n)}function Nx(n,i,o,c,m,g,v,w,D,K,re,oe,$,ee){if(n.timeoutHandle=-1,oe=i.subtreeFlags,oe&8192||(oe&16785408)===16785408){oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:qr},bx(i,g,oe);var Te=(g&62914560)===g?of-qe():(g&4194048)===g?wx-qe():0;if(Te=LR(oe,Te),Te!==null){ai=g,n.cancelPendingCommit=Te(Ox.bind(null,n,i,g,o,c,m,v,w,D,re,oe,null,$,ee)),Gi(n,g,v,!K);return}}Ox(n,i,g,o,c,m,v,w,D)}function eR(n){for(var i=n;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var m=o[c],g=m.getSnapshot;m=m.value;try{if(!cr(g(),m))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Gi(n,i,o,c){i&=~Ng,i&=~io,n.suspendedLanes|=i,n.pingedLanes&=~i,c&&(n.warmLanes|=i),c=n.expirationTimes;for(var m=i;0<m;){var g=31-Je(m),v=1<<g;c[g]=-1,m&=~v}o!==0&&ja(n,o,i)}function uf(){return(ot&6)===0?(Iu(0),!1):!0}function Pg(){if(He!==null){if(ut===0)var n=He.return;else n=He,Ys=Wa=null,Yp(n),gl=null,ou=0,n=He;for(;n!==null;)ix(n.alternate,n),n=n.return;He=null}}function Sl(n,i){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,bR(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),ai=0,Pg(),_t=n,He=o=Ks(n.current,null),Ye=i,ut=0,fr=null,Bi=!1,Tl=Ur(n,i),Ag=!1,wl=mr=Ng=io=qi=Ot=0,er=Tu=null,Rg=!1,(i&8)!==0&&(i|=i&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=i;0<c;){var m=31-Je(c),g=1<<m;i|=n[m],c&=~g}return ii=i,Ch(),o}function Rx(n,i){ze=null,Z.H=pu,i===pl||i===Lh?(i=Gv(),ut=3):i===Mp?(i=Gv(),ut=4):ut=i===dg?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,fr=i,He===null&&(Ot=1,Jh(n,Ar(i,n.current)))}function Cx(){var n=dr.current;return n===null?!0:(Ye&4194048)===Ye?kr===null:(Ye&62914560)===Ye||(Ye&536870912)!==0?n===kr:!1}function kx(){var n=Z.H;return Z.H=pu,n===null?pu:n}function Dx(){var n=Z.A;return Z.A=JN,n}function df(){Ot=4,Bi||(Ye&4194048)!==Ye&&dr.current!==null||(Tl=!0),(qi&134217727)===0&&(io&134217727)===0||_t===null||Gi(_t,Ye,mr,!1)}function jg(n,i,o){var c=ot;ot|=2;var m=kx(),g=Dx();(_t!==n||Ye!==i)&&(cf=null,Sl(n,i)),i=!1;var v=Ot;e:do try{if(ut!==0&&He!==null){var w=He,D=fr;switch(ut){case 8:Pg(),v=6;break e;case 3:case 2:case 9:case 6:dr.current===null&&(i=!0);var K=ut;if(ut=0,fr=null,Al(n,w,D,K),o&&Tl){v=0;break e}break;default:K=ut,ut=0,fr=null,Al(n,w,D,K)}}tR(),v=Ot;break}catch(re){Rx(n,re)}while(!0);return i&&n.shellSuspendCounter++,Ys=Wa=null,ot=c,Z.H=m,Z.A=g,He===null&&(_t=null,Ye=0,Ch()),v}function tR(){for(;He!==null;)Px(He)}function nR(n,i){var o=ot;ot|=2;var c=kx(),m=Dx();_t!==n||Ye!==i?(cf=null,lf=qe()+500,Sl(n,i)):Tl=Ur(n,i);e:do try{if(ut!==0&&He!==null){i=He;var g=fr;t:switch(ut){case 1:ut=0,fr=null,Al(n,i,g,1);break;case 2:case 9:if(Fv(g)){ut=0,fr=null,jx(i);break}i=function(){ut!==2&&ut!==9||_t!==n||(ut=7),ws(n)},g.then(i,i);break e;case 3:ut=7;break e;case 4:ut=5;break e;case 7:Fv(g)?(ut=0,fr=null,jx(i)):(ut=0,fr=null,Al(n,i,g,7));break;case 5:var v=null;switch(He.tag){case 26:v=He.memoizedState;case 5:case 27:var w=He;if(v?vE(v):w.stateNode.complete){ut=0,fr=null;var D=w.sibling;if(D!==null)He=D;else{var K=w.return;K!==null?(He=K,hf(K)):He=null}break t}}ut=0,fr=null,Al(n,i,g,5);break;case 6:ut=0,fr=null,Al(n,i,g,6);break;case 8:Pg(),Ot=6;break e;default:throw Error(r(462))}}rR();break}catch(re){Rx(n,re)}while(!0);return Ys=Wa=null,Z.H=c,Z.A=m,ot=o,He!==null?0:(_t=null,Ye=0,Ch(),Ot)}function rR(){for(;He!==null&&!Y();)Px(He)}function Px(n){var i=rx(n.alternate,n,ii);n.memoizedProps=n.pendingProps,i===null?hf(n):He=i}function jx(n){var i=n,o=i.alternate;switch(i.tag){case 15:case 0:i=Xb(o,i,i.pendingProps,i.type,void 0,Ye);break;case 11:i=Xb(o,i,i.pendingProps,i.type.render,i.ref,Ye);break;case 5:Yp(i);default:ix(o,i),i=He=Dv(i,ii),i=rx(o,i,ii)}n.memoizedProps=n.pendingProps,i===null?hf(n):He=i}function Al(n,i,o,c){Ys=Wa=null,Yp(i),gl=null,ou=0;var m=i.return;try{if(GN(n,m,i,o,Ye)){Ot=1,Jh(n,Ar(o,n.current)),He=null;return}}catch(g){if(m!==null)throw He=m,g;Ot=1,Jh(n,Ar(o,n.current)),He=null;return}i.flags&32768?(Ze||c===1?n=!0:Tl||(Ye&536870912)!==0?n=!1:(Bi=n=!0,(c===2||c===9||c===3||c===6)&&(c=dr.current,c!==null&&c.tag===13&&(c.flags|=16384))),Vx(i,n)):hf(i)}function hf(n){var i=n;do{if((i.flags&32768)!==0){Vx(i,Bi);return}n=i.return;var o=$N(i.alternate,i,ii);if(o!==null){He=o;return}if(i=i.sibling,i!==null){He=i;return}He=i=n}while(i!==null);Ot===0&&(Ot=5)}function Vx(n,i){do{var o=YN(n.alternate,n);if(o!==null){o.flags&=32767,He=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(n=n.sibling,n!==null)){He=n;return}He=n=o}while(n!==null);Ot=6,He=null}function Ox(n,i,o,c,m,g,v,w,D){n.cancelPendingCommit=null;do ff();while(ln!==0);if((ot&6)!==0)throw Error(r(327));if(i!==null){if(i===n.current)throw Error(r(177));if(g=i.lanes|i.childLanes,g|=Ep,fp(n,o,g,v,w,D),n===_t&&(He=_t=null,Ye=0),Il=i,Hi=n,ai=o,Cg=g,kg=m,Ix=c,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,oR(Kt,function(){return Bx(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||c){c=Z.T,Z.T=null,m=pe.p,pe.p=2,v=ot,ot|=4;try{WN(n,i,o)}finally{ot=v,pe.p=m,Z.T=c}}ln=1,Mx(),Lx(),Ux()}}function Mx(){if(ln===1){ln=0;var n=Hi,i=Il,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=Z.T,Z.T=null;var c=pe.p;pe.p=2;var m=ot;ot|=4;try{yx(i,n);var g=Qg,v=Tv(n.containerInfo),w=g.focusedElem,D=g.selectionRange;if(v!==w&&w&&w.ownerDocument&&Ev(w.ownerDocument.documentElement,w)){if(D!==null&&yp(w)){var K=D.start,re=D.end;if(re===void 0&&(re=K),"selectionStart"in w)w.selectionStart=K,w.selectionEnd=Math.min(re,w.value.length);else{var oe=w.ownerDocument||document,$=oe&&oe.defaultView||window;if($.getSelection){var ee=$.getSelection(),Te=w.textContent.length,ke=Math.min(D.start,Te),yt=D.end===void 0?ke:Math.min(D.end,Te);!ee.extend&&ke>yt&&(v=yt,yt=ke,ke=v);var U=xv(w,ke),M=xv(w,yt);if(U&&M&&(ee.rangeCount!==1||ee.anchorNode!==U.node||ee.anchorOffset!==U.offset||ee.focusNode!==M.node||ee.focusOffset!==M.offset)){var Q=oe.createRange();Q.setStart(U.node,U.offset),ee.removeAllRanges(),ke>yt?(ee.addRange(Q),ee.extend(M.node,M.offset)):(Q.setEnd(M.node,M.offset),ee.addRange(Q))}}}}for(oe=[],ee=w;ee=ee.parentNode;)ee.nodeType===1&&oe.push({element:ee,left:ee.scrollLeft,top:ee.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<oe.length;w++){var ie=oe[w];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}If=!!Gg,Qg=Gg=null}finally{ot=m,pe.p=c,Z.T=o}}n.current=i,ln=2}}function Lx(){if(ln===2){ln=0;var n=Hi,i=Il,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=Z.T,Z.T=null;var c=pe.p;pe.p=2;var m=ot;ot|=4;try{hx(n,i.alternate,i)}finally{ot=m,pe.p=c,Z.T=o}}ln=3}}function Ux(){if(ln===4||ln===3){ln=0,Ie();var n=Hi,i=Il,o=ai,c=Ix;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?ln=5:(ln=0,Il=Hi=null,zx(n,n.pendingLanes));var m=n.pendingLanes;if(m===0&&(Fi=null),Fs(o),i=i.stateNode,be&&typeof be.onCommitFiberRoot=="function")try{be.onCommitFiberRoot(Ln,i,void 0,(i.current.flags&128)===128)}catch{}if(c!==null){i=Z.T,m=pe.p,pe.p=2,Z.T=null;try{for(var g=n.onRecoverableError,v=0;v<c.length;v++){var w=c[v];g(w.value,{componentStack:w.stack})}}finally{Z.T=i,pe.p=m}}(ai&3)!==0&&ff(),ws(n),m=n.pendingLanes,(o&261930)!==0&&(m&42)!==0?n===Dg?wu++:(wu=0,Dg=n):wu=0,Iu(0)}}function zx(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,iu(i)))}function ff(){return Mx(),Lx(),Ux(),Bx()}function Bx(){if(ln!==5)return!1;var n=Hi,i=Cg;Cg=0;var o=Fs(ai),c=Z.T,m=pe.p;try{pe.p=32>o?32:o,Z.T=null,o=kg,kg=null;var g=Hi,v=ai;if(ln=0,Il=Hi=null,ai=0,(ot&6)!==0)throw Error(r(331));var w=ot;if(ot|=4,Ex(g.current),vx(g,g.current,v,o),ot=w,Iu(0,!1),be&&typeof be.onPostCommitFiberRoot=="function")try{be.onPostCommitFiberRoot(Ln,g)}catch{}return!0}finally{pe.p=m,Z.T=c,zx(n,i)}}function qx(n,i,o){i=Ar(o,i),i=ug(n.stateNode,i,2),n=Mi(n,i,2),n!==null&&(Pa(n,2),ws(n))}function dt(n,i,o){if(n.tag===3)qx(n,n,o);else for(;i!==null;){if(i.tag===3){qx(i,n,o);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Fi===null||!Fi.has(c))){n=Ar(o,n),o=Fb(2),c=Mi(i,o,2),c!==null&&(Hb(o,c,i,n),Pa(c,2),ws(c));break}}i=i.return}}function Vg(n,i,o){var c=n.pingCache;if(c===null){c=n.pingCache=new ZN;var m=new Set;c.set(i,m)}else m=c.get(i),m===void 0&&(m=new Set,c.set(i,m));m.has(o)||(Ag=!0,m.add(o),n=sR.bind(null,n,i,o),i.then(n,n))}function sR(n,i,o){var c=n.pingCache;c!==null&&c.delete(i),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,_t===n&&(Ye&o)===o&&(Ot===4||Ot===3&&(Ye&62914560)===Ye&&300>qe()-of?(ot&2)===0&&Sl(n,0):Ng|=o,wl===Ye&&(wl=0)),ws(n)}function Fx(n,i){i===0&&(i=lh()),n=Ka(n,i),n!==null&&(Pa(n,i),ws(n))}function iR(n){var i=n.memoizedState,o=0;i!==null&&(o=i.retryLane),Fx(n,o)}function aR(n,i){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,m=n.memoizedState;m!==null&&(o=m.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(i),Fx(n,o)}function oR(n,i){return xt(n,i)}var mf=null,Nl=null,Og=!1,pf=!1,Mg=!1,Qi=0;function ws(n){n!==Nl&&n.next===null&&(Nl===null?mf=Nl=n:Nl=Nl.next=n),pf=!0,Og||(Og=!0,cR())}function Iu(n,i){if(!Mg&&pf){Mg=!0;do for(var o=!1,c=mf;c!==null;){if(n!==0){var m=c.pendingLanes;if(m===0)var g=0;else{var v=c.suspendedLanes,w=c.pingedLanes;g=(1<<31-Je(42|n)+1)-1,g&=m&~(v&~w),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(o=!0,Kx(c,g))}else g=Ye,g=as(c,c===_t?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||Ur(c,g)||(o=!0,Kx(c,g));c=c.next}while(o);Mg=!1}}function lR(){Hx()}function Hx(){pf=Og=!1;var n=0;Qi!==0&&vR()&&(n=Qi);for(var i=qe(),o=null,c=mf;c!==null;){var m=c.next,g=Gx(c,i);g===0?(c.next=null,o===null?mf=m:o.next=m,m===null&&(Nl=o)):(o=c,(n!==0||(g&3)!==0)&&(pf=!0)),c=m}ln!==0&&ln!==5||Iu(n),Qi!==0&&(Qi=0)}function Gx(n,i){for(var o=n.suspendedLanes,c=n.pingedLanes,m=n.expirationTimes,g=n.pendingLanes&-62914561;0<g;){var v=31-Je(g),w=1<<v,D=m[v];D===-1?((w&o)===0||(w&c)!==0)&&(m[v]=hp(w,i)):D<=i&&(n.expiredLanes|=w),g&=~w}if(i=_t,o=Ye,o=as(n,n===i?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===i&&(ut===2||ut===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&kn(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Ur(n,o)){if(i=o&-o,i===n.callbackPriority)return i;switch(c!==null&&kn(c),Fs(o)){case 2:case 8:o=vn;break;case 32:o=Kt;break;case 268435456:o=qs;break;default:o=Kt}return c=Qx.bind(null,n),o=xt(o,c),n.callbackPriority=i,n.callbackNode=o,i}return c!==null&&c!==null&&kn(c),n.callbackPriority=2,n.callbackNode=null,2}function Qx(n,i){if(ln!==0&&ln!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(ff()&&n.callbackNode!==o)return null;var c=Ye;return c=as(n,n===_t?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(Ax(n,c,i),Gx(n,qe()),n.callbackNode!=null&&n.callbackNode===o?Qx.bind(null,n):null)}function Kx(n,i){if(ff())return null;Ax(n,i,!0)}function cR(){xR(function(){(ot&6)!==0?xt(kt,lR):Hx()})}function Lg(){if(Qi===0){var n=fl;n===0&&(n=ss,ss<<=1,(ss&261888)===0&&(ss=256)),Qi=n}return Qi}function $x(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Jo(""+n)}function Yx(n,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,n.id&&o.setAttribute("form",n.id),i.parentNode.insertBefore(o,i),n=new FormData(n),o.parentNode.removeChild(o),n}function uR(n,i,o,c,m){if(i==="submit"&&o&&o.stateNode===m){var g=$x((m[dn]||null).action),v=c.submitter;v&&(i=(i=v[dn]||null)?$x(i.formAction):v.getAttribute("formAction"),i!==null&&(g=i,v=null));var w=new ys("action","action",null,c,m);n.push({event:w,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Qi!==0){var D=v?Yx(m,v):new FormData(m);sg(o,{pending:!0,data:D,method:m.method,action:g},null,D)}}else typeof g=="function"&&(w.preventDefault(),D=v?Yx(m,v):new FormData(m),sg(o,{pending:!0,data:D,method:m.method,action:g},g,D))},currentTarget:m}]})}}for(var Ug=0;Ug<xp.length;Ug++){var zg=xp[Ug],dR=zg.toLowerCase(),hR=zg[0].toUpperCase()+zg.slice(1);Kr(dR,"on"+hR)}Kr(Sv,"onAnimationEnd"),Kr(Av,"onAnimationIteration"),Kr(Nv,"onAnimationStart"),Kr("dblclick","onDoubleClick"),Kr("focusin","onFocus"),Kr("focusout","onBlur"),Kr(NN,"onTransitionRun"),Kr(RN,"onTransitionStart"),Kr(CN,"onTransitionCancel"),Kr(Rv,"onTransitionEnd"),fs("onMouseEnter",["mouseout","mouseover"]),fs("onMouseLeave",["mouseout","mouseover"]),fs("onPointerEnter",["pointerout","pointerover"]),fs("onPointerLeave",["pointerout","pointerover"]),hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),hs("onBeforeInput",["compositionend","keypress","textInput","paste"]),hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Su="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Su));function Wx(n,i){i=(i&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],m=c.event;c=c.listeners;e:{var g=void 0;if(i)for(var v=c.length-1;0<=v;v--){var w=c[v],D=w.instance,K=w.currentTarget;if(w=w.listener,D!==g&&m.isPropagationStopped())break e;g=w,m.currentTarget=K;try{g(m)}catch(re){Rh(re)}m.currentTarget=null,g=D}else for(v=0;v<c.length;v++){if(w=c[v],D=w.instance,K=w.currentTarget,w=w.listener,D!==g&&m.isPropagationStopped())break e;g=w,m.currentTarget=K;try{g(m)}catch(re){Rh(re)}m.currentTarget=null,g=D}}}}function Ge(n,i){var o=i[Ko];o===void 0&&(o=i[Ko]=new Set);var c=n+"__bubble";o.has(c)||(Xx(i,n,2,!1),o.add(c))}function Bg(n,i,o){var c=0;i&&(c|=4),Xx(o,n,c,i)}var gf="_reactListening"+Math.random().toString(36).slice(2);function qg(n){if(!n[gf]){n[gf]=!0,Lc.forEach(function(o){o!=="selectionchange"&&(fR.has(o)||Bg(o,!1,n),Bg(o,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[gf]||(i[gf]=!0,Bg("selectionchange",!1,i))}}function Xx(n,i,o,c){switch(SE(i)){case 2:var m=BR;break;case 8:m=qR;break;default:m=ry}o=m.bind(null,i,o,n),m=void 0,!Ua||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),c?m!==void 0?n.addEventListener(i,o,{capture:!0,passive:m}):n.addEventListener(i,o,!0):m!==void 0?n.addEventListener(i,o,{passive:m}):n.addEventListener(i,o,!1)}function Fg(n,i,o,c,m){var g=c;if((i&1)===0&&(i&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var w=c.stateNode.containerInfo;if(w===m)break;if(v===4)for(v=c.return;v!==null;){var D=v.tag;if((D===3||D===4)&&v.stateNode.containerInfo===m)return;v=v.return}for(;w!==null;){if(v=us(w),v===null)return;if(D=v.tag,D===5||D===6||D===26||D===27){c=g=v;continue e}w=w.parentNode}}c=c.return}Ai(function(){var K=g,re=Tr(o),oe=[];e:{var $=Cv.get(n);if($!==void 0){var ee=ys,Te=n;switch(n){case"keypress":if(Ba(o)===0)break e;case"keydown":case"keyup":ee=Sh;break;case"focusin":Te="focus",ee=Fa;break;case"focusout":Te="blur",ee=Fa;break;case"beforeblur":case"afterblur":ee=Fa;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ee=Xc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ee=yh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ee=_;break;case Sv:case Av:case Nv:ee=vh;break;case Rv:ee=S;break;case"scroll":case"scrollend":ee=Wc;break;case"wheel":ee=J;break;case"copy":case"cut":case"paste":ee=bh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ee=Qs;break;case"toggle":case"beforetoggle":ee=Ue}var ke=(i&4)!==0,yt=!ke&&(n==="scroll"||n==="scrollend"),U=ke?$!==null?$+"Capture":null:$;ke=[];for(var M=K,Q;M!==null;){var ie=M;if(Q=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Q===null||U===null||(ie=Fr(M,U),ie!=null&&ke.push(Au(M,ie,Q))),yt)break;M=M.return}0<ke.length&&($=new ee($,Te,null,o,re),oe.push({event:$,listeners:ke}))}}if((i&7)===0){e:{if($=n==="mouseover"||n==="pointerover",ee=n==="mouseout"||n==="pointerout",$&&o!==Kc&&(Te=o.relatedTarget||o.fromElement)&&(us(Te)||Te[ls]))break e;if((ee||$)&&($=re.window===re?re:($=re.ownerDocument)?$.defaultView||$.parentWindow:window,ee?(Te=o.relatedTarget||o.toElement,ee=K,Te=Te?us(Te):null,Te!==null&&(yt=l(Te),ke=Te.tag,Te!==yt||ke!==5&&ke!==27&&ke!==6)&&(Te=null)):(ee=null,Te=K),ee!==Te)){if(ke=Xc,ie="onMouseLeave",U="onMouseEnter",M="mouse",(n==="pointerout"||n==="pointerover")&&(ke=Qs,ie="onPointerLeave",U="onPointerEnter",M="pointer"),yt=ee==null?$:or(ee),Q=Te==null?$:or(Te),$=new ke(ie,M+"leave",ee,o,re),$.target=yt,$.relatedTarget=Q,ie=null,us(re)===K&&(ke=new ke(U,M+"enter",Te,o,re),ke.target=Q,ke.relatedTarget=yt,ie=ke),yt=ie,ee&&Te)t:{for(ke=mR,U=ee,M=Te,Q=0,ie=U;ie;ie=ke(ie))Q++;ie=0;for(var Re=M;Re;Re=ke(Re))ie++;for(;0<Q-ie;)U=ke(U),Q--;for(;0<ie-Q;)M=ke(M),ie--;for(;Q--;){if(U===M||M!==null&&U===M.alternate){ke=U;break t}U=ke(U),M=ke(M)}ke=null}else ke=null;ee!==null&&Jx(oe,$,ee,ke,!1),Te!==null&&yt!==null&&Jx(oe,yt,Te,ke,!0)}}e:{if($=K?or(K):window,ee=$.nodeName&&$.nodeName.toLowerCase(),ee==="select"||ee==="input"&&$.type==="file")var nt=pv;else if(fv($))if(gv)nt=IN;else{nt=TN;var Se=EN}else ee=$.nodeName,!ee||ee.toLowerCase()!=="input"||$.type!=="checkbox"&&$.type!=="radio"?K&&Xo(K.elementType)&&(nt=pv):nt=wN;if(nt&&(nt=nt(n,K))){mv(oe,nt,o,re);break e}Se&&Se(n,$,K),n==="focusout"&&K&&$.type==="number"&&K.memoizedProps.value!=null&&Hc($,"number",$.value)}switch(Se=K?or(K):window,n){case"focusin":(fv(Se)||Se.contentEditable==="true")&&(il=Se,_p=K,nu=null);break;case"focusout":nu=_p=il=null;break;case"mousedown":vp=!0;break;case"contextmenu":case"mouseup":case"dragend":vp=!1,wv(oe,o,re);break;case"selectionchange":if(AN)break;case"keydown":case"keyup":wv(oe,o,re)}var Fe;if(at)e:{switch(n){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else sl?Ha(n,o)&&(We="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(We="onCompositionStart");We&&(bs&&o.locale!=="ko"&&(sl||We!=="onCompositionStart"?We==="onCompositionEnd"&&sl&&(Fe=Yc()):(gs=re,$c="value"in gs?gs.value:gs.textContent,sl=!0)),Se=yf(K,We),0<Se.length&&(We=new vs(We,n,null,o,re),oe.push({event:We,listeners:Se}),Fe?We.data=Fe:(Fe=rl(o),Fe!==null&&(We.data=Fe)))),(Fe=Ir?_N(n,o):vN(n,o))&&(We=yf(K,"onBeforeInput"),0<We.length&&(Se=new vs("onBeforeInput","beforeinput",null,o,re),oe.push({event:Se,listeners:We}),Se.data=Fe)),uR(oe,n,K,o,re)}Wx(oe,i)})}function Au(n,i,o){return{instance:n,listener:i,currentTarget:o}}function yf(n,i){for(var o=i+"Capture",c=[];n!==null;){var m=n,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=Fr(n,o),m!=null&&c.unshift(Au(n,m,g)),m=Fr(n,i),m!=null&&c.push(Au(n,m,g))),n.tag===3)return c;n=n.return}return[]}function mR(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Jx(n,i,o,c,m){for(var g=i._reactName,v=[];o!==null&&o!==c;){var w=o,D=w.alternate,K=w.stateNode;if(w=w.tag,D!==null&&D===c)break;w!==5&&w!==26&&w!==27||K===null||(D=K,m?(K=Fr(o,g),K!=null&&v.unshift(Au(o,K,D))):m||(K=Fr(o,g),K!=null&&v.push(Au(o,K,D)))),o=o.return}v.length!==0&&n.push({event:i,listeners:v})}var pR=/\r\n?/g,gR=/\u0000|\uFFFD/g;function Zx(n){return(typeof n=="string"?n:""+n).replace(pR,`
`).replace(gR,"")}function eE(n,i){return i=Zx(i),Zx(n)===i}function gt(n,i,o,c,m,g){switch(o){case"children":typeof c=="string"?i==="body"||i==="textarea"&&c===""||Wn(n,c):(typeof c=="number"||typeof c=="bigint")&&i!=="body"&&Wn(n,""+c);break;case"className":lr(n,"class",c);break;case"tabIndex":lr(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":lr(n,o,c);break;case"style":Qc(n,c,g);break;case"data":if(i!=="object"){lr(n,"data",c);break}case"src":case"href":if(c===""&&(i!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Jo(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(o==="formAction"?(i!=="input"&&gt(n,i,"name",m.name,m,null),gt(n,i,"formEncType",m.formEncType,m,null),gt(n,i,"formMethod",m.formMethod,m,null),gt(n,i,"formTarget",m.formTarget,m,null)):(gt(n,i,"encType",m.encType,m,null),gt(n,i,"method",m.method,m,null),gt(n,i,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Jo(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=qr);break;case"onScroll":c!=null&&Ge("scroll",n);break;case"onScrollEnd":c!=null&&Ge("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=Jo(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Ge("beforetoggle",n),Ge("toggle",n),Yo(n,"popover",c);break;case"xlinkActuate":Xt(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Xt(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Xt(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Xt(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Xt(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Xt(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Xt(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Xt(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Xt(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Yo(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=gh.get(o)||o,Yo(n,o,c))}}function Hg(n,i,o,c,m,g){switch(o){case"style":Qc(n,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(o=c.__html,o!=null){if(m.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Wn(n,c):(typeof c=="number"||typeof c=="bigint")&&Wn(n,""+c);break;case"onScroll":c!=null&&Ge("scroll",n);break;case"onScrollEnd":c!=null&&Ge("scrollend",n);break;case"onClick":c!=null&&(n.onclick=qr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Uc.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(m=o.endsWith("Capture"),i=o.slice(2,m?o.length-7:void 0),g=n[dn]||null,g=g!=null?g[o]:null,typeof g=="function"&&n.removeEventListener(i,g,m),typeof c=="function")){typeof g!="function"&&g!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(i,c,m);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):Yo(n,o,c)}}}function wn(n,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",n),Ge("load",n);var c=!1,m=!1,g;for(g in o)if(o.hasOwnProperty(g)){var v=o[g];if(v!=null)switch(g){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:gt(n,i,g,v,o,null)}}m&&gt(n,i,"srcSet",o.srcSet,o,null),c&&gt(n,i,"src",o.src,o,null);return;case"input":Ge("invalid",n);var w=g=v=m=null,D=null,K=null;for(c in o)if(o.hasOwnProperty(c)){var re=o[c];if(re!=null)switch(c){case"name":m=re;break;case"type":v=re;break;case"checked":D=re;break;case"defaultChecked":K=re;break;case"value":g=re;break;case"defaultValue":w=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(137,i));break;default:gt(n,i,c,re,o,null)}}fh(n,g,w,D,K,v,m,!1);return;case"select":Ge("invalid",n),c=v=g=null;for(m in o)if(o.hasOwnProperty(m)&&(w=o[m],w!=null))switch(m){case"value":g=w;break;case"defaultValue":v=w;break;case"multiple":c=w;default:gt(n,i,m,w,o,null)}i=g,o=v,n.multiple=!!c,i!=null?Ti(n,!!c,i,!1):o!=null&&Ti(n,!!c,o,!0);return;case"textarea":Ge("invalid",n),g=m=c=null;for(v in o)if(o.hasOwnProperty(v)&&(w=o[v],w!=null))switch(v){case"value":c=w;break;case"defaultValue":m=w;break;case"children":g=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(r(91));break;default:gt(n,i,v,w,o,null)}wi(n,c,m,g);return;case"option":for(D in o)o.hasOwnProperty(D)&&(c=o[D],c!=null)&&(D==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":gt(n,i,D,c,o,null));return;case"dialog":Ge("beforetoggle",n),Ge("toggle",n),Ge("cancel",n),Ge("close",n);break;case"iframe":case"object":Ge("load",n);break;case"video":case"audio":for(c=0;c<Su.length;c++)Ge(Su[c],n);break;case"image":Ge("error",n),Ge("load",n);break;case"details":Ge("toggle",n);break;case"embed":case"source":case"link":Ge("error",n),Ge("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in o)if(o.hasOwnProperty(K)&&(c=o[K],c!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:gt(n,i,K,c,o,null)}return;default:if(Xo(i)){for(re in o)o.hasOwnProperty(re)&&(c=o[re],c!==void 0&&Hg(n,i,re,c,o,void 0));return}}for(w in o)o.hasOwnProperty(w)&&(c=o[w],c!=null&&gt(n,i,w,c,o,null))}function yR(n,i,o,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,v=null,w=null,D=null,K=null,re=null;for(ee in o){var oe=o[ee];if(o.hasOwnProperty(ee)&&oe!=null)switch(ee){case"checked":break;case"value":break;case"defaultValue":D=oe;default:c.hasOwnProperty(ee)||gt(n,i,ee,null,c,oe)}}for(var $ in c){var ee=c[$];if(oe=o[$],c.hasOwnProperty($)&&(ee!=null||oe!=null))switch($){case"type":g=ee;break;case"name":m=ee;break;case"checked":K=ee;break;case"defaultChecked":re=ee;break;case"value":v=ee;break;case"defaultValue":w=ee;break;case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(137,i));break;default:ee!==oe&&gt(n,i,$,ee,c,oe)}}Wo(n,v,w,D,K,re,g,m);return;case"select":ee=v=w=$=null;for(g in o)if(D=o[g],o.hasOwnProperty(g)&&D!=null)switch(g){case"value":break;case"multiple":ee=D;default:c.hasOwnProperty(g)||gt(n,i,g,null,c,D)}for(m in c)if(g=c[m],D=o[m],c.hasOwnProperty(m)&&(g!=null||D!=null))switch(m){case"value":$=g;break;case"defaultValue":w=g;break;case"multiple":v=g;default:g!==D&&gt(n,i,m,g,c,D)}i=w,o=v,c=ee,$!=null?Ti(n,!!o,$,!1):!!c!=!!o&&(i!=null?Ti(n,!!o,i,!0):Ti(n,!!o,o?[]:"",!1));return;case"textarea":ee=$=null;for(w in o)if(m=o[w],o.hasOwnProperty(w)&&m!=null&&!c.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:gt(n,i,w,null,c,m)}for(v in c)if(m=c[v],g=o[v],c.hasOwnProperty(v)&&(m!=null||g!=null))switch(v){case"value":$=m;break;case"defaultValue":ee=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(r(91));break;default:m!==g&&gt(n,i,v,m,c,g)}mh(n,$,ee);return;case"option":for(var Te in o)$=o[Te],o.hasOwnProperty(Te)&&$!=null&&!c.hasOwnProperty(Te)&&(Te==="selected"?n.selected=!1:gt(n,i,Te,null,c,$));for(D in c)$=c[D],ee=o[D],c.hasOwnProperty(D)&&$!==ee&&($!=null||ee!=null)&&(D==="selected"?n.selected=$&&typeof $!="function"&&typeof $!="symbol":gt(n,i,D,$,c,ee));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in o)$=o[ke],o.hasOwnProperty(ke)&&$!=null&&!c.hasOwnProperty(ke)&&gt(n,i,ke,null,c,$);for(K in c)if($=c[K],ee=o[K],c.hasOwnProperty(K)&&$!==ee&&($!=null||ee!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(r(137,i));break;default:gt(n,i,K,$,c,ee)}return;default:if(Xo(i)){for(var yt in o)$=o[yt],o.hasOwnProperty(yt)&&$!==void 0&&!c.hasOwnProperty(yt)&&Hg(n,i,yt,void 0,c,$);for(re in c)$=c[re],ee=o[re],!c.hasOwnProperty(re)||$===ee||$===void 0&&ee===void 0||Hg(n,i,re,$,c,ee);return}}for(var U in o)$=o[U],o.hasOwnProperty(U)&&$!=null&&!c.hasOwnProperty(U)&&gt(n,i,U,null,c,$);for(oe in c)$=c[oe],ee=o[oe],!c.hasOwnProperty(oe)||$===ee||$==null&&ee==null||gt(n,i,oe,$,c,ee)}function tE(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function _R(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var m=o[c],g=m.transferSize,v=m.initiatorType,w=m.duration;if(g&&w&&tE(v)){for(v=0,w=m.responseEnd,c+=1;c<o.length;c++){var D=o[c],K=D.startTime;if(K>w)break;var re=D.transferSize,oe=D.initiatorType;re&&tE(oe)&&(D=D.responseEnd,v+=re*(D<w?1:(w-K)/(D-K)))}if(--c,i+=8*(g+v)/(m.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Gg=null,Qg=null;function _f(n){return n.nodeType===9?n:n.ownerDocument}function nE(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rE(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Kg(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var $g=null;function vR(){var n=window.event;return n&&n.type==="popstate"?n===$g?!1:($g=n,!0):($g=null,!1)}var sE=typeof setTimeout=="function"?setTimeout:void 0,bR=typeof clearTimeout=="function"?clearTimeout:void 0,iE=typeof Promise=="function"?Promise:void 0,xR=typeof queueMicrotask=="function"?queueMicrotask:typeof iE<"u"?function(n){return iE.resolve(null).then(n).catch(ER)}:sE;function ER(n){setTimeout(function(){throw n})}function Ki(n){return n==="head"}function aE(n,i){var o=i,c=0;do{var m=o.nextSibling;if(n.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(m),Dl(i);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Nu(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Nu(o);for(var g=o.firstChild;g;){var v=g.nextSibling,w=g.nodeName;g[cs]||w==="SCRIPT"||w==="STYLE"||w==="LINK"&&g.rel.toLowerCase()==="stylesheet"||o.removeChild(g),g=v}}else o==="body"&&Nu(n.ownerDocument.body);o=m}while(o);Dl(i)}function oE(n,i){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function Yg(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Yg(o),$o(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function TR(n,i,o,c){for(;n.nodeType===1;){var m=o;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[cs])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(g=n.getAttribute("rel"),g==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(g!==m.rel||n.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||n.getAttribute("title")!==(m.title==null?null:m.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(g=n.getAttribute("src"),(g!==(m.src==null?null:m.src)||n.getAttribute("type")!==(m.type==null?null:m.type)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&n.getAttribute("name")===g)return n}else return n;if(n=Dr(n.nextSibling),n===null)break}return null}function wR(n,i,o){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Dr(n.nextSibling),n===null))return null;return n}function lE(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=Dr(n.nextSibling),n===null))return null;return n}function Wg(n){return n.data==="$?"||n.data==="$~"}function Xg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function IR(n,i){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||o.readyState!=="loading")i();else{var c=function(){i(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Dr(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var Jg=null;function cE(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(i===0)return Dr(n.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}n=n.nextSibling}return null}function uE(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return n;i--}else o!=="/$"&&o!=="/&"||i++}n=n.previousSibling}return null}function dE(n,i,o){switch(i=_f(o),n){case"html":if(n=i.documentElement,!n)throw Error(r(452));return n;case"head":if(n=i.head,!n)throw Error(r(453));return n;case"body":if(n=i.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function Nu(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);$o(n)}var Pr=new Map,hE=new Set;function vf(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var oi=pe.d;pe.d={f:SR,r:AR,D:NR,C:RR,L:CR,m:kR,X:PR,S:DR,M:jR};function SR(){var n=oi.f(),i=uf();return n||i}function AR(n){var i=Er(n);i!==null&&i.tag===5&&i.type==="form"?Rb(i):oi.r(n)}var Rl=typeof document>"u"?null:document;function fE(n,i,o){var c=Rl;if(c&&typeof i=="string"&&i){var m=Yn(i);m='link[rel="'+n+'"][href="'+m+'"]',typeof o=="string"&&(m+='[crossorigin="'+o+'"]'),hE.has(m)||(hE.add(m),n={rel:n,crossOrigin:o,href:i},c.querySelector(m)===null&&(i=c.createElement("link"),wn(i,"link",n),Wt(i),c.head.appendChild(i)))}}function NR(n){oi.D(n),fE("dns-prefetch",n,null)}function RR(n,i){oi.C(n,i),fE("preconnect",n,i)}function CR(n,i,o){oi.L(n,i,o);var c=Rl;if(c&&n&&i){var m='link[rel="preload"][as="'+Yn(i)+'"]';i==="image"&&o&&o.imageSrcSet?(m+='[imagesrcset="'+Yn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(m+='[imagesizes="'+Yn(o.imageSizes)+'"]')):m+='[href="'+Yn(n)+'"]';var g=m;switch(i){case"style":g=Cl(n);break;case"script":g=kl(n)}Pr.has(g)||(n=E({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:n,as:i},o),Pr.set(g,n),c.querySelector(m)!==null||i==="style"&&c.querySelector(Ru(g))||i==="script"&&c.querySelector(Cu(g))||(i=c.createElement("link"),wn(i,"link",n),Wt(i),c.head.appendChild(i)))}}function kR(n,i){oi.m(n,i);var o=Rl;if(o&&n){var c=i&&typeof i.as=="string"?i.as:"script",m='link[rel="modulepreload"][as="'+Yn(c)+'"][href="'+Yn(n)+'"]',g=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=kl(n)}if(!Pr.has(g)&&(n=E({rel:"modulepreload",href:n},i),Pr.set(g,n),o.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Cu(g)))return}c=o.createElement("link"),wn(c,"link",n),Wt(c),o.head.appendChild(c)}}}function DR(n,i,o){oi.S(n,i,o);var c=Rl;if(c&&n){var m=ds(c).hoistableStyles,g=Cl(n);i=i||"default";var v=m.get(g);if(!v){var w={loading:0,preload:null};if(v=c.querySelector(Ru(g)))w.loading=5;else{n=E({rel:"stylesheet",href:n,"data-precedence":i},o),(o=Pr.get(g))&&Zg(n,o);var D=v=c.createElement("link");Wt(D),wn(D,"link",n),D._p=new Promise(function(K,re){D.onload=K,D.onerror=re}),D.addEventListener("load",function(){w.loading|=1}),D.addEventListener("error",function(){w.loading|=2}),w.loading|=4,bf(v,i,c)}v={type:"stylesheet",instance:v,count:1,state:w},m.set(g,v)}}}function PR(n,i){oi.X(n,i);var o=Rl;if(o&&n){var c=ds(o).hoistableScripts,m=kl(n),g=c.get(m);g||(g=o.querySelector(Cu(m)),g||(n=E({src:n,async:!0},i),(i=Pr.get(m))&&ey(n,i),g=o.createElement("script"),Wt(g),wn(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(m,g))}}function jR(n,i){oi.M(n,i);var o=Rl;if(o&&n){var c=ds(o).hoistableScripts,m=kl(n),g=c.get(m);g||(g=o.querySelector(Cu(m)),g||(n=E({src:n,async:!0,type:"module"},i),(i=Pr.get(m))&&ey(n,i),g=o.createElement("script"),Wt(g),wn(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(m,g))}}function mE(n,i,o,c){var m=(m=me.current)?vf(m):null;if(!m)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=Cl(o.href),o=ds(m).hoistableStyles,c=o.get(i),c||(c={type:"style",instance:null,count:0,state:null},o.set(i,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Cl(o.href);var g=ds(m).hoistableStyles,v=g.get(n);if(v||(m=m.ownerDocument||m,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(n,v),(g=m.querySelector(Ru(n)))&&!g._p&&(v.instance=g,v.state.loading=5),Pr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Pr.set(n,o),g||VR(m,n,o,v.state))),i&&c===null)throw Error(r(528,""));return v}if(i&&c!==null)throw Error(r(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=kl(o),o=ds(m).hoistableScripts,c=o.get(i),c||(c={type:"script",instance:null,count:0,state:null},o.set(i,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function Cl(n){return'href="'+Yn(n)+'"'}function Ru(n){return'link[rel="stylesheet"]['+n+"]"}function pE(n){return E({},n,{"data-precedence":n.precedence,precedence:null})}function VR(n,i,o,c){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?c.loading=1:(i=n.createElement("link"),c.preload=i,i.addEventListener("load",function(){return c.loading|=1}),i.addEventListener("error",function(){return c.loading|=2}),wn(i,"link",o),Wt(i),n.head.appendChild(i))}function kl(n){return'[src="'+Yn(n)+'"]'}function Cu(n){return"script[async]"+n}function gE(n,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var c=n.querySelector('style[data-href~="'+Yn(o.href)+'"]');if(c)return i.instance=c,Wt(c),c;var m=E({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),Wt(c),wn(c,"style",m),bf(c,o.precedence,n),i.instance=c;case"stylesheet":m=Cl(o.href);var g=n.querySelector(Ru(m));if(g)return i.state.loading|=4,i.instance=g,Wt(g),g;c=pE(o),(m=Pr.get(m))&&Zg(c,m),g=(n.ownerDocument||n).createElement("link"),Wt(g);var v=g;return v._p=new Promise(function(w,D){v.onload=w,v.onerror=D}),wn(g,"link",c),i.state.loading|=4,bf(g,o.precedence,n),i.instance=g;case"script":return g=kl(o.src),(m=n.querySelector(Cu(g)))?(i.instance=m,Wt(m),m):(c=o,(m=Pr.get(g))&&(c=E({},o),ey(c,m)),n=n.ownerDocument||n,m=n.createElement("script"),Wt(m),wn(m,"link",c),n.head.appendChild(m),i.instance=m);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(c=i.instance,i.state.loading|=4,bf(c,o.precedence,n));return i.instance}function bf(n,i,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,g=m,v=0;v<c.length;v++){var w=c[v];if(w.dataset.precedence===i)g=w;else if(g!==m)break}g?g.parentNode.insertBefore(n,g.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(n,i.firstChild))}function Zg(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function ey(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var xf=null;function yE(n,i,o){if(xf===null){var c=new Map,m=xf=new Map;m.set(o,c)}else m=xf,c=m.get(o),c||(c=new Map,m.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),m=0;m<o.length;m++){var g=o[m];if(!(g[cs]||g[Yt]||n==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var v=g.getAttribute(i)||"";v=n+v;var w=c.get(v);w?w.push(g):c.set(v,[g])}}return c}function _E(n,i,o){n=n.ownerDocument||n,n.head.insertBefore(o,i==="title"?n.querySelector("head > title"):null)}function OR(n,i,o){if(o===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(n=i.disabled,typeof i.precedence=="string"&&n==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function vE(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function MR(n,i,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var m=Cl(c.href),g=i.querySelector(Ru(m));if(g){i=g._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=Ef.bind(n),i.then(n,n)),o.state.loading|=4,o.instance=g,Wt(g);return}g=i.ownerDocument||i,c=pE(c),(m=Pr.get(m))&&Zg(c,m),g=g.createElement("link"),Wt(g);var v=g;v._p=new Promise(function(w,D){v.onload=w,v.onerror=D}),wn(g,"link",c),o.instance=g}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Ef.bind(n),i.addEventListener("load",o),i.addEventListener("error",o))}}var ty=0;function LR(n,i){return n.stylesheets&&n.count===0&&wf(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&wf(n,n.stylesheets),n.unsuspend){var g=n.unsuspend;n.unsuspend=null,g()}},6e4+i);0<n.imgBytes&&ty===0&&(ty=62500*_R());var m=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&wf(n,n.stylesheets),n.unsuspend)){var g=n.unsuspend;n.unsuspend=null,g()}},(n.imgBytes>ty?50:800)+i);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function Ef(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)wf(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Tf=null;function wf(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Tf=new Map,i.forEach(UR,n),Tf=null,Ef.call(n))}function UR(n,i){if(!(i.state.loading&4)){var o=Tf.get(n);if(o)var c=o.get(null);else{o=new Map,Tf.set(n,o);for(var m=n.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var v=m[g];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(o.set(v.dataset.precedence,v),c=v)}c&&o.set(null,c)}m=i.instance,v=m.getAttribute("data-precedence"),g=o.get(v)||c,g===c&&o.set(null,m),o.set(v,m),this.count++,c=Ef.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),g?g.parentNode.insertBefore(m,g.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(m,n.firstChild)),i.state.loading|=4}}var ku={$$typeof:se,Provider:null,Consumer:null,_currentValue:Ee,_currentValue2:Ee,_threadCount:0};function zR(n,i,o,c,m,g,v,w,D){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=os(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=os(0),this.hiddenUpdates=os(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function bE(n,i,o,c,m,g,v,w,D,K,re,oe){return n=new zR(n,i,o,v,D,K,re,oe,w),i=1,g===!0&&(i|=24),g=ur(3,null,null,i),n.current=g,g.stateNode=n,i=jp(),i.refCount++,n.pooledCache=i,i.refCount++,g.memoizedState={element:c,isDehydrated:o,cache:i},Lp(g),n}function xE(n){return n?(n=ll,n):ll}function EE(n,i,o,c,m,g){m=xE(m),c.context===null?c.context=m:c.pendingContext=m,c=Oi(i),c.payload={element:o},g=g===void 0?null:g,g!==null&&(c.callback=g),o=Mi(n,c,i),o!==null&&(tr(o,n,i),cu(o,n,i))}function TE(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<i?o:i}}function ny(n,i){TE(n,i),(n=n.alternate)&&TE(n,i)}function wE(n){if(n.tag===13||n.tag===31){var i=Ka(n,67108864);i!==null&&tr(i,n,67108864),ny(n,67108864)}}function IE(n){if(n.tag===13||n.tag===31){var i=pr();i=Va(i);var o=Ka(n,i);o!==null&&tr(o,n,i),ny(n,i)}}var If=!0;function BR(n,i,o,c){var m=Z.T;Z.T=null;var g=pe.p;try{pe.p=2,ry(n,i,o,c)}finally{pe.p=g,Z.T=m}}function qR(n,i,o,c){var m=Z.T;Z.T=null;var g=pe.p;try{pe.p=8,ry(n,i,o,c)}finally{pe.p=g,Z.T=m}}function ry(n,i,o,c){if(If){var m=sy(c);if(m===null)Fg(n,i,c,Sf,o),AE(n,c);else if(HR(m,n,i,o,c))c.stopPropagation();else if(AE(n,c),i&4&&-1<FR.indexOf(n)){for(;m!==null;){var g=Er(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var v=is(g.pendingLanes);if(v!==0){var w=g;for(w.pendingLanes|=2,w.entangledLanes|=2;v;){var D=1<<31-Je(v);w.entanglements[1]|=D,v&=~D}ws(g),(ot&6)===0&&(lf=qe()+500,Iu(0))}}break;case 31:case 13:w=Ka(g,2),w!==null&&tr(w,g,2),uf(),ny(g,2)}if(g=sy(c),g===null&&Fg(n,i,c,Sf,o),g===m)break;m=g}m!==null&&c.stopPropagation()}else Fg(n,i,c,null,o)}}function sy(n){return n=Tr(n),iy(n)}var Sf=null;function iy(n){if(Sf=null,n=us(n),n!==null){var i=l(n);if(i===null)n=null;else{var o=i.tag;if(o===13){if(n=u(i),n!==null)return n;n=null}else if(o===31){if(n=p(i),n!==null)return n;n=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Sf=n,null}function SE(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case kt:return 2;case vn:return 8;case Kt:case ka:return 32;case qs:return 268435456;default:return 32}default:return 32}}var ay=!1,$i=null,Yi=null,Wi=null,Du=new Map,Pu=new Map,Xi=[],FR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function AE(n,i){switch(n){case"focusin":case"focusout":$i=null;break;case"dragenter":case"dragleave":Yi=null;break;case"mouseover":case"mouseout":Wi=null;break;case"pointerover":case"pointerout":Du.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pu.delete(i.pointerId)}}function ju(n,i,o,c,m,g){return n===null||n.nativeEvent!==g?(n={blockedOn:i,domEventName:o,eventSystemFlags:c,nativeEvent:g,targetContainers:[m]},i!==null&&(i=Er(i),i!==null&&wE(i)),n):(n.eventSystemFlags|=c,i=n.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),n)}function HR(n,i,o,c,m){switch(i){case"focusin":return $i=ju($i,n,i,o,c,m),!0;case"dragenter":return Yi=ju(Yi,n,i,o,c,m),!0;case"mouseover":return Wi=ju(Wi,n,i,o,c,m),!0;case"pointerover":var g=m.pointerId;return Du.set(g,ju(Du.get(g)||null,n,i,o,c,m)),!0;case"gotpointercapture":return g=m.pointerId,Pu.set(g,ju(Pu.get(g)||null,n,i,o,c,m)),!0}return!1}function NE(n){var i=us(n.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=u(o),i!==null){n.blockedOn=i,zr(n.priority,function(){IE(o)});return}}else if(i===31){if(i=p(o),i!==null){n.blockedOn=i,zr(n.priority,function(){IE(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Af(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var o=sy(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);Kc=c,o.target.dispatchEvent(c),Kc=null}else return i=Er(o),i!==null&&wE(i),n.blockedOn=o,!1;i.shift()}return!0}function RE(n,i,o){Af(n)&&o.delete(i)}function GR(){ay=!1,$i!==null&&Af($i)&&($i=null),Yi!==null&&Af(Yi)&&(Yi=null),Wi!==null&&Af(Wi)&&(Wi=null),Du.forEach(RE),Pu.forEach(RE)}function Nf(n,i){n.blockedOn===i&&(n.blockedOn=null,ay||(ay=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,GR)))}var Rf=null;function CE(n){Rf!==n&&(Rf=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Rf===n&&(Rf=null);for(var i=0;i<n.length;i+=3){var o=n[i],c=n[i+1],m=n[i+2];if(typeof c!="function"){if(iy(c||o)===null)continue;break}var g=Er(o);g!==null&&(n.splice(i,3),i-=3,sg(g,{pending:!0,data:m,method:o.method,action:c},c,m))}}))}function Dl(n){function i(D){return Nf(D,n)}$i!==null&&Nf($i,n),Yi!==null&&Nf(Yi,n),Wi!==null&&Nf(Wi,n),Du.forEach(i),Pu.forEach(i);for(var o=0;o<Xi.length;o++){var c=Xi[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Xi.length&&(o=Xi[0],o.blockedOn===null);)NE(o),o.blockedOn===null&&Xi.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var m=o[c],g=o[c+1],v=m[dn]||null;if(typeof g=="function")v||CE(o);else if(v){var w=null;if(g&&g.hasAttribute("formAction")){if(m=g,v=g[dn]||null)w=v.formAction;else if(iy(m)!==null)continue}else w=v.action;typeof w=="function"?o[c+1]=w:(o.splice(c,3),c-=3),CE(o)}}}function kE(){function n(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(v){return m=v})},focusReset:"manual",scroll:"manual"})}function i(){m!==null&&(m(),m=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),m!==null&&(m(),m=null)}}}function oy(n){this._internalRoot=n}Cf.prototype.render=oy.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));var o=i.current,c=pr();EE(o,c,n,i,null,null)},Cf.prototype.unmount=oy.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;EE(n.current,2,null,n,null,null),uf(),i[ls]=null}};function Cf(n){this._internalRoot=n}Cf.prototype.unstable_scheduleHydration=function(n){if(n){var i=ch();n={blockedOn:null,target:n,priority:i};for(var o=0;o<Xi.length&&i!==0&&i<Xi[o].priority;o++);Xi.splice(o,0,n),o===0&&NE(n)}};var DE=e.version;if(DE!=="19.2.3")throw Error(r(527,DE,"19.2.3"));pe.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=y(i),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var QR={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Z,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kf.isDisabled&&kf.supportsFiber)try{Ln=kf.inject(QR),be=kf}catch{}}return Ou.createRoot=function(n,i){if(!a(n))throw Error(r(299));var o=!1,c="",m=Ub,g=zb,v=Bb;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onUncaughtError!==void 0&&(m=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(v=i.onRecoverableError)),i=bE(n,1,!1,null,null,o,c,null,m,g,v,kE),n[ls]=i.current,qg(n),new oy(i)},Ou.hydrateRoot=function(n,i,o){if(!a(n))throw Error(r(299));var c=!1,m="",g=Ub,v=zb,w=Bb,D=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(m=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(w=o.onRecoverableError),o.formState!==void 0&&(D=o.formState)),i=bE(n,1,!0,i,o??null,c,m,D,g,v,w,kE),i.context=xE(null),o=i.current,c=pr(),c=Va(c),m=Oi(c),m.callback=null,Mi(o,m,c),o=c,i.current.lanes=o,Pa(i,o),ws(i),n[ls]=i.current,qg(n),new Cf(i)},Ou.version="19.2.3",Ou}var qE;function tC(){if(qE)return uy.exports;qE=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),uy.exports=eC(),uy.exports}var nC=tC();const rC=S0(nC);const sC=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),iC=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),FE=s=>{const e=iC(s);return e.charAt(0).toUpperCase()+e.slice(1)},tI=(...s)=>s.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),aC=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var oC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const lC=mn.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:u,...p},f)=>mn.createElement("svg",{ref:f,...oC,width:e,height:e,stroke:s,strokeWidth:r?Number(t)*24/Number(e):t,className:tI("lucide",a),...!l&&!aC(p)&&{"aria-hidden":"true"},...p},[...u.map(([y,b])=>mn.createElement(y,b)),...Array.isArray(l)?l:[l]]));const Rn=(s,e)=>{const t=mn.forwardRef(({className:r,...a},l)=>mn.createElement(lC,{ref:l,iconNode:e,className:tI(`lucide-${sC(FE(s))}`,`lucide-${s}`,r),...a}));return t.displayName=FE(s),t};const cC=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],uC=Rn("archive",cC);const dC=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],nI=Rn("box",dC);const hC=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],jy=Rn("copy",hC);const fC=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],mC=Rn("download",fC);const pC=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Vy=Rn("eye",pC);const gC=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Oy=Rn("file-text",gC);const yC=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],_C=Rn("monitor",yC);const vC=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],bC=Rn("moon",vC);const xC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],go=Rn("plus",xC);const EC=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],zf=Rn("printer",EC);const TC=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],My=Rn("refresh-cw",TC);const wC=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],IC=Rn("save",wC);const SC=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],AC=Rn("settings",SC);const NC=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Eo=Rn("square-pen",NC);const RC=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],CC=Rn("sun",RC);const kC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ui=Rn("trash-2",kC);const DC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],N0=Rn("x",DC),PC=()=>{};var HE={};const rI=function(s){const e=[];let t=0;for(let r=0;r<s.length;r++){let a=s.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<s.length&&(s.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},jC=function(s){const e=[];let t=0,r=0;for(;t<s.length;){const a=s[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const l=s[t++];e[r++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=s[t++],u=s[t++],p=s[t++],f=((a&7)<<18|(l&63)<<12|(u&63)<<6|p&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const l=s[t++],u=s[t++];e[r++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},sI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<s.length;a+=3){const l=s[a],u=a+1<s.length,p=u?s[a+1]:0,f=a+2<s.length,y=f?s[a+2]:0,b=l>>2,E=(l&3)<<4|p>>4;let T=(p&15)<<2|y>>6,N=y&63;f||(N=64,u||(T=64)),r.push(t[b],t[E],t[T],t[N])}return r.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(rI(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):jC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<s.length;){const l=t[s.charAt(a++)],p=a<s.length?t[s.charAt(a)]:0;++a;const y=a<s.length?t[s.charAt(a)]:64;++a;const E=a<s.length?t[s.charAt(a)]:64;if(++a,l==null||p==null||y==null||E==null)throw new VC;const T=l<<2|p>>4;if(r.push(T),y!==64){const N=p<<4&240|y>>2;if(r.push(N),E!==64){const B=y<<6&192|E;r.push(B)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class VC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const OC=function(s){const e=rI(s);return sI.encodeByteArray(e,!0)},nm=function(s){return OC(s).replace(/\./g,"")},R0=function(s){try{return sI.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function rm(s,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!MC(t)||(s[t]=rm(s[t],e[t]));return s}function MC(s){return s!=="__proto__"}function C0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const LC=()=>C0().__FIREBASE_DEFAULTS__,UC=()=>{if(typeof process>"u"||typeof HE>"u")return;const s=HE.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},zC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&R0(s[1]);return e&&JSON.parse(e)},k0=()=>{try{return PC()||LC()||UC()||zC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},D0=()=>k0()?.config,BC=s=>k0()?.[`_${s}`];class qC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Ec(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function iI(s){return(await fetch(s,{credentials:"include"})).ok}function FC(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",a=s.iat||0,l=s.sub||s.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...s};return[nm(JSON.stringify(t)),nm(JSON.stringify(u)),""].join(".")}const td={};function HC(){const s={prod:[],emulator:[]};for(const e of Object.keys(td))td[e]?s.emulator.push(e):s.prod.push(e);return s}function GC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let GE=!1;function aI(s,e){if(typeof window>"u"||typeof document>"u"||!Ec(window.location.host)||td[s]===e||td[s]||GE)return;td[s]=e;function t(T){return`__firebase__banner__${T}`}const r="__firebase__banner",l=HC().prod.length>0;function u(){const T=document.getElementById(r);T&&T.remove()}function p(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function f(T,N){T.setAttribute("width","24"),T.setAttribute("id",N),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{GE=!0,u()},T}function b(T,N){T.setAttribute("id",N),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function E(){const T=GC(r),N=t("text"),B=document.getElementById(N)||document.createElement("span"),G=t("learnmore"),te=document.getElementById(G)||document.createElement("a"),I=t("preprendIcon"),X=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const se=T.element;p(se),b(te,G);const fe=y();f(X,I),se.append(X,B,te,fe),document.body.appendChild(se)}l?(B.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}function Pt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pt())}function Nm(){const s=k0()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function KC(){return typeof window<"u"||oI()}function oI(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function $C(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function lI(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function P0(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cI(){const s=Pt();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function uI(){return!Nm()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function dI(){return!Nm()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function gd(){try{return typeof indexedDB=="object"}catch{return!1}}function YC(){return new Promise((s,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),s(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(t){e(t)}})}const WC="FirebaseError";class Fn extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=WC,Object.setPrototypeOf(this,Fn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zo.prototype.create)}}class zo{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?XC(l,r):"Error",p=`${this.serviceName}: ${u} (${a}).`;return new Fn(a,p,r)}}function XC(s,e){return s.replace(JC,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const JC=/\{\$([^}]+)}/g;function QE(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function ZC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function fa(s,e){if(s===e)return!0;const t=Object.keys(s),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const l=s[a],u=e[a];if(KE(l)&&KE(u)){if(!fa(l,u))return!1}else if(l!==u)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function KE(s){return s!==null&&typeof s=="object"}function Tc(s){const e=[];for(const[t,r]of Object.entries(s))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Gl(s){const e={};return s.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,l]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Ku(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function hI(s,e){const t=new e2(s,e);return t.subscribe.bind(t)}class e2{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");t2(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=my),a.error===void 0&&(a.error=my),a.complete===void 0&&(a.complete=my);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function t2(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function my(){}function Ce(s){return s&&s._delegate?s._delegate:s}class Ls{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const oo="[DEFAULT]";class n2{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new qC;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(r)return null;throw a}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(s2(e))try{this.getOrInitializeService({instanceIdentifier:oo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});r.resolve(l)}catch{}}}}clearInstance(e=oo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=oo){return this.instances.has(e)}getOptions(e=oo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[l,u]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(l);r===p&&u.resolve(a)}return a}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(r)??new Set;a.add(e),this.onInitCallbacks.set(r,a);const l=this.instances.get(r);return l&&e(l,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:r2(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=oo){return this.component?this.component.multipleInstances?e:oo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function r2(s){return s===oo?void 0:s}function s2(s){return s.instantiationMode==="EAGER"}class fI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new n2(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const j0=[];var Qe;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Qe||(Qe={}));const mI={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},i2=Qe.INFO,a2={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},o2=(s,e,...t)=>{if(e<s.logLevel)return;const r=new Date().toISOString(),a=a2[e];if(a)console[a](`[${r}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Rm{constructor(e){this.name=e,this._logLevel=i2,this._logHandler=o2,this._userLogHandler=null,j0.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}function l2(s){j0.forEach(e=>{e.setLogLevel(s)})}function c2(s,e){for(const t of j0){let r=null;e&&e.level&&(r=mI[e.level]),s===null?t.userLogHandler=null:t.userLogHandler=(a,l,...u)=>{const p=u.map(f=>{if(f==null)return null;if(typeof f=="string")return f;if(typeof f=="number"||typeof f=="boolean")return f.toString();if(f instanceof Error)return f.message;try{return JSON.stringify(f)}catch{return null}}).filter(f=>f).join(" ");l>=(r??a.logLevel)&&s({level:Qe[l].toLowerCase(),message:p,args:u,type:a.name})}}}const u2=(s,e)=>e.some(t=>s instanceof t);let $E,YE;function d2(){return $E||($E=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function h2(){return YE||(YE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const pI=new WeakMap,Ly=new WeakMap,gI=new WeakMap,py=new WeakMap,V0=new WeakMap;function f2(s){const e=new Promise((t,r)=>{const a=()=>{s.removeEventListener("success",l),s.removeEventListener("error",u)},l=()=>{t(la(s.result)),a()},u=()=>{r(s.error),a()};s.addEventListener("success",l),s.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&pI.set(t,s)}).catch(()=>{}),V0.set(e,s),e}function m2(s){if(Ly.has(s))return;const e=new Promise((t,r)=>{const a=()=>{s.removeEventListener("complete",l),s.removeEventListener("error",u),s.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{r(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",l),s.addEventListener("error",u),s.addEventListener("abort",u)});Ly.set(s,e)}let Uy={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return Ly.get(s);if(e==="objectStoreNames")return s.objectStoreNames||gI.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return la(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function p2(s){Uy=s(Uy)}function g2(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=s.call(gy(this),e,...t);return gI.set(r,e.sort?e.sort():[e]),la(r)}:h2().includes(s)?function(...e){return s.apply(gy(this),e),la(pI.get(this))}:function(...e){return la(s.apply(gy(this),e))}}function y2(s){return typeof s=="function"?g2(s):(s instanceof IDBTransaction&&m2(s),u2(s,d2())?new Proxy(s,Uy):s)}function la(s){if(s instanceof IDBRequest)return f2(s);if(py.has(s))return py.get(s);const e=y2(s);return e!==s&&(py.set(s,e),V0.set(e,s)),e}const gy=s=>V0.get(s);function _2(s,e,{blocked:t,upgrade:r,blocking:a,terminated:l}={}){const u=indexedDB.open(s,e),p=la(u);return r&&u.addEventListener("upgradeneeded",f=>{r(la(u.result),f.oldVersion,f.newVersion,la(u.transaction),f)}),t&&u.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),p.then(f=>{l&&f.addEventListener("close",()=>l()),a&&f.addEventListener("versionchange",y=>a(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const v2=["get","getKey","getAll","getAllKeys","count"],b2=["put","add","delete","clear"],yy=new Map;function WE(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(yy.get(e))return yy.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=b2.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||v2.includes(t)))return;const l=async function(u,...p){const f=this.transaction(u,a?"readwrite":"readonly");let y=f.store;return r&&(y=y.index(p.shift())),(await Promise.all([y[t](...p),a&&f.done]))[0]};return yy.set(e,l),l}p2(s=>({...s,get:(e,t,r)=>WE(e,t)||s.get(e,t,r),has:(e,t)=>!!WE(e,t)||s.has(e,t)}));class x2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(E2(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function E2(s){return s.getComponent()?.type==="VERSION"}const sm="@firebase/app",zy="0.14.7";const hi=new Rm("@firebase/app"),T2="@firebase/app-compat",w2="@firebase/analytics-compat",I2="@firebase/analytics",S2="@firebase/app-check-compat",A2="@firebase/app-check",N2="@firebase/auth",R2="@firebase/auth-compat",C2="@firebase/database",k2="@firebase/data-connect",D2="@firebase/database-compat",P2="@firebase/functions",j2="@firebase/functions-compat",V2="@firebase/installations",O2="@firebase/installations-compat",M2="@firebase/messaging",L2="@firebase/messaging-compat",U2="@firebase/performance",z2="@firebase/performance-compat",B2="@firebase/remote-config",q2="@firebase/remote-config-compat",F2="@firebase/storage",H2="@firebase/storage-compat",G2="@firebase/firestore",Q2="@firebase/ai",K2="@firebase/firestore-compat",$2="firebase",Y2="12.8.0";const ma="[DEFAULT]",W2={[sm]:"fire-core",[T2]:"fire-core-compat",[I2]:"fire-analytics",[w2]:"fire-analytics-compat",[A2]:"fire-app-check",[S2]:"fire-app-check-compat",[N2]:"fire-auth",[R2]:"fire-auth-compat",[C2]:"fire-rtdb",[k2]:"fire-data-connect",[D2]:"fire-rtdb-compat",[P2]:"fire-fn",[j2]:"fire-fn-compat",[V2]:"fire-iid",[O2]:"fire-iid-compat",[M2]:"fire-fcm",[L2]:"fire-fcm-compat",[U2]:"fire-perf",[z2]:"fire-perf-compat",[B2]:"fire-rc",[q2]:"fire-rc-compat",[F2]:"fire-gcs",[H2]:"fire-gcs-compat",[G2]:"fire-fst",[K2]:"fire-fst-compat",[Q2]:"fire-vertex","fire-js":"fire-js",[$2]:"fire-js-all"};const pa=new Map,Zl=new Map,ec=new Map;function yd(s,e){try{s.container.addComponent(e)}catch(t){hi.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function yI(s,e){s.container.addOrOverwriteComponent(e)}function ga(s){const e=s.name;if(ec.has(e))return hi.debug(`There were multiple attempts to register component ${e}.`),!1;ec.set(e,s);for(const t of pa.values())yd(t,s);for(const t of Zl.values())yd(t,s);return!0}function _I(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function X2(s,e,t=ma){_I(s,e).clearInstance(t)}function O0(s){return s.options!==void 0}function vI(s){return O0(s)?!1:"authIdToken"in s||"appCheckToken"in s||"releaseOnDeref"in s||"automaticDataCollectionEnabled"in s}function Nt(s){return s==null?!1:s.settings!==void 0}function J2(){ec.clear()}const Z2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},vr=new zo("app","Firebase",Z2);let bI=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ls("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw vr.create("app-deleted",{appName:this._name})}};function XE(s,e){const t=R0(s.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const a=JSON.parse(t).exp*1e3,l=new Date().getTime();a-l<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class ek extends bI{constructor(e,t,r,a){const l=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,u={name:r,automaticDataCollectionEnabled:l};if(e.apiKey!==void 0)super(e,u,a);else{const p=e;super(p.options,u,a)}this._serverConfig={automaticDataCollectionEnabled:l,...t},this._serverConfig.authIdToken&&XE(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&XE(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Jr(sm,zy,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){L0(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw vr.create("server-app-deleted")}}const wa=Y2;function M0(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const r={name:ma,automaticDataCollectionEnabled:!0,...e},a=r.name;if(typeof a!="string"||!a)throw vr.create("bad-app-name",{appName:String(a)});if(t||(t=D0()),!t)throw vr.create("no-options");const l=pa.get(a);if(l){if(fa(t,l.options)&&fa(r,l.config))return l;throw vr.create("duplicate-app",{appName:a})}const u=new fI(a);for(const f of ec.values())u.addComponent(f);const p=new bI(t,r,u);return pa.set(a,p),p}function tk(s,e={}){if(KC()&&!oI())throw vr.create("invalid-server-app-environment");let t,r=e||{};if(s&&(O0(s)?t=s.options:vI(s)?r=s:t=s),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=D0()),!t)throw vr.create("no-options");const a={...r,...t};a.releaseOnDeref!==void 0&&delete a.releaseOnDeref;const l=b=>[...b].reduce((E,T)=>Math.imul(31,E)+T.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw vr.create("finalization-registry-not-supported",{});const u=""+l(JSON.stringify(a)),p=Zl.get(u);if(p)return p.incRefCount(r.releaseOnDeref),p;const f=new fI(u);for(const b of ec.values())f.addComponent(b);const y=new ek(t,r,u,f);return Zl.set(u,y),y}function nk(s=ma){const e=pa.get(s);if(!e&&s===ma&&D0())return M0();if(!e)throw vr.create("no-app",{appName:s});return e}function rk(){return Array.from(pa.values())}async function L0(s){let e=!1;const t=s.name;pa.has(t)?(e=!0,pa.delete(t)):Zl.has(t)&&s.decRefCount()<=0&&(Zl.delete(t),e=!0),e&&(await Promise.all(s.container.getProviders().map(r=>r.delete())),s.isDeleted=!0)}function Jr(s,e,t){let r=W2[s]??s;t&&(r+=`-${t}`);const a=r.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${r}" with version "${e}":`];a&&u.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hi.warn(u.join(" "));return}ga(new Ls(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function xI(s,e){if(s!==null&&typeof s!="function")throw vr.create("invalid-log-argument");c2(s,e)}function EI(s){l2(s)}const sk="firebase-heartbeat-database",ik=1,_d="firebase-heartbeat-store";let _y=null;function TI(){return _y||(_y=_2(sk,ik,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(_d)}catch(t){console.warn(t)}}}}).catch(s=>{throw vr.create("idb-open",{originalErrorMessage:s.message})})),_y}async function ak(s){try{const t=(await TI()).transaction(_d),r=await t.objectStore(_d).get(wI(s));return await t.done,r}catch(e){if(e instanceof Fn)hi.warn(e.message);else{const t=vr.create("idb-get",{originalErrorMessage:e?.message});hi.warn(t.message)}}}async function JE(s,e){try{const r=(await TI()).transaction(_d,"readwrite");await r.objectStore(_d).put(e,wI(s)),await r.done}catch(t){if(t instanceof Fn)hi.warn(t.message);else{const r=vr.create("idb-set",{originalErrorMessage:t?.message});hi.warn(r.message)}}}function wI(s){return`${s.name}!${s.options.appId}`}const ok=1024,lk=30;class ck{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new dk(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=ZE();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>lk){const a=hk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){hi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ZE(),{heartbeatsToSend:t,unsentEntries:r}=uk(this._heartbeatsCache.heartbeats),a=nm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return hi.warn(e),""}}}function ZE(){return new Date().toISOString().substring(0,10)}function uk(s,e=ok){const t=[];let r=s.slice();for(const a of s){const l=t.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),eT(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),eT(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class dk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gd()?YC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await ak(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return JE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return JE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function eT(s){return nm(JSON.stringify({version:2,heartbeats:s})).length}function hk(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let r=1;r<s.length;r++)s[r].date<t&&(t=s[r].date,e=r);return e}function fk(s){ga(new Ls("platform-logger",e=>new x2(e),"PRIVATE")),ga(new Ls("heartbeat",e=>new ck(e),"PRIVATE")),Jr(sm,zy,s),Jr(sm,zy,"esm2020"),Jr("fire-js","")}fk("");const mk=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Fn,SDK_VERSION:wa,_DEFAULT_ENTRY_NAME:ma,_addComponent:yd,_addOrOverwriteComponent:yI,_apps:pa,_clearComponents:J2,_components:ec,_getProvider:_I,_isFirebaseApp:O0,_isFirebaseServerApp:Nt,_isFirebaseServerAppSettings:vI,_registerComponent:ga,_removeServiceInstance:X2,_serverApps:Zl,deleteApp:L0,getApp:nk,getApps:rk,initializeApp:M0,initializeServerApp:tk,onLog:xI,registerVersion:Jr,setLogLevel:EI},Symbol.toStringTag,{value:"Module"}));class pk{constructor(e,t){this._delegate=e,this.firebase=t,yd(e,new Ls("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),L0(this._delegate)))}_getService(e,t=ma){this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&r.getComponent()?.instantiationMode==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=ma){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){yd(this._delegate,e)}_addOrOverwriteComponent(e){yI(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const gk={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},tT=new zo("app-compat","Firebase",gk);function yk(s){const e={},t={__esModule:!0,initializeApp:l,app:a,registerVersion:Jr,setLogLevel:EI,onLog:xI,apps:null,SDK_VERSION:wa,INTERNAL:{registerComponent:p,removeApp:r,useAsService:f,modularAPIs:mk}};t.default=t,Object.defineProperty(t,"apps",{get:u});function r(y){delete e[y]}function a(y){if(y=y||ma,!QE(e,y))throw tT.create("no-app",{appName:y});return e[y]}a.App=s;function l(y,b={}){const E=M0(y,b);if(QE(e,E.name))return e[E.name];const T=new s(E,t);return e[E.name]=T,T}function u(){return Object.keys(e).map(y=>e[y])}function p(y){const b=y.name,E=b.replace("-compat","");if(ga(y)&&y.type==="PUBLIC"){const T=(N=a())=>{if(typeof N[E]!="function")throw tT.create("invalid-app-argument",{appName:b});return N[E]()};y.serviceProps!==void 0&&rm(T,y.serviceProps),t[E]=T,s.prototype[E]=function(...N){return this._getService.bind(this,b).apply(this,y.multipleInstances?N:[])}}return y.type==="PUBLIC"?t[E]:null}function f(y,b){return b==="serverAuth"?null:b}return t}function II(){const s=yk(pk);s.INTERNAL={...s.INTERNAL,createFirebaseNamespace:II,extendNamespace:e,createSubscribe:hI,ErrorFactory:zo,deepExtend:rm};function e(t){rm(s,t)}return s}const _k=II();const nT=new Rm("@firebase/app-compat"),vk="@firebase/app-compat",bk="0.5.7";function xk(s){Jr(vk,bk,s)}try{const s=C0();if(s.firebase!==void 0){nT.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=s.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&nT.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const js=_k;xk();var Ek="firebase",Tk="12.8.0";js.registerVersion(Ek,Tk,"app-compat");const Mu={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Pl={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function wk(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function SI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ik=wk,Sk=SI,AI=new zo("auth","Firebase",SI());const im=new Rm("@firebase/auth");function Ak(s,...e){im.logLevel<=Qe.WARN&&im.warn(`Auth (${wa}): ${s}`,...e)}function Bf(s,...e){im.logLevel<=Qe.ERROR&&im.error(`Auth (${wa}): ${s}`,...e)}function Nn(s,...e){throw z0(s,...e)}function cn(s,...e){return z0(s,...e)}function U0(s,e,t){const r={...Sk(),[e]:t};return new zo("auth","Firebase",r).create(e,{appName:s.name})}function yn(s){return U0(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wc(s,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Nn(s,"argument-error"),U0(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function z0(s,...e){if(typeof s!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=s.name),s._errorFactory.create(t,...r)}return AI.create(s,...e)}function he(s,e,...t){if(!s)throw z0(e,...t)}function ks(s){const e="INTERNAL ASSERTION FAILED: "+s;throw Bf(e),new Error(e)}function ns(s,e){s||ks(e)}function vd(){return typeof self<"u"&&self.location?.href||""}function B0(){return rT()==="http:"||rT()==="https:"}function rT(){return typeof self<"u"&&self.location?.protocol||null}function Nk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(B0()||lI()||"connection"in navigator)?navigator.onLine:!0}function Rk(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Ud{constructor(e,t){this.shortDelay=e,this.longDelay=t,ns(t>e,"Short delay should be less than long delay!"),this.isMobile=QC()||P0()}get(){return Nk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function q0(s,e){ns(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class NI{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ks("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ks("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ks("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Ck={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const kk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Dk=new Ud(3e4,6e4);function Lt(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function Ut(s,e,t,r,a={}){return RI(s,a,async()=>{let l={},u={};r&&(e==="GET"?u=r:l={body:JSON.stringify(r)});const p=Tc({key:s.config.apiKey,...u}).slice(1),f=await s._getAdditionalHeaders();f["Content-Type"]="application/json",s.languageCode&&(f["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:f,...l};return $C()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&Ec(s.emulatorConfig.host)&&(y.credentials="include"),NI.fetch()(await CI(s,s.config.apiHost,t,p),y)})}async function RI(s,e,t){s._canInitEmulator=!1;const r={...Ck,...e};try{const a=new jk(s),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw $u(s,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const p=l.ok?u.errorMessage:u.error.message,[f,y]=p.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw $u(s,"credential-already-in-use",u);if(f==="EMAIL_EXISTS")throw $u(s,"email-already-in-use",u);if(f==="USER_DISABLED")throw $u(s,"user-disabled",u);const b=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw U0(s,b,y);Nn(s,b)}}catch(a){if(a instanceof Fn)throw a;Nn(s,"network-request-failed",{message:String(a)})}}async function gi(s,e,t,r,a={}){const l=await Ut(s,e,t,r,a);return"mfaPendingCredential"in l&&Nn(s,"multi-factor-auth-required",{_serverResponse:l}),l}async function CI(s,e,t,r){const a=`${e}${t}?${r}`,l=s,u=l.config.emulator?q0(s.config,a):`${s.config.apiScheme}://${a}`;return kk.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function Pk(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(cn(this.auth,"network-request-failed")),Dk.get())})}}function $u(s,e,t){const r={appName:s.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=cn(s,e,r);return a.customData._tokenResponse=t,a}function sT(s){return s!==void 0&&s.getResponse!==void 0}function iT(s){return s!==void 0&&s.enterprise!==void 0}class kI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Pk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Vk(s){return(await Ut(s,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function DI(s,e){return Ut(s,"GET","/v2/recaptchaConfig",Lt(s,e))}async function Ok(s,e){return Ut(s,"POST","/v1/accounts:delete",e)}async function Mk(s,e){return Ut(s,"POST","/v1/accounts:update",e)}async function am(s,e){return Ut(s,"POST","/v1/accounts:lookup",e)}function nd(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Lk(s,e=!1){const t=Ce(s),r=await t.getIdToken(e),a=Cm(r);he(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:r,authTime:nd(vy(a.auth_time)),issuedAtTime:nd(vy(a.iat)),expirationTime:nd(vy(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function vy(s){return Number(s)*1e3}function Cm(s){const[e,t,r]=s.split(".");if(e===void 0||t===void 0||r===void 0)return Bf("JWT malformed, contained fewer than 3 sections"),null;try{const a=R0(t);return a?JSON.parse(a):(Bf("Failed to decode base64 JWT payload"),null)}catch(a){return Bf("Caught error parsing JWT payload as JSON",a?.toString()),null}}function aT(s){const e=Cm(s);return he(e,"internal-error"),he(typeof e.exp<"u","internal-error"),he(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function fi(s,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Fn&&Uk(r)&&s.auth.currentUser===s&&await s.auth.signOut(),r}}function Uk({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class zk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class By{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=nd(this.lastLoginAt),this.creationTime=nd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function bd(s){const e=s.auth,t=await s.getIdToken(),r=await fi(s,am(e,{idToken:t}));he(r?.users.length,e,"internal-error");const a=r.users[0];s._notifyReloadListener(a);const l=a.providerUserInfo?.length?PI(a.providerUserInfo):[],u=qk(s.providerData,l),p=s.isAnonymous,f=!(s.email&&a.passwordHash)&&!u?.length,y=p?f:!1,b={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new By(a.createdAt,a.lastLoginAt),isAnonymous:y};Object.assign(s,b)}async function Bk(s){const e=Ce(s);await bd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qk(s,e){return[...s.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function PI(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function Fk(s,e){const t=await RI(s,{},async()=>{const r=Tc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=s.config,u=await CI(s,a,"/v1/token",`key=${l}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:p,body:r};return s.emulatorConfig&&Ec(s.emulatorConfig.host)&&(f.credentials="include"),NI.fetch()(u,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Hk(s,e){return Ut(s,"POST","/v2/accounts:revokeToken",Lt(s,e))}class Ql{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){he(e.idToken,"internal-error"),he(typeof e.idToken<"u","internal-error"),he(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):aT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){he(e.length!==0,"internal-error");const t=aT(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(he(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:l}=await Fk(e,t);this.updateTokensAndExpiration(r,a,Number(l))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:l}=t,u=new Ql;return r&&(he(typeof r=="string","internal-error",{appName:e}),u.refreshToken=r),a&&(he(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(he(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ql,this.toJSON())}_performRefresh(){return ks("not implemented")}}function Zi(s,e){he(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Xr{constructor({uid:e,auth:t,stsTokenManager:r,...a}){this.providerId="firebase",this.proactiveRefresh=new zk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new By(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await fi(this,this.stsTokenManager.getToken(this.auth,e));return he(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Lk(this,e)}reload(){return Bk(this)}_assign(e){this!==e&&(he(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Xr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){he(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await bd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Nt(this.auth.app))return Promise.reject(yn(this.auth));const e=await this.getIdToken();return await fi(this,Ok(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,p=t.tenantId??void 0,f=t._redirectEventId??void 0,y=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:E,emailVerified:T,isAnonymous:N,providerData:B,stsTokenManager:G}=t;he(E&&G,e,"internal-error");const te=Ql.fromJSON(this.name,G);he(typeof E=="string",e,"internal-error"),Zi(r,e.name),Zi(a,e.name),he(typeof T=="boolean",e,"internal-error"),he(typeof N=="boolean",e,"internal-error"),Zi(l,e.name),Zi(u,e.name),Zi(p,e.name),Zi(f,e.name),Zi(y,e.name),Zi(b,e.name);const I=new Xr({uid:E,auth:e,email:a,emailVerified:T,displayName:r,isAnonymous:N,photoURL:u,phoneNumber:l,tenantId:p,stsTokenManager:te,createdAt:y,lastLoginAt:b});return B&&Array.isArray(B)&&(I.providerData=B.map(X=>({...X}))),f&&(I._redirectEventId=f),I}static async _fromIdTokenResponse(e,t,r=!1){const a=new Ql;a.updateFromServerResponse(t);const l=new Xr({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await bd(l),l}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];he(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?PI(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,p=new Ql;p.updateFromIdToken(r);const f=new Xr({uid:a.localId,auth:e,stsTokenManager:p,isAnonymous:u}),y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new By(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(f,y),f}}const oT=new Map;function _r(s){ns(s instanceof Function,"Expected a class definition");let e=oT.get(s);return e?(ns(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,oT.set(s,e),e)}class jI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}jI.type="NONE";const tc=jI;function To(s,e,t){return`firebase:${s}:${e}:${t}`}class Kl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:l}=this.auth;this.fullUserKey=To(this.userKey,a.apiKey,l),this.fullPersistenceKey=To("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await am(this.auth,{idToken:e}).catch(()=>{});return t?Xr._fromGetAccountInfoResponse(this.auth,t,e):null}return Xr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Kl(_r(tc),e,r);const a=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=a[0]||_r(tc);const u=To(r,e.config.apiKey,e.name);let p=null;for(const y of t)try{const b=await y._get(u);if(b){let E;if(typeof b=="string"){const T=await am(e,{idToken:b}).catch(()=>{});if(!T)break;E=await Xr._fromGetAccountInfoResponse(e,T,b)}else E=Xr._fromJSON(e,b);y!==l&&(p=E),l=y;break}}catch{}const f=a.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!f.length?new Kl(l,e,r):(l=f[0],p&&await l._set(u,p.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(u)}catch{}})),new Kl(l,e,r))}}function lT(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(LI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(VI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(UI(e))return"Blackberry";if(zI(e))return"Webos";if(OI(e))return"Safari";if((e.includes("chrome/")||MI(e))&&!e.includes("edge/"))return"Chrome";if(zd(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=s.match(t);if(r?.length===2)return r[1]}return"Other"}function VI(s=Pt()){return/firefox\//i.test(s)}function OI(s=Pt()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function MI(s=Pt()){return/crios\//i.test(s)}function LI(s=Pt()){return/iemobile/i.test(s)}function zd(s=Pt()){return/android/i.test(s)}function UI(s=Pt()){return/blackberry/i.test(s)}function zI(s=Pt()){return/webos/i.test(s)}function Bd(s=Pt()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function Gk(s=Pt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(s)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(s)}function Qk(s=Pt()){return Bd(s)&&!!window.navigator?.standalone}function Kk(){return cI()&&document.documentMode===10}function BI(s=Pt()){return Bd(s)||zd(s)||zI(s)||UI(s)||/windows phone/i.test(s)||LI(s)}function qI(s,e=[]){let t;switch(s){case"Browser":t=lT(Pt());break;case"Worker":t=`${lT(Pt())}-${s}`;break;default:t=s}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${wa}/${r}`}class $k{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=l=>new Promise((u,p)=>{try{const f=e(l);u(f)}catch(f){p(f)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function Yk(s,e={}){return Ut(s,"GET","/v2/passwordPolicy",Lt(s,e))}const Wk=6;class Xk{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??Wk,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class Jk{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cT(this),this.idTokenSubscription=new cT(this),this.beforeStateQueue=new $k(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=AI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_r(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Kl.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await am(this,{idToken:e}),r=await Xr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Nt(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=r?._redirectEventId,p=await this.tryRedirectSignIn(e);(!l||l===u)&&p?.user&&(r=p.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(l){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return he(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await bd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Rk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Nt(this.app))return Promise.reject(yn(this));const t=e?Ce(e):null;return t&&he(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&he(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Nt(this.app)?Promise.reject(yn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Nt(this.app)?Promise.reject(yn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Yk(this),t=new Xk(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new zo("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Hk(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&_r(e)||this._popupRedirectResolver;he(t,this,"argument-error"),this.redirectPersistenceManager=await Kl.create(this,[_r(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(he(p,this,"internal-error"),p.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,r,a);return()=>{u=!0,f()}}else{const f=e.addObserver(t);return()=>{u=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return he(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Nt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Ak(`Error while retrieving App Check token: ${e.error}`),e?.token}}function jt(s){return Ce(s)}class cT{constructor(e){this.auth=e,this.observer=null,this.addObserver=hI(t=>this.observer=t)}get next(){return he(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let qd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Zk(s){qd=s}function F0(s){return qd.loadJS(s)}function eD(){return qd.recaptchaV2Script}function tD(){return qd.recaptchaEnterpriseScript}function nD(){return qd.gapiScript}function FI(s){return`__${s}${Math.floor(Math.random()*1e6)}`}const rD=500,sD=6e4,Df=1e12;class iD{constructor(e){this.auth=e,this.counter=Df,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new lD(e,this.auth.name,t||{})),this.counter++,r}reset(e){const t=e||Df;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||Df;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||Df;return this._widgets.get(t)?.execute(),""}}class aD{constructor(){this.enterprise=new oD}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class oD{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class lD{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const a=typeof e=="string"?document.getElementById(e):e;he(a,"argument-error",{appName:t}),this.container=a,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=cD(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},sD)},rD))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function cD(s){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<s;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const uD="recaptcha-enterprise",rd="NO_RECAPTCHA";class HI{constructor(e){this.type=uD,this.auth=jt(e)}async verify(e="verify",t=!1){async function r(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,p)=>{DI(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const y=new kI(f);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,u(y.siteKey)}}).catch(f=>{p(f)})})}function a(l,u,p){const f=window.grecaptcha;iT(f)?f.enterprise.ready(()=>{f.enterprise.execute(l,{action:e}).then(y=>{u(y)}).catch(()=>{u(rd)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new aD().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{r(this.auth).then(p=>{if(!t&&iT(window.grecaptcha))a(p,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let f=tD();f.length!==0&&(f+=p),F0(f).then(()=>{a(p,l,u)}).catch(y=>{u(y)})}}).catch(p=>{u(p)})})}}async function Lu(s,e,t,r=!1,a=!1){const l=new HI(s);let u;if(a)u=rd;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const f=p.phoneEnrollmentInfo.phoneNumber,y=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:y,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const f=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return r?Object.assign(p,{captchaResp:u}):Object.assign(p,{captchaResponse:u}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function ca(s,e,t,r,a){if(a==="EMAIL_PASSWORD_PROVIDER")if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await Lu(s,e,t,t==="getOobCode");return r(s,l)}else return r(s,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await Lu(s,e,t,t==="getOobCode");return r(s,u)}else return Promise.reject(l)});else if(a==="PHONE_PROVIDER")if(s._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const l=await Lu(s,e,t);return r(s,l).catch(async u=>{if(s._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(u.code==="auth/missing-recaptcha-token"||u.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const p=await Lu(s,e,t,!1,!0);return r(s,p)}return Promise.reject(u)})}else{const l=await Lu(s,e,t,!1,!0);return r(s,l)}else return Promise.reject(a+" provider is not supported.")}async function dD(s){const e=jt(s),t=await DI(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new kI(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new HI(e).verify()}function hD(s,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(_r);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(r,e?.popupRedirectResolver)}function fD(s,e,t){const r=jt(s);he(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!!t?.disableWarnings,l=GI(e),{host:u,port:p}=mD(e),f=p===null?"":`:${p}`,y={url:`${l}//${u}${f}/`},b=Object.freeze({host:u,port:p,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){he(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),he(fa(y,r.config.emulator)&&fa(b,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=y,r.emulatorConfig=b,r.settings.appVerificationDisabledForTesting=!0,Ec(u)?(iI(`${l}//${u}${f}`),aI("Auth",!0)):a||pD()}function GI(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function mD(s){const e=GI(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const l=a[1];return{host:l,port:uT(r.substr(l.length+1))}}else{const[l,u]=r.split(":");return{host:l,port:uT(u)}}}function uT(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function pD(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class Ic{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ks("not implemented")}_getIdTokenResponse(e){return ks("not implemented")}_linkToIdToken(e,t){return ks("not implemented")}_getReauthenticationResolver(e){return ks("not implemented")}}async function QI(s,e){return Ut(s,"POST","/v1/accounts:resetPassword",Lt(s,e))}async function gD(s,e){return Ut(s,"POST","/v1/accounts:update",e)}async function yD(s,e){return Ut(s,"POST","/v1/accounts:signUp",e)}async function _D(s,e){return Ut(s,"POST","/v1/accounts:update",Lt(s,e))}async function vD(s,e){return gi(s,"POST","/v1/accounts:signInWithPassword",Lt(s,e))}async function km(s,e){return Ut(s,"POST","/v1/accounts:sendOobCode",Lt(s,e))}async function bD(s,e){return km(s,e)}async function xD(s,e){return km(s,e)}async function ED(s,e){return km(s,e)}async function TD(s,e){return km(s,e)}async function wD(s,e){return gi(s,"POST","/v1/accounts:signInWithEmailLink",Lt(s,e))}async function ID(s,e){return gi(s,"POST","/v1/accounts:signInWithEmailLink",Lt(s,e))}class xd extends Ic{constructor(e,t,r,a=null){super("password",r),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new xd(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new xd(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ca(e,t,"signInWithPassword",vD,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return wD(e,{email:this._email,oobCode:this._password});default:Nn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ca(e,r,"signUpPassword",yD,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return ID(e,{idToken:t,email:this._email,oobCode:this._password});default:Nn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function di(s,e){return gi(s,"POST","/v1/accounts:signInWithIdp",Lt(s,e))}const SD="http://localhost";class Us extends Ic{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Us(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Nn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,...l}=t;if(!r||!a)return null;const u=new Us(r,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return di(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,di(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,di(e,t)}buildRequest(){const e={requestUri:SD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Tc(t)}return e}}async function dT(s,e){return Ut(s,"POST","/v1/accounts:sendVerificationCode",Lt(s,e))}async function AD(s,e){return gi(s,"POST","/v1/accounts:signInWithPhoneNumber",Lt(s,e))}async function ND(s,e){const t=await gi(s,"POST","/v1/accounts:signInWithPhoneNumber",Lt(s,e));if(t.temporaryProof)throw $u(s,"account-exists-with-different-credential",t);return t}const RD={USER_NOT_FOUND:"user-not-found"};async function CD(s,e){const t={...e,operation:"REAUTH"};return gi(s,"POST","/v1/accounts:signInWithPhoneNumber",Lt(s,t),RD)}class wo extends Ic{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new wo({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new wo({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return AD(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return ND(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return CD(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:a}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:a}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:a,temporaryProof:l}=e;return!r&&!t&&!a&&!l?null:new wo({verificationId:t,verificationCode:r,phoneNumber:a,temporaryProof:l})}}function kD(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function DD(s){const e=Gl(Ku(s)).link,t=e?Gl(Ku(e)).deep_link_id:null,r=Gl(Ku(s)).deep_link_id;return(r?Gl(Ku(r)).link:null)||r||t||e||s}class Dm{constructor(e){const t=Gl(Ku(e)),r=t.apiKey??null,a=t.oobCode??null,l=kD(t.mode??null);he(r&&a&&l,"argument-error"),this.apiKey=r,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=DD(e);try{return new Dm(t)}catch{return null}}}class Ia{constructor(){this.providerId=Ia.PROVIDER_ID}static credential(e,t){return xd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Dm.parseLink(t);return he(r,"argument-error"),xd._fromEmailAndCode(e,r.code,r.tenantId)}}Ia.PROVIDER_ID="password";Ia.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ia.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class yi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Sc extends yi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class $l extends Sc{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return he("providerId"in t&&"signInMethod"in t,"argument-error"),Us._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return he(e.idToken||e.accessToken,"argument-error"),Us._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return $l.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return $l.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:a,pendingToken:l,nonce:u,providerId:p}=e;if(!r&&!a&&!t&&!l||!p)return null;try{return new $l(p)._credential({idToken:t,accessToken:r,nonce:u,pendingToken:l})}catch{return null}}}class As extends Sc{constructor(){super("facebook.com")}static credential(e){return Us._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return As.credential(e.oauthAccessToken)}catch{return null}}}As.FACEBOOK_SIGN_IN_METHOD="facebook.com";As.PROVIDER_ID="facebook.com";class Ns extends Sc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Us._fromParams({providerId:Ns.PROVIDER_ID,signInMethod:Ns.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ns.credentialFromTaggedObject(e)}static credentialFromError(e){return Ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Ns.credential(t,r)}catch{return null}}}Ns.GOOGLE_SIGN_IN_METHOD="google.com";Ns.PROVIDER_ID="google.com";class Rs extends Sc{constructor(){super("github.com")}static credential(e){return Us._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rs.credential(e.oauthAccessToken)}catch{return null}}}Rs.GITHUB_SIGN_IN_METHOD="github.com";Rs.PROVIDER_ID="github.com";const PD="http://localhost";class nc extends Ic{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return di(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,di(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,di(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,pendingToken:l}=t;return!r||!a||!l||r!==a?null:new nc(r,l)}static _create(e,t){return new nc(e,t)}buildRequest(){return{requestUri:PD,returnSecureToken:!0,pendingToken:this.pendingToken}}}const jD="saml.";class om extends yi{constructor(e){he(e.startsWith(jD),"argument-error"),super(e)}static credentialFromResult(e){return om.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return om.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=nc.fromJSON(e);return he(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return nc._create(r,t)}catch{return null}}}class Cs extends Sc{constructor(){super("twitter.com")}static credential(e,t){return Us._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Cs.credential(t,r)}catch{return null}}}Cs.TWITTER_SIGN_IN_METHOD="twitter.com";Cs.PROVIDER_ID="twitter.com";async function KI(s,e){return gi(s,"POST","/v1/accounts:signUp",Lt(s,e))}class Mr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const l=await Xr._fromIdTokenResponse(e,r,a),u=hT(r);return new Mr({user:l,providerId:u,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=hT(r);return new Mr({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function hT(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}async function VD(s){if(Nt(s.app))return Promise.reject(yn(s));const e=jt(s);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Mr({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await KI(e,{returnSecureToken:!0}),r=await Mr._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class lm extends Fn{constructor(e,t,r,a){super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,lm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new lm(e,t,r,a)}}function $I(s,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?lm._fromErrorAndOperation(s,l,e,r):l})}function YI(s){return new Set(s.map(({providerId:e})=>e).filter(e=>!!e))}async function OD(s,e){const t=Ce(s);await Pm(!0,t,e);const{providerUserInfo:r}=await Mk(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=YI(r||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function H0(s,e,t=!1){const r=await fi(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Mr._forOperation(s,"link",r)}async function Pm(s,e,t){await bd(e);const r=YI(e.providerData),a=s===!1?"provider-already-linked":"no-such-provider";he(r.has(t)===s,e.auth,a)}async function WI(s,e,t=!1){const{auth:r}=s;if(Nt(r.app))return Promise.reject(yn(r));const a="reauthenticate";try{const l=await fi(s,$I(r,a,e,s),t);he(l.idToken,r,"internal-error");const u=Cm(l.idToken);he(u,r,"internal-error");const{sub:p}=u;return he(s.uid===p,r,"user-mismatch"),Mr._forOperation(s,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Nn(r,"user-mismatch"),l}}async function XI(s,e,t=!1){if(Nt(s.app))return Promise.reject(yn(s));const r="signIn",a=await $I(s,r,e),l=await Mr._fromIdTokenResponse(s,r,a);return t||await s._updateCurrentUser(l.user),l}async function jm(s,e){return XI(jt(s),e)}async function JI(s,e){const t=Ce(s);return await Pm(!1,t,e.providerId),H0(t,e)}async function ZI(s,e){return WI(Ce(s),e)}async function MD(s,e){return gi(s,"POST","/v1/accounts:signInWithCustomToken",Lt(s,e))}async function LD(s,e){if(Nt(s.app))return Promise.reject(yn(s));const t=jt(s),r=await MD(t,{token:e,returnSecureToken:!0}),a=await Mr._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(a.user),a}class Fd{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?G0._fromServerResponse(e,t):"totpInfo"in t?Q0._fromServerResponse(e,t):Nn(e,"internal-error")}}class G0 extends Fd{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new G0(t)}}class Q0 extends Fd{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Q0(t)}}function Vm(s,e,t){he(t.url?.length>0,s,"invalid-continue-uri"),he(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,s,"invalid-dynamic-link-domain"),he(typeof t.linkDomain>"u"||t.linkDomain.length>0,s,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(he(t.iOS.bundleId.length>0,s,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(he(t.android.packageName.length>0,s,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function K0(s){const e=jt(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function UD(s,e,t){const r=jt(s),a={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Vm(r,a,t),await ca(r,a,"getOobCode",xD,"EMAIL_PASSWORD_PROVIDER")}async function zD(s,e,t){await QI(Ce(s),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&K0(s),r})}async function BD(s,e){await _D(Ce(s),{oobCode:e})}async function eS(s,e){const t=Ce(s),r=await QI(t,{oobCode:e}),a=r.requestType;switch(he(a,t,"internal-error"),a){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":he(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":he(r.mfaInfo,t,"internal-error");default:he(r.email,t,"internal-error")}let l=null;return r.mfaInfo&&(l=Fd._fromServerResponse(jt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:l},operation:a}}async function qD(s,e){const{data:t}=await eS(Ce(s),e);return t.email}async function FD(s,e,t){if(Nt(s.app))return Promise.reject(yn(s));const r=jt(s),u=await ca(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",KI,"EMAIL_PASSWORD_PROVIDER").catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&K0(s),f}),p=await Mr._fromIdTokenResponse(r,"signIn",u);return await r._updateCurrentUser(p.user),p}function HD(s,e,t){return Nt(s.app)?Promise.reject(yn(s)):jm(Ce(s),Ia.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&K0(s),r})}async function GD(s,e,t){const r=jt(s),a={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function l(u,p){he(p.handleCodeInApp,r,"argument-error"),p&&Vm(r,u,p)}l(a,t),await ca(r,a,"getOobCode",ED,"EMAIL_PASSWORD_PROVIDER")}function QD(s,e){return Dm.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function KD(s,e,t){if(Nt(s.app))return Promise.reject(yn(s));const r=Ce(s),a=Ia.credentialWithLink(e,t||vd());return he(a._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),jm(r,a)}async function $D(s,e){return Ut(s,"POST","/v1/accounts:createAuthUri",Lt(s,e))}async function YD(s,e){const t=B0()?vd():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:a}=await $D(Ce(s),r);return a||[]}async function WD(s,e){const t=Ce(s),a={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()};e&&Vm(t.auth,a,e);const{email:l}=await bD(t.auth,a);l!==s.email&&await s.reload()}async function XD(s,e,t){const r=Ce(s),l={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await s.getIdToken(),newEmail:e};t&&Vm(r.auth,l,t);const{email:u}=await TD(r.auth,l);u!==s.email&&await s.reload()}async function JD(s,e){return Ut(s,"POST","/v1/accounts:update",e)}async function ZD(s,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Ce(s),l={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await fi(r,JD(r.auth,l));r.displayName=u.displayName||null,r.photoURL=u.photoUrl||null;const p=r.providerData.find(({providerId:f})=>f==="password");p&&(p.displayName=r.displayName,p.photoURL=r.photoURL),await r._updateTokensIfNecessary(u)}function eP(s,e){const t=Ce(s);return Nt(t.auth.app)?Promise.reject(yn(t.auth)):tS(t,e,null)}function tP(s,e){return tS(Ce(s),null,e)}async function tS(s,e,t){const{auth:r}=s,l={idToken:await s.getIdToken(),returnSecureToken:!0};e&&(l.email=e),t&&(l.password=t);const u=await fi(s,gD(r,l));await s._updateTokensIfNecessary(u,!0)}function nP(s){if(!s)return null;const{providerId:e}=s,t=s.rawUserInfo?JSON.parse(s.rawUserInfo):{},r=s.isNewUser||s.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&s?.idToken){const a=Cm(s.idToken)?.firebase?.sign_in_provider;if(a){const l=a!=="anonymous"&&a!=="custom"?a:null;return new Yl(r,l)}}if(!e)return null;switch(e){case"facebook.com":return new rP(r,t);case"github.com":return new sP(r,t);case"google.com":return new iP(r,t);case"twitter.com":return new aP(r,t,s.screenName||null);case"custom":case"anonymous":return new Yl(r,null);default:return new Yl(r,e,t)}}class Yl{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class nS extends Yl{constructor(e,t,r,a){super(e,t,r),this.username=a}}class rP extends Yl{constructor(e,t){super(e,"facebook.com",t)}}class sP extends nS{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}}class iP extends Yl{constructor(e,t){super(e,"google.com",t)}}class aP extends nS{constructor(e,t,r){super(e,"twitter.com",t,r)}}function oP(s){const{user:e,_tokenResponse:t}=s;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:nP(t)}class yo{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new yo("enroll",e,t)}static _fromMfaPendingCredential(e){return new yo("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return yo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return yo._fromIdtoken(e.multiFactorSession.idToken)}return null}}class $0{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=jt(e),a=t.customData._serverResponse,l=(a.mfaInfo||[]).map(p=>Fd._fromServerResponse(r,p));he(a.mfaPendingCredential,r,"internal-error");const u=yo._fromMfaPendingCredential(a.mfaPendingCredential);return new $0(u,l,async p=>{const f=await p._process(r,u);delete a.mfaInfo,delete a.mfaPendingCredential;const y={...a,idToken:f.idToken,refreshToken:f.refreshToken};switch(t.operationType){case"signIn":const b=await Mr._fromIdTokenResponse(r,t.operationType,y);return await r._updateCurrentUser(b.user),b;case"reauthenticate":return he(t.user,r,"internal-error"),Mr._forOperation(t.user,t.operationType,y);default:Nn(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function lP(s,e){const t=Ce(s),r=e;return he(e.customData.operationType,t,"argument-error"),he(r.customData._serverResponse?.mfaPendingCredential,t,"argument-error"),$0._fromError(t,r)}function fT(s,e){return Ut(s,"POST","/v2/accounts/mfaEnrollment:start",Lt(s,e))}function cP(s,e){return Ut(s,"POST","/v2/accounts/mfaEnrollment:finalize",Lt(s,e))}function uP(s,e){return Ut(s,"POST","/v2/accounts/mfaEnrollment:withdraw",Lt(s,e))}class Y0{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Fd._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new Y0(e)}async getSession(){return yo._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,a=await this.getSession(),l=await fi(this.user,r._process(this.user.auth,a,t));return await this.user._updateTokensIfNecessary(l),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const a=await fi(this.user,uP(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:l})=>l!==t),await this.user._updateTokensIfNecessary(a),await this.user.reload()}catch(a){throw a}}}const by=new WeakMap;function dP(s){const e=Ce(s);return by.has(e)||by.set(e,Y0._fromUser(e)),by.get(e)}const cm="__sak";class rS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(cm,"1"),this.storage.removeItem(cm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const hP=1e3,fP=10;class sS extends rS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=BI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,p,f)=>{this.notifyListeners(u,f)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(r);!t&&this.localCache[r]===u||this.notifyListeners(r,u)},l=this.storage.getItem(r);Kk()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,fP):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},hP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}sS.type="LOCAL";const W0=sS;class iS extends rS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}iS.type="SESSION";const So=iS;function mP(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Om{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new Om(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:l}=t.data,u=this.handlersMap[a];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const p=Array.from(u).map(async y=>y(t.origin,l)),f=await mP(p);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Om.receivers=[];function Hd(s="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return s+t}class pP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((p,f)=>{const y=Hd("",20);a.port1.start();const b=setTimeout(()=>{f(new Error("unsupported_event"))},r);u={messageChannel:a,onMessage(E){const T=E;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(b),l=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),p(T.data.response);break;default:clearTimeout(b),clearTimeout(l),f(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function rn(){return window}function gP(s){rn().location.href=s}function X0(){return typeof rn().WorkerGlobalScope<"u"&&typeof rn().importScripts=="function"}async function yP(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _P(){return navigator?.serviceWorker?.controller||null}function vP(){return X0()?self:null}const aS="firebaseLocalStorageDb",bP=1,um="firebaseLocalStorage",oS="fbase_key";class Gd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Mm(s,e){return s.transaction([um],e?"readwrite":"readonly").objectStore(um)}function xP(){const s=indexedDB.deleteDatabase(aS);return new Gd(s).toPromise()}function qy(){const s=indexedDB.open(aS,bP);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const r=s.result;try{r.createObjectStore(um,{keyPath:oS})}catch(a){t(a)}}),s.addEventListener("success",async()=>{const r=s.result;r.objectStoreNames.contains(um)?e(r):(r.close(),await xP(),e(await qy()))})})}async function mT(s,e,t){const r=Mm(s,!0).put({[oS]:e,value:t});return new Gd(r).toPromise()}async function EP(s,e){const t=Mm(s,!1).get(e),r=await new Gd(t).toPromise();return r===void 0?null:r.value}function pT(s,e){const t=Mm(s,!0).delete(e);return new Gd(t).toPromise()}const TP=800,wP=3;class lS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>wP)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return X0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Om._getInstance(vP()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await yP(),!this.activeServiceWorker)return;this.sender=new pP(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_P()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await qy();return await mT(e,cm,"1"),await pT(e,cm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>mT(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>EP(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>pT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Mm(a,!1).getAll();return new Gd(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),TP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}lS.type="LOCAL";const Ed=lS;function gT(s,e){return Ut(s,"POST","/v2/accounts/mfaSignIn:start",Lt(s,e))}function IP(s,e){return Ut(s,"POST","/v2/accounts/mfaSignIn:finalize",Lt(s,e))}const xy=FI("rcb"),SP=new Ud(3e4,6e4);class AP{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!rn().grecaptcha?.render}load(e,t=""){return he(NP(t),e,"argument-error"),this.shouldResolveImmediately(t)&&sT(rn().grecaptcha)?Promise.resolve(rn().grecaptcha):new Promise((r,a)=>{const l=rn().setTimeout(()=>{a(cn(e,"network-request-failed"))},SP.get());rn()[xy]=()=>{rn().clearTimeout(l),delete rn()[xy];const p=rn().grecaptcha;if(!p||!sT(p)){a(cn(e,"internal-error"));return}const f=p.render;p.render=(y,b)=>{const E=f(y,b);return this.counter++,E},this.hostLanguage=t,r(p)};const u=`${eD()}?${Tc({onload:xy,render:"explicit",hl:t})}`;F0(u).catch(()=>{clearTimeout(l),a(cn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!rn().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function NP(s){return s.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(s)}class RP{async load(e){return new iD(e)}clearedOneInstance(){}}const sd="recaptcha",CP={theme:"light",type:"image"};let kP=class{constructor(e,t,r={...CP}){this.parameters=r,this.type=sd,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=jt(e),this.isInvisible=this.parameters.size==="invisible",he(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const a=typeof t=="string"?document.getElementById(t):t;he(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new RP:new AP,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(a=>{const l=u=>{u&&(this.tokenChangeListeners.delete(l),a(u))};this.tokenChangeListeners.add(l),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){he(!this.parameters.sitekey,this.auth,"argument-error"),he(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),he(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=rn()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){he(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){he(B0()&&!X0(),this.auth,"internal-error"),await DP(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await Vk(this.auth);he(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return he(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function DP(){let s=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}s=()=>e(),window.addEventListener("load",s)}).catch(e=>{throw s&&window.removeEventListener("load",s),e})}class J0{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=wo._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function PP(s,e,t){if(Nt(s.app))return Promise.reject(yn(s));const r=jt(s),a=await Lm(r,e,Ce(t));return new J0(a,l=>jm(r,l))}async function jP(s,e,t){const r=Ce(s);await Pm(!1,r,"phone");const a=await Lm(r.auth,e,Ce(t));return new J0(a,l=>JI(r,l))}async function VP(s,e,t){const r=Ce(s);if(Nt(r.auth.app))return Promise.reject(yn(r.auth));const a=await Lm(r.auth,e,Ce(t));return new J0(a,l=>ZI(r,l))}async function Lm(s,e,t){if(!s._getRecaptchaConfig())try{await dD(s)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(typeof e=="string"?r={phoneNumber:e}:r=e,"session"in r){const a=r.session;if("phoneNumber"in r){he(a.type==="enroll",s,"internal-error");const l={idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await ca(s,l,"mfaSmsEnrollment",async(y,b)=>{if(b.phoneEnrollmentInfo.captchaResponse===rd){he(t?.type===sd,y,"argument-error");const E=await Ey(y,b,t);return fT(y,E)}return fT(y,b)},"PHONE_PROVIDER").catch(y=>Promise.reject(y))).phoneSessionInfo.sessionInfo}else{he(a.type==="signin",s,"internal-error");const l=r.multiFactorHint?.uid||r.multiFactorUid;he(l,s,"missing-multi-factor-info");const u={mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await ca(s,u,"mfaSmsSignIn",async(b,E)=>{if(E.phoneSignInInfo.captchaResponse===rd){he(t?.type===sd,b,"argument-error");const T=await Ey(b,E,t);return gT(b,T)}return gT(b,E)},"PHONE_PROVIDER").catch(b=>Promise.reject(b))).phoneResponseInfo.sessionInfo}}else{const a={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await ca(s,a,"sendVerificationCode",async(f,y)=>{if(y.captchaResponse===rd){he(t?.type===sd,f,"argument-error");const b=await Ey(f,y,t);return dT(f,b)}return dT(f,y)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).sessionInfo}}finally{t?._reset()}}async function OP(s,e){const t=Ce(s);if(Nt(t.auth.app))return Promise.reject(yn(t.auth));await H0(t,e)}async function Ey(s,e,t){he(t.type===sd,s,"argument-error");const r=await t.verify();he(typeof r=="string",s,"argument-error");const a={...e};if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.captchaResponse,p=a.phoneEnrollmentInfo.clientType,f=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:r,captchaResponse:u,clientType:p,recaptchaVersion:f}}),a}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.captchaResponse,u=a.phoneSignInInfo.clientType,p=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:l,clientType:u,recaptchaVersion:p}}),a}else return Object.assign(a,{recaptchaToken:r}),a}let Ao=class qf{constructor(e){this.providerId=qf.PROVIDER_ID,this.auth=jt(e)}verifyPhoneNumber(e,t){return Lm(this.auth,e,Ce(t))}static credential(e,t){return wo._fromVerification(e,t)}static credentialFromResult(e){const t=e;return qf.credentialFromTaggedObject(t)}static credentialFromError(e){return qf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?wo._fromTokenResponse(t,r):null}};Ao.PROVIDER_ID="phone";Ao.PHONE_SIGN_IN_METHOD="phone";function Bo(s,e){return e?_r(e):(he(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class Z0 extends Ic{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return di(e,this._buildIdpRequest())}_linkToIdToken(e,t){return di(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return di(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function MP(s){return XI(s.auth,new Z0(s),s.bypassAuthState)}function LP(s){const{auth:e,user:t}=s;return he(t,e,"internal-error"),WI(t,new Z0(s),s.bypassAuthState)}async function UP(s){const{auth:e,user:t}=s;return he(t,e,"internal-error"),H0(t,new Z0(s),s.bypassAuthState)}class cS{constructor(e,t,r,a,l=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:l,error:u,type:p}=e;if(u){this.reject(u);return}const f={auth:this.auth,requestUri:t,sessionId:r,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(f))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return MP;case"linkViaPopup":case"linkViaRedirect":return UP;case"reauthViaPopup":case"reauthViaRedirect":return LP;default:Nn(this.auth,"internal-error")}}resolve(e){ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ns(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const zP=new Ud(2e3,1e4);async function BP(s,e,t){if(Nt(s.app))return Promise.reject(cn(s,"operation-not-supported-in-this-environment"));const r=jt(s);wc(s,e,yi);const a=Bo(r,t);return new li(r,"signInViaPopup",e,a).executeNotNull()}async function qP(s,e,t){const r=Ce(s);if(Nt(r.auth.app))return Promise.reject(cn(r.auth,"operation-not-supported-in-this-environment"));wc(r.auth,e,yi);const a=Bo(r.auth,t);return new li(r.auth,"reauthViaPopup",e,a,r).executeNotNull()}async function FP(s,e,t){const r=Ce(s);wc(r.auth,e,yi);const a=Bo(r.auth,t);return new li(r.auth,"linkViaPopup",e,a,r).executeNotNull()}class li extends cS{constructor(e,t,r,a,l){super(e,t,a,l),this.provider=r,this.authWindow=null,this.pollId=null,li.currentPopupAction&&li.currentPopupAction.cancel(),li.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return he(e,this.auth,"internal-error"),e}async onExecution(){ns(this.filter.length===1,"Popup operations only handle one event");const e=Hd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(cn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(cn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,li.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(cn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,zP.get())};e()}}li.currentPopupAction=null;const HP="pendingRedirect",id=new Map;class GP extends cS{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=id.get(this.auth._key());if(!e){try{const r=await QP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}id.set(this.auth._key(),e)}return this.bypassAuthState||id.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function QP(s,e){const t=dS(e),r=uS(s);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}async function e_(s,e){return uS(s)._set(dS(e),"true")}function KP(){id.clear()}function t_(s,e){id.set(s._key(),e)}function uS(s){return _r(s._redirectPersistence)}function dS(s){return To(HP,s.config.apiKey,s.name)}function $P(s,e,t){return YP(s,e,t)}async function YP(s,e,t){if(Nt(s.app))return Promise.reject(yn(s));const r=jt(s);wc(s,e,yi),await r._initializationPromise;const a=Bo(r,t);return await e_(a,r),a._openRedirect(r,e,"signInViaRedirect")}function WP(s,e,t){return XP(s,e,t)}async function XP(s,e,t){const r=Ce(s);if(wc(r.auth,e,yi),Nt(r.auth.app))return Promise.reject(yn(r.auth));await r.auth._initializationPromise;const a=Bo(r.auth,t);await e_(a,r.auth);const l=await hS(r);return a._openRedirect(r.auth,e,"reauthViaRedirect",l)}function JP(s,e,t){return ZP(s,e,t)}async function ZP(s,e,t){const r=Ce(s);wc(r.auth,e,yi),await r.auth._initializationPromise;const a=Bo(r.auth,t);await Pm(!1,r,e.providerId),await e_(a,r.auth);const l=await hS(r);return a._openRedirect(r.auth,e,"linkViaRedirect",l)}async function ej(s,e){return await jt(s)._initializationPromise,Um(s,e,!1)}async function Um(s,e,t=!1){if(Nt(s.app))return Promise.reject(yn(s));const r=jt(s),a=Bo(r,e),u=await new GP(r,a,t).execute();return u&&!t&&(delete u.user._redirectEventId,await r._persistUserIfCurrent(u.user),await r._setRedirectUser(null,e)),u}async function hS(s){const e=Hd(`${s.uid}:::`);return s._redirectEventId=e,await s.auth._setRedirectUser(s),await s.auth._persistUserIfCurrent(s),e}const tj=600*1e3;class fS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!mS(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(cn(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tj&&this.cachedEventUids.clear(),this.cachedEventUids.has(yT(e))}saveEventToCache(e){this.cachedEventUids.add(yT(e)),this.lastProcessedEventTime=Date.now()}}function yT(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function mS({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function nj(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return mS(s);default:return!1}}async function pS(s,e={}){return Ut(s,"GET","/v1/projects",e)}const rj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sj=/^https?/;async function ij(s){if(s.config.emulator)return;const{authorizedDomains:e}=await pS(s);for(const t of e)try{if(aj(t))return}catch{}Nn(s,"unauthorized-domain")}function aj(s){const e=vd(),{protocol:t,hostname:r}=new URL(e);if(s.startsWith("chrome-extension://")){const u=new URL(s);return u.hostname===""&&r===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===r}if(!sj.test(t))return!1;if(rj.test(s))return r===s;const a=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const oj=new Ud(3e4,6e4);function _T(){const s=rn().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function lj(s){return new Promise((e,t)=>{function r(){_T(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_T(),t(cn(s,"network-request-failed"))},timeout:oj.get()})}if(rn().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(rn().gapi?.load)r();else{const a=FI("iframefcb");return rn()[a]=()=>{gapi.load?r():t(cn(s,"network-request-failed"))},F0(`${nD()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Ff=null,e})}let Ff=null;function cj(s){return Ff=Ff||lj(s),Ff}const uj=new Ud(5e3,15e3),dj="__/auth/iframe",hj="emulator/auth/iframe",fj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function pj(s){const e=s.config;he(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?q0(e,hj):`https://${s.config.authDomain}/${dj}`,r={apiKey:e.apiKey,appName:s.name,v:wa},a=mj.get(s.config.apiHost);a&&(r.eid=a);const l=s._getFrameworks();return l.length&&(r.fw=l.join(",")),`${t}?${Tc(r).slice(1)}`}async function gj(s){const e=await cj(s),t=rn().gapi;return he(t,s,"internal-error"),e.open({where:document.body,url:pj(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fj,dontclear:!0},r=>new Promise(async(a,l)=>{await r.restyle({setHideOnLeave:!1});const u=cn(s,"network-request-failed"),p=rn().setTimeout(()=>{l(u)},uj.get());function f(){rn().clearTimeout(p),a(r)}r.ping(f).then(f,()=>{l(u)})}))}const yj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},_j=500,vj=600,bj="_blank",xj="http://localhost";class vT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Ej(s,e,t,r=_j,a=vj){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-r)/2,0).toString();let p="";const f={...yj,width:r.toString(),height:a.toString(),top:l,left:u},y=Pt().toLowerCase();t&&(p=MI(y)?bj:t),VI(y)&&(e=e||xj,f.scrollbars="yes");const b=Object.entries(f).reduce((T,[N,B])=>`${T}${N}=${B},`,"");if(Qk(y)&&p!=="_self")return Tj(e||"",p),new vT(null);const E=window.open(e||"",p,b);he(E,s,"popup-blocked");try{E.focus()}catch{}return new vT(E)}function Tj(s,e){const t=document.createElement("a");t.href=s,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const wj="__/auth/handler",Ij="emulator/auth/handler",Sj=encodeURIComponent("fac");async function Fy(s,e,t,r,a,l){he(s.config.authDomain,s,"auth-domain-config-required"),he(s.config.apiKey,s,"invalid-api-key");const u={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:r,v:wa,eventId:a};if(e instanceof yi){e.setDefaultLanguage(s.languageCode),u.providerId=e.providerId||"",ZC(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,E]of Object.entries(l||{}))u[b]=E}if(e instanceof Sc){const b=e.getScopes().filter(E=>E!=="");b.length>0&&(u.scopes=b.join(","))}s.tenantId&&(u.tid=s.tenantId);const p=u;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const f=await s._getAppCheckToken(),y=f?`#${Sj}=${encodeURIComponent(f)}`:"";return`${Aj(s)}?${Tc(p).slice(1)}${y}`}function Aj({config:s}){return s.emulator?q0(s,Ij):`https://${s.authDomain}/${wj}`}const Ty="webStorageSupport";class Nj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=So,this._completeRedirectFn=Um,this._overrideRedirectResult=t_}async _openPopup(e,t,r,a){ns(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await Fy(e,t,r,vd(),a);return Ej(e,l,Hd())}async _openRedirect(e,t,r,a){await this._originValidation(e);const l=await Fy(e,t,r,vd(),a);return gP(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(ns(l,"If manager is not set, promise should be"),l)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await gj(e),r=new fS(e);return t.register("authEvent",a=>(he(a?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ty,{type:Ty},a=>{const l=a?.[0]?.[Ty];l!==void 0&&t(!!l),Nn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ij(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return BI()||OI()||Bd()}}const Rj=Nj;class Cj{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return ks("unexpected MultiFactorSessionType")}}}class n_ extends Cj{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n_(e)}_finalizeEnroll(e,t,r){return cP(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return IP(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class gS{constructor(){}static assertion(e){return n_._fromCredential(e)}}gS.FACTOR_ID="phone";var bT="@firebase/auth",xT="1.12.0";class kj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){he(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Dj(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Pj(s){ga(new Ls("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:p}=r.options;he(u&&!u.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:u,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qI(s)},y=new Jk(r,a,l,f);return hD(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ga(new Ls("auth-internal",e=>{const t=jt(e.getProvider("auth").getImmediate());return(r=>new kj(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Jr(bT,xT,Dj(s)),Jr(bT,xT,"esm2020")}const jj=300;BC("authIdTokenMaxAge");function Vj(){return document.getElementsByTagName("head")?.[0]??document}Zk({loadJS(s){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",s),r.onload=e,r.onerror=a=>{const l=cn("internal-error");l.customData=a,t(l)},r.type="text/javascript",r.charset="UTF-8",Vj().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Pj("Browser");function No(){return window}const Oj=2e3;async function Mj(s,e,t){const{BuildInfo:r}=No();ns(e.sessionId,"AuthEvent did not contain a session ID");const a=await qj(e.sessionId),l={};return Bd()?l.ibi=r.packageName:zd()?l.apn=r.packageName:Nn(s,"operation-not-supported-in-this-environment"),r.displayName&&(l.appDisplayName=r.displayName),l.sessionId=a,Fy(s,t,e.type,void 0,e.eventId??void 0,l)}async function Lj(s){const{BuildInfo:e}=No(),t={};Bd()?t.iosBundleId=e.packageName:zd()?t.androidPackageName=e.packageName:Nn(s,"operation-not-supported-in-this-environment"),await pS(s,t)}function Uj(s){const{cordova:e}=No();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let a=null;r?e.plugins.browsertab.openUrl(s):a=e.InAppBrowser.open(s,Gk()?"_blank":"_system","location=yes"),t(a)})})}async function zj(s,e,t){const{cordova:r}=No();let a=()=>{};try{await new Promise((l,u)=>{let p=null;function f(){l();const E=r.plugins.browsertab?.close;typeof E=="function"&&E(),typeof t?.close=="function"&&t.close()}function y(){p||(p=window.setTimeout(()=>{u(cn(s,"redirect-cancelled-by-user"))},Oj))}function b(){document?.visibilityState==="visible"&&y()}e.addPassiveListener(f),document.addEventListener("resume",y,!1),zd()&&document.addEventListener("visibilitychange",b,!1),a=()=>{e.removePassiveListener(f),document.removeEventListener("resume",y,!1),document.removeEventListener("visibilitychange",b,!1),p&&window.clearTimeout(p)}})}finally{a()}}function Bj(s){const e=No();he(typeof e?.universalLinks?.subscribe=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),he(typeof e?.BuildInfo?.packageName<"u",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),he(typeof e?.cordova?.plugins?.browsertab?.openUrl=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),he(typeof e?.cordova?.plugins?.browsertab?.isAvailable=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),he(typeof e?.cordova?.InAppBrowser?.open=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function qj(s){const e=Fj(s),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(a=>a.toString(16).padStart(2,"0")).join("")}function Fj(s){if(ns(/[0-9a-zA-Z]+/.test(s),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(s);const e=new ArrayBuffer(s.length),t=new Uint8Array(e);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t}const Hj=20;class Gj extends fS{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function Qj(s,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:Yj(),postBody:null,tenantId:s.tenantId,error:cn(s,"no-auth-event")}}function Kj(s,e){return Hy()._set(Gy(s),e)}async function ET(s){const e=await Hy()._get(Gy(s));return e&&await Hy()._remove(Gy(s)),e}function $j(s,e){const t=Xj(e);if(t.includes("/__/auth/callback")){const r=Hf(t),l=(r.firebaseError?Wj(decodeURIComponent(r.firebaseError)):null)?.code?.split("auth/")?.[1],u=l?cn(l):null;return u?{type:s.type,eventId:s.eventId,tenantId:s.tenantId,error:u,urlResponse:null,sessionId:null,postBody:null}:{type:s.type,eventId:s.eventId,tenantId:s.tenantId,sessionId:s.sessionId,urlResponse:t,postBody:null}}return null}function Yj(){const s=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<Hj;t++){const r=Math.floor(Math.random()*e.length);s.push(e.charAt(r))}return s.join("")}function Hy(){return _r(W0)}function Gy(s){return To("authEvent",s.config.apiKey,s.name)}function Wj(s){try{return JSON.parse(s)}catch{return null}}function Xj(s){const e=Hf(s),t=e.link?decodeURIComponent(e.link):void 0,r=Hf(t).link,a=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Hf(a).link||a||r||t||s}function Hf(s){if(!s?.includes("?"))return{};const[e,...t]=s.split("?");return Gl(t.join("?"))}const Jj=500;class Zj{constructor(){this._redirectPersistence=So,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Um,this._overrideRedirectResult=t_}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new Gj(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Nn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,a){Bj(e);const l=await this._initialize(e);await l.initialized(),l.resetRedirect(),KP(),await this._originValidation(e);const u=Qj(e,r,a);await Kj(e,u);const p=await Mj(e,u,t),f=await Uj(p);return zj(e,l,f)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Lj(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:a,BuildInfo:l}=No(),u=setTimeout(async()=>{await ET(e),t.onEvent(TT())},Jj),p=async b=>{clearTimeout(u);const E=await ET(e);let T=null;E&&b?.url&&(T=$j(E,b.url)),t.onEvent(T||TT())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,p);const f=a,y=`${l.packageName.toLowerCase()}://`;No().handleOpenURL=async b=>{if(b.toLowerCase().startsWith(y)&&p({url:b}),typeof f=="function")try{f(b)}catch(E){console.error(E)}}}}const eV=Zj;function TT(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:cn("no-auth-event")}}function tV(s,e){jt(s)._logFramework(e)}var nV="@firebase/auth-compat",rV="0.6.2";const sV=1e3;function ad(){return self?.location?.protocol||null}function iV(){return ad()==="http:"||ad()==="https:"}function yS(s=Pt()){return!!((ad()==="file:"||ad()==="ionic:"||ad()==="capacitor:")&&s.toLowerCase().match(/iphone|ipad|ipod|android/))}function aV(){return P0()||Nm()}function oV(){return cI()&&document?.documentMode===11}function lV(s=Pt()){return/Edge\/\d+/.test(s)}function cV(s=Pt()){return oV()||lV(s)}function _S(){try{const s=self.localStorage,e=Hd();if(s)return s.setItem(e,"1"),s.removeItem(e),cV()?gd():!0}catch{return r_()&&gd()}return!1}function r_(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function wy(){return(iV()||lI()||yS())&&!aV()&&_S()&&!r_()}function vS(){return yS()&&typeof document<"u"}async function uV(){return vS()?new Promise(s=>{const e=setTimeout(()=>{s(!1)},sV);document.addEventListener("deviceready",()=>{clearTimeout(e),s(!0)})}):!1}function dV(){return typeof window<"u"?window:null}const yr={LOCAL:"local",NONE:"none",SESSION:"session"},Uu=he,bS="persistence";function hV(s,e){if(Uu(Object.values(yr).includes(e),s,"invalid-persistence-type"),P0()){Uu(e!==yr.SESSION,s,"unsupported-persistence-type");return}if(Nm()){Uu(e===yr.NONE,s,"unsupported-persistence-type");return}if(r_()){Uu(e===yr.NONE||e===yr.LOCAL&&gd(),s,"unsupported-persistence-type");return}Uu(e===yr.NONE||_S(),s,"unsupported-persistence-type")}async function Qy(s){await s._initializationPromise;const e=xS(),t=To(bS,s.config.apiKey,s.name);e&&e.setItem(t,s._getPersistenceType())}function fV(s,e){const t=xS();if(!t)return[];const r=To(bS,s,e);switch(t.getItem(r)){case yr.NONE:return[tc];case yr.LOCAL:return[Ed,So];case yr.SESSION:return[So];default:return[]}}function xS(){try{return dV()?.sessionStorage||null}catch{return null}}const mV=he;class ia{constructor(){this.browserResolver=_r(Rj),this.cordovaResolver=_r(eV),this.underlyingResolver=null,this._redirectPersistence=So,this._completeRedirectFn=Um,this._overrideRedirectResult=t_}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,a)}async _openRedirect(e,t,r,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,a)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return vS()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return mV(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await uV();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function ES(s){return s.unwrap()}function pV(s){return s.wrapped()}function gV(s){return TS(s)}function yV(s,e){const t=e.customData?._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){const r=e;r.resolver=new _V(s,lP(s,e))}else if(t){const r=TS(e),a=e;r&&(a.credential=r,a.tenantId=t.tenantId||void 0,a.email=t.email||void 0,a.phoneNumber=t.phoneNumber||void 0)}}function TS(s){const{_tokenResponse:e}=s instanceof Fn?s.customData:s;if(!e)return null;if(!(s instanceof Fn)&&"temporaryProof"in e&&"phoneNumber"in e)return Ao.credentialFromResult(s);const t=e.providerId;if(!t||t===Mu.PASSWORD)return null;let r;switch(t){case Mu.GOOGLE:r=Ns;break;case Mu.FACEBOOK:r=As;break;case Mu.GITHUB:r=Rs;break;case Mu.TWITTER:r=Cs;break;default:const{oauthIdToken:a,oauthAccessToken:l,oauthTokenSecret:u,pendingToken:p,nonce:f}=e;return!l&&!u&&!a&&!p?null:p?t.startsWith("saml.")?nc._create(t,p):Us._fromParams({providerId:t,signInMethod:t,pendingToken:p,idToken:a,accessToken:l}):new $l(t).credential({idToken:a,accessToken:l,rawNonce:f})}return s instanceof Fn?r.credentialFromError(s):r.credentialFromResult(s)}function nr(s,e){return e.catch(t=>{throw t instanceof Fn&&yV(s,t),t}).then(t=>{const r=t.operationType,a=t.user;return{operationType:r,credential:gV(t),additionalUserInfo:oP(t),user:zm.getOrCreate(a)}})}async function Ky(s,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>nr(s,t.confirm(r))}}class _V{constructor(e,t){this.resolver=t,this.auth=pV(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return nr(ES(this.auth),this.resolver.resolveSignIn(e))}}let zm=class Yu{constructor(e){this._delegate=e,this.multiFactor=dP(e)}static getOrCreate(e){return Yu.USER_MAP.has(e)||Yu.USER_MAP.set(e,new Yu(e)),Yu.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return nr(this.auth,JI(this._delegate,e))}async linkWithPhoneNumber(e,t){return Ky(this.auth,jP(this._delegate,e,t))}async linkWithPopup(e){return nr(this.auth,FP(this._delegate,e,ia))}async linkWithRedirect(e){return await Qy(jt(this.auth)),JP(this._delegate,e,ia)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return nr(this.auth,ZI(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Ky(this.auth,VP(this._delegate,e,t))}reauthenticateWithPopup(e){return nr(this.auth,qP(this._delegate,e,ia))}async reauthenticateWithRedirect(e){return await Qy(jt(this.auth)),WP(this._delegate,e,ia)}sendEmailVerification(e){return WD(this._delegate,e)}async unlink(e){return await OD(this._delegate,e),this}updateEmail(e){return eP(this._delegate,e)}updatePassword(e){return tP(this._delegate,e)}updatePhoneNumber(e){return OP(this._delegate,e)}updateProfile(e){return ZD(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return XD(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};zm.USER_MAP=new WeakMap;const zu=he;class $y{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;zu(r,"invalid-api-key",{appName:e.name}),zu(r,"invalid-api-key",{appName:e.name});const a=typeof window<"u"?ia:void 0;this._delegate=t.initialize({options:{persistence:vV(r,e.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(Ik),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?zm.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){fD(this._delegate,e,t)}applyActionCode(e){return BD(this._delegate,e)}checkActionCode(e){return eS(this._delegate,e)}confirmPasswordReset(e,t){return zD(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return nr(this._delegate,FD(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return YD(this._delegate,e)}isSignInWithEmailLink(e){return QD(this._delegate,e)}async getRedirectResult(){zu(wy(),this._delegate,"operation-not-supported-in-this-environment");const e=await ej(this._delegate,ia);return e?nr(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){tV(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:a,error:l,complete:u}=wT(e,t,r);return this._delegate.onAuthStateChanged(a,l,u)}onIdTokenChanged(e,t,r){const{next:a,error:l,complete:u}=wT(e,t,r);return this._delegate.onIdTokenChanged(a,l,u)}sendSignInLinkToEmail(e,t){return GD(this._delegate,e,t)}sendPasswordResetEmail(e,t){return UD(this._delegate,e,t||void 0)}async setPersistence(e){hV(this._delegate,e);let t;switch(e){case yr.SESSION:t=So;break;case yr.LOCAL:t=await _r(Ed)._isAvailable()?Ed:W0;break;case yr.NONE:t=tc;break;default:return Nn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return nr(this._delegate,VD(this._delegate))}signInWithCredential(e){return nr(this._delegate,jm(this._delegate,e))}signInWithCustomToken(e){return nr(this._delegate,LD(this._delegate,e))}signInWithEmailAndPassword(e,t){return nr(this._delegate,HD(this._delegate,e,t))}signInWithEmailLink(e,t){return nr(this._delegate,KD(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Ky(this._delegate,PP(this._delegate,e,t))}async signInWithPopup(e){return zu(wy(),this._delegate,"operation-not-supported-in-this-environment"),nr(this._delegate,BP(this._delegate,e,ia))}async signInWithRedirect(e){return zu(wy(),this._delegate,"operation-not-supported-in-this-environment"),await Qy(this._delegate),$P(this._delegate,e,ia)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return qD(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}$y.Persistence=yr;function wT(s,e,t){let r=s;typeof s!="function"&&({next:r,error:e,complete:t}=s);const a=r;return{next:u=>a(u&&zm.getOrCreate(u)),error:e,complete:t}}function vV(s,e){const t=fV(s,e);if(typeof self<"u"&&!t.includes(Ed)&&t.push(Ed),typeof window<"u")for(const r of[W0,So])t.includes(r)||t.push(r);return t.includes(tc)||t.push(tc),t}class s_{static credential(e,t){return Ao.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new Ao(ES(js.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}s_.PHONE_SIGN_IN_METHOD=Ao.PHONE_SIGN_IN_METHOD;s_.PROVIDER_ID=Ao.PROVIDER_ID;const bV=he;class xV{constructor(e,t,r=js.app()){bV(r.options?.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new kP(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const EV="auth-compat";function TV(s){s.INTERNAL.registerComponent(new Ls(EV,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new $y(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Pl.EMAIL_SIGNIN,PASSWORD_RESET:Pl.PASSWORD_RESET,RECOVER_EMAIL:Pl.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Pl.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Pl.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Pl.VERIFY_EMAIL}},EmailAuthProvider:Ia,FacebookAuthProvider:As,GithubAuthProvider:Rs,GoogleAuthProvider:Ns,OAuthProvider:$l,SAMLAuthProvider:om,PhoneAuthProvider:s_,PhoneMultiFactorGenerator:gS,RecaptchaVerifier:xV,TwitterAuthProvider:Cs,Auth:$y,AuthCredential:Ic,Error:Fn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),s.registerVersion(nV,rV)}TV(js);var IT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ua,wS;(function(){var s;function e(A,R){function k(){}k.prototype=R.prototype,A.F=R.prototype,A.prototype=new k,A.prototype.constructor=A,A.D=function(j,P,L){for(var C=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)C[Me-2]=arguments[Me];return R.prototype[P].apply(j,C)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,R,k){k||(k=0);const j=Array(16);if(typeof R=="string")for(var P=0;P<16;++P)j[P]=R.charCodeAt(k++)|R.charCodeAt(k++)<<8|R.charCodeAt(k++)<<16|R.charCodeAt(k++)<<24;else for(P=0;P<16;++P)j[P]=R[k++]|R[k++]<<8|R[k++]<<16|R[k++]<<24;R=A.g[0],k=A.g[1],P=A.g[2];let L=A.g[3],C;C=R+(L^k&(P^L))+j[0]+3614090360&4294967295,R=k+(C<<7&4294967295|C>>>25),C=L+(P^R&(k^P))+j[1]+3905402710&4294967295,L=R+(C<<12&4294967295|C>>>20),C=P+(k^L&(R^k))+j[2]+606105819&4294967295,P=L+(C<<17&4294967295|C>>>15),C=k+(R^P&(L^R))+j[3]+3250441966&4294967295,k=P+(C<<22&4294967295|C>>>10),C=R+(L^k&(P^L))+j[4]+4118548399&4294967295,R=k+(C<<7&4294967295|C>>>25),C=L+(P^R&(k^P))+j[5]+1200080426&4294967295,L=R+(C<<12&4294967295|C>>>20),C=P+(k^L&(R^k))+j[6]+2821735955&4294967295,P=L+(C<<17&4294967295|C>>>15),C=k+(R^P&(L^R))+j[7]+4249261313&4294967295,k=P+(C<<22&4294967295|C>>>10),C=R+(L^k&(P^L))+j[8]+1770035416&4294967295,R=k+(C<<7&4294967295|C>>>25),C=L+(P^R&(k^P))+j[9]+2336552879&4294967295,L=R+(C<<12&4294967295|C>>>20),C=P+(k^L&(R^k))+j[10]+4294925233&4294967295,P=L+(C<<17&4294967295|C>>>15),C=k+(R^P&(L^R))+j[11]+2304563134&4294967295,k=P+(C<<22&4294967295|C>>>10),C=R+(L^k&(P^L))+j[12]+1804603682&4294967295,R=k+(C<<7&4294967295|C>>>25),C=L+(P^R&(k^P))+j[13]+4254626195&4294967295,L=R+(C<<12&4294967295|C>>>20),C=P+(k^L&(R^k))+j[14]+2792965006&4294967295,P=L+(C<<17&4294967295|C>>>15),C=k+(R^P&(L^R))+j[15]+1236535329&4294967295,k=P+(C<<22&4294967295|C>>>10),C=R+(P^L&(k^P))+j[1]+4129170786&4294967295,R=k+(C<<5&4294967295|C>>>27),C=L+(k^P&(R^k))+j[6]+3225465664&4294967295,L=R+(C<<9&4294967295|C>>>23),C=P+(R^k&(L^R))+j[11]+643717713&4294967295,P=L+(C<<14&4294967295|C>>>18),C=k+(L^R&(P^L))+j[0]+3921069994&4294967295,k=P+(C<<20&4294967295|C>>>12),C=R+(P^L&(k^P))+j[5]+3593408605&4294967295,R=k+(C<<5&4294967295|C>>>27),C=L+(k^P&(R^k))+j[10]+38016083&4294967295,L=R+(C<<9&4294967295|C>>>23),C=P+(R^k&(L^R))+j[15]+3634488961&4294967295,P=L+(C<<14&4294967295|C>>>18),C=k+(L^R&(P^L))+j[4]+3889429448&4294967295,k=P+(C<<20&4294967295|C>>>12),C=R+(P^L&(k^P))+j[9]+568446438&4294967295,R=k+(C<<5&4294967295|C>>>27),C=L+(k^P&(R^k))+j[14]+3275163606&4294967295,L=R+(C<<9&4294967295|C>>>23),C=P+(R^k&(L^R))+j[3]+4107603335&4294967295,P=L+(C<<14&4294967295|C>>>18),C=k+(L^R&(P^L))+j[8]+1163531501&4294967295,k=P+(C<<20&4294967295|C>>>12),C=R+(P^L&(k^P))+j[13]+2850285829&4294967295,R=k+(C<<5&4294967295|C>>>27),C=L+(k^P&(R^k))+j[2]+4243563512&4294967295,L=R+(C<<9&4294967295|C>>>23),C=P+(R^k&(L^R))+j[7]+1735328473&4294967295,P=L+(C<<14&4294967295|C>>>18),C=k+(L^R&(P^L))+j[12]+2368359562&4294967295,k=P+(C<<20&4294967295|C>>>12),C=R+(k^P^L)+j[5]+4294588738&4294967295,R=k+(C<<4&4294967295|C>>>28),C=L+(R^k^P)+j[8]+2272392833&4294967295,L=R+(C<<11&4294967295|C>>>21),C=P+(L^R^k)+j[11]+1839030562&4294967295,P=L+(C<<16&4294967295|C>>>16),C=k+(P^L^R)+j[14]+4259657740&4294967295,k=P+(C<<23&4294967295|C>>>9),C=R+(k^P^L)+j[1]+2763975236&4294967295,R=k+(C<<4&4294967295|C>>>28),C=L+(R^k^P)+j[4]+1272893353&4294967295,L=R+(C<<11&4294967295|C>>>21),C=P+(L^R^k)+j[7]+4139469664&4294967295,P=L+(C<<16&4294967295|C>>>16),C=k+(P^L^R)+j[10]+3200236656&4294967295,k=P+(C<<23&4294967295|C>>>9),C=R+(k^P^L)+j[13]+681279174&4294967295,R=k+(C<<4&4294967295|C>>>28),C=L+(R^k^P)+j[0]+3936430074&4294967295,L=R+(C<<11&4294967295|C>>>21),C=P+(L^R^k)+j[3]+3572445317&4294967295,P=L+(C<<16&4294967295|C>>>16),C=k+(P^L^R)+j[6]+76029189&4294967295,k=P+(C<<23&4294967295|C>>>9),C=R+(k^P^L)+j[9]+3654602809&4294967295,R=k+(C<<4&4294967295|C>>>28),C=L+(R^k^P)+j[12]+3873151461&4294967295,L=R+(C<<11&4294967295|C>>>21),C=P+(L^R^k)+j[15]+530742520&4294967295,P=L+(C<<16&4294967295|C>>>16),C=k+(P^L^R)+j[2]+3299628645&4294967295,k=P+(C<<23&4294967295|C>>>9),C=R+(P^(k|~L))+j[0]+4096336452&4294967295,R=k+(C<<6&4294967295|C>>>26),C=L+(k^(R|~P))+j[7]+1126891415&4294967295,L=R+(C<<10&4294967295|C>>>22),C=P+(R^(L|~k))+j[14]+2878612391&4294967295,P=L+(C<<15&4294967295|C>>>17),C=k+(L^(P|~R))+j[5]+4237533241&4294967295,k=P+(C<<21&4294967295|C>>>11),C=R+(P^(k|~L))+j[12]+1700485571&4294967295,R=k+(C<<6&4294967295|C>>>26),C=L+(k^(R|~P))+j[3]+2399980690&4294967295,L=R+(C<<10&4294967295|C>>>22),C=P+(R^(L|~k))+j[10]+4293915773&4294967295,P=L+(C<<15&4294967295|C>>>17),C=k+(L^(P|~R))+j[1]+2240044497&4294967295,k=P+(C<<21&4294967295|C>>>11),C=R+(P^(k|~L))+j[8]+1873313359&4294967295,R=k+(C<<6&4294967295|C>>>26),C=L+(k^(R|~P))+j[15]+4264355552&4294967295,L=R+(C<<10&4294967295|C>>>22),C=P+(R^(L|~k))+j[6]+2734768916&4294967295,P=L+(C<<15&4294967295|C>>>17),C=k+(L^(P|~R))+j[13]+1309151649&4294967295,k=P+(C<<21&4294967295|C>>>11),C=R+(P^(k|~L))+j[4]+4149444226&4294967295,R=k+(C<<6&4294967295|C>>>26),C=L+(k^(R|~P))+j[11]+3174756917&4294967295,L=R+(C<<10&4294967295|C>>>22),C=P+(R^(L|~k))+j[2]+718787259&4294967295,P=L+(C<<15&4294967295|C>>>17),C=k+(L^(P|~R))+j[9]+3951481745&4294967295,A.g[0]=A.g[0]+R&4294967295,A.g[1]=A.g[1]+(P+(C<<21&4294967295|C>>>11))&4294967295,A.g[2]=A.g[2]+P&4294967295,A.g[3]=A.g[3]+L&4294967295}r.prototype.v=function(A,R){R===void 0&&(R=A.length);const k=R-this.blockSize,j=this.C;let P=this.h,L=0;for(;L<R;){if(P==0)for(;L<=k;)a(this,A,L),L+=this.blockSize;if(typeof A=="string"){for(;L<R;)if(j[P++]=A.charCodeAt(L++),P==this.blockSize){a(this,j),P=0;break}}else for(;L<R;)if(j[P++]=A[L++],P==this.blockSize){a(this,j),P=0;break}}this.h=P,this.o+=R},r.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var R=1;R<A.length-8;++R)A[R]=0;R=this.o*8;for(var k=A.length-8;k<A.length;++k)A[k]=R&255,R/=256;for(this.v(A),A=Array(16),R=0,k=0;k<4;++k)for(let j=0;j<32;j+=8)A[R++]=this.g[k]>>>j&255;return A};function l(A,R){var k=p;return Object.prototype.hasOwnProperty.call(k,A)?k[A]:k[A]=R(A)}function u(A,R){this.h=R;const k=[];let j=!0;for(let P=A.length-1;P>=0;P--){const L=A[P]|0;j&&L==R||(k[P]=L,j=!1)}this.g=k}var p={};function f(A){return-128<=A&&A<128?l(A,function(R){return new u([R|0],R<0?-1:0)}):new u([A|0],A<0?-1:0)}function y(A){if(isNaN(A)||!isFinite(A))return E;if(A<0)return te(y(-A));const R=[];let k=1;for(let j=0;A>=k;j++)R[j]=A/k|0,k*=4294967296;return new u(R,0)}function b(A,R){if(A.length==0)throw Error("number format error: empty string");if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(A.charAt(0)=="-")return te(b(A.substring(1),R));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const k=y(Math.pow(R,8));let j=E;for(let L=0;L<A.length;L+=8){var P=Math.min(8,A.length-L);const C=parseInt(A.substring(L,L+P),R);P<8?(P=y(Math.pow(R,P)),j=j.j(P).add(y(C))):(j=j.j(k),j=j.add(y(C)))}return j}var E=f(0),T=f(1),N=f(16777216);s=u.prototype,s.m=function(){if(G(this))return-te(this).m();let A=0,R=1;for(let k=0;k<this.g.length;k++){const j=this.i(k);A+=(j>=0?j:4294967296+j)*R,R*=4294967296}return A},s.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(B(this))return"0";if(G(this))return"-"+te(this).toString(A);const R=y(Math.pow(A,6));var k=this;let j="";for(;;){const P=fe(k,R).g;k=I(k,P.j(R));let L=((k.g.length>0?k.g[0]:k.h)>>>0).toString(A);if(k=P,B(k))return L+j;for(;L.length<6;)L="0"+L;j=L+j}},s.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function B(A){if(A.h!=0)return!1;for(let R=0;R<A.g.length;R++)if(A.g[R]!=0)return!1;return!0}function G(A){return A.h==-1}s.l=function(A){return A=I(this,A),G(A)?-1:B(A)?0:1};function te(A){const R=A.g.length,k=[];for(let j=0;j<R;j++)k[j]=~A.g[j];return new u(k,~A.h).add(T)}s.abs=function(){return G(this)?te(this):this},s.add=function(A){const R=Math.max(this.g.length,A.g.length),k=[];let j=0;for(let P=0;P<=R;P++){let L=j+(this.i(P)&65535)+(A.i(P)&65535),C=(L>>>16)+(this.i(P)>>>16)+(A.i(P)>>>16);j=C>>>16,L&=65535,C&=65535,k[P]=C<<16|L}return new u(k,k[k.length-1]&-2147483648?-1:0)};function I(A,R){return A.add(te(R))}s.j=function(A){if(B(this)||B(A))return E;if(G(this))return G(A)?te(this).j(te(A)):te(te(this).j(A));if(G(A))return te(this.j(te(A)));if(this.l(N)<0&&A.l(N)<0)return y(this.m()*A.m());const R=this.g.length+A.g.length,k=[];for(var j=0;j<2*R;j++)k[j]=0;for(j=0;j<this.g.length;j++)for(let P=0;P<A.g.length;P++){const L=this.i(j)>>>16,C=this.i(j)&65535,Me=A.i(P)>>>16,Pe=A.i(P)&65535;k[2*j+2*P]+=C*Pe,X(k,2*j+2*P),k[2*j+2*P+1]+=L*Pe,X(k,2*j+2*P+1),k[2*j+2*P+1]+=C*Me,X(k,2*j+2*P+1),k[2*j+2*P+2]+=L*Me,X(k,2*j+2*P+2)}for(A=0;A<R;A++)k[A]=k[2*A+1]<<16|k[2*A];for(A=R;A<2*R;A++)k[A]=0;return new u(k,0)};function X(A,R){for(;(A[R]&65535)!=A[R];)A[R+1]+=A[R]>>>16,A[R]&=65535,R++}function se(A,R){this.g=A,this.h=R}function fe(A,R){if(B(R))throw Error("division by zero");if(B(A))return new se(E,E);if(G(A))return R=fe(te(A),R),new se(te(R.g),te(R.h));if(G(R))return R=fe(A,te(R)),new se(te(R.g),R.h);if(A.g.length>30){if(G(A)||G(R))throw Error("slowDivide_ only works with positive integers.");for(var k=T,j=R;j.l(A)<=0;)k=H(k),j=H(j);var P=ae(k,1),L=ae(j,1);for(j=ae(j,2),k=ae(k,2);!B(j);){var C=L.add(j);C.l(A)<=0&&(P=P.add(k),L=C),j=ae(j,1),k=ae(k,1)}return R=I(A,P.j(R)),new se(P,R)}for(P=E;A.l(R)>=0;){for(k=Math.max(1,Math.floor(A.m()/R.m())),j=Math.ceil(Math.log(k)/Math.LN2),j=j<=48?1:Math.pow(2,j-48),L=y(k),C=L.j(R);G(C)||C.l(A)>0;)k-=j,L=y(k),C=L.j(R);B(L)&&(L=T),P=P.add(L),A=I(A,C)}return new se(P,A)}s.B=function(A){return fe(this,A).h},s.and=function(A){const R=Math.max(this.g.length,A.g.length),k=[];for(let j=0;j<R;j++)k[j]=this.i(j)&A.i(j);return new u(k,this.h&A.h)},s.or=function(A){const R=Math.max(this.g.length,A.g.length),k=[];for(let j=0;j<R;j++)k[j]=this.i(j)|A.i(j);return new u(k,this.h|A.h)},s.xor=function(A){const R=Math.max(this.g.length,A.g.length),k=[];for(let j=0;j<R;j++)k[j]=this.i(j)^A.i(j);return new u(k,this.h^A.h)};function H(A){const R=A.g.length+1,k=[];for(let j=0;j<R;j++)k[j]=A.i(j)<<1|A.i(j-1)>>>31;return new u(k,A.h)}function ae(A,R){const k=R>>5;R%=32;const j=A.g.length-k,P=[];for(let L=0;L<j;L++)P[L]=R>0?A.i(L+k)>>>R|A.i(L+k+1)<<32-R:A.i(L+k);return new u(P,A.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,wS=r,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=y,u.fromString=b,ua=u}).apply(typeof IT<"u"?IT:typeof self<"u"?self:typeof window<"u"?window:{});var Pf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var IS,Wu,SS,Gf,Yy,AS,NS,RS;(function(){var s,e=Object.defineProperty;function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pf=="object"&&Pf];for(var _=0;_<d.length;++_){var x=d[_];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=t(this);function a(d,_){if(_)e:{var x=r;d=d.split(".");for(var S=0;S<d.length-1;S++){var F=d[S];if(!(F in x))break e;x=x[F]}d=d[d.length-1],S=x[d],_=_(S),_!=S&&_!=null&&e(x,d,{configurable:!0,writable:!0,value:_})}}a("Symbol.dispose",function(d){return d||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(d){return d||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(d){return d||function(_){var x=[],S;for(S in _)Object.prototype.hasOwnProperty.call(_,S)&&x.push([S,_[S]]);return x}});var l=l||{},u=this||self;function p(d){var _=typeof d;return _=="object"&&d!=null||_=="function"}function f(d,_,x){return d.call.apply(d.bind,arguments)}function y(d,_,x){return y=f,y.apply(null,arguments)}function b(d,_){var x=Array.prototype.slice.call(arguments,1);return function(){var S=x.slice();return S.push.apply(S,arguments),d.apply(this,S)}}function E(d,_){function x(){}x.prototype=_.prototype,d.Z=_.prototype,d.prototype=new x,d.prototype.constructor=d,d.Ob=function(S,F,J){for(var ge=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)ge[Ue-2]=arguments[Ue];return _.prototype[F].apply(S,ge)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?d=>d&&AsyncContext.Snapshot.wrap(d):d=>d;function N(d){const _=d.length;if(_>0){const x=Array(_);for(let S=0;S<_;S++)x[S]=d[S];return x}return[]}function B(d,_){for(let S=1;S<arguments.length;S++){const F=arguments[S];var x=typeof F;if(x=x!="object"?x:F?Array.isArray(F)?"array":x:"null",x=="array"||x=="object"&&typeof F.length=="number"){x=d.length||0;const J=F.length||0;d.length=x+J;for(let ge=0;ge<J;ge++)d[x+ge]=F[ge]}else d.push(F)}}class G{constructor(_,x){this.i=_,this.j=x,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function te(d){u.setTimeout(()=>{throw d},0)}function I(){var d=A;let _=null;return d.g&&(_=d.g,d.g=d.g.next,d.g||(d.h=null),_.next=null),_}class X{constructor(){this.h=this.g=null}add(_,x){const S=se.get();S.set(_,x),this.h?this.h.next=S:this.g=S,this.h=S}}var se=new G(()=>new fe,d=>d.reset());class fe{constructor(){this.next=this.g=this.h=null}set(_,x){this.h=_,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let H,ae=!1,A=new X,R=()=>{const d=Promise.resolve(void 0);H=()=>{d.then(k)}};function k(){for(var d;d=I();){try{d.h.call(d.g)}catch(x){te(x)}var _=se;_.j(d),_.h<100&&(_.h++,d.next=_.g,_.g=d)}ae=!1}function j(){this.u=this.u,this.C=this.C}j.prototype.u=!1,j.prototype.dispose=function(){this.u||(this.u=!0,this.N())},j.prototype[Symbol.dispose]=function(){this.dispose()},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function P(d,_){this.type=d,this.g=this.target=_,this.defaultPrevented=!1}P.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var d=!1,_=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};u.addEventListener("test",x,_),u.removeEventListener("test",x,_)}catch{}return d})();function C(d){return/^[\s\xa0]*$/.test(d)}function Me(d,_){P.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d&&this.init(d,_)}E(Me,P),Me.prototype.init=function(d,_){const x=this.type=d.type,S=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;this.target=d.target||d.srcElement,this.g=_,_=d.relatedTarget,_||(x=="mouseover"?_=d.fromElement:x=="mouseout"&&(_=d.toElement)),this.relatedTarget=_,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=d.pointerType,this.state=d.state,this.i=d,d.defaultPrevented&&Me.Z.h.call(this)},Me.prototype.h=function(){Me.Z.h.call(this);const d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Pe="closure_listenable_"+(Math.random()*1e6|0),Z=0;function pe(d,_,x,S,F){this.listener=d,this.proxy=null,this.src=_,this.type=x,this.capture=!!S,this.ha=F,this.key=++Z,this.da=this.fa=!1}function Ee(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Ne(d,_,x){for(const S in d)_.call(x,d[S],S,d)}function Le(d,_){for(const x in d)_.call(void 0,d[x],x,d)}function V(d){const _={};for(const x in d)_[x]=d[x];return _}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(d,_){let x,S;for(let F=1;F<arguments.length;F++){S=arguments[F];for(x in S)d[x]=S[x];for(let J=0;J<O.length;J++)x=O[J],Object.prototype.hasOwnProperty.call(S,x)&&(d[x]=S[x])}}function ne(d){this.src=d,this.g={},this.h=0}ne.prototype.add=function(d,_,x,S,F){const J=d.toString();d=this.g[J],d||(d=this.g[J]=[],this.h++);const ge=me(d,_,S,F);return ge>-1?(_=d[ge],x||(_.fa=!1)):(_=new pe(_,this.src,J,!!S,F),_.fa=x,d.push(_)),_};function de(d,_){const x=_.type;if(x in d.g){var S=d.g[x],F=Array.prototype.indexOf.call(S,_,void 0),J;(J=F>=0)&&Array.prototype.splice.call(S,F,1),J&&(Ee(_),d.g[x].length==0&&(delete d.g[x],d.h--))}}function me(d,_,x,S){for(let F=0;F<d.length;++F){const J=d[F];if(!J.da&&J.listener==_&&J.capture==!!x&&J.ha==S)return F}return-1}var _e="closure_lm_"+(Math.random()*1e6|0),it={};function tt(d,_,x,S,F){if(Array.isArray(_)){for(let J=0;J<_.length;J++)tt(d,_[J],x,S,F);return null}return x=$n(x),d&&d[Pe]?d.J(_,x,p(S)?!!S.capture:!1,F):ar(d,_,x,!1,S,F)}function ar(d,_,x,S,F,J){if(!_)throw Error("Invalid event type");const ge=p(F)?!!F.capture:!!F;let Ue=Cn(d);if(Ue||(d[_e]=Ue=new ne(d)),x=Ue.add(_,x,S,ge,J),x.proxy)return x;if(S=zt(),x.proxy=S,S.src=d,S.listener=x,d.addEventListener)L||(F=ge),F===void 0&&(F=!1),d.addEventListener(_.toString(),S,F);else if(d.attachEvent)d.attachEvent(on(_.toString()),S);else if(d.addListener&&d.removeListener)d.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return x}function zt(){function d(x){return _.call(d.src,d.listener,x)}const _=Qn;return d}function _n(d,_,x,S,F){if(Array.isArray(_))for(var J=0;J<_.length;J++)_n(d,_[J],x,S,F);else S=p(S)?!!S.capture:!!S,x=$n(x),d&&d[Pe]?(d=d.i,J=String(_).toString(),J in d.g&&(_=d.g[J],x=me(_,x,S,F),x>-1&&(Ee(_[x]),Array.prototype.splice.call(_,x,1),_.length==0&&(delete d.g[J],d.h--)))):d&&(d=Cn(d))&&(_=d.g[_.toString()],d=-1,_&&(d=me(_,x,S,F)),(x=d>-1?_[d]:null)&&xr(x))}function xr(d){if(typeof d!="number"&&d&&!d.da){var _=d.src;if(_&&_[Pe])de(_.i,d);else{var x=d.type,S=d.proxy;_.removeEventListener?_.removeEventListener(x,S,d.capture):_.detachEvent?_.detachEvent(on(x),S):_.addListener&&_.removeListener&&_.removeListener(S),(x=Cn(_))?(de(x,d),x.h==0&&(x.src=null,_[_e]=null)):Ee(d)}}}function on(d){return d in it?it[d]:it[d]="on"+d}function Qn(d,_){if(d.da)d=!0;else{_=new Me(_,this);const x=d.listener,S=d.ha||d.src;d.fa&&xr(d),d=x.call(S,_)}return d}function Cn(d){return d=d[_e],d instanceof ne?d:null}var Kn="__closure_events_fn_"+(Math.random()*1e9>>>0);function $n(d){return typeof d=="function"?d:(d[Kn]||(d[Kn]=function(_){return d.handleEvent(_)}),d[Kn])}function $e(){j.call(this),this.i=new ne(this),this.M=this,this.G=null}E($e,j),$e.prototype[Pe]=!0,$e.prototype.removeEventListener=function(d,_,x,S){_n(this,d,_,x,S)};function xt(d,_){var x,S=d.G;if(S)for(x=[];S;S=S.G)x.push(S);if(d=d.M,S=_.type||_,typeof _=="string")_=new P(_,d);else if(_ instanceof P)_.target=_.target||d;else{var F=_;_=new P(S,d),q(_,F)}F=!0;let J,ge;if(x)for(ge=x.length-1;ge>=0;ge--)J=_.g=x[ge],F=kn(J,S,!0,_)&&F;if(J=_.g=d,F=kn(J,S,!0,_)&&F,F=kn(J,S,!1,_)&&F,x)for(ge=0;ge<x.length;ge++)J=_.g=x[ge],F=kn(J,S,!1,_)&&F}$e.prototype.N=function(){if($e.Z.N.call(this),this.i){var d=this.i;for(const _ in d.g){const x=d.g[_];for(let S=0;S<x.length;S++)Ee(x[S]);delete d.g[_],d.h--}}this.G=null},$e.prototype.J=function(d,_,x,S){return this.i.add(String(d),_,!1,x,S)},$e.prototype.K=function(d,_,x,S){return this.i.add(String(d),_,!0,x,S)};function kn(d,_,x,S){if(_=d.i.g[String(_)],!_)return!0;_=_.concat();let F=!0;for(let J=0;J<_.length;++J){const ge=_[J];if(ge&&!ge.da&&ge.capture==x){const Ue=ge.listener,Bt=ge.ha||ge.src;ge.fa&&de(d.i,ge),F=Ue.call(Bt,S)!==!1&&F}}return F&&!S.defaultPrevented}function Y(d,_){if(typeof d!="function")if(d&&typeof d.handleEvent=="function")d=y(d.handleEvent,d);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:u.setTimeout(d,_||0)}function Ie(d){d.g=Y(()=>{d.g=null,d.i&&(d.i=!1,Ie(d))},d.l);const _=d.h;d.h=null,d.m.apply(null,_)}class qe extends j{constructor(_,x){super(),this.m=_,this.l=x,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Ie(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ce(d){j.call(this),this.h=d,this.g={}}E(ce,j);var kt=[];function vn(d){Ne(d.g,function(_,x){this.g.hasOwnProperty(x)&&xr(_)},d),d.g={}}ce.prototype.N=function(){ce.Z.N.call(this),vn(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Kt=u.JSON.stringify,ka=u.JSON.parse,qs=class{stringify(d){return u.JSON.stringify(d,void 0)}parse(d){return u.JSON.parse(d,void 0)}};function Vc(){}function Lr(){}var Ln={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function be(){P.call(this,"d")}E(be,P);function je(){P.call(this,"c")}E(je,P);var Je={},rs=null;function Qo(){return rs=rs||new $e}Je.Ia="serverreachability";function oh(d){P.call(this,Je.Ia,d)}E(oh,P);function ss(d){const _=Qo();xt(_,new oh(_))}Je.STAT_EVENT="statevent";function Da(d,_){P.call(this,Je.STAT_EVENT,d),this.stat=_}E(Da,P);function $t(d){const _=Qo();xt(_,new Da(_,d))}Je.Ja="timingevent";function is(d,_){P.call(this,Je.Ja,d),this.size=_}E(is,P);function as(d,_){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){d()},_)}function Ur(){this.g=!0}Ur.prototype.ua=function(){this.g=!1};function hp(d,_,x,S,F,J){d.info(function(){if(d.g)if(J){var ge="",Ue=J.split("&");for(let at=0;at<Ue.length;at++){var Bt=Ue[at].split("=");if(Bt.length>1){const It=Bt[0];Bt=Bt[1];const Ir=It.split("_");ge=Ir.length>=2&&Ir[1]=="type"?ge+(It+"="+Bt+"&"):ge+(It+"=redacted&")}}}else ge=null;else ge=J;return"XMLHTTP REQ ("+S+") [attempt "+F+"]: "+_+`
`+x+`
`+ge})}function lh(d,_,x,S,F,J,ge){d.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+F+"]: "+_+`
`+x+`
`+J+" "+ge})}function os(d,_,x,S){d.info(function(){return"XMLHTTP TEXT ("+_+"): "+fp(d,x)+(S?" "+S:"")})}function Pa(d,_){d.info(function(){return"TIMEOUT: "+_})}Ur.prototype.info=function(){};function fp(d,_){if(!d.g)return _;if(!_)return null;try{const J=JSON.parse(_);if(J){for(d=0;d<J.length;d++)if(Array.isArray(J[d])){var x=J[d];if(!(x.length<2)){var S=x[1];if(Array.isArray(S)&&!(S.length<1)){var F=S[0];if(F!="noop"&&F!="stop"&&F!="close")for(let ge=1;ge<S.length;ge++)S[ge]=""}}}}return Kt(J)}catch{return _}}var ja={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Oc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Mc;function Va(){}E(Va,Vc),Va.prototype.g=function(){return new XMLHttpRequest},Mc=new Va;function Fs(d){return encodeURIComponent(String(d))}function ch(d){var _=1;d=d.split(":");const x=[];for(;_>0&&d.length;)x.push(d.shift()),_--;return d.length&&x.push(d.join(":")),x}function zr(d,_,x,S){this.j=d,this.i=_,this.l=x,this.S=S||1,this.V=new ce(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Br}function Br(){this.i=null,this.g="",this.h=!1}var Yt={},dn={};function ls(d,_,x){d.M=1,d.A=Oa(Xt(_)),d.u=x,d.R=!0,Ko(d,null)}function Ko(d,_){d.F=Date.now(),cs(d),d.B=Xt(d.A);var x=d.B,S=d.S;Array.isArray(S)||(S=[String(S)]),Xo(x.i,"t",S),d.C=0,x=d.j.L,d.h=new Br,d.g=wh(d.j,x?_:null,!d.u),d.P>0&&(d.O=new qe(y(d.Y,d,d.g),d.P)),_=d.V,x=d.g,S=d.ba;var F="readystatechange";Array.isArray(F)||(F&&(kt[0]=F.toString()),F=kt);for(let J=0;J<F.length;J++){const ge=tt(x,F[J],S||_.handleEvent,!1,_.h||_);if(!ge)break;_.g[ge.key]=ge}_=d.J?V(d.J):{},d.u?(d.v||(d.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.B,d.v,d.u,_)):(d.v="GET",d.g.ea(d.B,d.v,null,_)),ss(),hp(d.i,d.v,d.B,d.l,d.S,d.u)}zr.prototype.ba=function(d){d=d.target;const _=this.O;_&&Hr(d)==3?_.j():this.Y(d)},zr.prototype.Y=function(d){try{if(d==this.g)e:{const Ue=Hr(this.g),Bt=this.g.ya(),at=this.g.ca();if(!(Ue<3)&&(Ue!=3||this.g&&(this.h.h||this.g.la()||bn(this.g)))){this.K||Ue!=4||Bt==7||(Bt==8||at<=0?ss(3):ss(2)),us(this);var _=this.g.ca();this.X=_;var x=mp(this);if(this.o=_==200,lh(this.i,this.v,this.B,this.l,this.S,Ue,_),this.o){if(this.U&&!this.L){t:{if(this.g){var S,F=this.g;if((S=F.g?F.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(S)){var J=S;break t}}J=null}if(d=J)os(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ds(this,d);else{this.o=!1,this.m=3,$t(12),or(this),Er(this);break e}}if(this.R){d=!0;let It;for(;!this.K&&this.C<x.length;)if(It=dh(this,x),It==dn){Ue==4&&(this.m=4,$t(14),d=!1),os(this.i,this.l,null,"[Incomplete Response]");break}else if(It==Yt){this.m=4,$t(15),os(this.i,this.l,x,"[Invalid Chunk]"),d=!1;break}else os(this.i,this.l,It,null),ds(this,It);if(uh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ue!=4||x.length!=0||this.h.h||(this.m=1,$t(16),d=!1),this.o=this.o&&d,!d)os(this.i,this.l,x,"[Invalid Chunked Response]"),or(this),Er(this);else if(x.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+x.length),Jc(ge),ge.P=!0,$t(11))}}else os(this.i,this.l,x,null),ds(this,x);Ue==4&&or(this),this.o&&!this.K&&(Ue==4?bh(this.j,this):(this.o=!1,cs(this)))}else Gs(this.g),_==400&&x.indexOf("Unknown SID")>0?(this.m=3,$t(12)):(this.m=0,$t(13)),or(this),Er(this)}}}catch{}};function mp(d){if(!uh(d))return d.g.la();const _=bn(d.g);if(_==="")return"";let x="";const S=_.length,F=Hr(d.g)==4;if(!d.h.i){if(typeof TextDecoder>"u")return or(d),Er(d),"";d.h.i=new u.TextDecoder}for(let J=0;J<S;J++)d.h.h=!0,x+=d.h.i.decode(_[J],{stream:!(F&&J==S-1)});return _.length=0,d.h.g+=x,d.C=0,d.h.g}function uh(d){return d.g?d.v=="GET"&&d.M!=2&&d.j.Aa:!1}function dh(d,_){var x=d.C,S=_.indexOf(`
`,x);return S==-1?dn:(x=Number(_.substring(x,S)),isNaN(x)?Yt:(S+=1,S+x>_.length?dn:(_=_.slice(S,S+x),d.C=S+x,_)))}zr.prototype.cancel=function(){this.K=!0,or(this)};function cs(d){d.T=Date.now()+d.H,$o(d,d.H)}function $o(d,_){if(d.D!=null)throw Error("WatchDog timer not null");d.D=as(y(d.aa,d),_)}function us(d){d.D&&(u.clearTimeout(d.D),d.D=null)}zr.prototype.aa=function(){this.D=null;const d=Date.now();d-this.T>=0?(Pa(this.i,this.B),this.M!=2&&(ss(),$t(17)),or(this),this.m=2,Er(this)):$o(this,this.T-d)};function Er(d){d.j.I==0||d.K||bh(d.j,d)}function or(d){us(d);var _=d.O;_&&typeof _.dispose=="function"&&_.dispose(),d.O=null,vn(d.V),d.g&&(_=d.g,d.g=null,_.abort(),_.dispose())}function ds(d,_){try{var x=d.j;if(x.I!=0&&(x.g==d||fs(x.h,d))){if(!d.L&&fs(x.h,d)&&x.I==3){try{var S=x.Ba.g.parse(_)}catch{S=null}if(Array.isArray(S)&&S.length==3){var F=S;if(F[0]==0){e:if(!x.v){if(x.g)if(x.g.F+3e3<d.F)nl(x),Ri(x);else break e;Fa(x),$t(18)}}else x.xa=F[1],0<x.xa-x.K&&F[2]<37500&&x.F&&x.A==0&&!x.C&&(x.C=as(y(x.Va,x),6e3));hs(x.h)<=1&&x.ta&&(x.ta=void 0)}else vs(x,11)}else if((d.L||x.g==d)&&nl(x),!C(_))for(F=x.Ba.g.parse(_),_=0;_<F.length;_++){let at=F[_];const It=at[0];if(!(It<=x.K))if(x.K=It,at=at[1],x.I==2)if(at[0]=="c"){x.M=at[1],x.ba=at[2];const Ir=at[3];Ir!=null&&(x.ka=Ir,x.j.info("VER="+x.ka));const bs=at[4];bs!=null&&(x.za=bs,x.j.info("SVER="+x.za));const Gr=at[5];Gr!=null&&typeof Gr=="number"&&Gr>0&&(S=1.5*Gr,x.O=S,x.j.info("backChannelRequestTimeoutMs_="+S)),S=x;const Qr=d.g;if(Qr){const Ha=Qr.g?Qr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ha){var J=S.h;J.g||Ha.indexOf("spdy")==-1&&Ha.indexOf("quic")==-1&&Ha.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(zc(J,J.h),J.h=null))}if(S.G){const rl=Qr.g?Qr.g.getResponseHeader("X-HTTP-Session-Id"):null;rl&&(S.wa=rl,ct(S.J,S.G,rl))}}x.I=3,x.l&&x.l.ra(),x.aa&&(x.T=Date.now()-d.F,x.j.info("Handshake RTT: "+x.T+"ms")),S=x;var ge=d;if(S.na=Th(S,S.L?S.ba:null,S.W),ge.L){Bc(S.h,ge);var Ue=ge,Bt=S.O;Bt&&(Ue.H=Bt),Ue.D&&(us(Ue),cs(Ue)),S.g=ge}else _h(S);x.i.length>0&&_s(x)}else at[0]!="stop"&&at[0]!="close"||vs(x,7);else x.I==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?vs(x,7):Wc(x):at[0]!="noop"&&x.l&&x.l.qa(at),x.A=0)}}ss(4)}catch{}}var Wt=class{constructor(d,_){this.g=d,this.map=_}};function Lc(d){this.l=d||10,u.PerformanceNavigationTiming?(d=u.performance.getEntriesByType("navigation"),d=d.length>0&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Uc(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function hs(d){return d.h?1:d.g?d.g.size:0}function fs(d,_){return d.h?d.h==_:d.g?d.g.has(_):!1}function zc(d,_){d.g?d.g.add(_):d.h=_}function Bc(d,_){d.h&&d.h==_?d.h=null:d.g&&d.g.has(_)&&d.g.delete(_)}Lc.prototype.cancel=function(){if(this.i=qc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function qc(d){if(d.h!=null)return d.i.concat(d.h.G);if(d.g!=null&&d.g.size!==0){let _=d.i;for(const x of d.g.values())_=_.concat(x.G);return _}return N(d.i)}var hh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yo(d,_){if(d){d=d.split("&");for(let x=0;x<d.length;x++){const S=d[x].indexOf("=");let F,J=null;S>=0?(F=d[x].substring(0,S),J=d[x].substring(S+1)):F=d[x],_(F,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function lr(d){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;d instanceof lr?(this.l=d.l,hn(this,d.j),this.o=d.o,this.g=d.g,Ei(this,d.u),this.h=d.h,Fc(this,gh(d.i)),this.m=d.m):d&&(_=String(d).match(hh))?(this.l=!1,hn(this,_[1]||"",!0),this.o=ms(_[2]||""),this.g=ms(_[3]||"",!0),Ei(this,_[4]),this.h=ms(_[5]||"",!0),Fc(this,_[6]||"",!0),this.m=ms(_[7]||"")):(this.l=!1,this.i=new wi(null,this.l))}lr.prototype.toString=function(){const d=[];var _=this.j;_&&d.push(Ma(_,Wo,!0),":");var x=this.g;return(x||_=="file")&&(d.push("//"),(_=this.o)&&d.push(Ma(_,Wo,!0),"@"),d.push(Fs(x).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.u,x!=null&&d.push(":",String(x))),(x=this.h)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(Ma(x,x.charAt(0)=="/"?Hc:fh,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",Ma(x,mh)),d.join("")},lr.prototype.resolve=function(d){const _=Xt(this);let x=!!d.j;x?hn(_,d.j):x=!!d.o,x?_.o=d.o:x=!!d.g,x?_.g=d.g:x=d.u!=null;var S=d.h;if(x)Ei(_,d.u);else if(x=!!d.h){if(S.charAt(0)!="/")if(this.g&&!this.h)S="/"+S;else{var F=_.h.lastIndexOf("/");F!=-1&&(S=_.h.slice(0,F+1)+S)}if(F=S,F==".."||F==".")S="";else if(F.indexOf("./")!=-1||F.indexOf("/.")!=-1){S=F.lastIndexOf("/",0)==0,F=F.split("/");const J=[];for(let ge=0;ge<F.length;){const Ue=F[ge++];Ue=="."?S&&ge==F.length&&J.push(""):Ue==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),S&&ge==F.length&&J.push("")):(J.push(Ue),S=!0)}S=J.join("/")}else S=F}return x?_.h=S:x=d.i.toString()!=="",x?Fc(_,gh(d.i)):x=!!d.m,x&&(_.m=d.m),_};function Xt(d){return new lr(d)}function hn(d,_,x){d.j=x?ms(_,!0):_,d.j&&(d.j=d.j.replace(/:$/,""))}function Ei(d,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);d.u=_}else d.u=null}function Fc(d,_,x){_ instanceof wi?(d.i=_,Jo(d.i,d.l)):(x||(_=Ma(_,Ti)),d.i=new wi(_,d.l))}function ct(d,_,x){d.i.set(_,x)}function Oa(d){return ct(d,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),d}function ms(d,_){return d?_?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Ma(d,_,x){return typeof d=="string"?(d=encodeURI(d).replace(_,Yn),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Yn(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Wo=/[#\/\?@]/g,fh=/[#\?:]/g,Hc=/[#\?]/g,Ti=/[#\?@]/g,mh=/#/g;function wi(d,_){this.h=this.g=null,this.i=d||null,this.j=!!_}function Wn(d){d.g||(d.g=new Map,d.h=0,d.i&&Yo(d.i,function(_,x){d.add(decodeURIComponent(_.replace(/\+/g," ")),x)}))}s=wi.prototype,s.add=function(d,_){Wn(this),this.i=null,d=Ii(this,d);let x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(_),this.h+=1,this};function ph(d,_){Wn(d),_=Ii(d,_),d.g.has(_)&&(d.i=null,d.h-=d.g.get(_).length,d.g.delete(_))}function Gc(d,_){return Wn(d),_=Ii(d,_),d.g.has(_)}s.forEach=function(d,_){Wn(this),this.g.forEach(function(x,S){x.forEach(function(F){d.call(_,F,S,this)},this)},this)};function Qc(d,_){Wn(d);let x=[];if(typeof _=="string")Gc(d,_)&&(x=x.concat(d.g.get(Ii(d,_))));else for(d=Array.from(d.g.values()),_=0;_<d.length;_++)x=x.concat(d[_]);return x}s.set=function(d,_){return Wn(this),this.i=null,d=Ii(this,d),Gc(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[_]),this.h+=1,this},s.get=function(d,_){return d?(d=Qc(this,d),d.length>0?String(d[0]):_):_};function Xo(d,_,x){ph(d,_),x.length>0&&(d.i=null,d.g.set(Ii(d,_),N(x)),d.h+=x.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],_=Array.from(this.g.keys());for(let S=0;S<_.length;S++){var x=_[S];const F=Fs(x);x=Qc(this,x);for(let J=0;J<x.length;J++){let ge=F;x[J]!==""&&(ge+="="+Fs(x[J])),d.push(ge)}}return this.i=d.join("&")};function gh(d){const _=new wi;return _.i=d.i,d.g&&(_.g=new Map(d.g),_.h=d.h),_}function Ii(d,_){return _=String(_),d.j&&(_=_.toLowerCase()),_}function Jo(d,_){_&&!d.j&&(Wn(d),d.i=null,d.g.forEach(function(x,S){const F=S.toLowerCase();S!=F&&(ph(this,S),Xo(this,F,x))},d)),d.j=_}function qr(d,_){const x=new Ur;if(u.Image){const S=new Image;S.onload=b(Tr,x,"TestLoadImage: loaded",!0,_,S),S.onerror=b(Tr,x,"TestLoadImage: error",!1,_,S),S.onabort=b(Tr,x,"TestLoadImage: abort",!1,_,S),S.ontimeout=b(Tr,x,"TestLoadImage: timeout",!1,_,S),u.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=d}else _(!1)}function Kc(d,_){const x=new Ur,S=new AbortController,F=setTimeout(()=>{S.abort(),Tr(x,"TestPingServer: timeout",!1,_)},1e4);fetch(d,{signal:S.signal}).then(J=>{clearTimeout(F),J.ok?Tr(x,"TestPingServer: ok",!0,_):Tr(x,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(F),Tr(x,"TestPingServer: error",!1,_)})}function Tr(d,_,x,S,F){try{F&&(F.onload=null,F.onerror=null,F.onabort=null,F.ontimeout=null),S(x)}catch{}}function Si(){this.g=new qs}function ps(d){this.i=d.Sb||null,this.h=d.ab||!1}E(ps,Vc),ps.prototype.g=function(){return new La(this.i,this.h)};function La(d,_){$e.call(this),this.H=d,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(La,$e),s=La.prototype,s.open=function(d,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=d,this.D=_,this.readyState=1,Fr(this)},s.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};d&&(_.body=d),(this.H||u).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ai(this)),this.readyState=0},s.Pa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Fr(this)),this.g&&(this.readyState=3,Fr(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Zo(this)}else d.text().then(this.Oa.bind(this),this.ga.bind(this))};function Zo(d){d.j.read().then(d.Ma.bind(d)).catch(d.ga.bind(d))}s.Ma=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var _=d.value?d.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!d.done}))&&(this.response=this.responseText+=_)}d.done?Ai(this):Fr(this),this.readyState==3&&Zo(this)}},s.Oa=function(d){this.g&&(this.response=this.responseText=d,Ai(this))},s.Na=function(d){this.g&&(this.response=d,Ai(this))},s.ga=function(){this.g&&Ai(this)};function Ai(d){d.readyState=4,d.l=null,d.j=null,d.B=null,Fr(d)}s.setRequestHeader=function(d,_){this.A.append(d,_)},s.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],_=this.h.entries();for(var x=_.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=_.next();return d.join(`\r
`)};function Fr(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(La.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function wr(d){let _="";return Ne(d,function(x,S){_+=S,_+=":",_+=x,_+=`\r
`}),_}function Ua(d,_,x){e:{for(S in x){var S=!1;break e}S=!0}S||(x=wr(x),typeof d=="string"?x!=null&&Fs(x):ct(d,_,x))}function mt(d){$e.call(this),this.headers=new Map,this.L=d||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(mt,$e);var gs=/^https?$/i,$c=["POST","PUT"];s=mt.prototype,s.Fa=function(d){this.H=d},s.ea=function(d,_,x,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);_=_?_.toUpperCase():"GET",this.D=d,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Mc.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(_,String(d),!0),this.B=!1}catch(J){za(this,J);return}if(d=x||"",x=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var F in S)x.set(F,S[F]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const J of S.keys())x.set(J,S.get(J));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(x.keys()).find(J=>J.toLowerCase()=="content-type"),F=u.FormData&&d instanceof u.FormData,!(Array.prototype.indexOf.call($c,_,void 0)>=0)||S||F||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,ge]of x)this.g.setRequestHeader(J,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(d),this.v=!1}catch(J){za(this,J)}};function za(d,_){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=_,d.o=5,Yc(d),Hs(d)}function Yc(d){d.A||(d.A=!0,xt(d,"complete"),xt(d,"error"))}s.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=d||7,xt(this,"complete"),xt(this,"abort"),Hs(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hs(this,!0)),mt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Ba(this):this.Xa())},s.Xa=function(){Ba(this)};function Ba(d){if(d.h&&typeof l<"u"){if(d.v&&Hr(d)==4)setTimeout(d.Ca.bind(d),0);else if(xt(d,"readystatechange"),Hr(d)==4){d.h=!1;try{const J=d.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var x;if(!(x=_)){var S;if(S=J===0){let ge=String(d.D).match(hh)[1]||null;!ge&&u.self&&u.self.location&&(ge=u.self.location.protocol.slice(0,-1)),S=!gs.test(ge?ge.toLowerCase():"")}x=S}if(x)xt(d,"complete"),xt(d,"success");else{d.o=6;try{var F=Hr(d)>2?d.g.statusText:""}catch{F=""}d.l=F+" ["+d.ca()+"]",Yc(d)}}finally{Hs(d)}}}}function Hs(d,_){if(d.g){d.m&&(clearTimeout(d.m),d.m=null);const x=d.g;d.g=null,_||xt(d,"ready");try{x.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Hr(d){return d.g?d.g.readyState:0}s.ca=function(){try{return Hr(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(d){if(this.g){var _=this.g.responseText;return d&&_.indexOf(d)==0&&(_=_.substring(d.length)),ka(_)}};function bn(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.F){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Gs(d){const _={};d=(d.g&&Hr(d)>=2&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<d.length;S++){if(C(d[S]))continue;var x=ch(d[S]);const F=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const J=_[F]||[];_[F]=J,J.push(x)}Le(_,function(S){return S.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ys(d,_,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||_}function Ni(d){this.za=0,this.i=[],this.j=new Ur,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ys("failFast",!1,d),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ys("baseRetryDelayMs",5e3,d),this.Za=ys("retryDelaySeedMs",1e4,d),this.Ta=ys("forwardChannelMaxRetries",2,d),this.va=ys("forwardChannelRequestTimeoutMs",2e4,d),this.ma=d&&d.xmlHttpFactory||void 0,this.Ua=d&&d.Rb||void 0,this.Aa=d&&d.useFetchStreams||!1,this.O=void 0,this.L=d&&d.supportsCrossDomainXhr||!1,this.M="",this.h=new Lc(d&&d.concurrentRequestLimit),this.Ba=new Si,this.S=d&&d.fastHandshake||!1,this.R=d&&d.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=d&&d.Pb||!1,d&&d.ua&&this.j.ua(),d&&d.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&d&&d.detectBufferingProxy||!1,this.ia=void 0,d&&d.longPollingTimeout&&d.longPollingTimeout>0&&(this.ia=d.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=Ni.prototype,s.ka=8,s.I=1,s.connect=function(d,_,x,S){$t(0),this.W=d,this.H=_||{},x&&S!==void 0&&(this.H.OSID=x,this.H.OAID=S),this.F=this.X,this.J=Th(this,null,this.W),_s(this)};function Wc(d){if(el(d),d.I==3){var _=d.V++,x=Xt(d.J);if(ct(x,"SID",d.M),ct(x,"RID",_),ct(x,"TYPE","terminate"),qa(d,x),_=new zr(d,d.j,_),_.M=2,_.A=Oa(Xt(x)),x=!1,u.navigator&&u.navigator.sendBeacon)try{x=u.navigator.sendBeacon(_.A.toString(),"")}catch{}!x&&u.Image&&(new Image().src=_.A,x=!0),x||(_.g=wh(_.j,null),_.g.ea(_.A)),_.F=Date.now(),cs(_)}Eh(d)}function Ri(d){d.g&&(Jc(d),d.g.cancel(),d.g=null)}function el(d){Ri(d),d.v&&(u.clearTimeout(d.v),d.v=null),nl(d),d.h.cancel(),d.m&&(typeof d.m=="number"&&u.clearTimeout(d.m),d.m=null)}function _s(d){if(!Uc(d.h)&&!d.m){d.m=!0;var _=d.Ea;H||R(),ae||(H(),ae=!0),A.add(_,d),d.D=0}}function tl(d,_){return hs(d.h)>=d.h.j-(d.m?1:0)?!1:d.m?(d.i=_.G.concat(d.i),!0):d.I==1||d.I==2||d.D>=(d.Sa?0:d.Ta)?!1:(d.m=as(y(d.Ea,d,_),xh(d,d.D)),d.D++,!0)}s.Ea=function(d){if(this.m)if(this.m=null,this.I==1){if(!d){this.V=Math.floor(Math.random()*1e5),d=this.V++;const F=new zr(this,this.j,d);let J=this.o;if(this.U&&(J?(J=V(J),q(J,this.U)):J=this.U),this.u!==null||this.R||(F.J=J,J=null),this.S)e:{for(var _=0,x=0;x<this.i.length;x++){t:{var S=this.i[x];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(_+=S,_>4096){_=x;break e}if(_===4096||x===this.i.length-1){_=x+1;break e}}_=1e3}else _=1e3;_=yh(this,F,_),x=Xt(this.J),ct(x,"RID",d),ct(x,"CVER",22),this.G&&ct(x,"X-HTTP-Session-Id",this.G),qa(this,x),J&&(this.R?_="headers="+Fs(wr(J))+"&"+_:this.u&&Ua(x,this.u,J)),zc(this.h,F),this.Ra&&ct(x,"TYPE","init"),this.S?(ct(x,"$req",_),ct(x,"SID","null"),F.U=!0,ls(F,x,null)):ls(F,x,_),this.I=2}}else this.I==3&&(d?Xc(this,d):this.i.length==0||Uc(this.h)||Xc(this))};function Xc(d,_){var x;_?x=_.l:x=d.V++;const S=Xt(d.J);ct(S,"SID",d.M),ct(S,"RID",x),ct(S,"AID",d.K),qa(d,S),d.u&&d.o&&Ua(S,d.u,d.o),x=new zr(d,d.j,x,d.D+1),d.u===null&&(x.J=d.o),_&&(d.i=_.G.concat(d.i)),_=yh(d,x,1e3),x.H=Math.round(d.va*.5)+Math.round(d.va*.5*Math.random()),zc(d.h,x),ls(x,S,_)}function qa(d,_){d.H&&Ne(d.H,function(x,S){ct(_,S,x)}),d.l&&Ne({},function(x,S){ct(_,S,x)})}function yh(d,_,x){x=Math.min(d.i.length,x);const S=d.l?y(d.l.Ka,d.l,d):null;e:{var F=d.i;let Ue=-1;for(;;){const Bt=["count="+x];Ue==-1?x>0?(Ue=F[0].g,Bt.push("ofs="+Ue)):Ue=0:Bt.push("ofs="+Ue);let at=!0;for(let It=0;It<x;It++){var J=F[It].g;const Ir=F[It].map;if(J-=Ue,J<0)Ue=Math.max(0,F[It].g-100),at=!1;else try{J="req"+J+"_"||"";try{var ge=Ir instanceof Map?Ir:Object.entries(Ir);for(const[bs,Gr]of ge){let Qr=Gr;p(Gr)&&(Qr=Kt(Gr)),Bt.push(J+bs+"="+encodeURIComponent(Qr))}}catch(bs){throw Bt.push(J+"type="+encodeURIComponent("_badmap")),bs}}catch{S&&S(Ir)}}if(at){ge=Bt.join("&");break e}}ge=void 0}return d=d.i.splice(0,x),_.G=d,ge}function _h(d){if(!d.g&&!d.v){d.Y=1;var _=d.Da;H||R(),ae||(H(),ae=!0),A.add(_,d),d.A=0}}function Fa(d){return d.g||d.v||d.A>=3?!1:(d.Y++,d.v=as(y(d.Da,d),xh(d,d.A)),d.A++,!0)}s.Da=function(){if(this.v=null,vh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var d=4*this.T;this.j.info("BP detection timer enabled: "+d),this.B=as(y(this.Wa,this),d)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,$t(10),Ri(this),vh(this))};function Jc(d){d.B!=null&&(u.clearTimeout(d.B),d.B=null)}function vh(d){d.g=new zr(d,d.j,"rpc",d.Y),d.u===null&&(d.g.J=d.o),d.g.P=0;var _=Xt(d.na);ct(_,"RID","rpc"),ct(_,"SID",d.M),ct(_,"AID",d.K),ct(_,"CI",d.F?"0":"1"),!d.F&&d.ia&&ct(_,"TO",d.ia),ct(_,"TYPE","xmlhttp"),qa(d,_),d.u&&d.o&&Ua(_,d.u,d.o),d.O&&(d.g.H=d.O);var x=d.g;d=d.ba,x.M=1,x.A=Oa(Xt(_)),x.u=null,x.R=!0,Ko(x,d)}s.Va=function(){this.C!=null&&(this.C=null,Ri(this),Fa(this),$t(19))};function nl(d){d.C!=null&&(u.clearTimeout(d.C),d.C=null)}function bh(d,_){var x=null;if(d.g==_){nl(d),Jc(d),d.g=null;var S=2}else if(fs(d.h,_))x=_.G,Bc(d.h,_),S=1;else return;if(d.I!=0){if(_.o)if(S==1){x=_.u?_.u.length:0,_=Date.now()-_.F;var F=d.D;S=Qo(),xt(S,new is(S,x)),_s(d)}else _h(d);else if(F=_.m,F==3||F==0&&_.X>0||!(S==1&&tl(d,_)||S==2&&Fa(d)))switch(x&&x.length>0&&(_=d.h,_.i=_.i.concat(x)),F){case 1:vs(d,5);break;case 4:vs(d,10);break;case 3:vs(d,6);break;default:vs(d,2)}}}function xh(d,_){let x=d.Qa+Math.floor(Math.random()*d.Za);return d.isActive()||(x*=2),x*_}function vs(d,_){if(d.j.info("Error code "+_),_==2){var x=y(d.bb,d),S=d.Ua;const F=!S;S=new lr(S||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||hn(S,"https"),Oa(S),F?qr(S.toString(),x):Kc(S.toString(),x)}else $t(2);d.I=0,d.l&&d.l.pa(_),Eh(d),el(d)}s.bb=function(d){d?(this.j.info("Successfully pinged google.com"),$t(2)):(this.j.info("Failed to ping google.com"),$t(1))};function Eh(d){if(d.I=0,d.ja=[],d.l){const _=qc(d.h);(_.length!=0||d.i.length!=0)&&(B(d.ja,_),B(d.ja,d.i),d.h.i.length=0,N(d.i),d.i.length=0),d.l.oa()}}function Th(d,_,x){var S=x instanceof lr?Xt(x):new lr(x);if(S.g!="")_&&(S.g=_+"."+S.g),Ei(S,S.u);else{var F=u.location;S=F.protocol,_=_?_+"."+F.hostname:F.hostname,F=+F.port;const J=new lr(null);S&&hn(J,S),_&&(J.g=_),F&&Ei(J,F),x&&(J.h=x),S=J}return x=d.G,_=d.wa,x&&_&&ct(S,x,_),ct(S,"VER",d.ka),qa(d,S),S}function wh(d,_,x){if(_&&!d.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=d.Aa&&!d.ma?new mt(new ps({ab:x})):new mt(d.ma),_.Fa(d.L),_}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ih(){}s=Ih.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function Ci(){}Ci.prototype.g=function(d,_){return new Un(d,_)};function Un(d,_){$e.call(this),this.g=new Ni(_),this.l=d,this.h=_&&_.messageUrlParams||null,d=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(d?d["X-WebChannel-Content-Type"]=_.messageContentType:d={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(d?d["X-WebChannel-Client-Profile"]=_.sa:d={"X-WebChannel-Client-Profile":_.sa}),this.g.U=d,(d=_&&_.Qb)&&!C(d)&&(this.g.u=d),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!C(_)&&(this.g.G=_,d=this.h,d!==null&&_ in d&&(d=this.h,_ in d&&delete d[_])),this.j=new Qs(this)}E(Un,$e),Un.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Un.prototype.close=function(){Wc(this.g)},Un.prototype.o=function(d){var _=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.v&&(x={},x.__data__=Kt(d),d=x);_.i.push(new Wt(_.Ya++,d)),_.I==3&&_s(_)},Un.prototype.N=function(){this.g.l=null,delete this.j,Wc(this.g),delete this.g,Un.Z.N.call(this)};function Sh(d){be.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var _=d.__sm__;if(_){e:{for(const x in _){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,_=_!==null&&d in _?_[d]:void 0),this.data=_}else this.data=d}E(Sh,be);function Ah(){je.call(this),this.status=1}E(Ah,je);function Qs(d){this.g=d}E(Qs,Ih),Qs.prototype.ra=function(){xt(this.g,"a")},Qs.prototype.qa=function(d){xt(this.g,new Sh(d))},Qs.prototype.pa=function(d){xt(this.g,new Ah)},Qs.prototype.oa=function(){xt(this.g,"b")},Ci.prototype.createWebChannel=Ci.prototype.g,Un.prototype.send=Un.prototype.o,Un.prototype.open=Un.prototype.m,Un.prototype.close=Un.prototype.close,RS=function(){return new Ci},NS=function(){return Qo()},AS=Je,Yy={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ja.NO_ERROR=0,ja.TIMEOUT=8,ja.HTTP_ERROR=6,Gf=ja,Oc.COMPLETE="complete",SS=Oc,Lr.EventType=Ln,Ln.OPEN="a",Ln.CLOSE="b",Ln.ERROR="c",Ln.MESSAGE="d",$e.prototype.listen=$e.prototype.J,Wu=Lr,mt.prototype.listenOnce=mt.prototype.K,mt.prototype.getLastError=mt.prototype.Ha,mt.prototype.getLastErrorCode=mt.prototype.ya,mt.prototype.getStatus=mt.prototype.ca,mt.prototype.getResponseJson=mt.prototype.La,mt.prototype.getResponseText=mt.prototype.la,mt.prototype.send=mt.prototype.ea,mt.prototype.setWithCredentials=mt.prototype.Fa,IS=mt}).apply(typeof Pf<"u"?Pf:typeof self<"u"?self:typeof window<"u"?window:{});class gn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gn.UNAUTHENTICATED=new gn(null),gn.GOOGLE_CREDENTIALS=new gn("google-credentials-uid"),gn.FIRST_PARTY=new gn("first-party-uid"),gn.MOCK_USER=new gn("mock-user");let Ac="12.8.0";function wV(s){Ac=s}const ya=new Rm("@firebase/firestore");function zl(){return ya.logLevel}function IV(s){ya.setLogLevel(s)}function ue(s,...e){if(ya.logLevel<=Qe.DEBUG){const t=e.map(i_);ya.debug(`Firestore (${Ac}): ${s}`,...t)}}function Ht(s,...e){if(ya.logLevel<=Qe.ERROR){const t=e.map(i_);ya.error(`Firestore (${Ac}): ${s}`,...t)}}function zs(s,...e){if(ya.logLevel<=Qe.WARN){const t=e.map(i_);ya.warn(`Firestore (${Ac}): ${s}`,...t)}}function i_(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function xe(s,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,CS(s,r,t)}function CS(s,e,t){let r=`FIRESTORE (${Ac}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ht(r),new Error(r)}function we(s,e,t,r){let a="Unexpected state";typeof t=="string"?a=t:r=t,s||CS(e,a,r)}function SV(s,e){s||xe(57014,e)}function ve(s,e){return s}const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class le extends Fn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class An{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class kS{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class AV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(gn.UNAUTHENTICATED)))}shutdown(){}}class NV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class RV{constructor(e){this.t=e,this.currentUser=gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){we(this.o===void 0,42304);let r=this.i;const a=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let l=new An;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new An,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const f=l;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},p=f=>{ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((f=>p(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?p(f):(ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new An)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(we(typeof r.accessToken=="string",31837,{l:r}),new kS(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return we(e===null||typeof e=="string",2055,{h:e}),new gn(e)}}class CV{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=gn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class kV{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new CV(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(gn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ST{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class DV{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Nt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){we(this.o===void 0,3512);const r=l=>{l.error!=null&&ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,ue("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>r(l)))};const a=l=>{ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new ST(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(we(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ST(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function PV(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<s;r++)t[r]=Math.floor(256*Math.random());return t}class a_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=PV(40);for(let l=0;l<a.length;++l)r.length<20&&a[l]<t&&(r+=e.charAt(a[l]%62))}return r}}function De(s,e){return s<e?-1:s>e?1:0}function Wy(s,e){const t=Math.min(s.length,e.length);for(let r=0;r<t;r++){const a=s.charAt(r),l=e.charAt(r);if(a!==l)return Iy(a)===Iy(l)?De(a,l):Iy(a)?1:-1}return De(s.length,e.length)}const jV=55296,VV=57343;function Iy(s){const e=s.charCodeAt(0);return e>=jV&&e<=VV}function rc(s,e,t){return s.length===e.length&&s.every(((r,a)=>t(r,e[a])))}function DS(s){return s+"\0"}const AT="__name__";class Is{constructor(e,t,r){t===void 0?t=0:t>e.length&&xe(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&xe(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Is.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Is?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const l=Is.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return De(e.length,t.length)}static compareSegments(e,t){const r=Is.isNumericId(e),a=Is.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?Is.extractNumericId(e).compare(Is.extractNumericId(t)):Wy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ua.fromString(e.substring(4,e.length-2))}}class Ke extends Is{construct(e,t,r){return new Ke(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new le(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((a=>a.length>0)))}return new Ke(t)}static emptyPath(){return new Ke([])}}const OV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Rt extends Is{construct(e,t,r){return new Rt(e,t,r)}static isValidIdentifier(e){return OV.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Rt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===AT}static keyField(){return new Rt([AT])}static fromServerFormat(e){const t=[];let r="",a=0;const l=()=>{if(r.length===0)throw new le(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let u=!1;for(;a<e.length;){const p=e[a];if(p==="\\"){if(a+1===e.length)throw new le(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new le(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,a+=2}else p==="`"?(u=!u,a++):p!=="."||u?(r+=p,a++):(l(),a++)}if(l(),u)throw new le(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Rt(t)}static emptyPath(){return new Rt([])}}class ye{constructor(e){this.path=e}static fromPath(e){return new ye(Ke.fromString(e))}static fromName(e){return new ye(Ke.fromString(e).popFirst(5))}static empty(){return new ye(Ke.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ke.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ke.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ye(new Ke(e.slice()))}}function o_(s,e,t){if(!t)throw new le(W.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function PS(s,e,t,r){if(e===!0&&r===!0)throw new le(W.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function NT(s){if(!ye.isDocumentKey(s))throw new le(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function RT(s){if(ye.isDocumentKey(s))throw new le(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function jS(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Bm(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":xe(12329,{type:typeof s})}function st(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new le(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Bm(s);throw new le(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function VS(s,e){if(e<=0)throw new le(W.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function an(s,e){const t={typeString:s};return e&&(t.value=e),t}function Qd(s,e){if(!jS(s))throw new le(W.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const a=e[r].typeString,l="value"in e[r]?{value:e[r].value}:void 0;if(!(r in s)){t=`JSON missing required field: '${r}'`;break}const u=s[r];if(a&&typeof u!==a){t=`JSON field '${r}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${r}' field to equal '${l.value}'`;break}}if(t)throw new le(W.INVALID_ARGUMENT,t);return!0}const CT=-62135596800,kT=1e6;class lt{static now(){return lt.fromMillis(Date.now())}static fromDate(e){return lt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*kT);return new lt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new le(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new le(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<CT)throw new le(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new le(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/kT}_compareTo(e){return this.seconds===e.seconds?De(this.nanoseconds,e.nanoseconds):De(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:lt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Qd(e,lt._jsonSchema))return new lt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-CT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}lt._jsonSchemaVersion="firestore/timestamp/1.0",lt._jsonSchema={type:an("string",lt._jsonSchemaVersion),seconds:an("number"),nanoseconds:an("number")};class Ae{static fromTimestamp(e){return new Ae(e)}static min(){return new Ae(new lt(0,0))}static max(){return new Ae(new lt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const sc=-1;class dm{constructor(e,t,r,a){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=a}}function Xy(s){return s.fields.find((e=>e.kind===2))}function lo(s){return s.fields.filter((e=>e.kind!==2))}dm.UNKNOWN_ID=-1;class Qf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Td{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Td(0,br.min())}}function OS(s,e){const t=s.toTimestamp().seconds,r=s.toTimestamp().nanoseconds+1,a=Ae.fromTimestamp(r===1e9?new lt(t+1,0):new lt(t,r));return new br(a,ye.empty(),e)}function MS(s){return new br(s.readTime,s.key,sc)}class br{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new br(Ae.min(),ye.empty(),sc)}static max(){return new br(Ae.max(),ye.empty(),sc)}}function l_(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ye.comparator(s.documentKey,e.documentKey),t!==0?t:De(s.largestBatchId,e.largestBatchId))}const LS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class US{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Sa(s){if(s.code!==W.FAILED_PRECONDITION||s.message!==LS)throw s;ue("LocalStore","Unexpectedly lost primary lease")}class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&xe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new z(((r,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(r,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(r,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof z?t:z.resolve(t)}catch(t){return z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):z.reject(t)}static resolve(e){return new z(((t,r)=>{t(e)}))}static reject(e){return new z(((t,r)=>{r(e)}))}static waitFor(e){return new z(((t,r)=>{let a=0,l=0,u=!1;e.forEach((p=>{++a,p.next((()=>{++l,u&&l===a&&t()}),(f=>r(f)))})),u=!0,l===a&&t()}))}static or(e){let t=z.resolve(!1);for(const r of e)t=t.next((a=>a?z.resolve(a):r()));return t}static forEach(e,t){const r=[];return e.forEach(((a,l)=>{r.push(t.call(this,a,l))})),this.waitFor(r)}static mapArray(e,t){return new z(((r,a)=>{const l=e.length,u=new Array(l);let p=0;for(let f=0;f<l;f++){const y=f;t(e[y]).next((b=>{u[y]=b,++p,p===l&&r(u)}),(b=>a(b)))}}))}static doWhile(e,t){return new z(((r,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):r()};l()}))}}const gr="SimpleDb";class qm{static open(e,t,r,a){try{return new qm(t,e.transaction(a,r))}catch(l){throw new od(t,l)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new An,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new od(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const a=c_(r.target.error);this.S.reject(new od(e,a))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ue(gr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new LV(t)}}class Vs{static delete(e){return ue(gr,"Removing database:",e),uo(C0().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!gd())return!1;if(Vs.F())return!0;const e=Pt(),t=Vs.M(e),r=0<t&&t<10,a=zS(e),l=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||l)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Vs.M(Pt())===12.2&&Ht("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ue(gr,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=l=>{const u=l.target.result;t(u)},a.onblocked=()=>{r(new od(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const u=l.target.error;u.name==="VersionError"?r(new le(W.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?r(new le(W.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):r(new od(e,u))},a.onupgradeneeded=l=>{ue(gr,'Database "'+this.name+'" requires upgrade from version:',l.oldVersion);const u=l.target.result;this.N.k(u,a.transaction,l.oldVersion,this.version).next((()=>{ue(gr,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,a){const l=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const p=qm.open(this.db,e,l?"readonly":"readwrite",r),f=a(p).next((y=>(p.C(),y))).catch((y=>(p.abort(y),z.reject(y)))).toPromise();return f.catch((()=>{})),await p.D,f}catch(p){const f=p,y=f.name!=="FirebaseError"&&u<3;if(ue(gr,"Transaction failed with error:",f.message,"Retrying:",y),this.close(),!y)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function zS(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class MV{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return uo(this.U.delete())}}class od extends le{constructor(e,t){super(W.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Aa(s){return s.name==="IndexedDbTransactionError"}class LV{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(ue(gr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(ue(gr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),uo(r)}add(e){return ue(gr,"ADD",this.store.name,e,e),uo(this.store.add(e))}get(e){return uo(this.store.get(e)).next((t=>(t===void 0&&(t=null),ue(gr,"GET",this.store.name,e,t),t)))}delete(e){return ue(gr,"DELETE",this.store.name,e),uo(this.store.delete(e))}count(){return ue(gr,"COUNT",this.store.name),uo(this.store.count())}H(e,t){const r=this.options(e,t),a=r.index?this.store.index(r.index):this.store;if(typeof a.getAll=="function"){const l=a.getAll(r.range);return new z(((u,p)=>{l.onerror=f=>{p(f.target.error)},l.onsuccess=f=>{u(f.target.result)}}))}{const l=this.cursor(r),u=[];return this.J(l,((p,f)=>{u.push(f)})).next((()=>u))}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new z(((a,l)=>{r.onerror=u=>{l(u.target.error)},r.onsuccess=u=>{a(u.target.result)}}))}X(e,t){ue(gr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const a=this.cursor(r);return this.J(a,((l,u,p)=>p.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const a=this.cursor(r);return this.J(a,t)}te(e){const t=this.cursor({});return new z(((r,a)=>{t.onerror=l=>{const u=c_(l.target.error);a(u)},t.onsuccess=l=>{const u=l.target.result;u?e(u.primaryKey,u.value).next((p=>{p?u.continue():r()})):r()}}))}J(e,t){const r=[];return new z(((a,l)=>{e.onerror=u=>{l(u.target.error)},e.onsuccess=u=>{const p=u.target.result;if(!p)return void a();const f=new MV(p),y=t(p.primaryKey,p.value,f);if(y instanceof z){const b=y.catch((E=>(f.done(),z.reject(E))));r.push(b)}f.isDone?a():f.G===null?p.continue():p.continue(f.G)}})).next((()=>z.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function uo(s){return new z(((e,t)=>{s.onsuccess=r=>{const a=r.target.result;e(a)},s.onerror=r=>{const a=c_(r.target.error);t(a)}}))}let DT=!1;function c_(s){const e=Vs.M(Pt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(t)>=0){const r=new le("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return DT||(DT=!0,setTimeout((()=>{throw r}),0)),r}}return s}const ld="IndexBackfiller";class UV{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ue(ld,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ue(ld,`Documents written: ${t}`)}catch(t){Aa(t)?ue(ld,"Ignoring IndexedDB error during index backfill: ",t):await Sa(t)}await this.re(6e4)}))}}class zV{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let a=t,l=!0;return z.doWhile((()=>l===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!r.has(u))return ue(ld,`Processing collection: ${u}`),this.oe(e,u,a).next((p=>{a-=p,r.add(u)}));l=!1})))).next((()=>t-a))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,r).next((l=>{const u=l.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(a,l))).next((p=>(ue(ld,`Updating offset: ${p}`),this.localStore.indexManager.updateCollectionGroup(e,t,p)))).next((()=>u.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((a,l)=>{const u=MS(l);l_(u,r)>0&&(r=u)})),new br(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class rr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}rr.ce=-1;const da=-1;function Kd(s){return s==null}function wd(s){return s===0&&1/s==-1/0}function BS(s){return typeof s=="number"&&Number.isInteger(s)&&!wd(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const hm="";function On(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=PT(e)),e=BV(s.get(t),e);return PT(e)}function BV(s,e){let t=e;const r=s.length;for(let a=0;a<r;a++){const l=s.charAt(a);switch(l){case"\0":t+="";break;case hm:t+="";break;default:t+=l}}return t}function PT(s){return s+hm+""}function Ds(s){const e=s.length;if(we(e>=2,64408,{path:s}),e===2)return we(s.charAt(0)===hm&&s.charAt(1)==="",56145,{path:s}),Ke.emptyPath();const t=e-2,r=[];let a="";for(let l=0;l<e;){const u=s.indexOf(hm,l);switch((u<0||u>t)&&xe(50515,{path:s}),s.charAt(u+1)){case"":const p=s.substring(l,u);let f;a.length===0?f=p:(a+=p,f=a,a=""),r.push(f);break;case"":a+=s.substring(l,u),a+="\0";break;case"":a+=s.substring(l,u+1);break;default:xe(61167,{path:s})}l=u+2}return new Ke(r)}const co="remoteDocuments",$d="owner",jl="owner",Id="mutationQueues",qV="userId",Wr="mutations",jT="batchId",_o="userMutationsIndex",VT=["userId","batchId"];function Kf(s,e){return[s,On(e)]}function qS(s,e,t){return[s,On(e),t]}const FV={},ic="documentMutations",fm="remoteDocumentsV14",HV=["prefixPath","collectionGroup","readTime","documentId"],$f="documentKeyIndex",GV=["prefixPath","collectionGroup","documentId"],FS="collectionGroupIndex",QV=["collectionGroup","readTime","prefixPath","documentId"],Sd="remoteDocumentGlobal",Jy="remoteDocumentGlobalKey",ac="targets",HS="queryTargetsIndex",KV=["canonicalId","targetId"],oc="targetDocuments",$V=["targetId","path"],u_="documentTargetsIndex",YV=["path","targetId"],mm="targetGlobalKey",Io="targetGlobal",Ad="collectionParents",WV=["collectionId","parent"],lc="clientMetadata",XV="clientId",Fm="bundles",JV="bundleId",Hm="namedQueries",ZV="name",d_="indexConfiguration",eO="indexId",Zy="collectionGroupIndex",tO="collectionGroup",cd="indexState",nO=["indexId","uid"],GS="sequenceNumberIndex",rO=["uid","sequenceNumber"],ud="indexEntries",sO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],QS="documentKeyIndex",iO=["indexId","uid","orderedDocumentKey"],Gm="documentOverlays",aO=["userId","collectionPath","documentId"],e0="collectionPathOverlayIndex",oO=["userId","collectionPath","largestBatchId"],KS="collectionGroupOverlayIndex",lO=["userId","collectionGroup","largestBatchId"],h_="globals",cO="name",$S=[Id,Wr,ic,co,ac,$d,Io,oc,lc,Sd,Ad,Fm,Hm],uO=[...$S,Gm],YS=[Id,Wr,ic,fm,ac,$d,Io,oc,lc,Sd,Ad,Fm,Hm,Gm],WS=YS,f_=[...WS,d_,cd,ud],dO=f_,XS=[...f_,h_],hO=XS;class t0 extends US{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function un(s,e){const t=ve(s);return Vs.O(t.le,e)}function OT(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Na(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function JS(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class bt{constructor(e,t){this.comparator=e,this.root=t||In.EMPTY}insert(e,t){return new bt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,In.BLACK,null,null))}remove(e){return new bt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,In.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new jf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new jf(this.root,e,this.comparator,!1)}getReverseIterator(){return new jf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new jf(this.root,e,this.comparator,!0)}}class jf{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class In{constructor(e,t,r,a,l){this.key=e,this.value=t,this.color=r??In.RED,this.left=a??In.EMPTY,this.right=l??In.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,l){return new In(e??this.key,t??this.value,r??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const l=r(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,r),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return In.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return In.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,In.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,In.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xe(27949);return e+(this.isRed()?0:1)}}In.EMPTY=null,In.RED=!0,In.BLACK=!1;In.EMPTY=new class{constructor(){this.size=0}get key(){throw xe(57766)}get value(){throw xe(16141)}get color(){throw xe(16727)}get left(){throw xe(29726)}get right(){throw xe(36894)}copy(e,t,r,a,l){return this}insert(e,t,r){return new In(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ft{constructor(e){this.comparator=e,this.data=new bt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new MT(this.data.getIterator())}getIteratorFrom(e){return new MT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof ft)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ft(this.comparator);return t.data=e,t}}class MT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Vl(s){return s.hasNext()?s.getNext():void 0}class sr{constructor(e){this.fields=e,e.sort(Rt.comparator)}static empty(){return new sr([])}unionWith(e){let t=new ft(Rt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new sr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return rc(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class ZS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function fO(){return typeof atob<"u"}class Mt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new ZS("Invalid base64 string: "+l):l}})(e);return new Mt(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new Mt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return De(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Mt.EMPTY_BYTE_STRING=new Mt("");const mO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mi(s){if(we(!!s,39018),typeof s=="string"){let e=0;const t=mO.exec(s);if(we(!!t,46558,{timestamp:s}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(s);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:At(s.seconds),nanos:At(s.nanos)}}function At(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function pi(s){return typeof s=="string"?Mt.fromBase64String(s):Mt.fromUint8Array(s)}const eA="server_timestamp",tA="__type__",nA="__previous_value__",rA="__local_write_time__";function Qm(s){return(s?.mapValue?.fields||{})[tA]?.stringValue===eA}function Km(s){const e=s.mapValue.fields[nA];return Qm(e)?Km(e):e}function Nd(s){const e=mi(s.mapValue.fields[rA].timestampValue);return new lt(e.seconds,e.nanos)}class pO{constructor(e,t,r,a,l,u,p,f,y,b,E){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=p,this.longPollingOptions=f,this.useFetchStreams=y,this.isUsingEmulator=b,this.apiKey=E}}const n0="(default)";class _a{constructor(e,t){this.projectId=e,this.database=t||n0}static empty(){return new _a("","")}get isDefaultDatabase(){return this.database===n0}isEqual(e){return e instanceof _a&&e.projectId===this.projectId&&e.database===this.database}}function gO(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new le(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _a(s.options.projectId,e)}const m_="__type__",sA="__max__",aa={mapValue:{fields:{__type__:{stringValue:sA}}}},p_="__vector__",cc="value",Yf={nullValue:"NULL_VALUE"};function va(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Qm(s)?4:iA(s)?9007199254740991:$m(s)?10:11:xe(28295,{value:s})}function Bs(s,e){if(s===e)return!0;const t=va(s);if(t!==va(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Nd(s).isEqual(Nd(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=mi(a.timestampValue),p=mi(l.timestampValue);return u.seconds===p.seconds&&u.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(a,l){return pi(a.bytesValue).isEqual(pi(l.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(a,l){return At(a.geoPointValue.latitude)===At(l.geoPointValue.latitude)&&At(a.geoPointValue.longitude)===At(l.geoPointValue.longitude)})(s,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return At(a.integerValue)===At(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=At(a.doubleValue),p=At(l.doubleValue);return u===p?wd(u)===wd(p):isNaN(u)&&isNaN(p)}return!1})(s,e);case 9:return rc(s.arrayValue.values||[],e.arrayValue.values||[],Bs);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},p=l.mapValue.fields||{};if(OT(u)!==OT(p))return!1;for(const f in u)if(u.hasOwnProperty(f)&&(p[f]===void 0||!Bs(u[f],p[f])))return!1;return!0})(s,e);default:return xe(52216,{left:s})}}function Rd(s,e){return(s.values||[]).find((t=>Bs(t,e)))!==void 0}function ba(s,e){if(s===e)return 0;const t=va(s),r=va(e);if(t!==r)return De(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return De(s.booleanValue,e.booleanValue);case 2:return(function(l,u){const p=At(l.integerValue||l.doubleValue),f=At(u.integerValue||u.doubleValue);return p<f?-1:p>f?1:p===f?0:isNaN(p)?isNaN(f)?0:-1:1})(s,e);case 3:return LT(s.timestampValue,e.timestampValue);case 4:return LT(Nd(s),Nd(e));case 5:return Wy(s.stringValue,e.stringValue);case 6:return(function(l,u){const p=pi(l),f=pi(u);return p.compareTo(f)})(s.bytesValue,e.bytesValue);case 7:return(function(l,u){const p=l.split("/"),f=u.split("/");for(let y=0;y<p.length&&y<f.length;y++){const b=De(p[y],f[y]);if(b!==0)return b}return De(p.length,f.length)})(s.referenceValue,e.referenceValue);case 8:return(function(l,u){const p=De(At(l.latitude),At(u.latitude));return p!==0?p:De(At(l.longitude),At(u.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return UT(s.arrayValue,e.arrayValue);case 10:return(function(l,u){const p=l.fields||{},f=u.fields||{},y=p[cc]?.arrayValue,b=f[cc]?.arrayValue,E=De(y?.values?.length||0,b?.values?.length||0);return E!==0?E:UT(y,b)})(s.mapValue,e.mapValue);case 11:return(function(l,u){if(l===aa.mapValue&&u===aa.mapValue)return 0;if(l===aa.mapValue)return 1;if(u===aa.mapValue)return-1;const p=l.fields||{},f=Object.keys(p),y=u.fields||{},b=Object.keys(y);f.sort(),b.sort();for(let E=0;E<f.length&&E<b.length;++E){const T=Wy(f[E],b[E]);if(T!==0)return T;const N=ba(p[f[E]],y[b[E]]);if(N!==0)return N}return De(f.length,b.length)})(s.mapValue,e.mapValue);default:throw xe(23264,{he:t})}}function LT(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return De(s,e);const t=mi(s),r=mi(e),a=De(t.seconds,r.seconds);return a!==0?a:De(t.nanos,r.nanos)}function UT(s,e){const t=s.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const l=ba(t[a],r[a]);if(l)return l}return De(t.length,r.length)}function uc(s){return r0(s)}function r0(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const r=mi(t);return`time(${r.seconds},${r.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return pi(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ye.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let r="[",a=!0;for(const l of t.values||[])a?a=!1:r+=",",r+=r0(l);return r+"]"})(s.arrayValue):"mapValue"in s?(function(t){const r=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const u of r)l?l=!1:a+=",",a+=`${u}:${r0(t.fields[u])}`;return a+"}"})(s.mapValue):xe(61005,{value:s})}function Wf(s){switch(va(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Km(s);return e?16+Wf(e):16;case 5:return 2*s.stringValue.length;case 6:return pi(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((a,l)=>a+Wf(l)),0)})(s.arrayValue);case 10:case 11:return(function(r){let a=0;return Na(r.fields,((l,u)=>{a+=l.length+Wf(u)})),a})(s.mapValue);default:throw xe(13486,{value:s})}}function Ro(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function s0(s){return!!s&&"integerValue"in s}function Cd(s){return!!s&&"arrayValue"in s}function zT(s){return!!s&&"nullValue"in s}function BT(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Xf(s){return!!s&&"mapValue"in s}function $m(s){return(s?.mapValue?.fields||{})[m_]?.stringValue===p_}function dd(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Na(s.mapValue.fields,((t,r)=>e.mapValue.fields[t]=dd(r))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=dd(s.arrayValue.values[t]);return e}return{...s}}function iA(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===sA}const aA={mapValue:{fields:{[m_]:{stringValue:p_},[cc]:{arrayValue:{}}}}};function yO(s){return"nullValue"in s?Yf:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?Ro(_a.empty(),ye.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?$m(s)?aA:{mapValue:{}}:xe(35942,{value:s})}function _O(s){return"nullValue"in s?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?Ro(_a.empty(),ye.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?aA:"mapValue"in s?$m(s)?{mapValue:{}}:aa:xe(61959,{value:s})}function qT(s,e){const t=ba(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?-1:!s.inclusive&&e.inclusive?1:0}function FT(s,e){const t=ba(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?1:!s.inclusive&&e.inclusive?-1:0}class Sn{constructor(e){this.value=e}static empty(){return new Sn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Xf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=dd(t)}setAll(e){let t=Rt.emptyPath(),r={},a=[];e.forEach(((u,p)=>{if(!t.isImmediateParentOf(p)){const f=this.getFieldsMap(t);this.applyChanges(f,r,a),r={},a=[],t=p.popLast()}u?r[p.lastSegment()]=dd(u):a.push(p.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,r,a)}delete(e){const t=this.field(e.popLast());Xf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Bs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];Xf(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){Na(t,((a,l)=>e[a]=l));for(const a of r)delete e[a]}clone(){return new Sn(dd(this.value))}}function oA(s){const e=[];return Na(s.fields,((t,r)=>{const a=new Rt([t]);if(Xf(r)){const l=oA(r.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new sr(e)}class wt{constructor(e,t,r,a,l,u,p){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=l,this.data=u,this.documentState=p}static newInvalidDocument(e){return new wt(e,0,Ae.min(),Ae.min(),Ae.min(),Sn.empty(),0)}static newFoundDocument(e,t,r,a){return new wt(e,1,t,Ae.min(),r,a,0)}static newNoDocument(e,t){return new wt(e,2,t,Ae.min(),Ae.min(),Sn.empty(),0)}static newUnknownDocument(e,t){return new wt(e,3,t,Ae.min(),Ae.min(),Sn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Sn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof wt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new wt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class xa{constructor(e,t){this.position=e,this.inclusive=t}}function HT(s,e,t){let r=0;for(let a=0;a<s.position.length;a++){const l=e[a],u=s.position[a];if(l.field.isKeyField()?r=ye.comparator(ye.fromName(u.referenceValue),t.key):r=ba(u,t.data.field(l.field)),l.dir==="desc"&&(r*=-1),r!==0)break}return r}function GT(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!Bs(s.position[t],e.position[t]))return!1;return!0}class kd{constructor(e,t="asc"){this.field=e,this.dir=t}}function vO(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class lA{}class Xe extends lA{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new bO(e,t,r):t==="array-contains"?new TO(e,r):t==="in"?new mA(e,r):t==="not-in"?new wO(e,r):t==="array-contains-any"?new IO(e,r):new Xe(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new xO(e,r):new EO(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ba(t,this.value)):t!==null&&va(this.value)===va(t)&&this.matchesComparison(ba(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ht extends lA{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ht(e,t)}matches(e){return dc(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function dc(s){return s.op==="and"}function i0(s){return s.op==="or"}function g_(s){return cA(s)&&dc(s)}function cA(s){for(const e of s.filters)if(e instanceof ht)return!1;return!0}function a0(s){if(s instanceof Xe)return s.field.canonicalString()+s.op.toString()+uc(s.value);if(g_(s))return s.filters.map((e=>a0(e))).join(",");{const e=s.filters.map((t=>a0(t))).join(",");return`${s.op}(${e})`}}function uA(s,e){return s instanceof Xe?(function(r,a){return a instanceof Xe&&r.op===a.op&&r.field.isEqual(a.field)&&Bs(r.value,a.value)})(s,e):s instanceof ht?(function(r,a){return a instanceof ht&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((l,u,p)=>l&&uA(u,a.filters[p])),!0):!1})(s,e):void xe(19439)}function dA(s,e){const t=s.filters.concat(e);return ht.create(t,s.op)}function hA(s){return s instanceof Xe?(function(t){return`${t.field.canonicalString()} ${t.op} ${uc(t.value)}`})(s):s instanceof ht?(function(t){return t.op.toString()+" {"+t.getFilters().map(hA).join(" ,")+"}"})(s):"Filter"}class bO extends Xe{constructor(e,t,r){super(e,t,r),this.key=ye.fromName(r.referenceValue)}matches(e){const t=ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class xO extends Xe{constructor(e,t){super(e,"in",t),this.keys=fA("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class EO extends Xe{constructor(e,t){super(e,"not-in",t),this.keys=fA("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function fA(s,e){return(e.arrayValue?.values||[]).map((t=>ye.fromName(t.referenceValue)))}class TO extends Xe{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Cd(t)&&Rd(t.arrayValue,this.value)}}class mA extends Xe{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Rd(this.value.arrayValue,t)}}class wO extends Xe{constructor(e,t){super(e,"not-in",t)}matches(e){if(Rd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Rd(this.value.arrayValue,t)}}class IO extends Xe{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Cd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Rd(this.value.arrayValue,r)))}}class SO{constructor(e,t=null,r=[],a=[],l=null,u=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=l,this.startAt=u,this.endAt=p,this.Te=null}}function o0(s,e=null,t=[],r=[],a=null,l=null,u=null){return new SO(s,e,t,r,a,l,u)}function Co(s){const e=ve(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>a0(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(l){return l.field.canonicalString()+l.dir})(r))).join(","),Kd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>uc(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>uc(r))).join(",")),e.Te=t}return e.Te}function Yd(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!vO(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!uA(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!GT(s.startAt,e.startAt)&&GT(s.endAt,e.endAt)}function pm(s){return ye.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function gm(s,e){return s.filters.filter((t=>t instanceof Xe&&t.field.isEqual(e)))}function QT(s,e,t){let r=Yf,a=!0;for(const l of gm(s,e)){let u=Yf,p=!0;switch(l.op){case"<":case"<=":u=yO(l.value);break;case"==":case"in":case">=":u=l.value;break;case">":u=l.value,p=!1;break;case"!=":case"not-in":u=Yf}qT({value:r,inclusive:a},{value:u,inclusive:p})<0&&(r=u,a=p)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const u=t.position[l];qT({value:r,inclusive:a},{value:u,inclusive:t.inclusive})<0&&(r=u,a=t.inclusive);break}}return{value:r,inclusive:a}}function KT(s,e,t){let r=aa,a=!0;for(const l of gm(s,e)){let u=aa,p=!0;switch(l.op){case">=":case">":u=_O(l.value),p=!1;break;case"==":case"in":case"<=":u=l.value;break;case"<":u=l.value,p=!1;break;case"!=":case"not-in":u=aa}FT({value:r,inclusive:a},{value:u,inclusive:p})>0&&(r=u,a=p)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const u=t.position[l];FT({value:r,inclusive:a},{value:u,inclusive:t.inclusive})>0&&(r=u,a=t.inclusive);break}}return{value:r,inclusive:a}}class _i{constructor(e,t=null,r=[],a=[],l=null,u="F",p=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=l,this.limitType=u,this.startAt=p,this.endAt=f,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function pA(s,e,t,r,a,l,u,p){return new _i(s,e,t,r,a,l,u,p)}function Nc(s){return new _i(s)}function $T(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function AO(s){return ye.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function y_(s){return s.collectionGroup!==null}function Wl(s){const e=ve(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let p=new ft(Rt.comparator);return u.filters.forEach((f=>{f.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new kd(l,r))})),t.has(Rt.keyField().canonicalString())||e.Ie.push(new kd(Rt.keyField(),r))}return e.Ie}function Hn(s){const e=ve(s);return e.Ee||(e.Ee=NO(e,Wl(s))),e.Ee}function NO(s,e){if(s.limitType==="F")return o0(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new kd(a.field,l)}));const t=s.endAt?new xa(s.endAt.position,s.endAt.inclusive):null,r=s.startAt?new xa(s.startAt.position,s.startAt.inclusive):null;return o0(s.path,s.collectionGroup,e,s.filters,s.limit,t,r)}}function l0(s,e){const t=s.filters.concat([e]);return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function RO(s,e){const t=s.explicitOrderBy.concat([e]);return new _i(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function ym(s,e,t){return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function CO(s,e){return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,e,s.endAt)}function kO(s,e){return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,e)}function Wd(s,e){return Yd(Hn(s),Hn(e))&&s.limitType===e.limitType}function gA(s){return`${Co(Hn(s))}|lt:${s.limitType}`}function Bl(s){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((a=>hA(a))).join(", ")}]`),Kd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((a=>uc(a))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((a=>uc(a))).join(",")),`Target(${r})`})(Hn(s))}; limitType=${s.limitType})`}function Xd(s,e){return e.isFoundDocument()&&(function(r,a){const l=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(l):ye.isDocumentKey(r.path)?r.path.isEqual(l):r.path.isImmediateParentOf(l)})(s,e)&&(function(r,a){for(const l of Wl(r))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(s,e)&&(function(r,a){for(const l of r.filters)if(!l.matches(a))return!1;return!0})(s,e)&&(function(r,a){return!(r.startAt&&!(function(u,p,f){const y=HT(u,p,f);return u.inclusive?y<=0:y<0})(r.startAt,Wl(r),a)||r.endAt&&!(function(u,p,f){const y=HT(u,p,f);return u.inclusive?y>=0:y>0})(r.endAt,Wl(r),a))})(s,e)}function yA(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function _A(s){return(e,t)=>{let r=!1;for(const a of Wl(s)){const l=DO(a,e,t);if(l!==0)return l;r=r||a.field.isKeyField()}return 0}}function DO(s,e,t){const r=s.field.isKeyField()?ye.comparator(e.key,t.key):(function(l,u,p){const f=u.data.field(l),y=p.data.field(l);return f!==null&&y!==null?ba(f,y):xe(42886)})(s.field,e,t);switch(s.dir){case"asc":return r;case"desc":return-1*r;default:return xe(19790,{direction:s.dir})}}class vi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,l]of r)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Na(this.inner,((t,r)=>{for(const[a,l]of r)e(a,l)}))}isEmpty(){return JS(this.inner)}size(){return this.innerSize}}const PO=new bt(ye.comparator);function ir(){return PO}const vA=new bt(ye.comparator);function Xu(...s){let e=vA;for(const t of s)e=e.insert(t.key,t);return e}function bA(s){let e=vA;return s.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ps(){return hd()}function xA(){return hd()}function hd(){return new vi((s=>s.toString()),((s,e)=>s.isEqual(e)))}const jO=new bt(ye.comparator),VO=new ft(ye.comparator);function Be(...s){let e=VO;for(const t of s)e=e.add(t);return e}const OO=new ft(De);function __(){return OO}function v_(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wd(e)?"-0":e}}function EA(s){return{integerValue:""+s}}function TA(s,e){return BS(e)?EA(e):v_(s,e)}class Ym{constructor(){this._=void 0}}function MO(s,e,t){return s instanceof hc?(function(a,l){const u={fields:{[tA]:{stringValue:eA},[rA]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Qm(l)&&(l=Km(l)),l&&(u.fields[nA]=l),{mapValue:u}})(t,e):s instanceof ko?IA(s,e):s instanceof Do?SA(s,e):(function(a,l){const u=wA(a,l),p=YT(u)+YT(a.Ae);return s0(u)&&s0(a.Ae)?EA(p):v_(a.serializer,p)})(s,e)}function LO(s,e,t){return s instanceof ko?IA(s,e):s instanceof Do?SA(s,e):t}function wA(s,e){return s instanceof fc?(function(r){return s0(r)||(function(l){return!!l&&"doubleValue"in l})(r)})(e)?e:{integerValue:0}:null}class hc extends Ym{}class ko extends Ym{constructor(e){super(),this.elements=e}}function IA(s,e){const t=AA(e);for(const r of s.elements)t.some((a=>Bs(a,r)))||t.push(r);return{arrayValue:{values:t}}}class Do extends Ym{constructor(e){super(),this.elements=e}}function SA(s,e){let t=AA(e);for(const r of s.elements)t=t.filter((a=>!Bs(a,r)));return{arrayValue:{values:t}}}class fc extends Ym{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function YT(s){return At(s.integerValue||s.doubleValue)}function AA(s){return Cd(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class Jd{constructor(e,t){this.field=e,this.transform=t}}function UO(s,e){return s.field.isEqual(e.field)&&(function(r,a){return r instanceof ko&&a instanceof ko||r instanceof Do&&a instanceof Do?rc(r.elements,a.elements,Bs):r instanceof fc&&a instanceof fc?Bs(r.Ae,a.Ae):r instanceof hc&&a instanceof hc})(s.transform,e.transform)}class zO{constructor(e,t){this.version=e,this.transformResults=t}}class Ct{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ct}static exists(e){return new Ct(void 0,e)}static updateTime(e){return new Ct(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jf(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Wm{}function NA(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new Cc(s.key,Ct.none()):new Rc(s.key,s.data,Ct.none());{const t=s.data,r=Sn.empty();let a=new ft(Rt.comparator);for(let l of e.fields)if(!a.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?r.delete(l):r.set(l,u),a=a.add(l)}return new bi(s.key,r,new sr(a.toArray()),Ct.none())}}function BO(s,e,t){s instanceof Rc?(function(a,l,u){const p=a.value.clone(),f=XT(a.fieldTransforms,l,u.transformResults);p.setAll(f),l.convertToFoundDocument(u.version,p).setHasCommittedMutations()})(s,e,t):s instanceof bi?(function(a,l,u){if(!Jf(a.precondition,l))return void l.convertToUnknownDocument(u.version);const p=XT(a.fieldTransforms,l,u.transformResults),f=l.data;f.setAll(RA(a)),f.setAll(p),l.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(s,e,t):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function fd(s,e,t,r){return s instanceof Rc?(function(l,u,p,f){if(!Jf(l.precondition,u))return p;const y=l.value.clone(),b=JT(l.fieldTransforms,f,u);return y.setAll(b),u.convertToFoundDocument(u.version,y).setHasLocalMutations(),null})(s,e,t,r):s instanceof bi?(function(l,u,p,f){if(!Jf(l.precondition,u))return p;const y=JT(l.fieldTransforms,f,u),b=u.data;return b.setAll(RA(l)),b.setAll(y),u.convertToFoundDocument(u.version,b).setHasLocalMutations(),p===null?null:p.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(s,e,t,r):(function(l,u,p){return Jf(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):p})(s,e,t)}function qO(s,e){let t=null;for(const r of s.fieldTransforms){const a=e.data.field(r.field),l=wA(r.transform,a||null);l!=null&&(t===null&&(t=Sn.empty()),t.set(r.field,l))}return t||null}function WT(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&rc(r,a,((l,u)=>UO(l,u)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Rc extends Wm{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class bi extends Wm{constructor(e,t,r,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function RA(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=s.data.field(t);e.set(t,r)}})),e}function XT(s,e,t){const r=new Map;we(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let a=0;a<t.length;a++){const l=s[a],u=l.transform,p=e.data.field(l.field);r.set(l.field,LO(u,p,t[a]))}return r}function JT(s,e,t){const r=new Map;for(const a of s){const l=a.transform,u=t.data.field(a.field);r.set(a.field,MO(l,u,e))}return r}class Cc extends Wm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class b_ extends Wm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class x_{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&BO(l,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=fd(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=fd(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=xA();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let p=this.applyToLocalView(u,l.mutatedFields);p=t.has(a.key)?null:p;const f=NA(u,p);f!==null&&r.set(a.key,f),u.isValidDocument()||u.convertToNoDocument(Ae.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Be())}isEqual(e){return this.batchId===e.batchId&&rc(this.mutations,e.mutations,((t,r)=>WT(t,r)))&&rc(this.baseMutations,e.baseMutations,((t,r)=>WT(t,r)))}}class E_{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){we(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let a=(function(){return jO})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,r[u].version);return new E_(e,t,r,a)}}class T_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class FO{constructor(e,t){this.count=e,this.unchangedNames=t}}var nn,et;function CA(s){switch(s){case W.OK:return xe(64938);case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0;default:return xe(15467,{code:s})}}function kA(s){if(s===void 0)return Ht("GRPC error has no .code"),W.UNKNOWN;switch(s){case nn.OK:return W.OK;case nn.CANCELLED:return W.CANCELLED;case nn.UNKNOWN:return W.UNKNOWN;case nn.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case nn.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case nn.INTERNAL:return W.INTERNAL;case nn.UNAVAILABLE:return W.UNAVAILABLE;case nn.UNAUTHENTICATED:return W.UNAUTHENTICATED;case nn.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case nn.NOT_FOUND:return W.NOT_FOUND;case nn.ALREADY_EXISTS:return W.ALREADY_EXISTS;case nn.PERMISSION_DENIED:return W.PERMISSION_DENIED;case nn.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case nn.ABORTED:return W.ABORTED;case nn.OUT_OF_RANGE:return W.OUT_OF_RANGE;case nn.UNIMPLEMENTED:return W.UNIMPLEMENTED;case nn.DATA_LOSS:return W.DATA_LOSS;default:return xe(39323,{code:s})}}(et=nn||(nn={}))[et.OK=0]="OK",et[et.CANCELLED=1]="CANCELLED",et[et.UNKNOWN=2]="UNKNOWN",et[et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",et[et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",et[et.NOT_FOUND=5]="NOT_FOUND",et[et.ALREADY_EXISTS=6]="ALREADY_EXISTS",et[et.PERMISSION_DENIED=7]="PERMISSION_DENIED",et[et.UNAUTHENTICATED=16]="UNAUTHENTICATED",et[et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",et[et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",et[et.ABORTED=10]="ABORTED",et[et.OUT_OF_RANGE=11]="OUT_OF_RANGE",et[et.UNIMPLEMENTED=12]="UNIMPLEMENTED",et[et.INTERNAL=13]="INTERNAL",et[et.UNAVAILABLE=14]="UNAVAILABLE",et[et.DATA_LOSS=15]="DATA_LOSS";function DA(){return new TextEncoder}const HO=new ua([4294967295,4294967295],0);function ZT(s){const e=DA().encode(s),t=new wS;return t.update(e),new Uint8Array(t.digest())}function ew(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ua([t,r],0),new ua([a,l],0)]}class w_{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Ju(`Invalid padding: ${t}`);if(r<0)throw new Ju(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ju(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Ju(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ua.fromNumber(this.ge)}ye(e,t,r){let a=e.add(t.multiply(ua.fromNumber(r)));return a.compare(HO)===1&&(a=new ua([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=ZT(e),[r,a]=ew(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(r,a,l);if(!this.we(u))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new w_(l,a,t);return r.forEach((p=>u.insert(p))),u}insert(e){if(this.ge===0)return;const t=ZT(e),[r,a]=ew(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(r,a,l);this.be(u)}}be(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Ju extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Zd{constructor(e,t,r,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,eh.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Zd(Ae.min(),a,new bt(De),ir(),Be())}}class eh{constructor(e,t,r,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new eh(r,t,Be(),Be(),Be())}}class Zf{constructor(e,t,r,a){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=a}}class PA{constructor(e,t){this.targetId=e,this.Ce=t}}class jA{constructor(e,t,r=Mt.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class tw{constructor(){this.ve=0,this.Fe=nw(),this.Me=Mt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Be(),t=Be(),r=Be();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:xe(38017,{changeType:l})}})),new eh(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=nw()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,we(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class GO{constructor(e){this.Ge=e,this.ze=new Map,this.je=ir(),this.He=Vf(),this.Je=Vf(),this.Ze=new bt(De)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:xe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,r=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(pm(l))if(r===0){const u=new ye(l.path);this.et(t,u,wt.newNoDocument(u,Ae.min()))}else we(r===1,20013,{expectedCount:r});else{const u=this._t(t);if(u!==r){const p=this.ut(e),f=p?this.ct(p,e,u):1;if(f!==0){this.it(t);const y=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:l=0}=t;let u,p;try{u=pi(r).toUint8Array()}catch(f){if(f instanceof ZS)return zs("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{p=new w_(u,a,l)}catch(f){return zs(f instanceof Ju?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return p.ge===0?null:p}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let a=0;return r.forEach((l=>{const u=this.Ge.ht(),p=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(p)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const p=this.ot(u);if(p){if(l.current&&pm(p.target)){const f=new ye(p.target.path);this.It(f).has(u)||this.Et(u,f)||this.et(u,f,wt.newNoDocument(f,e))}l.Be&&(t.set(u,l.ke()),l.Ke())}}));let r=Be();this.Je.forEach(((l,u)=>{let p=!0;u.forEachWhile((f=>{const y=this.ot(f);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(r=r.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new Zd(e,t,this.Ze,this.je,r);return this.je=ir(),this.He=Vf(),this.Je=Vf(),this.Ze=new bt(De),a}Ye(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.qe(t,1):a.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new tw,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new ft(De),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new ft(De),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ue("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new tw),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Vf(){return new bt(ye.comparator)}function nw(){return new bt(ye.comparator)}const QO={asc:"ASCENDING",desc:"DESCENDING"},KO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$O={and:"AND",or:"OR"};class YO{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function c0(s,e){return s.useProto3Json||Kd(e)?e:{value:e}}function mc(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function VA(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function WO(s,e){return mc(s,e.toTimestamp())}function Gt(s){return we(!!s,49232),Ae.fromTimestamp((function(t){const r=mi(t);return new lt(r.seconds,r.nanos)})(s))}function I_(s,e){return u0(s,e).canonicalString()}function u0(s,e){const t=(function(a){return new Ke(["projects",a.projectId,"databases",a.database])})(s).child("documents");return e===void 0?t:t.child(e)}function OA(s){const e=Ke.fromString(s);return we(QA(e),10190,{key:e.toString()}),e}function Dd(s,e){return I_(s.databaseId,e.path)}function Os(s,e){const t=OA(e);if(t.get(1)!==s.databaseId.projectId)throw new le(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new le(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ye(UA(t))}function MA(s,e){return I_(s.databaseId,e)}function LA(s){const e=OA(s);return e.length===4?Ke.emptyPath():UA(e)}function d0(s){return new Ke(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function UA(s){return we(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function rw(s,e,t){return{name:Dd(s,e),fields:t.value.mapValue.fields}}function zA(s,e,t){const r=Os(s,e.name),a=Gt(e.updateTime),l=e.createTime?Gt(e.createTime):Ae.min(),u=new Sn({mapValue:{fields:e.fields}}),p=wt.newFoundDocument(r,a,l,u);return t&&p.setHasCommittedMutations(),t?p.setHasCommittedMutations():p}function XO(s,e){return"found"in e?(function(r,a){we(!!a.found,43571),a.found.name,a.found.updateTime;const l=Os(r,a.found.name),u=Gt(a.found.updateTime),p=a.found.createTime?Gt(a.found.createTime):Ae.min(),f=new Sn({mapValue:{fields:a.found.fields}});return wt.newFoundDocument(l,u,p,f)})(s,e):"missing"in e?(function(r,a){we(!!a.missing,3894),we(!!a.readTime,22933);const l=Os(r,a.missing),u=Gt(a.readTime);return wt.newNoDocument(l,u)})(s,e):xe(7234,{result:e})}function JO(s,e){let t;if("targetChange"in e){e.targetChange;const r=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:xe(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(y,b){return y.useProto3Json?(we(b===void 0||typeof b=="string",58123),Mt.fromBase64String(b||"")):(we(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Mt.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),u=e.targetChange.cause,p=u&&(function(y){const b=y.code===void 0?W.UNKNOWN:kA(y.code);return new le(b,y.message||"")})(u);t=new jA(r,a,l,p||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=Os(s,r.document.name),l=Gt(r.document.updateTime),u=r.document.createTime?Gt(r.document.createTime):Ae.min(),p=new Sn({mapValue:{fields:r.document.fields}}),f=wt.newFoundDocument(a,l,u,p),y=r.targetIds||[],b=r.removedTargetIds||[];t=new Zf(y,b,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=Os(s,r.document),l=r.readTime?Gt(r.readTime):Ae.min(),u=wt.newNoDocument(a,l),p=r.removedTargetIds||[];t=new Zf([],p,u.key,u)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=Os(s,r.document),l=r.removedTargetIds||[];t=new Zf([],l,a,null)}else{if(!("filter"in e))return xe(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:l}=r,u=new FO(a,l),p=r.targetId;t=new PA(p,u)}}return t}function Pd(s,e){let t;if(e instanceof Rc)t={update:rw(s,e.key,e.value)};else if(e instanceof Cc)t={delete:Dd(s,e.key)};else if(e instanceof bi)t={update:rw(s,e.key,e.data),updateMask:sM(e.fieldMask)};else{if(!(e instanceof b_))return xe(16599,{dt:e.type});t={verify:Dd(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(l,u){const p=u.transform;if(p instanceof hc)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof ko)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof Do)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof fc)return{fieldPath:u.field.canonicalString(),increment:p.Ae};throw xe(20930,{transform:u.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:WO(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:xe(27497)})(s,e.precondition)),t}function h0(s,e){const t=e.currentDocument?(function(l){return l.updateTime!==void 0?Ct.updateTime(Gt(l.updateTime)):l.exists!==void 0?Ct.exists(l.exists):Ct.none()})(e.currentDocument):Ct.none(),r=e.updateTransforms?e.updateTransforms.map((a=>(function(u,p){let f=null;if("setToServerValue"in p)we(p.setToServerValue==="REQUEST_TIME",16630,{proto:p}),f=new hc;else if("appendMissingElements"in p){const b=p.appendMissingElements.values||[];f=new ko(b)}else if("removeAllFromArray"in p){const b=p.removeAllFromArray.values||[];f=new Do(b)}else"increment"in p?f=new fc(u,p.increment):xe(16584,{proto:p});const y=Rt.fromServerFormat(p.fieldPath);return new Jd(y,f)})(s,a))):[];if(e.update){e.update.name;const a=Os(s,e.update.name),l=new Sn({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(f){const y=f.fieldPaths||[];return new sr(y.map((b=>Rt.fromServerFormat(b))))})(e.updateMask);return new bi(a,l,u,t,r)}return new Rc(a,l,t,r)}if(e.delete){const a=Os(s,e.delete);return new Cc(a,t)}if(e.verify){const a=Os(s,e.verify);return new b_(a,t)}return xe(1463,{proto:e})}function ZO(s,e){return s&&s.length>0?(we(e!==void 0,14353),s.map((t=>(function(a,l){let u=a.updateTime?Gt(a.updateTime):Gt(l);return u.isEqual(Ae.min())&&(u=Gt(l)),new zO(u,a.transformResults||[])})(t,e)))):[]}function BA(s,e){return{documents:[MA(s,e.path)]}}function qA(s,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=MA(s,a);const l=(function(y){if(y.length!==0)return GA(ht.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(y){if(y.length!==0)return y.map((b=>(function(T){return{field:ql(T.field),direction:tM(T.dir)}})(b)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const p=c0(s,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:a}}function FA(s){let e=LA(s.parent);const t=s.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){we(r===1,65062);const b=t.from[0];b.allDescendants?a=b.collectionId:e=e.child(b.collectionId)}let l=[];t.where&&(l=(function(E){const T=HA(E);return T instanceof ht&&g_(T)?T.getFilters():[T]})(t.where));let u=[];t.orderBy&&(u=(function(E){return E.map((T=>(function(B){return new kd(Fl(B.field),(function(te){switch(te){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(T)))})(t.orderBy));let p=null;t.limit&&(p=(function(E){let T;return T=typeof E=="object"?E.value:E,Kd(T)?null:T})(t.limit));let f=null;t.startAt&&(f=(function(E){const T=!!E.before,N=E.values||[];return new xa(N,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(E){const T=!E.before,N=E.values||[];return new xa(N,T)})(t.endAt)),pA(e,a,u,l,p,"F",f,y)}function eM(s,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xe(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function HA(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Fl(t.unaryFilter.field);return Xe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=Fl(t.unaryFilter.field);return Xe.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Fl(t.unaryFilter.field);return Xe.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Fl(t.unaryFilter.field);return Xe.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xe(61313);default:return xe(60726)}})(s):s.fieldFilter!==void 0?(function(t){return Xe.create(Fl(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xe(58110);default:return xe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return ht.create(t.compositeFilter.filters.map((r=>HA(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return xe(1026)}})(t.compositeFilter.op))})(s):xe(30097,{filter:s})}function tM(s){return QO[s]}function nM(s){return KO[s]}function rM(s){return $O[s]}function ql(s){return{fieldPath:s.canonicalString()}}function Fl(s){return Rt.fromServerFormat(s.fieldPath)}function GA(s){return s instanceof Xe?(function(t){if(t.op==="=="){if(BT(t.value))return{unaryFilter:{field:ql(t.field),op:"IS_NAN"}};if(zT(t.value))return{unaryFilter:{field:ql(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(BT(t.value))return{unaryFilter:{field:ql(t.field),op:"IS_NOT_NAN"}};if(zT(t.value))return{unaryFilter:{field:ql(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ql(t.field),op:nM(t.op),value:t.value}}})(s):s instanceof ht?(function(t){const r=t.getFilters().map((a=>GA(a)));return r.length===1?r[0]:{compositeFilter:{op:rM(t.op),filters:r}}})(s):xe(54877,{filter:s})}function sM(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function QA(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function KA(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class ci{constructor(e,t,r,a,l=Ae.min(),u=Ae.min(),p=Mt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=p,this.expectedCount=f}withSequenceNumber(e){return new ci(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ci(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ci(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ci(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class $A{constructor(e){this.yt=e}}function iM(s,e){let t;if(e.document)t=zA(s.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ye.fromSegments(e.noDocument.path),a=jo(e.noDocument.readTime);t=wt.newNoDocument(r,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return xe(56709);{const r=ye.fromSegments(e.unknownDocument.path),a=jo(e.unknownDocument.version);t=wt.newUnknownDocument(r,a)}}return e.readTime&&t.setReadTime((function(a){const l=new lt(a[0],a[1]);return Ae.fromTimestamp(l)})(e.readTime)),t}function sw(s,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:_m(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(l,u){return{name:Dd(l,u.key),fields:u.data.value.mapValue.fields,updateTime:mc(l,u.version.toTimestamp()),createTime:mc(l,u.createTime.toTimestamp())}})(s.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Po(e.version)};else{if(!e.isUnknownDocument())return xe(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Po(e.version)}}return r}function _m(s){const e=s.toTimestamp();return[e.seconds,e.nanoseconds]}function Po(s){const e=s.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function jo(s){const e=new lt(s.seconds,s.nanoseconds);return Ae.fromTimestamp(e)}function ho(s,e){const t=(e.baseMutations||[]).map((l=>h0(s.yt,l)));for(let l=0;l<e.mutations.length-1;++l){const u=e.mutations[l];if(l+1<e.mutations.length&&e.mutations[l+1].transform!==void 0){const p=e.mutations[l+1];u.updateTransforms=p.transform.fieldTransforms,e.mutations.splice(l+1,1),++l}}const r=e.mutations.map((l=>h0(s.yt,l))),a=lt.fromMillis(e.localWriteTimeMs);return new x_(e.batchId,a,t,r)}function Zu(s){const e=jo(s.readTime),t=s.lastLimboFreeSnapshotVersion!==void 0?jo(s.lastLimboFreeSnapshotVersion):Ae.min();let r;return r=(function(l){return l.documents!==void 0})(s.query)?(function(l){const u=l.documents.length;return we(u===1,1966,{count:u}),Hn(Nc(LA(l.documents[0])))})(s.query):(function(l){return Hn(FA(l))})(s.query),new ci(r,s.targetId,"TargetPurposeListen",s.lastListenSequenceNumber,e,t,Mt.fromBase64String(s.resumeToken))}function YA(s,e){const t=Po(e.snapshotVersion),r=Po(e.lastLimboFreeSnapshotVersion);let a;a=pm(e.target)?BA(s.yt,e.target):qA(s.yt,e.target).ft;const l=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Co(e.target),readTime:t,resumeToken:l,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:a}}function S_(s){const e=FA({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?ym(e,e.limit,"L"):e}function Sy(s,e){return new T_(e.largestBatchId,h0(s.yt,e.overlayMutation))}function iw(s,e){const t=e.path.lastSegment();return[s,On(e.path.popLast()),t]}function aw(s,e,t,r){return{indexId:s,uid:e,sequenceNumber:t,readTime:Po(r.readTime),documentKey:On(r.documentKey.path),largestBatchId:r.largestBatchId}}class aM{getBundleMetadata(e,t){return ow(e).get(t).next((r=>{if(r)return(function(l){return{id:l.bundleId,createTime:jo(l.createTime),version:l.version}})(r)}))}saveBundleMetadata(e,t){return ow(e).put((function(a){return{bundleId:a.id,createTime:Po(Gt(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return lw(e).get(t).next((r=>{if(r)return(function(l){return{name:l.name,query:S_(l.bundledQuery),readTime:jo(l.readTime)}})(r)}))}saveNamedQuery(e,t){return lw(e).put((function(a){return{name:a.name,readTime:Po(Gt(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function ow(s){return un(s,Fm)}function lw(s){return un(s,Hm)}class Xm{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Xm(e,r)}getOverlay(e,t){return Bu(e).get(iw(this.userId,t)).next((r=>r?Sy(this.serializer,r):null))}getOverlays(e,t){const r=Ps();return z.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&r.set(a,l)})))).next((()=>r))}saveOverlays(e,t,r){const a=[];return r.forEach(((l,u)=>{const p=new T_(t,u);a.push(this.bt(e,p))})),z.waitFor(a)}removeOverlaysForBatchId(e,t,r){const a=new Set;t.forEach((u=>a.add(On(u.getCollectionPath()))));const l=[];return a.forEach((u=>{const p=IDBKeyRange.bound([this.userId,u,r],[this.userId,u,r+1],!1,!0);l.push(Bu(e).X(e0,p))})),z.waitFor(l)}getOverlaysForCollection(e,t,r){const a=Ps(),l=On(t),u=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,Number.POSITIVE_INFINITY],!0);return Bu(e).H(e0,u).next((p=>{for(const f of p){const y=Sy(this.serializer,f);a.set(y.getKey(),y)}return a}))}getOverlaysForCollectionGroup(e,t,r,a){const l=Ps();let u;const p=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Bu(e).ee({index:KS,range:p},((f,y,b)=>{const E=Sy(this.serializer,y);l.size()<a||E.largestBatchId===u?(l.set(E.getKey(),E),u=E.largestBatchId):b.done()})).next((()=>l))}bt(e,t){return Bu(e).put((function(a,l,u){const[p,f,y]=iw(l,u.mutation.key);return{userId:l,collectionPath:f,documentId:y,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:Pd(a.yt,u.mutation)}})(this.serializer,this.userId,t))}}function Bu(s){return un(s,Gm)}class oM{St(e){return un(e,h_)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const r=t?.value;return r?Mt.fromUint8Array(r):Mt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class fo{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(At(e.integerValue));else if("doubleValue"in e){const r=At(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),wd(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=mi(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(pi(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?iA(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):$m(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):xe(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const r=e.fields||{};this.Ft(t,55);for(const a of Object.keys(r))this.Ot(a,t),this.Ct(r[a],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const a=cc,l=r[a].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(At(l)),this.Ot(a,t),this.Ct(r[a],t)}qt(e,t){const r=e.values||[];this.Ft(t,50);for(const a of r)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),ye.fromName(e).path.forEach((r=>{this.Ft(t,60),this.$t(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}fo.Wt=new fo;const Ol=255;function lM(s){if(s===0)return 8;let e=0;return s>>4||(e+=4,s<<=4),s>>6||(e+=2,s<<=2),s>>7||(e+=1),e}function cw(s){const e=64-(function(r){let a=0;for(let l=0;l<8;++l){const u=lM(255&r[l]);if(a+=u,u!==8)break}return a})(s);return Math.ceil(e/8)}class cM{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const a=t.codePointAt(0);this.Gt(240|a>>>18),this.Gt(128|63&a>>>12),this.Gt(128|63&a>>>6),this.Gt(128|63&a)}}this.zt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const a=t.codePointAt(0);this.Ht(240|a>>>18),this.Ht(128|63&a>>>12),this.Ht(128|63&a>>>6),this.Ht(128|63&a)}}this.Jt()}Yt(e){const t=this.en(e),r=cw(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),r=cw(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(Ol),this.sn(255)}_n(){this.an(Ol),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(l){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,l,!1),new Uint8Array(u.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let a=1;a<t.length;++a)t[a]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ol?(this.sn(Ol),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ol?(this.an(Ol),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const a=new Uint8Array(r);a.set(this.buffer),this.buffer=a}}class uM{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class dM{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class qu{constructor(){this.cn=new cM,this.ascending=new uM(this.cn),this.descending=new dM(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class mo{constructor(e,t,r,a){this.hn=e,this.Pn=t,this.Tn=r,this.In=a}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new mo(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:em(this.Tn),directionalValue:em(this.In),orderedDocumentKey:em(t),documentKey:r.path.toArray()}}An(e,t,r){const a=this.Rn(e,t,r);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function ea(s,e){let t=s.hn-e.hn;return t!==0?t:(t=uw(s.Tn,e.Tn),t!==0?t:(t=uw(s.In,e.In),t!==0?t:ye.comparator(s.Pn,e.Pn)))}function uw(s,e){for(let t=0;t<s.length&&t<e.length;++t){const r=s[t]-e[t];if(r!==0)return r}return s.length-e.length}function em(s){return dI()?(function(t){let r="";for(let a=0;a<t.length;a++)r+=String.fromCharCode(t[a]);return r})(s):s}function dw(s){return typeof s!="string"?s:(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(s)}class hw{constructor(e){this.Vn=new ft(((t,r)=>Rt.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(we(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=Xy(e);if(t!==void 0&&!this.pn(t))return!1;const r=lo(e);let a=new Set,l=0,u=0;for(;l<r.length&&this.pn(r[l]);++l)a=a.add(r[l].fieldPath.canonicalString());if(l===r.length)return!0;if(this.Vn.size>0){const p=this.Vn.getIterator().getNext();if(!a.has(p.field.canonicalString())){const f=r[l];if(!this.yn(p,f)||!this.wn(this.dn[u++],f))return!1}++l}for(;l<r.length;++l){const p=r[l];if(u>=this.dn.length||!this.wn(this.dn[u++],p))return!1}return!0}bn(){if(this.fn)return null;let e=new ft(Rt.comparator);const t=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Qf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Qf(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Qf(r.field,r.dir==="asc"?0:1)));return new dm(dm.UNKNOWN_ID,this.collectionId,t,Td.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function WA(s){if(we(s instanceof Xe||s instanceof ht,20012),s instanceof Xe){if(s instanceof mA){const t=s.value.arrayValue?.values?.map((r=>Xe.create(s.field,"==",r)))||[];return ht.create(t,"or")}return s}const e=s.filters.map((t=>WA(t)));return ht.create(e,s.op)}function hM(s){if(s.getFilters().length===0)return[];const e=p0(WA(s));return we(XA(e),7391),f0(e)||m0(e)?[e]:e.getFilters()}function f0(s){return s instanceof Xe}function m0(s){return s instanceof ht&&g_(s)}function XA(s){return f0(s)||m0(s)||(function(t){if(t instanceof ht&&i0(t)){for(const r of t.getFilters())if(!f0(r)&&!m0(r))return!1;return!0}return!1})(s)}function p0(s){if(we(s instanceof Xe||s instanceof ht,34018),s instanceof Xe)return s;if(s.filters.length===1)return p0(s.filters[0]);const e=s.filters.map((r=>p0(r)));let t=ht.create(e,s.op);return t=vm(t),XA(t)?t:(we(t instanceof ht,64498),we(dc(t),40251),we(t.filters.length>1,57927),t.filters.reduce(((r,a)=>A_(r,a))))}function A_(s,e){let t;return we(s instanceof Xe||s instanceof ht,38388),we(e instanceof Xe||e instanceof ht,25473),t=s instanceof Xe?e instanceof Xe?(function(a,l){return ht.create([a,l],"and")})(s,e):fw(s,e):e instanceof Xe?fw(e,s):(function(a,l){if(we(a.filters.length>0&&l.filters.length>0,48005),dc(a)&&dc(l))return dA(a,l.getFilters());const u=i0(a)?a:l,p=i0(a)?l:a,f=u.filters.map((y=>A_(y,p)));return ht.create(f,"or")})(s,e),vm(t)}function fw(s,e){if(dc(e))return dA(e,s.getFilters());{const t=e.filters.map((r=>A_(s,r)));return ht.create(t,"or")}}function vm(s){if(we(s instanceof Xe||s instanceof ht,11850),s instanceof Xe)return s;const e=s.getFilters();if(e.length===1)return vm(e[0]);if(cA(s))return s;const t=e.map((a=>vm(a))),r=[];return t.forEach((a=>{a instanceof Xe?r.push(a):a instanceof ht&&(a.op===s.op?r.push(...a.filters):r.push(a))})),r.length===1?r[0]:ht.create(r,s.op)}class fM{constructor(){this.Sn=new N_}addToCollectionParentIndex(e,t){return this.Sn.add(t),z.resolve()}getCollectionParents(e,t){return z.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return z.resolve()}deleteFieldIndex(e,t){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,t){return z.resolve()}getDocumentsMatchingTarget(e,t){return z.resolve(null)}getIndexType(e,t){return z.resolve(0)}getFieldIndexes(e,t){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,t){return z.resolve(br.min())}getMinOffsetFromCollectionGroup(e,t){return z.resolve(br.min())}updateCollectionGroup(e,t,r){return z.resolve()}updateIndexEntries(e,t){return z.resolve()}}class N_{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new ft(Ke.comparator),l=!a.has(r);return this.index[t]=a.add(r),l}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new ft(Ke.comparator)).toArray()}}const mw="IndexedDbIndexManager",Of=new Uint8Array(0);class mM{constructor(e,t){this.databaseId=t,this.Dn=new N_,this.Cn=new vi((r=>Co(r)),((r,a)=>Yd(r,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const r=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const l={collectionId:r,parent:On(a)};return pw(e).put(l)}return z.resolve()}getCollectionParents(e,t){const r=[],a=IDBKeyRange.bound([t,""],[DS(t),""],!1,!0);return pw(e).H(a).next((l=>{for(const u of l){if(u.collectionId!==t)break;r.push(Ds(u.parent))}return r}))}addFieldIndex(e,t){const r=Fu(e),a=(function(p){return{indexId:p.indexId,collectionGroup:p.collectionGroup,fields:p.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete a.indexId;const l=r.add(a);if(t.indexState){const u=Ll(e);return l.next((p=>{u.put(aw(p,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return l.next()}deleteFieldIndex(e,t){const r=Fu(e),a=Ll(e),l=Ml(e);return r.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>l.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Fu(e),r=Ml(e),a=Ll(e);return t.X().next((()=>r.X())).next((()=>a.X()))}createTargetIndexes(e,t){return z.forEach(this.vn(t),(r=>this.getIndexType(e,r).next((a=>{if(a===0||a===1){const l=new hw(r).bn();if(l!=null)return this.addFieldIndex(e,l)}}))))}getDocumentsMatchingTarget(e,t){const r=Ml(e);let a=!0;const l=new Map;return z.forEach(this.vn(t),(u=>this.Fn(e,u).next((p=>{a&&(a=!!p),l.set(u,p)})))).next((()=>{if(a){let u=Be();const p=[];return z.forEach(l,((f,y)=>{ue(mw,`Using index ${(function(se){return`id=${se.indexId}|cg=${se.collectionGroup}|f=${se.fields.map((fe=>`${fe.fieldPath}:${fe.kind}`)).join(",")}`})(f)} to execute ${Co(t)}`);const b=(function(se,fe){const H=Xy(fe);if(H===void 0)return null;for(const ae of gm(se,H.fieldPath))switch(ae.op){case"array-contains-any":return ae.value.arrayValue.values||[];case"array-contains":return[ae.value]}return null})(y,f),E=(function(se,fe){const H=new Map;for(const ae of lo(fe))for(const A of gm(se,ae.fieldPath))switch(A.op){case"==":case"in":H.set(ae.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return H.set(ae.fieldPath.canonicalString(),A.value),Array.from(H.values())}return null})(y,f),T=(function(se,fe){const H=[];let ae=!0;for(const A of lo(fe)){const R=A.kind===0?QT(se,A.fieldPath,se.startAt):KT(se,A.fieldPath,se.startAt);H.push(R.value),ae&&(ae=R.inclusive)}return new xa(H,ae)})(y,f),N=(function(se,fe){const H=[];let ae=!0;for(const A of lo(fe)){const R=A.kind===0?KT(se,A.fieldPath,se.endAt):QT(se,A.fieldPath,se.endAt);H.push(R.value),ae&&(ae=R.inclusive)}return new xa(H,ae)})(y,f),B=this.Mn(f,y,T),G=this.Mn(f,y,N),te=this.xn(f,y,E),I=this.On(f.indexId,b,B,T.inclusive,G,N.inclusive,te);return z.forEach(I,(X=>r.Z(X,t.limit).next((se=>{se.forEach((fe=>{const H=ye.fromSegments(fe.documentKey);u.has(H)||(u=u.add(H),p.push(H))}))}))))})).next((()=>p))}return z.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=hM(ht.create(e.filters,"and")).map((r=>o0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,r,a,l,u,p){const f=(t!=null?t.length:1)*Math.max(r.length,l.length),y=f/(t!=null?t.length:1),b=[];for(let E=0;E<f;++E){const T=t?this.Nn(t[E/y]):Of,N=this.Bn(e,T,r[E%y],a),B=this.Ln(e,T,l[E%y],u),G=p.map((te=>this.Bn(e,T,te,!0)));b.push(...this.createRange(N,B,G))}return b}Bn(e,t,r,a){const l=new mo(e,ye.empty(),t,r);return a?l:l.En()}Ln(e,t,r,a){const l=new mo(e,ye.empty(),t,r);return a?l.En():l}Fn(e,t){const r=new hw(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((l=>{let u=null;for(const p of l)r.gn(p)&&(!u||p.fields.length>u.fields.length)&&(u=p);return u}))}getIndexType(e,t){let r=2;const a=this.vn(t);return z.forEach(a,(l=>this.Fn(e,l).next((u=>{u?r!==0&&u.fields.length<(function(f){let y=new ft(Rt.comparator),b=!1;for(const E of f.filters)for(const T of E.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?b=!0:y=y.add(T.field));for(const E of f.orderBy)E.field.isKeyField()||(y=y.add(E.field));return y.size+(b?1:0)})(l)&&(r=1):r=0})))).next((()=>(function(u){return u.limit!==null})(t)&&a.length>1&&r===2?1:r))}kn(e,t){const r=new qu;for(const a of lo(e)){const l=t.data.field(a.fieldPath);if(l==null)return null;const u=r.ln(a.kind);fo.Wt.Dt(l,u)}return r.un()}Nn(e){const t=new qu;return fo.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const r=new qu;return fo.Wt.Dt(Ro(this.databaseId,t),r.ln((function(l){const u=lo(l);return u.length===0?0:u[u.length-1].kind})(e))),r.un()}xn(e,t,r){if(r===null)return[];let a=[];a.push(new qu);let l=0;for(const u of lo(e)){const p=r[l++];for(const f of a)if(this.qn(t,u.fieldPath)&&Cd(p))a=this.Un(a,u,p);else{const y=f.ln(u.kind);fo.Wt.Dt(p,y)}}return this.$n(a)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){const a=[...e],l=[];for(const u of r.arrayValue.values||[])for(const p of a){const f=new qu;f.seed(p.un()),fo.Wt.Dt(u,f.ln(t.kind)),l.push(f)}return l}qn(e,t){return!!e.filters.find((r=>r instanceof Xe&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Fu(e),a=Ll(e);return(t?r.H(Zy,IDBKeyRange.bound(t,t)):r.H()).next((l=>{const u=[];return z.forEach(l,(p=>a.get([p.indexId,this.uid]).next((f=>{u.push((function(b,E){const T=E?new Td(E.sequenceNumber,new br(jo(E.readTime),new ye(Ds(E.documentKey)),E.largestBatchId)):Td.empty(),N=b.fields.map((([B,G])=>new Qf(Rt.fromServerFormat(B),G)));return new dm(b.indexId,b.collectionGroup,N,T)})(p,f))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,a)=>{const l=r.indexState.sequenceNumber-a.indexState.sequenceNumber;return l!==0?l:De(r.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const a=Fu(e),l=Ll(e);return this.Wn(e).next((u=>a.H(Zy,IDBKeyRange.bound(t,t)).next((p=>z.forEach(p,(f=>l.put(aw(f.indexId,this.uid,u,r))))))))}updateIndexEntries(e,t){const r=new Map;return z.forEach(t,((a,l)=>{const u=r.get(a.collectionGroup);return(u?z.resolve(u):this.getFieldIndexes(e,a.collectionGroup)).next((p=>(r.set(a.collectionGroup,p),z.forEach(p,(f=>this.Qn(e,a,f).next((y=>{const b=this.Gn(l,f);return y.isEqual(b)?z.resolve():this.zn(e,l,f,y,b)})))))))}))}jn(e,t,r,a){return Ml(e).put(a.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,a){return Ml(e).delete(a.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){const a=Ml(e);let l=new ft(ea);return a.ee({index:QS,range:IDBKeyRange.only([r.indexId,this.uid,em(this.Kn(r,t))])},((u,p)=>{l=l.add(new mo(r.indexId,t,dw(p.arrayValue),dw(p.directionalValue)))})).next((()=>l))}Gn(e,t){let r=new ft(ea);const a=this.kn(t,e);if(a==null)return r;const l=Xy(t);if(l!=null){const u=e.data.field(l.fieldPath);if(Cd(u))for(const p of u.arrayValue.values||[])r=r.add(new mo(t.indexId,e.key,this.Nn(p),a))}else r=r.add(new mo(t.indexId,e.key,Of,a));return r}zn(e,t,r,a,l){ue(mw,"Updating index entries for document '%s'",t.key);const u=[];return(function(f,y,b,E,T){const N=f.getIterator(),B=y.getIterator();let G=Vl(N),te=Vl(B);for(;G||te;){let I=!1,X=!1;if(G&&te){const se=b(G,te);se<0?X=!0:se>0&&(I=!0)}else G!=null?X=!0:I=!0;I?(E(te),te=Vl(B)):X?(T(G),G=Vl(N)):(G=Vl(N),te=Vl(B))}})(a,l,ea,(p=>{u.push(this.jn(e,t,r,p))}),(p=>{u.push(this.Hn(e,t,r,p))})),z.waitFor(u)}Wn(e){let t=1;return Ll(e).ee({index:GS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,a,l)=>{l.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((u,p)=>ea(u,p))).filter(((u,p,f)=>!p||ea(u,f[p-1])!==0));const a=[];a.push(e);for(const u of r){const p=ea(u,e),f=ea(u,t);if(p===0)a[0]=e.En();else if(p>0&&f<0)a.push(u),a.push(u.En());else if(f>0)break}a.push(t);const l=[];for(let u=0;u<a.length;u+=2){if(this.Jn(a[u],a[u+1]))return[];const p=a[u].An(this.uid,Of,ye.empty()),f=a[u+1].An(this.uid,Of,ye.empty());l.push(IDBKeyRange.bound(p,f))}return l}Jn(e,t){return ea(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(gw)}getMinOffset(e,t){return z.mapArray(this.vn(t),(r=>this.Fn(e,r).next((a=>a||xe(44426))))).next(gw)}}function pw(s){return un(s,Ad)}function Ml(s){return un(s,ud)}function Fu(s){return un(s,d_)}function Ll(s){return un(s,cd)}function gw(s){we(s.length!==0,28825);let e=s[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<s.length;r++){const a=s[r].indexState.offset;l_(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new br(e.readTime,e.documentKey,t)}const yw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},JA=41943040;class jn{static withCacheSize(e){return new jn(e,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function ZA(s,e,t){const r=s.store(Wr),a=s.store(ic),l=[],u=IDBKeyRange.only(t.batchId);let p=0;const f=r.ee({range:u},((b,E,T)=>(p++,T.delete())));l.push(f.next((()=>{we(p===1,47070,{batchId:t.batchId})})));const y=[];for(const b of t.mutations){const E=qS(e,b.key.path,t.batchId);l.push(a.delete(E)),y.push(b.key)}return z.waitFor(l).next((()=>y))}function bm(s){if(!s)return 0;let e;if(s.document)e=s.document;else if(s.unknownDocument)e=s.unknownDocument;else{if(!s.noDocument)throw xe(14731);e=s.noDocument}return JSON.stringify(e).length}jn.DEFAULT_COLLECTION_PERCENTILE=10,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jn.DEFAULT=new jn(JA,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jn.DISABLED=new jn(-1,0,0);class Jm{constructor(e,t,r,a){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=a,this.Zn={}}static wt(e,t,r,a){we(e.uid!=="",64387);const l=e.isAuthenticated()?e.uid:"";return new Jm(l,t,r,a)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ta(e).ee({index:_o,range:r},((a,l,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,r,a){const l=Hl(e),u=ta(e);return u.add({}).next((p=>{we(typeof p=="number",49019);const f=new x_(p,t,r,a),y=(function(N,B,G){const te=G.baseMutations.map((X=>Pd(N.yt,X))),I=G.mutations.map((X=>Pd(N.yt,X)));return{userId:B,batchId:G.batchId,localWriteTimeMs:G.localWriteTime.toMillis(),baseMutations:te,mutations:I}})(this.serializer,this.userId,f),b=[];let E=new ft(((T,N)=>De(T.canonicalString(),N.canonicalString())));for(const T of a){const N=qS(this.userId,T.key.path,p);E=E.add(T.key.path.popLast()),b.push(u.put(y)),b.push(l.put(N,FV))}return E.forEach((T=>{b.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Zn[p]=f.keys()})),z.waitFor(b).next((()=>f))}))}lookupMutationBatch(e,t){return ta(e).get(t).next((r=>r?(we(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),ho(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?z.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const a=r.keys();return this.Zn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=IDBKeyRange.lowerBound([this.userId,r]);let l=null;return ta(e).ee({index:_o,range:a},((u,p,f)=>{p.userId===this.userId&&(we(p.batchId>=r,47524,{Yn:r}),l=ho(this.serializer,p)),f.done()})).next((()=>l))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=da;return ta(e).ee({index:_o,range:t,reverse:!0},((a,l,u)=>{r=l.batchId,u.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,da],[this.userId,Number.POSITIVE_INFINITY]);return ta(e).H(_o,t).next((r=>r.map((a=>ho(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Kf(this.userId,t.path),a=IDBKeyRange.lowerBound(r),l=[];return Hl(e).ee({range:a},((u,p,f)=>{const[y,b,E]=u,T=Ds(b);if(y===this.userId&&t.path.isEqual(T))return ta(e).get(E).next((N=>{if(!N)throw xe(61480,{er:u,batchId:E});we(N.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:N.userId,batchId:E}),l.push(ho(this.serializer,N))}));f.done()})).next((()=>l))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ft(De);const a=[];return t.forEach((l=>{const u=Kf(this.userId,l.path),p=IDBKeyRange.lowerBound(u),f=Hl(e).ee({range:p},((y,b,E)=>{const[T,N,B]=y,G=Ds(N);T===this.userId&&l.path.isEqual(G)?r=r.add(B):E.done()}));a.push(f)})),z.waitFor(a).next((()=>this.tr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1,l=Kf(this.userId,r),u=IDBKeyRange.lowerBound(l);let p=new ft(De);return Hl(e).ee({range:u},((f,y,b)=>{const[E,T,N]=f,B=Ds(T);E===this.userId&&r.isPrefixOf(B)?B.length===a&&(p=p.add(N)):b.done()})).next((()=>this.tr(e,p)))}tr(e,t){const r=[],a=[];return t.forEach((l=>{a.push(ta(e).get(l).next((u=>{if(u===null)throw xe(35274,{batchId:l});we(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:l}),r.push(ho(this.serializer,u))})))})),z.waitFor(a).next((()=>r))}removeMutationBatch(e,t){return ZA(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),z.forEach(r,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return z.resolve();const r=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),a=[];return Hl(e).ee({range:r},((l,u,p)=>{if(l[0]===this.userId){const f=Ds(l[1]);a.push(f)}else p.done()})).next((()=>{we(a.length===0,56720,{rr:a.map((l=>l.canonicalString()))})}))}))}containsKey(e,t){return e1(e,this.userId,t)}ir(e){return t1(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:da,lastStreamToken:""}))}}function e1(s,e,t){const r=Kf(e,t.path),a=r[1],l=IDBKeyRange.lowerBound(r);let u=!1;return Hl(s).ee({range:l,Y:!0},((p,f,y)=>{const[b,E,T]=p;b===e&&E===a&&(u=!0),y.done()})).next((()=>u))}function ta(s){return un(s,Wr)}function Hl(s){return un(s,ic)}function t1(s){return un(s,Id)}class Vo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Vo(0)}static ar(){return new Vo(-1)}}class pM{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const r=new Vo(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Ae.fromTimestamp(new lt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.ur(e).next((a=>(a.highestListenSequenceNumber=t,r&&(a.lastRemoteSnapshotVersion=r.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.cr(e,a))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Ul(e).delete(t.targetId))).next((()=>this.ur(e))).next((r=>(we(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r))))}removeTargets(e,t,r){let a=0;const l=[];return Ul(e).ee(((u,p)=>{const f=Zu(p);f.sequenceNumber<=t&&r.get(f.targetId)===null&&(a++,l.push(this.removeTargetData(e,f)))})).next((()=>z.waitFor(l))).next((()=>a))}forEachTarget(e,t){return Ul(e).ee(((r,a)=>{const l=Zu(a);t(l)}))}ur(e){return _w(e).get(mm).next((t=>(we(t!==null,2888),t)))}cr(e,t){return _w(e).put(mm,t)}lr(e,t){return Ul(e).put(YA(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Co(t),a=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let l=null;return Ul(e).ee({range:a,index:HS},((u,p,f)=>{const y=Zu(p);Yd(t,y.target)&&(l=y,f.done())})).next((()=>l))}addMatchingKeys(e,t,r){const a=[],l=sa(e);return t.forEach((u=>{const p=On(u.path);a.push(l.put({targetId:r,path:p})),a.push(this.referenceDelegate.addReference(e,r,u))})),z.waitFor(a)}removeMatchingKeys(e,t,r){const a=sa(e);return z.forEach(t,(l=>{const u=On(l.path);return z.waitFor([a.delete([r,u]),this.referenceDelegate.removeReference(e,r,l)])}))}removeMatchingKeysForTargetId(e,t){const r=sa(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(a)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),a=sa(e);let l=Be();return a.ee({range:r,Y:!0},((u,p,f)=>{const y=Ds(u[1]),b=new ye(y);l=l.add(b)})).next((()=>l))}containsKey(e,t){const r=On(t.path),a=IDBKeyRange.bound([r],[DS(r)],!1,!0);let l=0;return sa(e).ee({index:u_,Y:!0,range:a},(([u,p],f,y)=>{u!==0&&(l++,y.done())})).next((()=>l>0))}At(e,t){return Ul(e).get(t).next((r=>r?Zu(r):null))}}function Ul(s){return un(s,ac)}function _w(s){return un(s,Io)}function sa(s){return un(s,oc)}const vw="LruGarbageCollector",gM=1048576;function bw([s,e],[t,r]){const a=De(s,t);return a===0?De(e,r):a}class yM{constructor(e){this.Pr=e,this.buffer=new ft(bw),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();bw(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class n1{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ue(vw,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Aa(t)?ue(vw,"Ignoring IndexedDB error during garbage collection: ",t):await Sa(t)}await this.Ar(3e5)}))}}class _M{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return z.resolve(rr.ce);const r=new yM(t);return this.Vr.forEachTarget(e,(a=>r.Er(a.sequenceNumber))).next((()=>this.Vr.mr(e,(a=>r.Er(a))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ue("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(yw)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ue("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yw):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,a,l,u,p,f,y;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(ue("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),a=this.params.maximumSequenceNumbersToCollect):a=E,u=Date.now(),this.nthSequenceNumber(e,a)))).next((E=>(r=E,p=Date.now(),this.removeTargets(e,r,t)))).next((E=>(l=E,f=Date.now(),this.removeOrphanedDocuments(e,r)))).next((E=>(y=Date.now(),zl()<=Qe.DEBUG&&ue("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-b}ms
	Determined least recently used ${a} in `+(p-u)+`ms
	Removed ${l} targets in `+(f-p)+`ms
	Removed ${E} documents in `+(y-f)+`ms
Total Duration: ${y-b}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:E}))))}}function r1(s,e){return new _M(s,e)}class vM{constructor(e,t){this.db=e,this.garbageCollector=r1(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((r,a)=>t(a)))}addReference(e,t,r){return Mf(e,r)}removeReference(e,t,r){return Mf(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Mf(e,t)}wr(e,t){return(function(a,l){let u=!1;return t1(a).te((p=>e1(a,p,l).next((f=>(f&&(u=!0),z.resolve(!f)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let l=0;return this.yr(e,((u,p)=>{if(p<=t){const f=this.wr(e,u).next((y=>{if(!y)return l++,r.getEntry(e,u).next((()=>(r.removeEntry(u,Ae.min()),sa(e).delete((function(E){return[0,On(E.path)]})(u)))))}));a.push(f)}})).next((()=>z.waitFor(a))).next((()=>r.apply(e))).next((()=>l))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Mf(e,t)}yr(e,t){const r=sa(e);let a,l=rr.ce;return r.ee({index:u_},(([u,p],{path:f,sequenceNumber:y})=>{u===0?(l!==rr.ce&&t(new ye(Ds(a)),l),l=y,a=f):l=rr.ce})).next((()=>{l!==rr.ce&&t(new ye(Ds(a)),l)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Mf(s,e){return sa(s).put((function(r,a){return{targetId:0,path:On(r.path),sequenceNumber:a}})(e,s.currentSequenceNumber))}class s1{constructor(){this.changes=new vi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?z.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class bM{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return ao(e).put(r)}removeEntry(e,t,r){return ao(e).delete((function(l,u){const p=l.path.toArray();return[p.slice(0,p.length-2),p[p.length-2],_m(u),p[p.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=wt.newInvalidDocument(t);return ao(e).ee({index:$f,range:IDBKeyRange.only(Hu(t))},((a,l)=>{r=this.Sr(t,l)})).next((()=>r))}Dr(e,t){let r={size:0,document:wt.newInvalidDocument(t)};return ao(e).ee({index:$f,range:IDBKeyRange.only(Hu(t))},((a,l)=>{r={document:this.Sr(t,l),size:bm(l)}})).next((()=>r))}getEntries(e,t){let r=ir();return this.Cr(e,t,((a,l)=>{const u=this.Sr(a,l);r=r.insert(a,u)})).next((()=>r))}vr(e,t){let r=ir(),a=new bt(ye.comparator);return this.Cr(e,t,((l,u)=>{const p=this.Sr(l,u);r=r.insert(l,p),a=a.insert(l,bm(u))})).next((()=>({documents:r,Fr:a})))}Cr(e,t,r){if(t.isEmpty())return z.resolve();let a=new ft(Tw);t.forEach((f=>a=a.add(f)));const l=IDBKeyRange.bound(Hu(a.first()),Hu(a.last())),u=a.getIterator();let p=u.getNext();return ao(e).ee({index:$f,range:l},((f,y,b)=>{const E=ye.fromSegments([...y.prefixPath,y.collectionGroup,y.documentId]);for(;p&&Tw(p,E)<0;)r(p,null),p=u.getNext();p&&p.isEqual(E)&&(r(p,y),p=u.hasNext()?u.getNext():null),p?b.j(Hu(p)):b.done()})).next((()=>{for(;p;)r(p,null),p=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,r,a,l){const u=t.path,p=[u.popLast().toArray(),u.lastSegment(),_m(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ao(e).H(IDBKeyRange.bound(p,f,!0)).next((y=>{l?.incrementDocumentReadCount(y.length);let b=ir();for(const E of y){const T=this.Sr(ye.fromSegments(E.prefixPath.concat(E.collectionGroup,E.documentId)),E);T.isFoundDocument()&&(Xd(t,T)||a.has(T.key))&&(b=b.insert(T.key,T))}return b}))}getAllFromCollectionGroup(e,t,r,a){let l=ir();const u=Ew(t,r),p=Ew(t,br.max());return ao(e).ee({index:FS,range:IDBKeyRange.bound(u,p,!0)},((f,y,b)=>{const E=this.Sr(ye.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);l=l.insert(E.key,E),l.size===a&&b.done()})).next((()=>l))}newChangeBuffer(e){return new xM(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return xw(e).get(Jy).next((t=>(we(!!t,20021),t)))}br(e,t){return xw(e).put(Jy,t)}Sr(e,t){if(t){const r=iM(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ae.min())))return r}return wt.newInvalidDocument(e)}}function i1(s){return new bM(s)}class xM extends s1{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new vi((r=>r.toString()),((r,a)=>r.isEqual(a)))}applyChanges(e){const t=[];let r=0,a=new ft(((l,u)=>De(l.canonicalString(),u.canonicalString())));return this.changes.forEach(((l,u)=>{const p=this.Or.get(l);if(t.push(this.Mr.removeEntry(e,l,p.readTime)),u.isValidDocument()){const f=sw(this.Mr.serializer,u);a=a.add(l.path.popLast());const y=bm(f);r+=y-p.size,t.push(this.Mr.addEntry(e,l,f))}else if(r-=p.size,this.trackRemovals){const f=sw(this.Mr.serializer,u.convertToNoDocument(Ae.min()));t.push(this.Mr.addEntry(e,l,f))}})),a.forEach((l=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,l))})),t.push(this.Mr.updateMetadata(e,r)),z.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((r=>(this.Or.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:r,Fr:a})=>(a.forEach(((l,u)=>{this.Or.set(l,{size:u,readTime:r.get(l).readTime})})),r)))}}function xw(s){return un(s,Sd)}function ao(s){return un(s,fm)}function Hu(s){const e=s.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Ew(s,e){const t=e.documentKey.path.toArray();return[s,_m(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Tw(s,e){const t=s.path.toArray(),r=e.path.toArray();let a=0;for(let l=0;l<t.length-2&&l<r.length-2;++l)if(a=De(t[l],r[l]),a)return a;return a=De(t.length,r.length),a||(a=De(t[t.length-2],r[r.length-2]),a||De(t[t.length-1],r[r.length-1]))}class EM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class a1{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(r!==null&&fd(r.mutation,a,sr.empty(),lt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Be()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Be()){const a=Ps();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,r).next((l=>{let u=Xu();return l.forEach(((p,f)=>{u=u.insert(p,f.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const r=Ps();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Be())))}populateOverlays(e,t,r){const a=[];return r.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,p)=>{t.set(u,p)}))}))}computeViews(e,t,r,a){let l=ir();const u=hd(),p=(function(){return hd()})();return t.forEach(((f,y)=>{const b=r.get(y.key);a.has(y.key)&&(b===void 0||b.mutation instanceof bi)?l=l.insert(y.key,y):b!==void 0?(u.set(y.key,b.mutation.getFieldMask()),fd(b.mutation,y,b.mutation.getFieldMask(),lt.now())):u.set(y.key,sr.empty())})),this.recalculateAndSaveOverlays(e,l).next((f=>(f.forEach(((y,b)=>u.set(y,b))),t.forEach(((y,b)=>p.set(y,new EM(b,u.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,t){const r=hd();let a=new bt(((u,p)=>u-p)),l=Be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const p of u)p.keys().forEach((f=>{const y=t.get(f);if(y===null)return;let b=r.get(f)||sr.empty();b=p.applyToLocalView(y,b),r.set(f,b);const E=(a.get(p.batchId)||Be()).add(f);a=a.insert(p.batchId,E)}))})).next((()=>{const u=[],p=a.getReverseIterator();for(;p.hasNext();){const f=p.getNext(),y=f.key,b=f.value,E=xA();b.forEach((T=>{if(!l.has(T)){const N=NA(t.get(T),r.get(T));N!==null&&E.set(T,N),l=l.add(T)}})),u.push(this.documentOverlayCache.saveOverlays(e,y,E))}return z.waitFor(u)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,a){return AO(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):y_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-l.size):z.resolve(Ps());let p=sc,f=l;return u.next((y=>z.forEach(y,((b,E)=>(p<E.largestBatchId&&(p=E.largestBatchId),l.get(b)?z.resolve():this.remoteDocumentCache.getEntry(e,b).next((T=>{f=f.insert(b,T)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,f,y,Be()))).next((b=>({batchId:p,changes:bA(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ye(t)).next((r=>{let a=Xu();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const l=t.collectionGroup;let u=Xu();return this.indexManager.getCollectionParents(e,l).next((p=>z.forEach(p,(f=>{const y=(function(E,T){return new _i(T,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,f.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,r,a).next((b=>{b.forEach(((E,T)=>{u=u.insert(E,T)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,r,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,l,a)))).next((u=>{l.forEach(((f,y)=>{const b=y.getKey();u.get(b)===null&&(u=u.insert(b,wt.newInvalidDocument(b)))}));let p=Xu();return u.forEach(((f,y)=>{const b=l.get(f);b!==void 0&&fd(b.mutation,y,sr.empty(),lt.now()),Xd(t,y)&&(p=p.insert(f,y))})),p}))}}class TM{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return z.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Gt(a.createTime)}})(t)),z.resolve()}getNamedQuery(e,t){return z.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(a){return{name:a.name,query:S_(a.bundledQuery),readTime:Gt(a.readTime)}})(t)),z.resolve()}}class wM{constructor(){this.overlays=new bt(ye.comparator),this.Lr=new Map}getOverlay(e,t){return z.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ps();return z.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&r.set(a,l)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((a,l)=>{this.bt(e,t,l)})),z.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.Lr.get(r);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(r)),z.resolve()}getOverlaysForCollection(e,t,r){const a=Ps(),l=t.length+1,u=new ye(t.child("")),p=this.overlays.getIteratorFrom(u);for(;p.hasNext();){const f=p.getNext().value,y=f.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&f.largestBatchId>r&&a.set(f.getKey(),f)}return z.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let l=new bt(((y,b)=>y-b));const u=this.overlays.getIterator();for(;u.hasNext();){const y=u.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>r){let b=l.get(y.largestBatchId);b===null&&(b=Ps(),l=l.insert(y.largestBatchId,b)),b.set(y.getKey(),y)}}const p=Ps(),f=l.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((y,b)=>p.set(y,b))),!(p.size()>=a)););return z.resolve(p)}bt(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const u=this.Lr.get(a.largestBatchId).delete(r.key);this.Lr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new T_(t,r));let l=this.Lr.get(t);l===void 0&&(l=Be(),this.Lr.set(t,l)),this.Lr.set(t,l.add(r.key))}}class IM{constructor(){this.sessionToken=Mt.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,z.resolve()}}class R_{constructor(){this.kr=new ft(pn.Kr),this.qr=new ft(pn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const r=new pn(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new pn(e,t))}Qr(e,t){e.forEach((r=>this.removeReference(r,t)))}Gr(e){const t=new ye(new Ke([])),r=new pn(t,e),a=new pn(t,e+1),l=[];return this.qr.forEachInRange([r,a],(u=>{this.Wr(u),l.push(u.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ye(new Ke([])),r=new pn(t,e),a=new pn(t,e+1);let l=Be();return this.qr.forEachInRange([r,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new pn(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class pn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ye.comparator(e.key,t.key)||De(e.Hr,t.Hr)}static Ur(e,t){return De(e.Hr,t.Hr)||ye.comparator(e.key,t.key)}}class SM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new ft(pn.Kr)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new x_(l,t,r,a);this.mutationQueue.push(u);for(const p of a)this.Jr=this.Jr.add(new pn(p.key,l)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return z.resolve(u)}lookupMutationBatch(e,t){return z.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.Xr(r),l=a<0?0:a;return z.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?da:this.Yn-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new pn(t,0),a=new pn(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([r,a],(u=>{const p=this.Zr(u.Hr);l.push(p)})),z.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ft(De);return t.forEach((a=>{const l=new pn(a,0),u=new pn(a,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,u],(p=>{r=r.add(p.Hr)}))})),z.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let l=r;ye.isDocumentKey(l)||(l=l.child(""));const u=new pn(new ye(l),0);let p=new ft(De);return this.Jr.forEachWhile((f=>{const y=f.key.path;return!!r.isPrefixOf(y)&&(y.length===a&&(p=p.add(f.Hr)),!0)}),u),z.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((r=>{const a=this.Zr(r);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){we(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return z.forEach(t.mutations,(a=>{const l=new pn(a.key,t.batchId);return r=r.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,t){const r=new pn(t,0),a=this.Jr.firstAfterOrEqual(r);return z.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class AM{constructor(e){this.ti=e,this.docs=(function(){return new bt(ye.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),l=a?a.size:0,u=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return z.resolve(r?r.document.mutableCopy():wt.newInvalidDocument(t))}getEntries(e,t){let r=ir();return t.forEach((a=>{const l=this.docs.get(a);r=r.insert(a,l?l.document.mutableCopy():wt.newInvalidDocument(a))})),z.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let l=ir();const u=t.path,p=new ye(u.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(p);for(;f.hasNext();){const{key:y,value:{document:b}}=f.getNext();if(!u.isPrefixOf(y.path))break;y.path.length>u.length+1||l_(MS(b),r)<=0||(a.has(b.key)||Xd(t,b))&&(l=l.insert(b.key,b.mutableCopy()))}return z.resolve(l)}getAllFromCollectionGroup(e,t,r,a){xe(9500)}ni(e,t){return z.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new NM(this)}getSize(e){return z.resolve(this.size)}}class NM extends s1{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?t.push(this.Mr.addEntry(e,a)):this.Mr.removeEntry(r)})),z.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class RM{constructor(e){this.persistence=e,this.ri=new vi((t=>Co(t)),Yd),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this.ii=0,this.si=new R_,this.targetCount=0,this.oi=Vo._r()}forEachTarget(e,t){return this.ri.forEach(((r,a)=>t(a))),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),z.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Vo(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,z.resolve()}updateTargetData(e,t){return this.lr(t),z.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,t,r){let a=0;const l=[];return this.ri.forEach(((u,p)=>{p.sequenceNumber<=t&&r.get(p.targetId)===null&&(this.ri.delete(u),l.push(this.removeMatchingKeysForTargetId(e,p.targetId)),a++)})),z.waitFor(l).next((()=>a))}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,t){const r=this.ri.get(t)||null;return z.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),z.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),z.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),z.resolve()}getMatchingKeysForTargetId(e,t){const r=this.si.jr(t);return z.resolve(r)}containsKey(e,t){return z.resolve(this.si.containsKey(t))}}class C_{constructor(e,t){this._i={},this.overlays={},this.ai=new rr(0),this.ui=!1,this.ui=!0,this.ci=new IM,this.referenceDelegate=e(this),this.li=new RM(this),this.indexManager=new fM,this.remoteDocumentCache=(function(a){return new AM(a)})((r=>this.referenceDelegate.hi(r))),this.serializer=new $A(t),this.Pi=new TM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new wM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new SM(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){ue("MemoryPersistence","Starting transaction:",e);const a=new CM(this.ai.next());return this.referenceDelegate.Ti(),r(a).next((l=>this.referenceDelegate.Ii(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return z.or(Object.values(this._i).map((r=>()=>r.containsKey(e,t))))}}class CM extends US{constructor(e){super(),this.currentSequenceNumber=e}}class Zm{constructor(e){this.persistence=e,this.Ri=new R_,this.Ai=null}static Vi(e){return new Zm(e)}get di(){if(this.Ai)return this.Ai;throw xe(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),z.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),z.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((a=>this.di.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.di.add(l.toString())))})).next((()=>r.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.di,(r=>{const a=ye.fromPath(r);return this.mi(e,a).next((l=>{l||t.removeEntry(a,Ae.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return z.or([()=>z.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class xm{constructor(e,t){this.persistence=e,this.fi=new vi((r=>On(r.path)),((r,a)=>r.isEqual(a))),this.garbageCollector=r1(this,t)}static Vi(e,t){return new xm(e,t)}Ti(){}Ii(e){return z.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}mr(e,t){return z.forEach(this.fi,((r,a)=>this.wr(e,r,a).next((l=>l?z.resolve():t(a)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ni(e,(u=>this.wr(e,u,t).next((p=>{p||(r++,l.removeEntry(u,Ae.min()))})))).next((()=>l.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),z.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),z.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),z.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wf(e.data.value)),t}wr(e,t,r){return z.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.fi.get(t);return z.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class kM{constructor(e){this.serializer=e}k(e,t,r,a){const l=new qm("createOrUpgrade",t);r<1&&a>=1&&((function(f){f.createObjectStore($d)})(e),(function(f){f.createObjectStore(Id,{keyPath:qV}),f.createObjectStore(Wr,{keyPath:jT,autoIncrement:!0}).createIndex(_o,VT,{unique:!0}),f.createObjectStore(ic)})(e),ww(e),(function(f){f.createObjectStore(co)})(e));let u=z.resolve();return r<3&&a>=3&&(r!==0&&((function(f){f.deleteObjectStore(oc),f.deleteObjectStore(ac),f.deleteObjectStore(Io)})(e),ww(e)),u=u.next((()=>(function(f){const y=f.store(Io),b={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ae.min().toTimestamp(),targetCount:0};return y.put(mm,b)})(l)))),r<4&&a>=4&&(r!==0&&(u=u.next((()=>(function(f,y){return y.store(Wr).H().next((E=>{f.deleteObjectStore(Wr),f.createObjectStore(Wr,{keyPath:jT,autoIncrement:!0}).createIndex(_o,VT,{unique:!0});const T=y.store(Wr),N=E.map((B=>T.put(B)));return z.waitFor(N)}))})(e,l)))),u=u.next((()=>{(function(f){f.createObjectStore(lc,{keyPath:XV})})(e)}))),r<5&&a>=5&&(u=u.next((()=>this.gi(l)))),r<6&&a>=6&&(u=u.next((()=>((function(f){f.createObjectStore(Sd)})(e),this.pi(l))))),r<7&&a>=7&&(u=u.next((()=>this.yi(l)))),r<8&&a>=8&&(u=u.next((()=>this.wi(e,l)))),r<9&&a>=9&&(u=u.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&a>=10&&(u=u.next((()=>this.bi(l)))),r<11&&a>=11&&(u=u.next((()=>{(function(f){f.createObjectStore(Fm,{keyPath:JV})})(e),(function(f){f.createObjectStore(Hm,{keyPath:ZV})})(e)}))),r<12&&a>=12&&(u=u.next((()=>{(function(f){const y=f.createObjectStore(Gm,{keyPath:aO});y.createIndex(e0,oO,{unique:!1}),y.createIndex(KS,lO,{unique:!1})})(e)}))),r<13&&a>=13&&(u=u.next((()=>(function(f){const y=f.createObjectStore(fm,{keyPath:HV});y.createIndex($f,GV),y.createIndex(FS,QV)})(e))).next((()=>this.Si(e,l))).next((()=>e.deleteObjectStore(co)))),r<14&&a>=14&&(u=u.next((()=>this.Di(e,l)))),r<15&&a>=15&&(u=u.next((()=>(function(f){f.createObjectStore(d_,{keyPath:eO,autoIncrement:!0}).createIndex(Zy,tO,{unique:!1}),f.createObjectStore(cd,{keyPath:nO}).createIndex(GS,rO,{unique:!1}),f.createObjectStore(ud,{keyPath:sO}).createIndex(QS,iO,{unique:!1})})(e)))),r<16&&a>=16&&(u=u.next((()=>{t.objectStore(cd).clear()})).next((()=>{t.objectStore(ud).clear()}))),r<17&&a>=17&&(u=u.next((()=>{(function(f){f.createObjectStore(h_,{keyPath:cO})})(e)}))),r<18&&a>=18&&dI()&&(u=u.next((()=>{t.objectStore(cd).clear()})).next((()=>{t.objectStore(ud).clear()}))),u}pi(e){let t=0;return e.store(co).ee(((r,a)=>{t+=bm(a)})).next((()=>{const r={byteSize:t};return e.store(Sd).put(Jy,r)}))}gi(e){const t=e.store(Id),r=e.store(Wr);return t.H().next((a=>z.forEach(a,(l=>{const u=IDBKeyRange.bound([l.userId,da],[l.userId,l.lastAcknowledgedBatchId]);return r.H(_o,u).next((p=>z.forEach(p,(f=>{we(f.userId===l.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const y=ho(this.serializer,f);return ZA(e,l.userId,y).next((()=>{}))}))))}))))}yi(e){const t=e.store(oc),r=e.store(co);return e.store(Io).get(mm).next((a=>{const l=[];return r.ee(((u,p)=>{const f=new Ke(u),y=(function(E){return[0,On(E)]})(f);l.push(t.get(y).next((b=>b?z.resolve():(E=>t.put({targetId:0,path:On(E),sequenceNumber:a.highestListenSequenceNumber}))(f))))})).next((()=>z.waitFor(l)))}))}wi(e,t){e.createObjectStore(Ad,{keyPath:WV});const r=t.store(Ad),a=new N_,l=u=>{if(a.add(u)){const p=u.lastSegment(),f=u.popLast();return r.put({collectionId:p,parent:On(f)})}};return t.store(co).ee({Y:!0},((u,p)=>{const f=new Ke(u);return l(f.popLast())})).next((()=>t.store(ic).ee({Y:!0},(([u,p,f],y)=>{const b=Ds(p);return l(b.popLast())}))))}bi(e){const t=e.store(ac);return t.ee(((r,a)=>{const l=Zu(a),u=YA(this.serializer,l);return t.put(u)}))}Si(e,t){const r=t.store(co),a=[];return r.ee(((l,u)=>{const p=t.store(fm),f=(function(E){return E.document?new ye(Ke.fromString(E.document.name).popFirst(5)):E.noDocument?ye.fromSegments(E.noDocument.path):E.unknownDocument?ye.fromSegments(E.unknownDocument.path):xe(36783)})(u).path.toArray(),y={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};a.push(p.put(y))})).next((()=>z.waitFor(a)))}Di(e,t){const r=t.store(Wr),a=i1(this.serializer),l=new C_(Zm.Vi,this.serializer.yt);return r.H().next((u=>{const p=new Map;return u.forEach((f=>{let y=p.get(f.userId)??Be();ho(this.serializer,f).keys().forEach((b=>y=y.add(b))),p.set(f.userId,y)})),z.forEach(p,((f,y)=>{const b=new gn(y),E=Xm.wt(this.serializer,b),T=l.getIndexManager(b),N=Jm.wt(b,this.serializer,T,l.referenceDelegate);return new a1(a,N,E,T).recalculateAndSaveOverlaysForDocumentKeys(new t0(t,rr.ce),f).next()}))}))}}function ww(s){s.createObjectStore(oc,{keyPath:$V}).createIndex(u_,YV,{unique:!0}),s.createObjectStore(ac,{keyPath:"targetId"}).createIndex(HS,KV,{unique:!0}),s.createObjectStore(Io)}const na="IndexedDbPersistence",Ay=18e5,Ny=5e3,Ry="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",o1="main";class k_{constructor(e,t,r,a,l,u,p,f,y,b,E=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=l,this.window=u,this.document=p,this.Fi=y,this.Mi=b,this.xi=E,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=T=>Promise.resolve(),!k_.v())throw new le(W.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new vM(this,a),this.Ki=t+o1,this.serializer=new $A(f),this.qi=new Vs(this.Ki,this.xi,new kM(this.serializer)),this.ci=new oM,this.li=new pM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=i1(this.serializer),this.Pi=new aM,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,b===!1&&Ht(na,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new le(W.FAILED_PRECONDITION,Ry);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new rr(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Lf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(Aa(e))return ue(na,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ue(na,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Gu(e).get(jl).next((t=>z.resolve(this.Xi(t))))}Yi(e){return Lf(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Ay)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=un(t,lc);return r.H().next((a=>{const l=this.ns(a,Ay),u=a.filter((p=>l.indexOf(p)===-1));return z.forEach(u,(p=>r.delete(p.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?z.resolve(!0):Gu(e).get(jl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Ny)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new le(W.FAILED_PRECONDITION,Ry);return!1}}return!(!this.networkEnabled||!this.inForeground)||Lf(e).H().next((r=>this.ns(r,Ny).find((a=>{if(this.clientId!==a.clientId){const l=!this.networkEnabled&&a.networkEnabled,u=!this.inForeground&&a.inForeground,p=this.networkEnabled===a.networkEnabled;if(l||u&&p)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ue(na,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[$d,lc],(e=>{const t=new t0(e,rr.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((r=>this.ts(r.updateTimeMs,t)&&!this.ss(r.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Lf(e).H().next((t=>this.ns(t,Ay).map((r=>r.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return Jm.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new mM(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Xm.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){ue(na,"Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",l=(function(f){return f===18?hO:f===17?XS:f===16?dO:f===15?f_:f===14?WS:f===13?YS:f===12?uO:f===11?$S:void xe(60245)})(this.xi);let u;return this.qi.runTransaction(e,a,l,(p=>(u=new t0(p,this.ai?this.ai.next():rr.ce),t==="readwrite-primary"?this.ji(u).next((f=>!!f||this.Hi(u))).next((f=>{if(!f)throw Ht(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new le(W.FAILED_PRECONDITION,LS);return r(u)})).next((f=>this.Zi(u).next((()=>f)))):this.Ps(u).next((()=>r(u)))))).then((p=>(u.raiseOnCommittedEvent(),p)))}Ps(e){return Gu(e).get(jl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,Ny)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new le(W.FAILED_PRECONDITION,Ry)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Gu(e).put(jl,t)}static v(){return Vs.v()}Ji(e){const t=Gu(e);return t.get(jl).next((r=>this.Xi(r)?(ue(na,"Releasing primary lease."),t.delete(jl)):z.resolve()))}ts(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Ht(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;uI()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const t=this.Ui?.getItem(this.rs(e))!==null;return ue(na,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Ht(na,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Ht("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Gu(s){return un(s,$d)}function Lf(s){return un(s,lc)}function D_(s,e){let t=s.projectId;return s.isDefaultDatabase||(t+="."+s.database),"firestore/"+e+"/"+t+"/"}class P_{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=a}static Es(e,t){let r=Be(),a=Be();for(const l of t.docChanges)switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new P_(e,t.fromCache,r,a)}}class DM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class l1{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return uI()?8:zS(Pt())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,a){const l={result:null};return this.gs(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ps(e,t,a,r).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new DM;return this.ys(e,t,u).next((p=>{if(l.result=p,this.As)return this.ws(e,t,u,p.size)}))})).next((()=>l.result))}ws(e,t,r,a){return r.documentReadCount<this.Vs?(zl()<=Qe.DEBUG&&ue("QueryEngine","SDK will not create cache indexes for query:",Bl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),z.resolve()):(zl()<=Qe.DEBUG&&ue("QueryEngine","Query:",Bl(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.ds*a?(zl()<=Qe.DEBUG&&ue("QueryEngine","The SDK decides to create cache indexes for query:",Bl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hn(t))):z.resolve())}gs(e,t){if($T(t))return z.resolve(null);let r=Hn(t);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=ym(t,null,"F"),r=Hn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((l=>{const u=Be(...l);return this.fs.getDocuments(e,u).next((p=>this.indexManager.getMinOffset(e,r).next((f=>{const y=this.bs(t,p);return this.Ss(t,y,u,f.readTime)?this.gs(e,ym(t,null,"F")):this.Ds(e,y,t,f)}))))})))))}ps(e,t,r,a){return $T(t)||a.isEqual(Ae.min())?z.resolve(null):this.fs.getDocuments(e,r).next((l=>{const u=this.bs(t,l);return this.Ss(t,u,r,a)?z.resolve(null):(zl()<=Qe.DEBUG&&ue("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Bl(t)),this.Ds(e,u,t,OS(a,sc)).next((p=>p)))}))}bs(e,t){let r=new ft(_A(e));return t.forEach(((a,l)=>{Xd(e,l)&&(r=r.add(l))})),r}Ss(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ys(e,t,r){return zl()<=Qe.DEBUG&&ue("QueryEngine","Using full collection scan to execute query:",Bl(t)),this.fs.getDocumentsMatchingQuery(e,t,br.min(),r)}Ds(e,t,r,a){return this.fs.getDocumentsMatchingQuery(e,r,a).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}const j_="LocalStore",PM=3e8;class jM{constructor(e,t,r,a){this.persistence=e,this.Cs=t,this.serializer=a,this.vs=new bt(De),this.Fs=new vi((l=>Co(l)),Yd),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new a1(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function c1(s,e,t,r){return new jM(s,e,t,r)}async function u1(s,e){const t=ve(s);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next((l=>(a=l,t.Os(e),t.mutationQueue.getAllMutationBatches(r)))).next((l=>{const u=[],p=[];let f=Be();for(const y of a){u.push(y.batchId);for(const b of y.mutations)f=f.add(b.key)}for(const y of l){p.push(y.batchId);for(const b of y.mutations)f=f.add(b.key)}return t.localDocuments.getDocuments(r,f).next((y=>({Ns:y,removedBatchIds:u,addedBatchIds:p})))}))}))}function VM(s,e){const t=ve(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,f,y,b){const E=y.batch,T=E.keys();let N=z.resolve();return T.forEach((B=>{N=N.next((()=>b.getEntry(f,B))).next((G=>{const te=y.docVersions.get(B);we(te!==null,48541),G.version.compareTo(te)<0&&(E.applyToRemoteDocument(G,y),G.isValidDocument()&&(G.setReadTime(y.commitVersion),b.addEntry(G)))}))})),N.next((()=>p.mutationQueue.removeMutationBatch(f,E)))})(t,r,e,l).next((()=>l.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(p){let f=Be();for(let y=0;y<p.mutationResults.length;++y)p.mutationResults[y].transformResults.length>0&&(f=f.add(p.batch.mutations[y].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(r,a)))}))}function d1(s){const e=ve(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function OM(s,e){const t=ve(s),r=e.snapshotVersion;let a=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.xs.newChangeBuffer({trackRemovals:!0});a=t.vs;const p=[];e.targetChanges.forEach(((b,E)=>{const T=a.get(E);if(!T)return;p.push(t.li.removeMatchingKeys(l,b.removedDocuments,E).next((()=>t.li.addMatchingKeys(l,b.addedDocuments,E))));let N=T.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(E)!==null?N=N.withResumeToken(Mt.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):b.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(b.resumeToken,r)),a=a.insert(E,N),(function(G,te,I){return G.resumeToken.approximateByteSize()===0||te.snapshotVersion.toMicroseconds()-G.snapshotVersion.toMicroseconds()>=PM?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0})(T,N,b)&&p.push(t.li.updateTargetData(l,N))}));let f=ir(),y=Be();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(l,b))})),p.push(h1(l,u,e.documentUpdates).next((b=>{f=b.Bs,y=b.Ls}))),!r.isEqual(Ae.min())){const b=t.li.getLastRemoteSnapshotVersion(l).next((E=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,r)));p.push(b)}return z.waitFor(p).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,f,y))).next((()=>f))})).then((l=>(t.vs=a,l)))}function h1(s,e,t){let r=Be(),a=Be();return t.forEach((l=>r=r.add(l))),e.getEntries(s,r).next((l=>{let u=ir();return t.forEach(((p,f)=>{const y=l.get(p);f.isFoundDocument()!==y.isFoundDocument()&&(a=a.add(p)),f.isNoDocument()&&f.version.isEqual(Ae.min())?(e.removeEntry(p,f.readTime),u=u.insert(p,f)):!y.isValidDocument()||f.version.compareTo(y.version)>0||f.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(f),u=u.insert(p,f)):ue(j_,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",f.version)})),{Bs:u,Ls:a}}))}function MM(s,e){const t=ve(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=da),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function pc(s,e){const t=ve(s);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return t.li.getTargetData(r,e).next((l=>l?(a=l,z.resolve(a)):t.li.allocateTargetId(r).next((u=>(a=new ci(e,u,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=t.vs.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r}))}async function gc(s,e,t){const r=ve(s),a=r.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",l,(u=>r.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!Aa(u))throw u;ue(j_,`Failed to update sequence numbers for target ${e}: ${u}`)}r.vs=r.vs.remove(e),r.Fs.delete(a.target)}function Em(s,e,t){const r=ve(s);let a=Ae.min(),l=Be();return r.persistence.runTransaction("Execute query","readwrite",(u=>(function(f,y,b){const E=ve(f),T=E.Fs.get(b);return T!==void 0?z.resolve(E.vs.get(T)):E.li.getTargetData(y,b)})(r,u,Hn(e)).next((p=>{if(p)return a=p.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(u,p.targetId).next((f=>{l=f}))})).next((()=>r.Cs.getDocumentsMatchingQuery(u,e,t?a:Ae.min(),t?l:Be()))).next((p=>(p1(r,yA(e),p),{documents:p,ks:l})))))}function f1(s,e){const t=ve(s),r=ve(t.li),a=t.vs.get(e);return a?Promise.resolve(a.target):t.persistence.runTransaction("Get target data","readonly",(l=>r.At(l,e).next((u=>u?u.target:null))))}function m1(s,e){const t=ve(s),r=t.Ms.get(e)||Ae.min();return t.persistence.runTransaction("Get new document changes","readonly",(a=>t.xs.getAllFromCollectionGroup(a,e,OS(r,sc),Number.MAX_SAFE_INTEGER))).then((a=>(p1(t,e,a),a)))}function p1(s,e,t){let r=s.Ms.get(e)||Ae.min();t.forEach(((a,l)=>{l.readTime.compareTo(r)>0&&(r=l.readTime)})),s.Ms.set(e,r)}async function LM(s,e,t,r){const a=ve(s);let l=Be(),u=ir();for(const y of t){const b=e.Ks(y.metadata.name);y.document&&(l=l.add(b));const E=e.qs(y);E.setReadTime(e.Us(y.metadata.readTime)),u=u.insert(b,E)}const p=a.xs.newChangeBuffer({trackRemovals:!0}),f=await pc(a,(function(b){return Hn(Nc(Ke.fromString(`__bundle__/docs/${b}`)))})(r));return a.persistence.runTransaction("Apply bundle documents","readwrite",(y=>h1(y,p,u).next((b=>(p.apply(y),b))).next((b=>a.li.removeMatchingKeysForTargetId(y,f.targetId).next((()=>a.li.addMatchingKeys(y,l,f.targetId))).next((()=>a.localDocuments.getLocalViewOfDocuments(y,b.Bs,b.Ls))).next((()=>b.Bs))))))}async function UM(s,e,t=Be()){const r=await pc(s,Hn(S_(e.bundledQuery))),a=ve(s);return a.persistence.runTransaction("Save named query","readwrite",(l=>{const u=Gt(e.readTime);if(r.snapshotVersion.compareTo(u)>=0)return a.Pi.saveNamedQuery(l,e);const p=r.withResumeToken(Mt.EMPTY_BYTE_STRING,u);return a.vs=a.vs.insert(p.targetId,p),a.li.updateTargetData(l,p).next((()=>a.li.removeMatchingKeysForTargetId(l,r.targetId))).next((()=>a.li.addMatchingKeys(l,t,r.targetId))).next((()=>a.Pi.saveNamedQuery(l,e)))}))}const g1="firestore_clients";function Iw(s,e){return`${g1}_${s}_${e}`}const y1="firestore_mutations";function Sw(s,e,t){let r=`${y1}_${s}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const _1="firestore_targets";function Cy(s,e){return`${_1}_${s}_${e}`}const Ss="SharedClientState";class Tm{constructor(e,t,r,a){this.user=e,this.batchId=t,this.state=r,this.error=a}static $s(e,t,r){const a=JSON.parse(r);let l,u=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return u&&a.error&&(u=typeof a.error.message=="string"&&typeof a.error.code=="string",u&&(l=new le(a.error.code,a.error.message))),u?new Tm(e,t,a.state,l):(Ht(Ss,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class md{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){const r=JSON.parse(t);let a,l=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return l&&r.error&&(l=typeof r.error.message=="string"&&typeof r.error.code=="string",l&&(a=new le(r.error.code,r.error.message))),l?new md(e,r.state,a):(Ht(Ss,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class wm{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const r=JSON.parse(t);let a=typeof r=="object"&&r.activeTargetIds instanceof Array,l=__();for(let u=0;a&&u<r.activeTargetIds.length;++u)a=BS(r.activeTargetIds[u]),l=l.add(r.activeTargetIds[u]);return a?new wm(e,l):(Ht(Ss,`Failed to parse client data for instance '${e}': ${t}`),null)}}class V_{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new V_(t.clientId,t.onlineState):(Ht(Ss,`Failed to parse online state: ${e}`),null)}}class g0{constructor(){this.activeTargetIds=__()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ky{constructor(e,t,r,a,l){this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new bt(De),this.started=!1,this.Zs=[];const u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=l,this.Xs=Iw(this.persistenceKey,this.zs),this.Ys=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new g0),this.eo=new RegExp(`^${g1}_${u}_([^_]*)$`),this.no=new RegExp(`^${y1}_${u}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${_1}_${u}_(\\d+)$`),this.io=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this.so=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const a=this.getItem(Iw(this.persistenceKey,r));if(a){const l=wm.$s(r,a);l&&(this.Js=this.Js.insert(l.clientId,l))}}this.oo();const t=this.storage.getItem(this.io);if(t){const r=this._o(t);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((r,a)=>{a.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const a=this.storage.getItem(Cy(this.persistenceKey,e));if(a){const l=md.$s(e,a);l&&(r=l.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Cy(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach((a=>{this.lo(a)})),this.currentUser=e,r.forEach((a=>{this.addPendingMutation(a)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ue(Ss,"READ",e,t),t}setItem(e,t){ue(Ss,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ue(Ss,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(ue(Ss,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Ht("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const r=this.Eo(t.key);return this.Ro(r,null)}{const r=this.Ao(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(t.key)){if(t.newValue!==null){const r=this.Vo(t.key,t.newValue);if(r)return this.mo(r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(t.key===this.io){if(t.newValue!==null){const r=this._o(t.newValue);if(r)return this.ao(r)}}else if(t.key===this.Ys){const r=(function(l){let u=rr.ce;if(l!=null)try{const p=JSON.parse(l);we(typeof p=="number",30636,{yo:l}),u=p}catch(p){Ht(Ss,"Failed to read sequence number from WebStorage",p)}return u})(t.newValue);r!==rr.ce&&this.sequenceNumberHandler(r)}else if(t.key===this.so){const r=this.wo(t.newValue);await Promise.all(r.map((a=>this.syncEngine.bo(a))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){const a=new Tm(this.currentUser,e,t,r),l=Sw(this.persistenceKey,this.currentUser,e);this.setItem(l,a.Ws())}lo(e){const t=Sw(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){const a=Cy(this.persistenceKey,e),l=new md(e,t,r);this.setItem(a,l.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const r=this.Eo(e);return wm.$s(r,t)}Vo(e,t){const r=this.no.exec(e),a=Number(r[1]),l=r[2]!==void 0?r[2]:null;return Tm.$s(new gn(l),a,t)}fo(e,t){const r=this.ro.exec(e),a=Number(r[1]);return md.$s(a,t)}_o(e){return V_.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);ue(Ss,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const r=t?this.Js.insert(e,t):this.Js.remove(e),a=this.uo(this.Js),l=this.uo(r),u=[],p=[];return l.forEach((f=>{a.has(f)||u.push(f)})),a.forEach((f=>{l.has(f)||p.push(f)})),this.syncEngine.Co(u,p).then((()=>{this.Js=r}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=__();return e.forEach(((r,a)=>{t=t.unionWith(a.activeTargetIds)})),t}}class v1{constructor(){this.vo=new g0,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new g0,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class zM{Mo(e){}shutdown(){}}const Aw="ConnectivityMonitor";class Nw{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ue(Aw,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ue(Aw,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Uf=null;function y0(){return Uf===null?Uf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Uf++,"0x"+Uf.toString(16)}const Dy="RestConnection",BM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class qM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${a}`,this.$o=this.databaseId.database===n0?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Wo(e,t,r,a,l){const u=y0(),p=this.Qo(e,t.toUriEncodedString());ue(Dy,`Sending RPC '${e}' ${u}:`,p,r);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(f,a,l);const{host:y}=new URL(p),b=Ec(y);return this.zo(e,p,f,r,b).then((E=>(ue(Dy,`Received RPC '${e}' ${u}: `,E),E)),(E=>{throw zs(Dy,`RPC '${e}' ${u} failed with error: `,E,"url: ",p,"request:",r),E}))}jo(e,t,r,a,l,u){return this.Wo(e,t,r,a,l)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ac})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),r&&r.headers.forEach(((a,l)=>e[l]=a))}Qo(e,t){const r=BM[e];let a=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(a=`${a}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),a}terminate(){}}class FM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Pn="WebChannelConnection",Qu=(s,e,t)=>{s.listen(e,(r=>{try{t(r)}catch(a){setTimeout((()=>{throw a}),0)}}))};class Xl extends qM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Xl.c_){const e=NS();Qu(e,AS.STAT_EVENT,(t=>{t.stat===Yy.PROXY?ue(Pn,"STAT_EVENT: detected buffering proxy"):t.stat===Yy.NOPROXY&&ue(Pn,"STAT_EVENT: detected no buffering proxy")})),Xl.c_=!0}}zo(e,t,r,a,l){const u=y0();return new Promise(((p,f)=>{const y=new IS;y.setWithCredentials(!0),y.listenOnce(SS.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Gf.NO_ERROR:const E=y.getResponseJson();ue(Pn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(E)),p(E);break;case Gf.TIMEOUT:ue(Pn,`RPC '${e}' ${u} timed out`),f(new le(W.DEADLINE_EXCEEDED,"Request time out"));break;case Gf.HTTP_ERROR:const T=y.getStatus();if(ue(Pn,`RPC '${e}' ${u} failed with status:`,T,"response text:",y.getResponseText()),T>0){let N=y.getResponseJson();Array.isArray(N)&&(N=N[0]);const B=N?.error;if(B&&B.status&&B.message){const G=(function(I){const X=I.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(X)>=0?X:W.UNKNOWN})(B.status);f(new le(G,B.message))}else f(new le(W.UNKNOWN,"Server responded with status "+y.getStatus()))}else f(new le(W.UNAVAILABLE,"Connection failed."));break;default:xe(9055,{l_:e,streamId:u,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ue(Pn,`RPC '${e}' ${u} completed.`)}}));const b=JSON.stringify(a);ue(Pn,`RPC '${e}' ${u} sending request:`,a),y.send(t,"POST",b,r,15)}))}T_(e,t,r){const a=y0(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(p.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,r),p.encodeInitMessageHeaders=!0;const y=l.join("");ue(Pn,`Creating RPC '${e}' stream ${a}: ${y}`,p);const b=u.createWebChannel(y,p);this.I_(b);let E=!1,T=!1;const N=new FM({Ho:B=>{T?ue(Pn,`Not sending because RPC '${e}' stream ${a} is closed:`,B):(E||(ue(Pn,`Opening RPC '${e}' stream ${a} transport.`),b.open(),E=!0),ue(Pn,`RPC '${e}' stream ${a} sending:`,B),b.send(B))},Jo:()=>b.close()});return Qu(b,Wu.EventType.OPEN,(()=>{T||(ue(Pn,`RPC '${e}' stream ${a} transport opened.`),N.i_())})),Qu(b,Wu.EventType.CLOSE,(()=>{T||(T=!0,ue(Pn,`RPC '${e}' stream ${a} transport closed`),N.o_(),this.E_(b))})),Qu(b,Wu.EventType.ERROR,(B=>{T||(T=!0,zs(Pn,`RPC '${e}' stream ${a} transport errored. Name:`,B.name,"Message:",B.message),N.o_(new le(W.UNAVAILABLE,"The operation could not be completed")))})),Qu(b,Wu.EventType.MESSAGE,(B=>{if(!T){const G=B.data[0];we(!!G,16349);const te=G,I=te?.error||te[0]?.error;if(I){ue(Pn,`RPC '${e}' stream ${a} received error:`,I);const X=I.status;let se=(function(ae){const A=nn[ae];if(A!==void 0)return kA(A)})(X),fe=I.message;se===void 0&&(se=W.INTERNAL,fe="Unknown error status: "+X+" with message "+I.message),T=!0,N.o_(new le(se,fe)),b.close()}else ue(Pn,`RPC '${e}' stream ${a} received:`,G),N.__(G)}})),Xl.u_(),setTimeout((()=>{N.s_()}),0),N}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return RS()}}function HM(s){return new Xl(s)}function b1(){return typeof window<"u"?window:null}function tm(){return typeof document<"u"?document:null}function th(s){return new YO(s,!0)}Xl.c_=!1;class O_{constructor(e,t,r=1e3,a=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=a,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-r);a>0&&ue("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Rw="PersistentStream";class x1{constructor(e,t,r,a,l,u,p,f){this.Ci=e,this.b_=r,this.S_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=p,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new O_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===W.RESOURCE_EXHAUSTED?(Ht(t.toString()),Ht("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.D_===t&&this.G_(r,a)}),(r=>{e((()=>{const a=new le(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(a)}))}))}G_(e,t){const r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((a=>{r((()=>this.z_(a)))})),this.stream.onMessage((a=>{r((()=>++this.F_==1?this.H_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ue(Rw,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(ue(Rw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class GM extends x1{constructor(e,t,r,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=JO(this.serializer,e),r=(function(l){if(!("targetChange"in l))return Ae.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Ae.min():u.readTime?Gt(u.readTime):Ae.min()})(e);return this.listener.J_(t,r)}Z_(e){const t={};t.database=d0(this.serializer),t.addTarget=(function(l,u){let p;const f=u.target;if(p=pm(f)?{documents:BA(l,f)}:{query:qA(l,f).ft},p.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){p.resumeToken=VA(l,u.resumeToken);const y=c0(l,u.expectedCount);y!==null&&(p.expectedCount=y)}else if(u.snapshotVersion.compareTo(Ae.min())>0){p.readTime=mc(l,u.snapshotVersion.toTimestamp());const y=c0(l,u.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const r=eM(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){const t={};t.database=d0(this.serializer),t.removeTarget=e,this.K_(t)}}class QM extends x1{constructor(e,t,r,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,u),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return we(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,we(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){we(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=ZO(e.writeResults,e.commitTime),r=Gt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=d0(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Pd(this.serializer,r)))};this.K_(t)}}class KM{}class $M extends KM{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new le(W.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Wo(e,u0(t,r),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new le(W.UNKNOWN,l.toString())}))}jo(e,t,r,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,p])=>this.connection.jo(e,u0(t,r),a,u,p,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new le(W.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function YM(s,e,t,r){return new $M(s,e,t,r)}class WM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ht(t),this.aa=!1):ue("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Oo="RemoteStore";class XM{constructor(e,t,r,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((u=>{r.enqueueAndForget((async()=>{Ra(this)&&(ue(Oo,"Restarting streams for network reachability change."),await(async function(f){const y=ve(f);y.Ea.add(4),await kc(y),y.Va.set("Unknown"),y.Ea.delete(4),await nh(y)})(this))}))})),this.Va=new WM(r,a)}}async function nh(s){if(Ra(s))for(const e of s.Ra)await e(!0)}async function kc(s){for(const e of s.Ra)await e(!1)}function ep(s,e){const t=ve(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),U_(t)?L_(t):Pc(t).O_()&&M_(t,e))}function yc(s,e){const t=ve(s),r=Pc(t);t.Ia.delete(e),r.O_()&&E1(t,e),t.Ia.size===0&&(r.O_()?r.L_():Ra(t)&&t.Va.set("Unknown"))}function M_(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ae.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Pc(s).Z_(e)}function E1(s,e){s.da.$e(e),Pc(s).X_(e)}function L_(s){s.da=new GO({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Pc(s).start(),s.Va.ua()}function U_(s){return Ra(s)&&!Pc(s).x_()&&s.Ia.size>0}function Ra(s){return ve(s).Ea.size===0}function T1(s){s.da=void 0}async function JM(s){s.Va.set("Online")}async function ZM(s){s.Ia.forEach(((e,t)=>{M_(s,e)}))}async function e4(s,e){T1(s),U_(s)?(s.Va.ha(e),L_(s)):s.Va.set("Unknown")}async function t4(s,e,t){if(s.Va.set("Online"),e instanceof jA&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const p of l.targetIds)a.Ia.has(p)&&(await a.remoteSyncer.rejectListen(p,u),a.Ia.delete(p),a.da.removeTarget(p))})(s,e)}catch(r){ue(Oo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Im(s,r)}else if(e instanceof Zf?s.da.Xe(e):e instanceof PA?s.da.st(e):s.da.tt(e),!t.isEqual(Ae.min()))try{const r=await d1(s.localStore);t.compareTo(r)>=0&&await(function(l,u){const p=l.da.Tt(u);return p.targetChanges.forEach(((f,y)=>{if(f.resumeToken.approximateByteSize()>0){const b=l.Ia.get(y);b&&l.Ia.set(y,b.withResumeToken(f.resumeToken,u))}})),p.targetMismatches.forEach(((f,y)=>{const b=l.Ia.get(f);if(!b)return;l.Ia.set(f,b.withResumeToken(Mt.EMPTY_BYTE_STRING,b.snapshotVersion)),E1(l,f);const E=new ci(b.target,f,y,b.sequenceNumber);M_(l,E)})),l.remoteSyncer.applyRemoteEvent(p)})(s,t)}catch(r){ue(Oo,"Failed to raise snapshot:",r),await Im(s,r)}}async function Im(s,e,t){if(!Aa(e))throw e;s.Ea.add(1),await kc(s),s.Va.set("Offline"),t||(t=()=>d1(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{ue(Oo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await nh(s)}))}function w1(s,e){return e().catch((t=>Im(s,t,e)))}async function Dc(s){const e=ve(s),t=Ea(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:da;for(;n4(e);)try{const a=await MM(e.localStore,r);if(a===null){e.Ta.length===0&&t.L_();break}r=a.batchId,r4(e,a)}catch(a){await Im(e,a)}I1(e)&&S1(e)}function n4(s){return Ra(s)&&s.Ta.length<10}function r4(s,e){s.Ta.push(e);const t=Ea(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function I1(s){return Ra(s)&&!Ea(s).x_()&&s.Ta.length>0}function S1(s){Ea(s).start()}async function s4(s){Ea(s).ra()}async function i4(s){const e=Ea(s);for(const t of s.Ta)e.ea(t.mutations)}async function a4(s,e,t){const r=s.Ta.shift(),a=E_.from(r,e,t);await w1(s,(()=>s.remoteSyncer.applySuccessfulWrite(a))),await Dc(s)}async function o4(s,e){e&&Ea(s).Y_&&await(async function(r,a){if((function(u){return CA(u)&&u!==W.ABORTED})(a.code)){const l=r.Ta.shift();Ea(r).B_(),await w1(r,(()=>r.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Dc(r)}})(s,e),I1(s)&&S1(s)}async function Cw(s,e){const t=ve(s);t.asyncQueue.verifyOperationInProgress(),ue(Oo,"RemoteStore received new credentials");const r=Ra(t);t.Ea.add(3),await kc(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await nh(t)}async function _0(s,e){const t=ve(s);e?(t.Ea.delete(2),await nh(t)):e||(t.Ea.add(2),await kc(t),t.Va.set("Unknown"))}function Pc(s){return s.ma||(s.ma=(function(t,r,a){const l=ve(t);return l.sa(),new GM(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:JM.bind(null,s),Yo:ZM.bind(null,s),t_:e4.bind(null,s),J_:t4.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),U_(s)?L_(s):s.Va.set("Unknown")):(await s.ma.stop(),T1(s))}))),s.ma}function Ea(s){return s.fa||(s.fa=(function(t,r,a){const l=ve(t);return l.sa(),new QM(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:s4.bind(null,s),t_:o4.bind(null,s),ta:i4.bind(null,s),na:a4.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await Dc(s)):(await s.fa.stop(),s.Ta.length>0&&(ue(Oo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class z_{constructor(e,t,r,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=l,this.deferred=new An,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,l){const u=Date.now()+r,p=new z_(e,t,u,a,l);return p.start(r),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new le(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jc(s,e){if(Ht("AsyncQueue",`${e}: ${s}`),Aa(s))return new le(W.UNAVAILABLE,`${e}: ${s}`);throw s}class Jl{static emptySet(e){return new Jl(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ye.comparator(t.key,r.key):(t,r)=>ye.comparator(t.key,r.key),this.keyedMap=Xu(),this.sortedSet=new bt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Jl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Jl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class kw{constructor(){this.ga=new bt(ye.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):xe(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class _c{constructor(e,t,r,a,l,u,p,f,y){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=p,this.excludesMetadataChanges=f,this.hasCachedResults=y}static fromInitialDocuments(e,t,r,a,l){const u=[];return t.forEach((p=>{u.push({type:0,doc:p})})),new _c(e,t,Jl.emptySet(t),u,r,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Wd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}class l4{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class c4{constructor(){this.queries=Dw(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const a=ve(t),l=a.queries;a.queries=Dw(),l.forEach(((u,p)=>{for(const f of p.ba)f.onError(r)}))})(this,new le(W.ABORTED,"Firestore shutting down"))}}function Dw(){return new vi((s=>gA(s)),Wd)}async function B_(s,e){const t=ve(s);let r=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.Da()&&(r=2):(l=new l4,r=e.Da()?0:1);try{switch(r){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(u){const p=jc(u,`Initialization of query '${Bl(e.query)}' failed`);return void e.onError(p)}t.queries.set(a,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&F_(t)}async function q_(s,e){const t=ve(s),r=e.query;let a=3;const l=t.queries.get(r);if(l){const u=l.ba.indexOf(e);u>=0&&(l.ba.splice(u,1),l.ba.length===0?a=e.Da()?0:1:!l.Sa()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function u4(s,e){const t=ve(s);let r=!1;for(const a of e){const l=a.query,u=t.queries.get(l);if(u){for(const p of u.ba)p.Fa(a)&&(r=!0);u.wa=a}}r&&F_(t)}function d4(s,e,t){const r=ve(s),a=r.queries.get(e);if(a)for(const l of a.ba)l.onError(t);r.queries.delete(e)}function F_(s){s.Ca.forEach((e=>{e.next()}))}var v0,Pw;(Pw=v0||(v0={})).Ma="default",Pw.Cache="cache";class H_{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new _c(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=_c.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==v0.Cache}}class h4{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class jw{constructor(e){this.serializer=e}Ks(e){return Os(this.serializer,e)}qs(e){return e.metadata.exists?zA(this.serializer,e.document,!1):wt.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return Gt(e)}}class f4{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=A1(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const r=Ke.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new jw(this.serializer);for(const a of e)if(a.metadata.queries){const l=r.Ks(a.metadata.name);for(const u of a.metadata.queries){const p=(t.get(u)||Be()).add(l);t.set(u,p)}}return t}async ja(e){const t=await LM(e,new jw(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(const a of this.Wa)await UM(e,a,r.get(a.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function A1(s){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:s.totalDocuments,totalBytes:s.totalBytes}}class N1{constructor(e){this.key=e}}class R1{constructor(e){this.key=e}}class C1{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Be(),this.mutatedKeys=Be(),this.eu=_A(e),this.tu=new Jl(this.eu)}get nu(){return this.Za}ru(e,t){const r=t?t.iu:new kw,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=a,p=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,y=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((b,E)=>{const T=a.get(b),N=Xd(this.query,E)?E:null,B=!!T&&this.mutatedKeys.has(T.key),G=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let te=!1;T&&N?T.data.isEqual(N.data)?B!==G&&(r.track({type:3,doc:N}),te=!0):this.su(T,N)||(r.track({type:2,doc:N}),te=!0,(f&&this.eu(N,f)>0||y&&this.eu(N,y)<0)&&(p=!0)):!T&&N?(r.track({type:0,doc:N}),te=!0):T&&!N&&(r.track({type:1,doc:T}),te=!0,(f||y)&&(p=!0)),te&&(N?(u=u.add(N),l=G?l.add(b):l.delete(b)):(u=u.delete(b),l=l.delete(b)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const b=this.query.limitType==="F"?u.last():u.first();u=u.delete(b.key),l=l.delete(b.key),r.track({type:1,doc:b})}return{tu:u,iu:r,Ss:p,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((b,E)=>(function(N,B){const G=te=>{switch(te){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xe(20277,{Vt:te})}};return G(N)-G(B)})(b.type,E.type)||this.eu(b.doc,E.doc))),this.ou(r),a=a??!1;const p=t&&!a?this._u():[],f=this.Ya.size===0&&this.current&&!a?1:0,y=f!==this.Xa;return this.Xa=f,u.length!==0||y?{snapshot:new _c(this.query,e.tu,l,u,e.mutatedKeys,f===0,y,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new kw,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Be(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const t=[];return e.forEach((r=>{this.Ya.has(r)||t.push(new R1(r))})),this.Ya.forEach((r=>{e.has(r)||t.push(new N1(r))})),t}cu(e){this.Za=e.ks,this.Ya=Be();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return _c.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Ca="SyncEngine";class m4{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class p4{constructor(e){this.key=e,this.hu=!1}}class g4{constructor(e,t,r,a,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new vi((p=>gA(p)),Wd),this.Iu=new Map,this.Eu=new Set,this.Ru=new bt(ye.comparator),this.Au=new Map,this.Vu=new R_,this.du={},this.mu=new Map,this.fu=Vo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function y4(s,e,t=!0){const r=tp(s);let a;const l=r.Tu.get(e);return l?(r.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await k1(r,e,t,!0),a}async function _4(s,e){const t=tp(s);await k1(t,e,!0,!1)}async function k1(s,e,t,r){const a=await pc(s.localStore,Hn(e)),l=a.targetId,u=s.sharedClientState.addLocalQueryTarget(l,t);let p;return r&&(p=await G_(s,e,l,u==="current",a.resumeToken)),s.isPrimaryClient&&t&&ep(s.remoteStore,a),p}async function G_(s,e,t,r,a){s.pu=(E,T,N)=>(async function(G,te,I,X){let se=te.view.ru(I);se.Ss&&(se=await Em(G.localStore,te.query,!1).then((({documents:A})=>te.view.ru(A,se))));const fe=X&&X.targetChanges.get(te.targetId),H=X&&X.targetMismatches.get(te.targetId)!=null,ae=te.view.applyChanges(se,G.isPrimaryClient,fe,H);return b0(G,te.targetId,ae.au),ae.snapshot})(s,E,T,N);const l=await Em(s.localStore,e,!0),u=new C1(e,l.ks),p=u.ru(l.documents),f=eh.createSynthesizedTargetChangeForCurrentChange(t,r&&s.onlineState!=="Offline",a),y=u.applyChanges(p,s.isPrimaryClient,f);b0(s,t,y.au);const b=new m4(e,t,u);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function v4(s,e,t){const r=ve(s),a=r.Tu.get(e),l=r.Iu.get(a.targetId);if(l.length>1)return r.Iu.set(a.targetId,l.filter((u=>!Wd(u,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await gc(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),t&&yc(r.remoteStore,a.targetId),vc(r,a.targetId)})).catch(Sa)):(vc(r,a.targetId),await gc(r.localStore,a.targetId,!0))}async function b4(s,e){const t=ve(s),r=t.Tu.get(e),a=t.Iu.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),yc(t.remoteStore,r.targetId))}async function x4(s,e,t){const r=Y_(s);try{const a=await(function(u,p){const f=ve(u),y=lt.now(),b=p.reduce(((N,B)=>N.add(B.key)),Be());let E,T;return f.persistence.runTransaction("Locally write mutations","readwrite",(N=>{let B=ir(),G=Be();return f.xs.getEntries(N,b).next((te=>{B=te,B.forEach(((I,X)=>{X.isValidDocument()||(G=G.add(I))}))})).next((()=>f.localDocuments.getOverlayedDocuments(N,B))).next((te=>{E=te;const I=[];for(const X of p){const se=qO(X,E.get(X.key).overlayedDocument);se!=null&&I.push(new bi(X.key,se,oA(se.value.mapValue),Ct.exists(!0)))}return f.mutationQueue.addMutationBatch(N,y,I,p)})).next((te=>{T=te;const I=te.applyToLocalDocumentSet(E,G);return f.documentOverlayCache.saveOverlays(N,te.batchId,I)}))})).then((()=>({batchId:T.batchId,changes:bA(E)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(u,p,f){let y=u.du[u.currentUser.toKey()];y||(y=new bt(De)),y=y.insert(p,f),u.du[u.currentUser.toKey()]=y})(r,a.batchId,t),await xi(r,a.changes),await Dc(r.remoteStore)}catch(a){const l=jc(a,"Failed to persist write");t.reject(l)}}async function D1(s,e){const t=ve(s);try{const r=await OM(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=t.Au.get(l);u&&(we(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?we(u.hu,14607):a.removedDocuments.size>0&&(we(u.hu,42227),u.hu=!1))})),await xi(t,r,e)}catch(r){await Sa(r)}}function Vw(s,e,t){const r=ve(s);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Tu.forEach(((l,u)=>{const p=u.view.va(e);p.snapshot&&a.push(p.snapshot)})),(function(u,p){const f=ve(u);f.onlineState=p;let y=!1;f.queries.forEach(((b,E)=>{for(const T of E.ba)T.va(p)&&(y=!0)})),y&&F_(f)})(r.eventManager,e),a.length&&r.Pu.J_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function E4(s,e,t){const r=ve(s);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Au.get(e),l=a&&a.key;if(l){let u=new bt(ye.comparator);u=u.insert(l,wt.newNoDocument(l,Ae.min()));const p=Be().add(l),f=new Zd(Ae.min(),new Map,new bt(De),u,p);await D1(r,f),r.Ru=r.Ru.remove(l),r.Au.delete(e),$_(r)}else await gc(r.localStore,e,!1).then((()=>vc(r,e,t))).catch(Sa)}async function T4(s,e){const t=ve(s),r=e.batch.batchId;try{const a=await VM(t.localStore,e);K_(t,r,null),Q_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await xi(t,a)}catch(a){await Sa(a)}}async function w4(s,e,t){const r=ve(s);try{const a=await(function(u,p){const f=ve(u);return f.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let b;return f.mutationQueue.lookupMutationBatch(y,p).next((E=>(we(E!==null,37113),b=E.keys(),f.mutationQueue.removeMutationBatch(y,E)))).next((()=>f.mutationQueue.performConsistencyCheck(y))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(y,b,p))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,b))).next((()=>f.localDocuments.getDocuments(y,b)))}))})(r.localStore,e);K_(r,e,t),Q_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await xi(r,a)}catch(a){await Sa(a)}}async function I4(s,e){const t=ve(s);Ra(t.remoteStore)||ue(Ca,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(u){const p=ve(u);return p.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(f=>p.mutationQueue.getHighestUnacknowledgedBatchId(f)))})(t.localStore);if(r===da)return void e.resolve();const a=t.mu.get(r)||[];a.push(e),t.mu.set(r,a)}catch(r){const a=jc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(a)}}function Q_(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function K_(s,e,t){const r=ve(s);let a=r.du[r.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),r.du[r.currentUser.toKey()]=a}}function vc(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const r of s.Iu.get(e))s.Tu.delete(r),t&&s.Pu.yu(r,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((r=>{s.Vu.containsKey(r)||P1(s,r)}))}function P1(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(yc(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),$_(s))}function b0(s,e,t){for(const r of t)r instanceof N1?(s.Vu.addReference(r.key,e),S4(s,r)):r instanceof R1?(ue(Ca,"Document no longer in limbo: "+r.key),s.Vu.removeReference(r.key,e),s.Vu.containsKey(r.key)||P1(s,r.key)):xe(19791,{wu:r})}function S4(s,e){const t=e.key,r=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(r)||(ue(Ca,"New document in limbo: "+t),s.Eu.add(r),$_(s))}function $_(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ye(Ke.fromString(e)),r=s.fu.next();s.Au.set(r,new p4(t)),s.Ru=s.Ru.insert(t,r),ep(s.remoteStore,new ci(Hn(Nc(t.path)),r,"TargetPurposeLimboResolution",rr.ce))}}async function xi(s,e,t){const r=ve(s),a=[],l=[],u=[];r.Tu.isEmpty()||(r.Tu.forEach(((p,f)=>{u.push(r.pu(f,e,t).then((y=>{if((y||t)&&r.isPrimaryClient){const b=y?!y.fromCache:t?.targetChanges.get(f.targetId)?.current;r.sharedClientState.updateQueryState(f.targetId,b?"current":"not-current")}if(y){a.push(y);const b=P_.Es(f.targetId,y);l.push(b)}})))})),await Promise.all(u),r.Pu.J_(a),await(async function(f,y){const b=ve(f);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>z.forEach(y,(T=>z.forEach(T.Ts,(N=>b.persistence.referenceDelegate.addReference(E,T.targetId,N))).next((()=>z.forEach(T.Is,(N=>b.persistence.referenceDelegate.removeReference(E,T.targetId,N)))))))))}catch(E){if(!Aa(E))throw E;ue(j_,"Failed to update sequence numbers: "+E)}for(const E of y){const T=E.targetId;if(!E.fromCache){const N=b.vs.get(T),B=N.snapshotVersion,G=N.withLastLimboFreeSnapshotVersion(B);b.vs=b.vs.insert(T,G)}}})(r.localStore,l))}async function A4(s,e){const t=ve(s);if(!t.currentUser.isEqual(e)){ue(Ca,"User change. New user:",e.toKey());const r=await u1(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((p=>{p.forEach((f=>{f.reject(new le(W.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await xi(t,r.Ns)}}function N4(s,e){const t=ve(s),r=t.Au.get(e);if(r&&r.hu)return Be().add(r.key);{let a=Be();const l=t.Iu.get(e);if(!l)return a;for(const u of l){const p=t.Tu.get(u);a=a.unionWith(p.view.nu)}return a}}async function R4(s,e){const t=ve(s),r=await Em(t.localStore,e.query,!0),a=e.view.cu(r);return t.isPrimaryClient&&b0(t,e.targetId,a.au),a}async function C4(s,e){const t=ve(s);return m1(t.localStore,e).then((r=>xi(t,r)))}async function k4(s,e,t,r){const a=ve(s),l=await(function(p,f){const y=ve(p),b=ve(y.mutationQueue);return y.persistence.runTransaction("Lookup mutation documents","readonly",(E=>b.Xn(E,f).next((T=>T?y.localDocuments.getDocuments(E,T):z.resolve(null)))))})(a.localStore,e);l!==null?(t==="pending"?await Dc(a.remoteStore):t==="acknowledged"||t==="rejected"?(K_(a,e,r||null),Q_(a,e),(function(p,f){ve(ve(p).mutationQueue).nr(f)})(a.localStore,e)):xe(6720,"Unknown batchState",{bu:t}),await xi(a,l)):ue(Ca,"Cannot apply mutation batch with id: "+e)}async function D4(s,e){const t=ve(s);if(tp(t),Y_(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),a=await Ow(t,r.toArray());t.gu=!0,await _0(t.remoteStore,!0);for(const l of a)ep(t.remoteStore,l)}else if(e===!1&&t.gu!==!1){const r=[];let a=Promise.resolve();t.Iu.forEach(((l,u)=>{t.sharedClientState.isLocalQueryTarget(u)?r.push(u):a=a.then((()=>(vc(t,u),gc(t.localStore,u,!0)))),yc(t.remoteStore,u)})),await a,await Ow(t,r),(function(u){const p=ve(u);p.Au.forEach(((f,y)=>{yc(p.remoteStore,y)})),p.Vu.zr(),p.Au=new Map,p.Ru=new bt(ye.comparator)})(t),t.gu=!1,await _0(t.remoteStore,!1)}}async function Ow(s,e,t){const r=ve(s),a=[],l=[];for(const u of e){let p;const f=r.Iu.get(u);if(f&&f.length!==0){p=await pc(r.localStore,Hn(f[0]));for(const y of f){const b=r.Tu.get(y),E=await R4(r,b);E.snapshot&&l.push(E.snapshot)}}else{const y=await f1(r.localStore,u);p=await pc(r.localStore,y),await G_(r,j1(y),u,!1,p.resumeToken)}a.push(p)}return r.Pu.J_(l),a}function j1(s){return pA(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function P4(s){return(function(t){return ve(ve(t).persistence).hs()})(ve(s).localStore)}async function j4(s,e,t,r){const a=ve(s);if(a.gu)return void ue(Ca,"Ignoring unexpected query state notification.");const l=a.Iu.get(e);if(l&&l.length>0)switch(t){case"current":case"not-current":{const u=await m1(a.localStore,yA(l[0])),p=Zd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Mt.EMPTY_BYTE_STRING);await xi(a,u,p);break}case"rejected":await gc(a.localStore,e,!0),vc(a,e,r);break;default:xe(64155,t)}}async function V4(s,e,t){const r=tp(s);if(r.gu){for(const a of e){if(r.Iu.has(a)&&r.sharedClientState.isActiveQueryTarget(a)){ue(Ca,"Adding an already active target "+a);continue}const l=await f1(r.localStore,a),u=await pc(r.localStore,l);await G_(r,j1(l),u.targetId,!1,u.resumeToken),ep(r.remoteStore,u)}for(const a of t)r.Iu.has(a)&&await gc(r.localStore,a,!1).then((()=>{yc(r.remoteStore,a),vc(r,a)})).catch(Sa)}}function tp(s){const e=ve(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=D1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=N4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=E4.bind(null,e),e.Pu.J_=u4.bind(null,e.eventManager),e.Pu.yu=d4.bind(null,e.eventManager),e}function Y_(s){const e=ve(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=T4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=w4.bind(null,e),e}function O4(s,e,t){const r=ve(s);(async function(l,u,p){try{const f=await u.getMetadata();if(await(function(N,B){const G=ve(N),te=Gt(B.createTime);return G.persistence.runTransaction("hasNewerBundle","readonly",(I=>G.Pi.getBundleMetadata(I,B.id))).then((I=>!!I&&I.createTime.compareTo(te)>=0))})(l.localStore,f))return await u.close(),p._completeWith((function(N){return{taskState:"Success",documentsLoaded:N.totalDocuments,bytesLoaded:N.totalBytes,totalDocuments:N.totalDocuments,totalBytes:N.totalBytes}})(f)),Promise.resolve(new Set);p._updateProgress(A1(f));const y=new f4(f,u.serializer);let b=await u.Su();for(;b;){const T=await y.Ga(b);T&&p._updateProgress(T),b=await u.Su()}const E=await y.ja(l.localStore);return await xi(l,E.Ja,void 0),await(function(N,B){const G=ve(N);return G.persistence.runTransaction("Save bundle","readwrite",(te=>G.Pi.saveBundleMetadata(te,B)))})(l.localStore,f),p._completeWith(E.progress),Promise.resolve(E.Ha)}catch(f){return zs(Ca,`Loading bundle failed with ${f}`),p._failWith(f),Promise.resolve(new Set)}})(r,e,t).then((a=>{r.sharedClientState.notifyBundleLoaded(a)}))}class jd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=th(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return c1(this.persistence,new l1,e.initialUser,this.serializer)}Cu(e){return new C_(Zm.Vi,this.serializer)}Du(e){return new v1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jd.provider={build:()=>new jd};class M4 extends jd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){we(this.persistence.referenceDelegate instanceof xm,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new n1(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new C_((r=>xm.Vi(r,t)),this.serializer)}}class V1 extends jd{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Y_(this.xu.syncEngine),await Dc(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return c1(this.persistence,new l1,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new n1(r,e.asyncQueue,t)}Mu(e,t){const r=new zV(t,this.persistence);return new UV(e.asyncQueue,r)}Cu(e){const t=D_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new k_(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,b1(),tm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new v1}}class L4 extends V1{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof ky&&(this.sharedClientState.syncEngine={So:k4.bind(null,t),Do:j4.bind(null,t),Co:V4.bind(null,t),hs:P4.bind(null,t),bo:C4.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async r=>{await D4(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=b1();if(!ky.v(t))throw new le(W.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=D_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ky(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Vd{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Vw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=A4.bind(null,this.syncEngine),await _0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new c4})()}createDatastore(e){const t=th(e.databaseInfo.databaseId),r=HM(e.databaseInfo);return YM(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,a,l,u,p){return new XM(r,a,l,u,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>Vw(this.syncEngine,t,0)),(function(){return Nw.v()?new Nw:new zM})())}createSyncEngine(e,t){return(function(a,l,u,p,f,y,b){const E=new g4(a,l,u,p,f,y);return b&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=ve(t);ue(Oo,"RemoteStore shutting down."),r.Ea.add(5),await kc(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Vd.provider={build:()=>new Vd};function Mw(s,e=10240){let t=0;return{async read(){if(t<s.byteLength){const r={value:s.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class np{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ht("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class U4{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new An,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.Ua()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);const a=await this.Uu(r);return new h4(JSON.parse(a),e.length+r)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}let z4=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new le(W.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(a,l){const u=ve(a),p={documents:l.map((E=>Dd(u.serializer,E)))},f=await u.jo("BatchGetDocuments",u.serializer.databaseId,Ke.emptyPath(),p,l.length),y=new Map;f.forEach((E=>{const T=XO(u.serializer,E);y.set(T.key.toString(),T)}));const b=[];return l.forEach((E=>{const T=y.get(E.toString());we(!!T,55234,{key:E}),b.push(T)})),b})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Cc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const a=ye.fromPath(r);this.mutations.push(new b_(a,this.precondition(a)))})),await(async function(r,a){const l=ve(r),u={writes:a.map((p=>Pd(l.serializer,p)))};await l.Wo("Commit",l.serializer.databaseId,Ke.emptyPath(),u)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw xe(50498,{Gu:e.constructor.name});t=Ae.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new le(W.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ae.min())?Ct.exists(!1):Ct.updateTime(t):Ct.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ae.min()))throw new le(W.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ct.updateTime(t)}return Ct.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};class B4{constructor(e,t,r,a,l){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=a,this.deferred=l,this.zu=r.maxAttempts,this.M_=new O_(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new z4(this.datastore),t=this.Ju(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((a=>{this.Zu(a)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(e){try{const t=this.updateFunction(e);return!Kd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!CA(t)}return!1}}const Ta="FirestoreClient";class q4{constructor(e,t,r,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=a,this.user=gn.UNAUTHENTICATED,this.clientId=a_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(r,(async u=>{ue(Ta,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(r,(u=>(ue(Ta,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new An;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=jc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Py(s,e){s.asyncQueue.verifyOperationInProgress(),ue(Ta,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let r=t.initialUser;s.setCredentialChangeListener((async a=>{r.isEqual(a)||(await u1(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function Lw(s,e){s.asyncQueue.verifyOperationInProgress();const t=await W_(s);ue(Ta,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((r=>Cw(e.remoteStore,r))),s.setAppCheckTokenChangeListener(((r,a)=>Cw(e.remoteStore,a))),s._onlineComponents=e}async function W_(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){ue(Ta,"Using user provided OfflineComponentProvider");try{await Py(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===W.FAILED_PRECONDITION||a.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;zs("Error using user provided cache. Falling back to memory cache: "+t),await Py(s,new jd)}}else ue(Ta,"Using default OfflineComponentProvider"),await Py(s,new M4(void 0));return s._offlineComponents}async function rp(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(ue(Ta,"Using user provided OnlineComponentProvider"),await Lw(s,s._uninitializedComponentsProvider._online)):(ue(Ta,"Using default OnlineComponentProvider"),await Lw(s,new Vd))),s._onlineComponents}function O1(s){return W_(s).then((e=>e.persistence))}function X_(s){return W_(s).then((e=>e.localStore))}function M1(s){return rp(s).then((e=>e.remoteStore))}function J_(s){return rp(s).then((e=>e.syncEngine))}function F4(s){return rp(s).then((e=>e.datastore))}async function bc(s){const e=await rp(s),t=e.eventManager;return t.onListen=y4.bind(null,e.syncEngine),t.onUnlisten=v4.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=_4.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=b4.bind(null,e.syncEngine),t}function H4(s){return s.asyncQueue.enqueue((async()=>{const e=await O1(s),t=await M1(s);return e.setNetworkEnabled(!0),(function(a){const l=ve(a);return l.Ea.delete(0),nh(l)})(t)}))}function G4(s){return s.asyncQueue.enqueue((async()=>{const e=await O1(s),t=await M1(s);return e.setNetworkEnabled(!1),(async function(a){const l=ve(a);l.Ea.add(0),await kc(l),l.Va.set("Offline")})(t)}))}function Q4(s,e,t,r){const a=new np(r),l=new H_(e,a,t);return s.asyncQueue.enqueueAndForget((async()=>B_(await bc(s),l))),()=>{a.Nu(),s.asyncQueue.enqueueAndForget((async()=>q_(await bc(s),l)))}}function K4(s,e){const t=new An;return s.asyncQueue.enqueueAndForget((async()=>(async function(a,l,u){try{const p=await(function(y,b){const E=ve(y);return E.persistence.runTransaction("read document","readonly",(T=>E.localDocuments.getDocument(T,b)))})(a,l);p.isFoundDocument()?u.resolve(p):p.isNoDocument()?u.resolve(null):u.reject(new le(W.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(p){const f=jc(p,`Failed to get document '${l} from cache`);u.reject(f)}})(await X_(s),e,t))),t.promise}function L1(s,e,t={}){const r=new An;return s.asyncQueue.enqueueAndForget((async()=>(function(l,u,p,f,y){const b=new np({next:T=>{b.Nu(),u.enqueueAndForget((()=>q_(l,E)));const N=T.docs.has(p);!N&&T.fromCache?y.reject(new le(W.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&T.fromCache&&f&&f.source==="server"?y.reject(new le(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new H_(Nc(p.path),b,{includeMetadataChanges:!0,Ka:!0});return B_(l,E)})(await bc(s),s.asyncQueue,e,t,r))),r.promise}function $4(s,e){const t=new An;return s.asyncQueue.enqueueAndForget((async()=>(async function(a,l,u){try{const p=await Em(a,l,!0),f=new C1(l,p.ks),y=f.ru(p.documents),b=f.applyChanges(y,!1);u.resolve(b.snapshot)}catch(p){const f=jc(p,`Failed to execute query '${l} against cache`);u.reject(f)}})(await X_(s),e,t))),t.promise}function U1(s,e,t={}){const r=new An;return s.asyncQueue.enqueueAndForget((async()=>(function(l,u,p,f,y){const b=new np({next:T=>{b.Nu(),u.enqueueAndForget((()=>q_(l,E))),T.fromCache&&f.source==="server"?y.reject(new le(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new H_(p,b,{includeMetadataChanges:!0,Ka:!0});return B_(l,E)})(await bc(s),s.asyncQueue,e,t,r))),r.promise}function Y4(s,e){const t=new An;return s.asyncQueue.enqueueAndForget((async()=>x4(await J_(s),e,t))),t.promise}function W4(s,e){const t=new np(e);return s.asyncQueue.enqueueAndForget((async()=>(function(a,l){ve(a).Ca.add(l),l.next()})(await bc(s),t))),()=>{t.Nu(),s.asyncQueue.enqueueAndForget((async()=>(function(a,l){ve(a).Ca.delete(l)})(await bc(s),t)))}}function X4(s,e,t){const r=new An;return s.asyncQueue.enqueueAndForget((async()=>{const a=await F4(s);new B4(s.asyncQueue,a,t,e,r).ju()})),r.promise}function J4(s,e,t,r){const a=(function(u,p){let f;return f=typeof u=="string"?DA().encode(u):u,(function(b,E){return new U4(b,E)})((function(b,E){if(b instanceof Uint8Array)return Mw(b,E);if(b instanceof ArrayBuffer)return Mw(new Uint8Array(b),E);if(b instanceof ReadableStream)return b.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(f),p)})(t,th(e));s.asyncQueue.enqueueAndForget((async()=>{O4(await J_(s),a,r)}))}function Z4(s,e){return s.asyncQueue.enqueue((async()=>(function(r,a){const l=ve(r);return l.persistence.runTransaction("Get named query","readonly",(u=>l.Pi.getNamedQuery(u,a)))})(await X_(s),e)))}function z1(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const e6="ComponentProvider",Uw=new Map;function t6(s,e,t,r,a){return new pO(s,e,t,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,z1(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,r)}const B1="firestore.googleapis.com",zw=!0;class Bw{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new le(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=B1,this.ssl=zw}else this.host=e.host,this.ssl=e.ssl??zw;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=JA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<gM)throw new le(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}PS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=z1(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new le(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new le(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new le(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rh{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Bw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new le(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new le(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Bw(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new AV;switch(r.type){case"firstParty":return new kV(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new le(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=Uw.get(t);r&&(ue(e6,"Removing Datastore"),Uw.delete(t),r.terminate())})(this),Promise.resolve()}}function n6(s,e,t,r={}){s=st(s,rh);const a=Ec(e),l=s._getSettings(),u={...l,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${t}`;a&&(iI(`https://${p}`),aI("Firestore",!0)),l.host!==B1&&l.host!==p&&zs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...l,host:p,ssl:a,emulatorOptions:r};if(!fa(f,u)&&(s._setSettings(f),r.mockUserToken)){let y,b;if(typeof r.mockUserToken=="string")y=r.mockUserToken,b=gn.MOCK_USER;else{y=FC(r.mockUserToken,s._app?.options.projectId);const E=r.mockUserToken.sub||r.mockUserToken.user_id;if(!E)throw new le(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new gn(E)}s._authCredentials=new NV(new kS(y,b))}}let Gn=class q1{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new q1(this.firestore,e,this._query)}},vt=class ed{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ha(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ed(this.firestore,e,this._key)}toJSON(){return{type:ed._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Qd(t,ed._jsonSchema))return new ed(e,r||null,new ye(Ke.fromString(t.referencePath)))}};vt._jsonSchemaVersion="firestore/documentReference/1.0",vt._jsonSchema={type:an("string",vt._jsonSchemaVersion),referencePath:an("string")};let ha=class F1 extends Gn{constructor(e,t,r){super(e,t,Nc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vt(this.firestore,null,new ye(e))}withConverter(e){return new F1(this.firestore,e,this._path)}};function H1(s,e,...t){if(s=Ce(s),o_("collection","path",e),s instanceof rh){const r=Ke.fromString(e,...t);return RT(r),new ha(s,null,r)}{if(!(s instanceof vt||s instanceof ha))throw new le(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child(Ke.fromString(e,...t));return RT(r),new ha(s.firestore,null,r)}}function r6(s,e){if(s=st(s,rh),o_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new le(W.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Gn(s,null,(function(r){return new _i(Ke.emptyPath(),r)})(e))}function Sm(s,e,...t){if(s=Ce(s),arguments.length===1&&(e=a_.newId()),o_("doc","path",e),s instanceof rh){const r=Ke.fromString(e,...t);return NT(r),new vt(s,null,new ye(r))}{if(!(s instanceof vt||s instanceof ha))throw new le(W.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child(Ke.fromString(e,...t));return NT(r),new vt(s.firestore,s instanceof ha?s.converter:null,new ye(r))}}function G1(s,e){return s=Ce(s),e=Ce(e),(s instanceof vt||s instanceof ha)&&(e instanceof vt||e instanceof ha)&&s.firestore===e.firestore&&s.path===e.path&&s.converter===e.converter}function Q1(s,e){return s=Ce(s),e=Ce(e),s instanceof Gn&&e instanceof Gn&&s.firestore===e.firestore&&Wd(s._query,e._query)&&s.converter===e.converter}const qw="AsyncQueue";class Fw{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new O_(this,"async_queue_retry"),this._c=()=>{const r=tm();r&&ue(qw,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=tm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=tm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new An;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Aa(e))throw e;ue(qw,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Ht("INTERNAL UNHANDLED ERROR: ",Hw(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=z_.createAndSchedule(this,e,t,r,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&xe(47125,{Pc:Hw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Hw(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class s6{constructor(){this._progressObserver={},this._taskCompletionResolver=new An,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const i6=-1;let Qt=class extends rh{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new Fw,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fw(e),this._firestoreClient=void 0,await e}}};function Mn(s){if(s._terminated)throw new le(W.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||K1(s),s._firestoreClient}function K1(s){const e=s._freezeSettings(),t=t6(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new q4(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(s._componentsProvider))}function a6(s,e){zs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=s._freezeSettings();return $1(s,Vd.provider,{build:r=>new V1(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function o6(s){zs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=s._freezeSettings();$1(s,Vd.provider,{build:t=>new L4(t,e.cacheSizeBytes)})}function $1(s,e,t){if((s=st(s,Qt))._firestoreClient||s._terminated)throw new le(W.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(s._componentsProvider||s._getSettings().localCache)throw new le(W.FAILED_PRECONDITION,"SDK cache is already specified.");s._componentsProvider={_online:e,_offline:t},K1(s)}function l6(s){if(s._initialized&&!s._terminated)throw new le(W.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new An;return s._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!Vs.v())return Promise.resolve();const a=r+o1;await Vs.delete(a)})(D_(s._databaseId,s._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function c6(s){return(function(t){const r=new An;return t.asyncQueue.enqueueAndForget((async()=>I4(await J_(t),r))),r.promise})(Mn(s=st(s,Qt)))}function u6(s){return H4(Mn(s=st(s,Qt)))}function d6(s){return G4(Mn(s=st(s,Qt)))}function h6(s,e){const t=Mn(s=st(s,Qt)),r=new s6;return J4(t,s._databaseId,e,r),r}function f6(s,e){return Z4(Mn(s=st(s,Qt)),e).then((t=>t?new Gn(s,null,t.query):null))}class Vn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vn(Mt.fromBase64String(e))}catch(t){throw new le(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Vn(Mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Qd(e,Vn._jsonSchema))return Vn.fromBase64String(e.bytes)}}Vn._jsonSchemaVersion="firestore/bytes/1.0",Vn._jsonSchema={type:an("string",Vn._jsonSchemaVersion),bytes:an("string")};let Mo=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new le(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Rt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let qo=class{constructor(e){this._methodName=e}};class Zr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new le(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new le(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return De(this._lat,e._lat)||De(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Zr._jsonSchemaVersion}}static fromJSON(e){if(Qd(e,Zr._jsonSchema))return new Zr(e.latitude,e.longitude)}}Zr._jsonSchemaVersion="firestore/geoPoint/1.0",Zr._jsonSchema={type:an("string",Zr._jsonSchemaVersion),latitude:an("number"),longitude:an("number")};class es{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let l=0;l<r.length;++l)if(r[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:es._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Qd(e,es._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new es(e.vectorValues);throw new le(W.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}es._jsonSchemaVersion="firestore/vectorValue/1.0",es._jsonSchema={type:an("string",es._jsonSchemaVersion),vectorValues:an("object")};const m6=/^__.*__$/;class p6{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new bi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Rc(e,this.data,t,this.fieldTransforms)}}class Y1{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new bi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function W1(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xe(40011,{dataSource:s})}}class sp{constructor(e,t,r,a,l,u){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new sp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){const t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Am(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(W1(this.dataSource)&&m6.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class g6{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||th(e)}createContext(e,t,r,a=!1){return new sp({dataSource:e,methodName:t,targetDoc:r,path:Rt.emptyPath(),arrayElement:!1,hasConverter:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fo(s){const e=s._freezeSettings(),t=th(s._databaseId);return new g6(s._databaseId,!!e.ignoreUndefinedProperties,t)}function ip(s,e,t,r,a,l={}){const u=s.createContext(l.merge||l.mergeFields?2:0,e,t,a);iv("Data must be an object, but it was:",u,r);const p=Z1(r,u);let f,y;if(l.merge)f=new sr(u.fieldMask),y=u.fieldTransforms;else if(l.mergeFields){const b=[];for(const E of l.mergeFields){const T=Lo(e,E,t);if(!u.contains(T))throw new le(W.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);nN(b,T)||b.push(T)}f=new sr(b),y=u.fieldTransforms.filter((E=>f.covers(E.field)))}else f=null,y=u.fieldTransforms;return new p6(new Sn(p),f,y)}class sh extends qo{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof sh}}function X1(s,e,t){return new sp({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Z_ extends qo{_toFieldTransform(e){return new Jd(e.path,new hc)}isEqual(e){return e instanceof Z_}}class ev extends qo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=X1(this,e,!0),r=this.Ac.map((l=>Ho(l,t))),a=new ko(r);return new Jd(e.path,a)}isEqual(e){return e instanceof ev&&fa(this.Ac,e.Ac)}}class tv extends qo{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=X1(this,e,!0),r=this.Ac.map((l=>Ho(l,t))),a=new Do(r);return new Jd(e.path,a)}isEqual(e){return e instanceof tv&&fa(this.Ac,e.Ac)}}class nv extends qo{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new fc(e.serializer,TA(e.serializer,this.Vc));return new Jd(e.path,t)}isEqual(e){return e instanceof nv&&this.Vc===e.Vc}}function rv(s,e,t,r){const a=s.createContext(1,e,t);iv("Data must be an object, but it was:",a,r);const l=[],u=Sn.empty();Na(r,((f,y)=>{const b=tN(e,f,t);y=Ce(y);const E=a.childContextForFieldPath(b);if(y instanceof sh)l.push(b);else{const T=Ho(y,E);T!=null&&(l.push(b),u.set(b,T))}}));const p=new sr(l);return new Y1(u,p,a.fieldTransforms)}function sv(s,e,t,r,a,l){const u=s.createContext(1,e,t),p=[Lo(e,r,t)],f=[a];if(l.length%2!=0)throw new le(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<l.length;T+=2)p.push(Lo(e,l[T])),f.push(l[T+1]);const y=[],b=Sn.empty();for(let T=p.length-1;T>=0;--T)if(!nN(y,p[T])){const N=p[T];let B=f[T];B=Ce(B);const G=u.childContextForFieldPath(N);if(B instanceof sh)y.push(N);else{const te=Ho(B,G);te!=null&&(y.push(N),b.set(N,te))}}const E=new sr(y);return new Y1(b,E,u.fieldTransforms)}function J1(s,e,t,r=!1){return Ho(t,s.createContext(r?4:3,e))}function Ho(s,e){if(eN(s=Ce(s)))return iv("Unsupported field value:",e,s),Z1(s,e);if(s instanceof qo)return(function(r,a){if(!W1(a.dataSource))throw a.createError(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.createError(`${r._methodName}() is not currently supported inside arrays`);const l=r._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,a){const l=[];let u=0;for(const p of r){let f=Ho(p,a.childContextForArray(u));f==null&&(f={nullValue:"NULL_VALUE"}),l.push(f),u++}return{arrayValue:{values:l}}})(s,e)}return(function(r,a){if((r=Ce(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return TA(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const l=lt.fromDate(r);return{timestampValue:mc(a.serializer,l)}}if(r instanceof lt){const l=new lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:mc(a.serializer,l)}}if(r instanceof Zr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Vn)return{bytesValue:VA(a.serializer,r._byteString)};if(r instanceof vt){const l=a.databaseId,u=r.firestore._databaseId;if(!u.isEqual(l))throw a.createError(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:I_(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof es)return(function(u,p){const f=u instanceof es?u.toArray():u;return{mapValue:{fields:{[m_]:{stringValue:p_},[cc]:{arrayValue:{values:f.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return v_(p.serializer,b)}))}}}}}})(r,a);if(KA(r))return r._toProto(a.serializer);throw a.createError(`Unsupported field value: ${Bm(r)}`)})(s,e)}function Z1(s,e){const t={};return JS(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Na(s,((r,a)=>{const l=Ho(a,e.childContextForField(r));l!=null&&(t[r]=l)})),{mapValue:{fields:t}}}function eN(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof lt||s instanceof Zr||s instanceof Vn||s instanceof vt||s instanceof qo||s instanceof es||KA(s))}function iv(s,e,t){if(!eN(t)||!jS(t)){const r=Bm(t);throw r==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+r)}}function Lo(s,e,t){if((e=Ce(e))instanceof Mo)return e._internalPath;if(typeof e=="string")return tN(s,e);throw Am("Field path arguments must be of type string or ",s,!1,void 0,t)}const y6=new RegExp("[~\\*/\\[\\]]");function tN(s,e,t){if(e.search(y6)>=0)throw Am(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Mo(...e.split("."))._internalPath}catch{throw Am(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Am(s,e,t,r,a){const l=r&&!r.isEmpty(),u=a!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let f="";return(l||u)&&(f+=" (found",l&&(f+=` in field ${r}`),u&&(f+=` in document ${a}`),f+=")"),new le(W.INVALID_ARGUMENT,p+s+f)}function nN(s,e){return s.some((t=>t.isEqual(e)))}class av{convertValue(e,t="none"){switch(va(e)){case 0:return null;case 1:return e.booleanValue;case 2:return At(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(pi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw xe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Na(e,((a,l)=>{r[a]=this.convertValue(l,t)})),r}convertVectorValue(e){const t=e.fields?.[cc].arrayValue?.values?.map((r=>At(r.doubleValue)));return new es(t)}convertGeoPoint(e){return new Zr(At(e.latitude),At(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Km(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Nd(e));default:return null}}convertTimestamp(e){const t=mi(e);return new lt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ke.fromString(e);we(QA(r),9688,{name:e});const a=new _a(r.get(1),r.get(3)),l=new ye(r.popFirst(5));return a.isEqual(t)||Ht(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}class Go extends av{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vt(this.firestore,null,t)}}function _6(){return new sh("deleteField")}function v6(){return new Z_("serverTimestamp")}function b6(...s){return new ev("arrayUnion",s)}function x6(...s){return new tv("arrayRemove",s)}function E6(s){return new nv("increment",s)}const Gw="@firebase/firestore",Qw="4.10.0";function x0(s){return(function(t,r){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of r)if(l in a&&typeof a[l]=="function")return!0;return!1})(s,["next","error","complete"])}class Od{constructor(e,t,r,a,l){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new vt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new T6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(Lo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class T6 extends Od{data(){return super.data()}}function rN(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new le(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ov{}class ih extends ov{}function ra(s,e,...t){let r=[];e instanceof ov&&r.push(e),r=r.concat(t),(function(l){const u=l.filter((f=>f instanceof lv)).length,p=l.filter((f=>f instanceof ap)).length;if(u>1||u>0&&p>0)throw new le(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const a of r)s=a._apply(s);return s}class ap extends ih{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new ap(e,t,r)}_apply(e){const t=this._parse(e);return iN(e._query,t),new Gn(e.firestore,e.converter,l0(e._query,t))}_parse(e){const t=Fo(e.firestore);return(function(l,u,p,f,y,b,E){let T;if(y.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new le(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){$w(E,b);const B=[];for(const G of E)B.push(Kw(f,l,G));T={arrayValue:{values:B}}}else T=Kw(f,l,E)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||$w(E,b),T=J1(p,u,E,b==="in"||b==="not-in");return Xe.create(y,b,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function w6(s,e,t){const r=e,a=Lo("where",s);return ap._create(a,r,t)}class lv extends ov{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new lv(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let u=a;const p=l.getFlattenedFilters();for(const f of p)iN(u,f),u=l0(u,f)})(e._query,t),new Gn(e.firestore,e.converter,l0(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class cv extends ih{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new cv(e,t)}_apply(e){const t=(function(a,l,u){if(a.startAt!==null)throw new le(W.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new le(W.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new kd(l,u)})(e._query,this._field,this._direction);return new Gn(e.firestore,e.converter,RO(e._query,t))}}function I6(s,e="asc"){const t=e,r=Lo("orderBy",s);return cv._create(r,t)}class op extends ih{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new op(e,t,r)}_apply(e){return new Gn(e.firestore,e.converter,ym(e._query,this._limit,this._limitType))}}function S6(s){return VS("limit",s),op._create("limit",s,"F")}function A6(s){return VS("limitToLast",s),op._create("limitToLast",s,"L")}class lp extends ih{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new lp(e,t,r)}_apply(e){const t=sN(e,this.type,this._docOrFields,this._inclusive);return new Gn(e.firestore,e.converter,CO(e._query,t))}}function N6(...s){return lp._create("startAt",s,!0)}function R6(...s){return lp._create("startAfter",s,!1)}class cp extends ih{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new cp(e,t,r)}_apply(e){const t=sN(e,this.type,this._docOrFields,this._inclusive);return new Gn(e.firestore,e.converter,kO(e._query,t))}}function C6(...s){return cp._create("endBefore",s,!1)}function k6(...s){return cp._create("endAt",s,!0)}function sN(s,e,t,r){if(t[0]=Ce(t[0]),t[0]instanceof Od)return(function(l,u,p,f,y){if(!f)throw new le(W.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${p}().`);const b=[];for(const E of Wl(l))if(E.field.isKeyField())b.push(Ro(u,f.key));else{const T=f.data.field(E.field);if(Qm(T))throw new le(W.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+E.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const N=E.field.canonicalString();throw new le(W.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${N}' (used as the orderBy) does not exist.`)}b.push(T)}return new xa(b,y)})(s._query,s.firestore._databaseId,e,t[0]._document,r);{const a=Fo(s.firestore);return(function(u,p,f,y,b,E){const T=u.explicitOrderBy;if(b.length>T.length)throw new le(W.INVALID_ARGUMENT,`Too many arguments provided to ${y}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const N=[];for(let B=0;B<b.length;B++){const G=b[B];if(T[B].field.isKeyField()){if(typeof G!="string")throw new le(W.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${y}(), but got a ${typeof G}`);if(!y_(u)&&G.indexOf("/")!==-1)throw new le(W.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${y}() must be a plain document ID, but '${G}' contains a slash.`);const te=u.path.child(Ke.fromString(G));if(!ye.isDocumentKey(te))throw new le(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${y}() must result in a valid document path, but '${te}' is not because it contains an odd number of segments.`);const I=new ye(te);N.push(Ro(p,I))}else{const te=J1(f,y,G);N.push(te)}}return new xa(N,E)})(s._query,s.firestore._databaseId,a,e,t,r)}}function Kw(s,e,t){if(typeof(t=Ce(t))=="string"){if(t==="")throw new le(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!y_(e)&&t.indexOf("/")!==-1)throw new le(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ke.fromString(t));if(!ye.isDocumentKey(r))throw new le(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ro(s,new ye(r))}if(t instanceof vt)return Ro(s,t._key);throw new le(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bm(t)}.`)}function $w(s,e){if(!Array.isArray(s)||s.length===0)throw new le(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function iN(s,e){const t=(function(a,l){for(const u of a)for(const p of u.getFlattenedFilters())if(l.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new le(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new le(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function up(s,e,t){let r;return r=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,r}class D6 extends av{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vt(this.firestore,null,t)}}class vo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Or=class aN extends Od{constructor(e,t,r,a,l,u){super(e,t,r,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new pd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Lo("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new le(W.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=aN._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Or._jsonSchemaVersion="firestore/documentSnapshot/1.0",Or._jsonSchema={type:an("string",Or._jsonSchemaVersion),bundleSource:an("string","DocumentSnapshot"),bundleName:an("string"),bundle:an("string")};let pd=class extends Or{data(e={}){return super.data(e)}},ts=class oN{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new vo(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new pd(this._firestore,this._userDataWriter,r.key,r,new vo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new le(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((p=>{const f=new pd(a._firestore,a._userDataWriter,p.doc.key,p.doc,new vo(a._snapshot.mutatedKeys.has(p.doc.key),a._snapshot.fromCache),a.query.converter);return p.doc,{type:"added",doc:f,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((p=>l||p.type!==3)).map((p=>{const f=new pd(a._firestore,a._userDataWriter,p.doc.key,p.doc,new vo(a._snapshot.mutatedKeys.has(p.doc.key),a._snapshot.fromCache),a.query.converter);let y=-1,b=-1;return p.type!==0&&(y=u.indexOf(p.doc.key),u=u.delete(p.doc.key)),p.type!==1&&(u=u.add(p.doc),b=u.indexOf(p.doc.key)),{type:P6(p.type),doc:f,oldIndex:y,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new le(W.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=oN._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=a_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),r.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function P6(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xe(61501,{type:s})}}function lN(s,e){return s instanceof Or&&e instanceof Or?s._firestore===e._firestore&&s._key.isEqual(e._key)&&(s._document===null?e._document===null:s._document.isEqual(e._document))&&s._converter===e._converter:s instanceof ts&&e instanceof ts&&s._firestore===e._firestore&&Q1(s.query,e.query)&&s.metadata.isEqual(e.metadata)&&s._snapshot.isEqual(e._snapshot)}ts._jsonSchemaVersion="firestore/querySnapshot/1.0",ts._jsonSchema={type:an("string",ts._jsonSchemaVersion),bundleSource:an("string","QuerySnapshot"),bundleName:an("string"),bundle:an("string")};const j6={maxAttempts:5};let V6=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Fo(e)}set(e,t,r){this._verifyNotCommitted();const a=oa(e,this._firestore),l=up(a.converter,t,r),u=ip(this._dataReader,"WriteBatch.set",a._key,l,a.converter!==null,r);return this._mutations.push(u.toMutation(a._key,Ct.none())),this}update(e,t,r,...a){this._verifyNotCommitted();const l=oa(e,this._firestore);let u;return u=typeof(t=Ce(t))=="string"||t instanceof Mo?sv(this._dataReader,"WriteBatch.update",l._key,t,r,a):rv(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(u.toMutation(l._key,Ct.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=oa(e,this._firestore);return this._mutations=this._mutations.concat(new Cc(t._key,Ct.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new le(W.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function oa(s,e){if((s=Ce(s)).firestore!==e)throw new le(W.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}class O6{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Fo(e)}get(e){const t=oa(e,this._firestore),r=new D6(this._firestore);return this._transaction.lookup([t._key]).then((a=>{if(!a||a.length!==1)return xe(24041);const l=a[0];if(l.isFoundDocument())return new Od(this._firestore,r,l.key,l,t.converter);if(l.isNoDocument())return new Od(this._firestore,r,t._key,null,t.converter);throw xe(18433,{doc:l})}))}set(e,t,r){const a=oa(e,this._firestore),l=up(a.converter,t,r),u=ip(this._dataReader,"Transaction.set",a._key,l,a.converter!==null,r);return this._transaction.set(a._key,u),this}update(e,t,r,...a){const l=oa(e,this._firestore);let u;return u=typeof(t=Ce(t))=="string"||t instanceof Mo?sv(this._dataReader,"Transaction.update",l._key,t,r,a):rv(this._dataReader,"Transaction.update",l._key,t),this._transaction.update(l._key,u),this}delete(e){const t=oa(e,this._firestore);return this._transaction.delete(t._key),this}}let M6=class extends O6{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=oa(e,this._firestore),r=new Go(this._firestore);return super.get(e).then((a=>new Or(this._firestore,r,t._key,a._document,new vo(!1,!1),t.converter)))}};function L6(s,e,t){s=st(s,Qt);const r={...j6,...t};(function(u){if(u.maxAttempts<1)throw new le(W.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const a=Mn(s);return X4(a,(l=>e(new M6(s,l))),r)}function U6(s){s=st(s,vt);const e=st(s.firestore,Qt),t=Mn(e);return L1(t,s._key).then((r=>uv(e,s,r)))}function z6(s){s=st(s,vt);const e=st(s.firestore,Qt),t=Mn(e),r=new Go(e);return K4(t,s._key).then((a=>new Or(e,r,s._key,a,new vo(a!==null&&a.hasLocalMutations,!0),s.converter)))}function B6(s){s=st(s,vt);const e=st(s.firestore,Qt),t=Mn(e);return L1(t,s._key,{source:"server"}).then((r=>uv(e,s,r)))}function q6(s){s=st(s,Gn);const e=st(s.firestore,Qt),t=Mn(e),r=new Go(e);return rN(s._query),U1(t,s._query).then((a=>new ts(e,r,s,a)))}function F6(s){s=st(s,Gn);const e=st(s.firestore,Qt),t=Mn(e),r=new Go(e);return $4(t,s._query).then((a=>new ts(e,r,s,a)))}function H6(s){s=st(s,Gn);const e=st(s.firestore,Qt),t=Mn(e),r=new Go(e);return U1(t,s._query,{source:"server"}).then((a=>new ts(e,r,s,a)))}function Yw(s,e,t){s=st(s,vt);const r=st(s.firestore,Qt),a=up(s.converter,e,t),l=Fo(r);return ah(r,[ip(l,"setDoc",s._key,a,s.converter!==null,t).toMutation(s._key,Ct.none())])}function Ww(s,e,t,...r){s=st(s,vt);const a=st(s.firestore,Qt),l=Fo(a);let u;return u=typeof(e=Ce(e))=="string"||e instanceof Mo?sv(l,"updateDoc",s._key,e,t,r):rv(l,"updateDoc",s._key,e),ah(a,[u.toMutation(s._key,Ct.exists(!0))])}function G6(s){return ah(st(s.firestore,Qt),[new Cc(s._key,Ct.none())])}function Q6(s,e){const t=st(s.firestore,Qt),r=Sm(s),a=up(s.converter,e),l=Fo(s.firestore);return ah(t,[ip(l,"addDoc",r._key,a,s.converter!==null,{}).toMutation(r._key,Ct.exists(!1))]).then((()=>r))}function cN(s,...e){s=Ce(s);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||x0(e[r])||(t=e[r++]);const a={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(x0(e[r])){const y=e[r];e[r]=y.next?.bind(y),e[r+1]=y.error?.bind(y),e[r+2]=y.complete?.bind(y)}let l,u,p;if(s instanceof vt)u=st(s.firestore,Qt),p=Nc(s._key.path),l={next:y=>{e[r]&&e[r](uv(u,s,y))},error:e[r+1],complete:e[r+2]};else{const y=st(s,Gn);u=st(y.firestore,Qt),p=y._query;const b=new Go(u);l={next:E=>{e[r]&&e[r](new ts(u,b,y,E))},error:e[r+1],complete:e[r+2]},rN(s._query)}const f=Mn(u);return Q4(f,p,a,l)}function K6(s,e){s=st(s,Qt);const t=Mn(s),r=x0(e)?e:{next:e};return W4(t,r)}function ah(s,e){const t=Mn(s);return Y4(t,e)}function uv(s,e,t){const r=t.docs.get(e._key),a=new Go(s);return new Or(s,a,e._key,r,new vo(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){wV(wa),ga(new Ls("firestore",((r,{instanceIdentifier:a,options:l})=>{const u=r.getProvider("app").getImmediate(),p=new Qt(new RV(r.getProvider("auth-internal")),new DV(u,r.getProvider("app-check-internal")),gO(u,a),u);return l={useFetchStreams:t,...l},p._setSettings(l),p}),"PUBLIC").setMultipleInstances(!0)),Jr(Gw,Qw,e),Jr(Gw,Qw,"esm2020")})();const $6="@firebase/firestore-compat",Y6="0.4.4";function dv(s,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new le("invalid-argument",`Invalid options passed to function ${s}(): You cannot specify both "merge" and "mergeFields".`);return e}function Xw(){if(typeof Uint8Array>"u")throw new le("unimplemented","Uint8Arrays are not available in this environment.")}function Jw(){if(!fO())throw new le("unimplemented","Blobs are unavailable in Firestore in this environment.")}let uN=class E0{constructor(e){this._delegate=e}static fromBase64String(e){return Jw(),new E0(Vn.fromBase64String(e))}static fromUint8Array(e){return Xw(),new E0(Vn.fromUint8Array(e))}toBase64(){return Jw(),this._delegate.toBase64()}toUint8Array(){return Xw(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function T0(s){return W6(s,["next","error","complete"])}function W6(s,e){if(typeof s!="object"||s===null)return!1;const t=s;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class X6{enableIndexedDbPersistence(e,t){return a6(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return o6(e._delegate)}clearIndexedDbPersistence(e){return l6(e._delegate)}}class dN{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof _a||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&zs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){n6(this._delegate,e,t,r)}enableNetwork(){return u6(this._delegate)}disableNetwork(){return d6(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,PS("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return c6(this._delegate)}onSnapshotsInSync(e){return K6(this._delegate,e)}get app(){if(!this._appCompat)throw new le("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new xc(this,H1(this._delegate,e))}catch(t){throw qn(t,"collection()","Firestore.collection()")}}doc(e){try{return new jr(this,Sm(this._delegate,e))}catch(t){throw qn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Bn(this,r6(this._delegate,e))}catch(t){throw qn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return L6(this._delegate,t=>e(new hN(this,t)))}batch(){return Mn(this._delegate),new fN(new V6(this._delegate,e=>ah(this._delegate,e)))}loadBundle(e){return h6(this._delegate,e)}namedQuery(e){return f6(this._delegate,e).then(t=>t?new Bn(this,t):null)}}class dp extends av{constructor(e){super(),this.firestore=e}convertBytes(e){return new uN(new Vn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return jr.forKey(t,this.firestore,null)}}function J6(s){IV(s)}class hN{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new dp(e)}get(e){const t=bo(e);return this._delegate.get(t).then(r=>new Md(this._firestore,new Or(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const a=bo(e);return r?(dv("Transaction.set",r),this._delegate.set(a,t,r)):this._delegate.set(a,t),this}update(e,t,r,...a){const l=bo(e);return arguments.length===2?this._delegate.update(l,t):this._delegate.update(l,t,r,...a),this}delete(e){const t=bo(e);return this._delegate.delete(t),this}}class fN{constructor(e){this._delegate=e}set(e,t,r){const a=bo(e);return r?(dv("WriteBatch.set",r),this._delegate.set(a,t,r)):this._delegate.set(a,t),this}update(e,t,r,...a){const l=bo(e);return arguments.length===2?this._delegate.update(l,t):this._delegate.update(l,t,r,...a),this}delete(e){const t=bo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Uo{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new pd(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ld(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Uo.INSTANCES;let a=r.get(e);a||(a=new WeakMap,r.set(e,a));let l=a.get(t);return l||(l=new Uo(e,new dp(e),t),a.set(t,l)),l}}Uo.INSTANCES=new WeakMap;class jr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new dp(e)}static forPath(e,t,r){if(e.length%2!==0)throw new le("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new jr(t,new vt(t._delegate,r,new ye(e)))}static forKey(e,t,r){return new jr(t,new vt(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new xc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new xc(this.firestore,H1(this._delegate,e))}catch(t){throw qn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ce(e),e instanceof vt?G1(this._delegate,e):!1}set(e,t){t=dv("DocumentReference.set",t);try{return t?Yw(this._delegate,e,t):Yw(this._delegate,e)}catch(r){throw qn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?Ww(this._delegate,e):Ww(this._delegate,e,t,...r)}catch(a){throw qn(a,"updateDoc()","DocumentReference.update()")}}delete(){return G6(this._delegate)}onSnapshot(...e){const t=mN(e),r=pN(e,a=>new Md(this.firestore,new Or(this.firestore._delegate,this._userDataWriter,a._key,a._document,a.metadata,this._delegate.converter)));return cN(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=z6(this._delegate):e?.source==="server"?t=B6(this._delegate):t=U6(this._delegate),t.then(r=>new Md(this.firestore,new Or(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new jr(this.firestore,e?this._delegate.withConverter(Uo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function qn(s,e,t){return s.message=s.message.replace(e,t),s}function mN(s){for(const e of s)if(typeof e=="object"&&!T0(e))return e;return{}}function pN(s,e){let t;return T0(s[0])?t=s[0]:T0(s[1])?t=s[1]:typeof s[0]=="function"?t={next:s[0],error:s[1],complete:s[2]}:t={next:s[1],error:s[2],complete:s[3]},{next:r=>{t.next&&t.next(e(r))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}class Md{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new jr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return lN(this._delegate,e._delegate)}}class Ld extends Md{data(e){const t=this._delegate.data(e);return this._delegate._converter||SV(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Bn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new dp(e)}where(e,t,r){try{return new Bn(this.firestore,ra(this._delegate,w6(e,t,r)))}catch(a){throw qn(a,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Bn(this.firestore,ra(this._delegate,I6(e,t)))}catch(r){throw qn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Bn(this.firestore,ra(this._delegate,S6(e)))}catch(t){throw qn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Bn(this.firestore,ra(this._delegate,A6(e)))}catch(t){throw qn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Bn(this.firestore,ra(this._delegate,N6(...e)))}catch(t){throw qn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Bn(this.firestore,ra(this._delegate,R6(...e)))}catch(t){throw qn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Bn(this.firestore,ra(this._delegate,C6(...e)))}catch(t){throw qn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Bn(this.firestore,ra(this._delegate,k6(...e)))}catch(t){throw qn(t,"endAt()","Query.endAt()")}}isEqual(e){return Q1(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=F6(this._delegate):e?.source==="server"?t=H6(this._delegate):t=q6(this._delegate),t.then(r=>new w0(this.firestore,new ts(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=mN(e),r=pN(e,a=>new w0(this.firestore,new ts(this.firestore._delegate,this._userDataWriter,this._delegate,a._snapshot)));return cN(this._delegate,t,r)}withConverter(e){return new Bn(this.firestore,e?this._delegate.withConverter(Uo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Z6{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ld(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class w0{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Bn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ld(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Z6(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Ld(this._firestore,r))})}isEqual(e){return lN(this._delegate,e._delegate)}}class xc extends Bn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new jr(this.firestore,e):null}doc(e){try{return e===void 0?new jr(this.firestore,Sm(this._delegate)):new jr(this.firestore,Sm(this._delegate,e))}catch(t){throw qn(t,"doc()","CollectionReference.doc()")}}add(e){return Q6(this._delegate,e).then(t=>new jr(this.firestore,t))}isEqual(e){return G1(this._delegate,e._delegate)}withConverter(e){return new xc(this.firestore,e?this._delegate.withConverter(Uo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function bo(s){return st(s,vt)}class hv{constructor(...e){this._delegate=new Mo(...e)}static documentId(){return new hv(Rt.keyField().canonicalString())}isEqual(e){return e=Ce(e),e instanceof Mo?this._delegate._internalPath.isEqual(e._internalPath):!1}}class po{static serverTimestamp(){const e=v6();return e._methodName="FieldValue.serverTimestamp",new po(e)}static delete(){const e=_6();return e._methodName="FieldValue.delete",new po(e)}static arrayUnion(...e){const t=b6(...e);return t._methodName="FieldValue.arrayUnion",new po(t)}static arrayRemove(...e){const t=x6(...e);return t._methodName="FieldValue.arrayRemove",new po(t)}static increment(e){const t=E6(e);return t._methodName="FieldValue.increment",new po(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}const e3={Firestore:dN,GeoPoint:Zr,Timestamp:lt,Blob:uN,Transaction:hN,WriteBatch:fN,DocumentReference:jr,DocumentSnapshot:Md,Query:Bn,QueryDocumentSnapshot:Ld,QuerySnapshot:w0,CollectionReference:xc,FieldPath:hv,FieldValue:po,setLogLevel:J6,CACHE_SIZE_UNLIMITED:i6};function t3(s,e){s.INTERNAL.registerComponent(new Ls("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),a=t.getProvider("firestore").getImmediate();return e(r,a)},"PUBLIC").setServiceProps({...e3}))}function n3(s){t3(s,(e,t)=>new dN(e,t,new X6)),s.registerVersion($6,Y6)}n3(js);const r3={apiKey:"AIzaSyDS5RsnYL49tertpcIUXPa3dppw_soU1FQ",authDomain:"led-react-6204e.firebaseapp.com",projectId:"led-react-6204e",storageBucket:"led-react-6204e.firebasestorage.app",messagingSenderId:"500086523818",appId:"1:500086523818:web:74b4a57f9c55730eee4dd3",measurementId:"G-B0D52YG6QQ"};js.apps.length?js.app():js.initializeApp(r3);const Zw=js.auth(),Vr=js.firestore(),Ms="admire-signage-external",Oe=(s,e="INR",t=!1)=>new Intl.NumberFormat(e==="INR"?"en-IN":"en-US",{style:"currency",currency:e,maximumFractionDigits:t?1:0,notation:t?"compact":"standard"}).format(s),I0=()=>Math.random().toString(36).substr(2,9).toUpperCase(),xo=(s,e,t,r)=>{if(!s||!e)return null;const{screenQty:a,targetWidth:l,targetHeight:u,unit:p,selectedIndoor:f,assemblyMode:y,selectedPitch:b,selectedModuleId:E,selectedCabinetId:T,selectedCardId:N,selectedSMPSId:B,selectedProcId:G,sizingMode:te,readyId:I,margin:X,extras:se,overrides:fe,extraComponents:H,pricingMode:ae,targetSellPrice:A,commercials:R,terms:k}=s,j=Number(a||1),P=be=>{if(!be)return 0;const je=Number(be.price||0),Je=Number(be.carriage||0),rs=je+Je;return be.currency==="USD"?rs*r:rs};let L,C,Me,Pe,Z,pe=0;if(y==="assembled"){if(L=e.find(be=>be.id===E),C=e.find(be=>be.id===T),Me=e.find(be=>be.id===N),Pe=e.find(be=>be.id===B),Z=e.find(be=>be.id===G),!L||!C)return null}else{const be=e.find(je=>je.id===I);if(Z=e.find(je=>je.id===G),!be)return null;L=be,C=be}const Ee=p==="m"?l*1e3:l*304.8,Ne=p==="m"?u*1e3:u*304.8,Le=Ee/C.width,V=Ne/C.height;let O,q;te==="up"?(O=Math.ceil(Le),q=Math.ceil(V)):te==="down"?(O=Math.max(1,Math.floor(Le)),q=Math.max(1,Math.floor(V))):(O=Math.max(1,Math.round(Le)),q=Math.max(1,Math.round(V)));const ne=O*C.width,de=q*C.height,me=O*q,_e=ne*de/92903;let it=[];if(y==="assembled"){const be=Math.floor(C.width/L.width)*Math.floor(C.height/L.height);pe=me*be,it=[{id:"modules",inventoryId:E,name:"Modules",spec:`${L.brand} ${L.model}`,qty:pe,unit:P(L),total:pe*P(L),type:"led"},{id:"cabinets",inventoryId:T,name:"Cabinets",spec:`${C.brand} ${C.model}`,qty:me,unit:P(C),total:me*P(C),type:"led"},{id:"cards",inventoryId:N,name:"Cards",spec:Me?Me.brand:"-",qty:me,unit:P(Me),total:me*P(Me),type:"led"},{id:"smps",inventoryId:B,name:"SMPS",spec:Pe?Pe.brand:"-",qty:me,unit:P(Pe),total:me*P(Pe),type:"led"}]}else it=[{id:"ready",inventoryId:I,name:"LED Panels (Ready)",spec:`${C.brand} ${C.model}`,qty:me,unit:P(C),total:me*P(C),type:"led"}],pe=me;it.push({id:"processor",inventoryId:G,name:"Processor",spec:Z?Z.brand:"Select Processor",qty:1,unit:Z?P(Z):0,total:Z?P(Z):0,type:"service"}),H&&H.length>0&&H.forEach(be=>{const je=e.find(Je=>Je.id===be.componentId);if(je){const Je=be.type==="cabinet"?be.qty*me:be.qty;it.push({id:be.id,inventoryId:be.componentId,name:`Extra: ${je.type}`,spec:`${je.brand} ${je.model}`,qty:Je,unit:P(je),total:Je*P(je),type:je.type==="processor"?"service":"led"})}else it.push({id:be.id,inventoryId:"",name:"Extra Component",spec:"Select Item...",qty:be.qty||1,unit:0,total:0,type:"led"})});const tt=it.map(be=>{if(fe&&fe[be.id]){const je=fe[be.id],Je=je.qty!==void 0&&je.qty!==""?Number(je.qty):be.qty,rs=je.rate!==void 0&&je.rate!==""?Number(je.rate):be.unit;return{...be,qty:Je,unit:rs,total:Je*rs,isOverridden:!0}}return be}),ar=tt.filter(be=>be.type==="led").reduce((be,je)=>be+je.total,0),zt=tt.filter(be=>be.type!=="led").reduce((be,je)=>be+je.total,0),_n={};let xr=0,on=0;Array.isArray(se)&&se.forEach(be=>{let je=0;const Je=ar;be.type==="pct"?je=Je*(Number(be.val)/100):je=Number(be.val),_n[be.id]=je,xr+=je});const Qn=R?.installation||{cost:0,costType:"abs"};let Cn=0;Qn.costType==="pct"?Cn=zt*(Number(Qn.cost)/100):(Qn.unit||"sqft")==="sqft"?Cn=Number(Qn.cost)*_e:Cn=Number(Qn.cost),_n.install=Cn,on+=Cn;const Kn=R?.structure||{cost:0,costType:"abs"};let $n=0;Kn.costType==="pct"?$n=zt*(Number(Kn.cost)/100):(Kn.unit||"sqft")==="sqft"?$n=Number(Kn.cost)*_e:$n=Number(Kn.cost),_n.structure=$n,on+=$n;const $e=ar+xr,xt=zt+on,kn=$e+xt,Y=kn*j,Ie=R||{processor:{val:0},installation:{val:0},structure:{val:0}};let qe=0;if(Ie.processor.unit==="unit"){const be=tt.find(Je=>Je.id==="processor"),je=be?be.qty:1;qe=Number(Ie.processor.val)*je*j}else qe=Number(Ie.processor.val)*j;let ce=0;Ie.installation.unit==="sqft"?ce=Number(Ie.installation.val)*_e*j:ce=Number(Ie.installation.val)*j;let kt=0;Ie.structure.unit==="sqft"?kt=Number(Ie.structure.val)*_e*j:kt=Number(Ie.structure.val)*j;const vn=qe+ce+kt;let Kt=0,ka=X;const qs=ae||"margin";if(qs==="margin")Kt=$e*(1+X/100);else{const be=Number(A||0);qs==="screen"?Kt=be:qs==="sqft"?Kt=be*_e:qs==="sqm"&&(Kt=be*(_e/10.7639)),$e>0?ka=(Kt-$e)/$e*100:ka=0}const Lr=Kt*j+vn,Ln=Lr-Y;return{gridCols:O,gridRows:q,finalWidth:(ne/1e3).toFixed(2),finalHeight:(de/1e3).toFixed(2),totalCabinets:me,moduleType:L,cabinetType:C,processor:Z,breakdown:{qtyModules:pe,ledOps:xr,serviceOps:on},detailedItems:tt,calculatedExtras:_n,costLEDPerScreen:$e,costServicesPerScreen:xt,costPerScreen:kn,totalProjectCost:Y,finalPrice:Lr,totalProjectSell:Lr,assemblyMode:y,screenQty:j,commercials:{sellProcTotal:qe,sellInstallTotal:ce,sellStructureTotal:kt},terms:k||{price:"Ex-works Mumbai",deliveryWeeks:10,payment:[]},matrix:{cost:{sqft:kn/_e,unit:kn,total:Y},margin:{sqft:Ln/j/_e,unit:Ln/j,total:Ln},sell:{sqft:Lr/j/_e,unit:Lr/j,total:Lr},led:{cost:$e,sell:Kt,margin:Kt-$e,marginPct:ka},sqft:{perScreen:_e,total:_e*j}}}},Dt={COMPANY:{NAME:"ADMIRE SIGN & DISPLAY PVT. LTD.",ADDRESS_1:"102, Priya Industrial Estate 4, K.T. Industrial Estate",ADDRESS_2:"Kherpada, Waliv, Vasai East, Mumbai - 401208",EMAIL:"info@admiresign.com",WEB:"www.admiresign.com"},DEFAULTS:{EXCHANGE_RATE:90,GST_RATE:18,DELIVERY_WEEKS:10,PRICE_BASIS:"Ex-works Mumbai",PAYMENT_TERMS:[{name:"Advance with PO",percent:60},{name:"Before dispatch",percent:30},{name:"After installation",percent:10}]},TEXT:{WARRANTY:"Against any manufacturing defect. Offsite support for troubleshooting. Client can sign up for Admires excellent AMC services for on-site support. Serious fault will be attended to by our technical team within 48-72 hours upon receipt of written complaints with pictures/videos of the fault. 2% Extra spares includes Modules, Power Supply, Receiver Card (if there are over 100 cabinets), Flat cables, 5V connectors, Power and Data Cable. Any damage to the screen due to force majure, natural disasters, electricity surge, earthing, accident, etc is not covered under the warranty. Power supplies damage due to power fluctuation will not be covered under warranty. Power supply will be under the direct warranty of the OEM supplier. If the repair requires additional components then these will be charged extra. Brightness control meter, Video Processor & Timer can be supplied at extra cost. Maintenance team visit in six months during warranty period.",SCOPE_STRUCTURE:"Foundation & Structure. Structural stability certificate from a consultant. For wall mounted outdoor screen, Client to ensure strong and solid brick wall, RCC beams and column base. For front access indoor screen, Client to ensure a strong base. Indoor Structures cannot be mounted on ACP Sheets, Gypsum boards etc. Scaffolding, Aluminium composite panelling if required. Personnel for troubleshooting training during the screen installation. Helpers for loading, unloading and installing the display at site.",SCOPE_ELEC:"Electricity 3 phase electric power near the site, not more than 5m from the site, before the commencement of work. Electrical distribution board within 5m from the screen. Conduited electrical cable. 4mm 2 core armored cable or 4mm 3 core cables, 32 ampere MCB, 1 switch board with 2 sockets. Good quality Stabiliser and timers. 1 Certified electrical engineer for all connections from power Main to the unit. Ventilation machineries such as Air Conditioners or Fans.",SCOPE_NET:"CAT 6 or Optic Fiber Data cable and its terminations. Data points near the screen. Space with power sockets for Video wall Controllers. Data source/AV room within 80 meters of the screen. Connections to be availed through CAT 6 cables duly terminated with RJ45. If the length is farther then Fiber optic converter will be required. Fiber optic converters, if required, will be charged extra. In case the fiber optic converter is required, single mode Fiber optic cable is to be provided by client from source point to the display, terminated as per specs with Patch Chords from the splicing unit to connect to screen.",SCOPE_SOFT:"3rd party Software for Content upload on screen will be provided by the controller card supplier. Admire cannot provide regular updates and application stability.",SCOPE_PERM:"All permissions such as PTW, work permits & gate passes for workers, engineers and executives.",SCOPE_PC:"As per specification, to be arranged by client.",VALIDITY:"30 days."}},s3=({user:s,transactions:e=[]})=>{const[t,r]=sn.useState([]),[a,l]=sn.useState(null),[u,p]=sn.useState(!1),[f,y]=sn.useState({type:"module",brand:"",model:"",vendor:"",pitch:"",width:"",height:"",price:"",carriage:"",currency:"INR",indoor:!0,brightness:"",refreshRate:"",ledType:"",lampMake:"",material:"",weight:"",avgPower:"",maxPower:"",contrast:"",viewAngleH:"",viewAngleV:"",ipFront:"",ipBack:"",ports:"",amps:""}),[b,E]=sn.useState(!0);sn.useEffect(()=>{if(!s||!Vr)return;const I=Vr.collection("artifacts").doc(Ms).collection("public").doc("data").collection("inventory").onSnapshot(X=>{const se=X.docs.map(fe=>({id:fe.id,...fe.data()}));r(se),E(!1)},X=>console.error(X));return()=>I()},[s]);const T=async()=>{if(f.type==="module"){if(!f.pitch||!f.brand||!f.model||!f.price||!f.width||!f.height||!f.weight||!f.avgPower||!f.maxPower||!f.brightness||!f.refreshRate||!f.contrast||!f.viewAngleH||!f.viewAngleV||!f.ipFront||!f.ipBack)return alert("Please fill all compulsory (*) fields.")}else if(f.type==="cabinet"){if(!f.brand||!f.material||!f.model||!f.price||!f.width||!f.height)return alert("Please fill all compulsory (*) fields.")}else if(f.type==="card"||f.type==="processor"){if(!f.brand||!f.model||!f.price||!f.vendor)return alert("Please fill all compulsory (*) fields.")}else if(f.type==="smps"){if(!f.brand||!f.model||!f.price||!f.vendor||!f.amps)return alert("Please fill all compulsory (*) fields.")}else if(f.type==="ready"){if(!f.pitch||!f.brand||!f.model||!f.price||!f.material||!f.width||!f.height||!f.weight||!f.avgPower||!f.maxPower||!f.brightness||!f.refreshRate||!f.contrast||!f.viewAngleH||!f.viewAngleV||!f.ipFront||!f.ipBack)return alert("Please fill all compulsory (*) fields.")}else if(!f.brand||!f.model)return alert("Brand and Model are required");try{const I=Vr.collection("artifacts").doc(Ms).collection("public").doc("data").collection("inventory"),X={...f,width:Number(f.width),height:Number(f.height),price:Number(f.price),carriage:Number(f.carriage||0),pitch:Number(f.pitch),currency:f.currency||"INR",indoor:f.indoor==="true"||f.indoor===!0,material:f.material||"",weight:f.weight?Number(f.weight):0,avgPower:f.avgPower?Number(f.avgPower):0,maxPower:f.maxPower?Number(f.maxPower):0,brightness:f.brightness?parseInt(f.brightness):0,refreshRate:f.refreshRate?parseInt(f.refreshRate):0,viewAngleH:f.viewAngleH?parseInt(f.viewAngleH):0,viewAngleV:f.viewAngleV?parseInt(f.viewAngleV):0,ipFront:f.ipFront?parseInt(f.ipFront):0,ipBack:f.ipBack?parseInt(f.ipBack):0,ports:f.ports?parseInt(f.ports):0,amps:f.amps?Number(f.amps):0,updatedAt:new Date};a?(await I.doc(a).update(X),l(null),p(!1)):(await I.add({...X,createdAt:new Date}),y({type:f.type,brand:"",model:"",vendor:"",pitch:"",width:"",height:"",price:"",carriage:"",currency:"INR",indoor:!0,brightness:"",refreshRate:"",ledType:"",lampMake:"",material:"",weight:"",avgPower:"",maxPower:"",contrast:"",viewAngleH:"",viewAngleV:"",ipFront:"",ipBack:"",ports:"",amps:""}),alert("Item Added!"))}catch(I){console.error(I)}},N=I=>{y({...I,vendor:I.vendor||"",currency:I.currency||"INR",carriage:I.carriage||0}),l(I.id),p(!0),window.scrollTo({top:0,behavior:"smooth"})},B=()=>{l(null),p(!1),y({type:"module",brand:"",model:"",vendor:"",pitch:"",width:"",height:"",price:"",carriage:"",currency:"INR",indoor:!0,brightness:"",refreshRate:"",ledType:"",lampMake:"",material:"",weight:"",avgPower:"",maxPower:"",contrast:"",viewAngleH:"",viewAngleV:"",ipFront:"",ipBack:"",ports:"",amps:""})},G=async I=>{confirm("Delete this item?")&&await Vr.collection("artifacts").doc(Ms).collection("public").doc("data").collection("inventory").doc(I).delete()},te=[...t].sort((I,X)=>{const se=(I.type||"").toLowerCase(),fe=(X.type||"").toLowerCase();if(se<fe)return-1;if(se>fe)return 1;const H=(I.brand+" "+I.model).toLowerCase(),ae=(X.brand+" "+X.model).toLowerCase();return H<ae?-1:H>ae?1:0});return h.jsxs("div",{className:"p-6 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[h.jsxs("div",{className:"flex justify-between items-center mb-6",children:[h.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-slate-800 dark:text-white",children:[h.jsx(nI,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"})," Components Management"]}),!u&&h.jsxs("button",{onClick:()=>p(!0),className:"bg-teal-600 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2 hover:bg-teal-700 transition-colors",children:[h.jsx(go,{size:16})," Add New Component"]})]}),u&&h.jsxs("div",{className:`grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 p-6 rounded-lg transition-colors border shadow-sm ${a?"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-700":"bg-slate-50 dark:bg-slate-700/50 border-slate-200 dark:border-slate-600"}`,children:[h.jsxs("div",{className:"col-span-2 md:col-span-4 flex justify-between items-center mb-2 pb-2 border-b border-slate-200 dark:border-slate-600",children:[h.jsx("h3",{className:"text-sm font-bold uppercase text-slate-500 dark:text-slate-400",children:a?"Editing Item":"Add New Item"}),h.jsxs("button",{onClick:B,className:"text-xs text-slate-500 hover:text-red-500 flex items-center gap-1",children:[h.jsx(N0,{size:14})," Close"]})]}),h.jsxs("select",{className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.type,onChange:I=>y({...f,type:I.target.value}),children:[h.jsx("option",{value:"module",children:"Module"}),h.jsx("option",{value:"cabinet",children:"Cabinet"}),h.jsx("option",{value:"ready",children:"Ready Unit"}),h.jsx("option",{value:"card",children:"Receiving Card"}),h.jsx("option",{value:"smps",children:"SMPS"}),h.jsx("option",{value:"processor",children:"Processor"})]}),(f.type==="module"||f.type==="ready")&&h.jsxs(h.Fragment,{children:[h.jsx("input",{placeholder:"Pitch*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white border-teal-500 ring-1 ring-teal-500",value:f.pitch,onChange:I=>y({...f,pitch:I.target.value})}),h.jsxs("select",{className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white border-teal-500 ring-1 ring-teal-500",value:f.indoor,onChange:I=>y({...f,indoor:I.target.value}),children:[h.jsx("option",{value:"true",children:"Indoor"}),h.jsx("option",{value:"false",children:"Outdoor"})]})]}),h.jsx("input",{placeholder:f.type==="module"||f.type==="ready"||f.type==="cabinet"||f.type==="card"||f.type==="processor"||f.type==="smps"?"Brand*":"Brand",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.brand,onChange:I=>y({...f,brand:I.target.value})}),h.jsx("input",{placeholder:f.type==="module"||f.type==="ready"||f.type==="cabinet"||f.type==="card"||f.type==="processor"||f.type==="psu"?"Model/SKU*":"Model",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.model,onChange:I=>y({...f,model:I.target.value})}),h.jsxs("div",{className:"flex gap-2 items-center col-span-2 md:col-span-1",children:[h.jsxs("div",{className:"flex-1 min-w-[100px]",title:"Base Price",children:[h.jsx("input",{placeholder:"Base Rate*",type:"number",className:"p-2 w-full border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.price,onChange:I=>y({...f,price:I.target.value})}),h.jsx("div",{className:"text-[9px] text-slate-400 mt-0.5 ml-1",children:"BASE RATE*"})]}),h.jsx("span",{className:"text-slate-400 font-bold mb-3",children:"+"}),h.jsxs("div",{className:"flex-1 min-w-[80px]",title:"Carriage Inwards",children:[h.jsx("input",{placeholder:"Carriage",type:"number",className:"p-2 w-full border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.carriage,onChange:I=>y({...f,carriage:I.target.value})}),h.jsx("div",{className:"text-[9px] text-slate-400 mt-0.5 ml-1",children:"CARRIAGE"})]}),h.jsx("div",{className:"flex-none mb-3",children:h.jsxs("select",{className:"p-2 border rounded bg-slate-100 dark:bg-slate-600 dark:border-slate-600 dark:text-white",value:f.currency,onChange:I=>y({...f,currency:I.target.value}),children:[h.jsx("option",{value:"INR",children:"INR"}),h.jsx("option",{value:"USD",children:"USD"})]})})]}),f.type!=="cabinet"&&h.jsx("input",{placeholder:f.type==="card"||f.type==="processor"||f.type==="smps"?"Vendor*":"Vendor",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.vendor,onChange:I=>y({...f,vendor:I.target.value})}),(f.type==="card"||f.type==="processor")&&h.jsx("input",{placeholder:"Ports (Optional)",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.ports,onChange:I=>y({...f,ports:I.target.value})}),f.type==="smps"&&h.jsx("input",{placeholder:"Capacity (Amps)*",type:"number",step:"0.1",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.amps,onChange:I=>y({...f,amps:I.target.value})}),f.type==="module"&&h.jsxs(h.Fragment,{children:[h.jsx("input",{placeholder:"LED Type",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.ledType,onChange:I=>y({...f,ledType:I.target.value})}),h.jsx("input",{placeholder:"Lamp Make",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.lampMake,onChange:I=>y({...f,lampMake:I.target.value})}),h.jsx("input",{placeholder:"Width (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.width,onChange:I=>y({...f,width:I.target.value})}),h.jsx("input",{placeholder:"Height (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.height,onChange:I=>y({...f,height:I.target.value})}),h.jsx("input",{placeholder:"Weight/sqm (kg)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.weight,onChange:I=>y({...f,weight:I.target.value})}),h.jsx("input",{placeholder:"Avg Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.avgPower,onChange:I=>y({...f,avgPower:I.target.value})}),h.jsx("input",{placeholder:"Max Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.maxPower,onChange:I=>y({...f,maxPower:I.target.value})}),h.jsx("input",{placeholder:"Brightness (nits)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.brightness,onChange:I=>y({...f,brightness:I.target.value})}),h.jsx("input",{placeholder:"Refresh Rate*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.refreshRate,onChange:I=>y({...f,refreshRate:I.target.value})}),h.jsx("input",{placeholder:"Contrast* (e.g. 5000:1)",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.contrast,onChange:I=>y({...f,contrast:I.target.value})}),h.jsx("input",{placeholder:"Viewing Angle (H)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.viewAngleH,onChange:I=>y({...f,viewAngleH:I.target.value})}),h.jsx("input",{placeholder:"Viewing Angle (V)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.viewAngleV,onChange:I=>y({...f,viewAngleV:I.target.value})}),h.jsx("input",{placeholder:"IP Protection (Front)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.ipFront,onChange:I=>y({...f,ipFront:I.target.value})}),h.jsx("input",{placeholder:"IP Protection (Back)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.ipBack,onChange:I=>y({...f,ipBack:I.target.value})})]}),f.type==="cabinet"&&h.jsxs(h.Fragment,{children:[h.jsx("input",{placeholder:"Material*",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.material,onChange:I=>y({...f,material:I.target.value})}),h.jsxs("select",{className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.indoor,onChange:I=>y({...f,indoor:I.target.value}),children:[h.jsx("option",{value:"true",children:"Indoor"}),h.jsx("option",{value:"false",children:"Outdoor"})]}),h.jsx("input",{placeholder:"Width (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.width,onChange:I=>y({...f,width:I.target.value})}),h.jsx("input",{placeholder:"Height (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.height,onChange:I=>y({...f,height:I.target.value})}),h.jsx("input",{placeholder:"Weight (kg)",type:"number",step:"1",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.weight,onChange:I=>y({...f,weight:I.target.value})})]}),f.type==="ready"&&h.jsxs(h.Fragment,{children:[h.jsx("input",{placeholder:"Cabinet Material*",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.material,onChange:I=>y({...f,material:I.target.value})}),h.jsx("input",{placeholder:"LED Type",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.ledType,onChange:I=>y({...f,ledType:I.target.value})}),h.jsx("input",{placeholder:"Lamp Make",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.lampMake,onChange:I=>y({...f,lampMake:I.target.value})}),h.jsx("input",{placeholder:"Width (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.width,onChange:I=>y({...f,width:I.target.value})}),h.jsx("input",{placeholder:"Height (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.height,onChange:I=>y({...f,height:I.target.value})}),h.jsx("input",{placeholder:"Weight/sqm (kg)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.weight,onChange:I=>y({...f,weight:I.target.value})}),h.jsx("input",{placeholder:"Avg Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.avgPower,onChange:I=>y({...f,avgPower:I.target.value})}),h.jsx("input",{placeholder:"Max Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.maxPower,onChange:I=>y({...f,maxPower:I.target.value})}),h.jsx("input",{placeholder:"Brightness (nits)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.brightness,onChange:I=>y({...f,brightness:I.target.value})}),h.jsx("input",{placeholder:"Refresh Rate*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.refreshRate,onChange:I=>y({...f,refreshRate:I.target.value})}),h.jsx("input",{placeholder:"Contrast* (e.g. 5000:1)",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.contrast,onChange:I=>y({...f,contrast:I.target.value})}),h.jsx("input",{placeholder:"Viewing Angle (H)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.viewAngleH,onChange:I=>y({...f,viewAngleH:I.target.value})}),h.jsx("input",{placeholder:"Viewing Angle (V)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.viewAngleV,onChange:I=>y({...f,viewAngleV:I.target.value})}),h.jsx("input",{placeholder:"IP Protection (Front)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.ipFront,onChange:I=>y({...f,ipFront:I.target.value})}),h.jsx("input",{placeholder:"IP Protection (Back)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:f.ipBack,onChange:I=>y({...f,ipBack:I.target.value})})]}),h.jsxs("button",{onClick:T,className:`px-4 py-2 rounded text-white flex items-center justify-center gap-2 hover:opacity-90 transition ${a?"bg-amber-600":"bg-teal-600"} col-span-2 md:col-span-1`,children:[a?h.jsx(Eo,{size:16}):h.jsx(go,{size:16}),a?"Update Item":"Add Item"]})]}),h.jsxs("div",{className:"mt-6",children:[h.jsx("div",{className:"md:hidden space-y-4",children:te.map(I=>{const X=e.filter(se=>se.itemId===I.id).reduce((se,fe)=>se+(fe.type==="in"?Number(fe.qty):-Number(fe.qty)),0);return h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm relative overflow-hidden",children:[h.jsx("div",{className:`absolute top-0 right-0 px-3 py-1 rounded-bl-lg text-[10px] font-bold uppercase tracking-wider ${I.type==="module"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-600 dark:bg-slate-700 dark:text-slate-300"}`,children:I.type}),h.jsxs("div",{className:"pr-16 mb-3",children:[h.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white text-lg",children:[I.brand," ",I.model]}),I.vendor&&h.jsx("div",{className:"text-xs text-teal-600 font-medium",children:I.vendor})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-xs text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-700/50 p-3 rounded-lg",children:[h.jsxs("div",{children:[h.jsx("span",{className:"block text-[10px] uppercase font-bold text-slate-400",children:"Specs"}),I.type==="module"?h.jsxs("span",{children:["P",I.pitch," ",I.indoor?"In":"Out","  ",I.width,"x",I.height]}):h.jsx("span",{children:I.width?`${I.width}x${I.height}`:"Standard"})]}),h.jsxs("div",{children:[h.jsx("span",{className:"block text-[10px] uppercase font-bold text-slate-400",children:"Stock"}),h.jsx("span",{className:`font-bold text-sm ${X<0?"text-red-500":"text-slate-700 dark:text-slate-200"}`,children:X})]}),h.jsxs("div",{className:"col-span-2 border-t border-slate-200 dark:border-slate-600 pt-2 mt-1",children:[h.jsx("span",{className:"block text-[10px] uppercase font-bold text-slate-400",children:"Landed Cost"}),h.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:Oe((I.price||0)+(I.carriage||0),I.currency||"INR")})]})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("button",{onClick:()=>N(I),className:"flex-1 py-2 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg text-xs font-bold flex justify-center items-center gap-2 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors",children:[h.jsx(Eo,{size:14})," Edit"]}),h.jsxs("button",{onClick:()=>G(I.id),className:"flex-1 py-2 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg text-xs font-bold flex justify-center items-center gap-2 hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors",children:[h.jsx(ui,{size:14})," Delete"]})]})]},I.id)})}),h.jsx("div",{className:"hidden md:block overflow-x-auto rounded border border-slate-200 dark:border-slate-700",children:h.jsxs("table",{className:"w-full text-sm text-left",children:[h.jsx("thead",{className:"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 uppercase",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-3",children:"Type"}),h.jsx("th",{className:"px-4 py-3",children:"Component"}),h.jsx("th",{className:"px-4 py-3",children:"Specs"}),h.jsx("th",{className:"px-4 py-3 text-center",children:"Stock"}),h.jsx("th",{className:"px-4 py-3",children:"Landed Cost"}),h.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),h.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700 bg-white dark:bg-slate-800",children:te.map(I=>h.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-slate-700/50 ${a===I.id?"bg-amber-50 dark:bg-amber-900/20":""}`,children:[h.jsx("td",{className:"px-4 py-3 capitalize",children:h.jsx("span",{className:`px-2 py-1 rounded-full text-xs capitalize ${I.type==="module"?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":I.type==="cabinet"?"bg-teal-100 dark:bg-teal-900 text-teal-700 dark:text-teal-300":I.type==="card"?"bg-amber-100 dark:bg-amber-900 text-amber-700 dark:text-amber-300":I.type==="smps"?"bg-rose-100 dark:bg-rose-900 text-rose-700 dark:text-rose-300":I.type==="processor"?"bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300":I.type==="ready"?"bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:I.type==="smps"?"SMPS":I.type})}),h.jsxs("td",{className:"px-4 py-3 dark:text-slate-200",children:[h.jsxs("div",{className:"font-medium",children:[I.brand," ",I.model]}),I.vendor&&h.jsx("div",{className:"text-[10px] text-teal-600 dark:text-teal-400 mt-0.5",children:I.vendor})]}),h.jsxs("td",{className:"px-4 py-3 text-slate-500 dark:text-slate-400 text-xs",children:[I.type==="module"&&h.jsxs("div",{className:"flex flex-col",children:[h.jsxs("span",{children:["P",I.pitch," ",I.indoor?"Indoor":"Outdoor"]}),h.jsxs("span",{children:[I.width,"x",I.height,"mm"]})]}),I.type==="cabinet"&&h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{children:I.material}),h.jsxs("span",{children:[I.width,"x",I.height,"mm"]}),h.jsx("span",{children:I.indoor?"Indoor":"Outdoor"})]}),(I.type==="card"||I.type==="processor")&&h.jsx("span",{children:I.ports?`${I.ports} Ports`:""}),I.type==="smps"&&h.jsx("span",{children:I.amps?`${I.amps} Amps`:""}),I.type==="ready"&&h.jsxs("span",{children:[I.width,"x",I.height,"mm P",I.pitch]})]}),h.jsx("td",{className:"px-4 py-3 font-bold dark:text-slate-200 text-teal-600 text-center",children:e.filter(X=>X.itemId===I.id).reduce((X,se)=>X+(se.type==="in"?Number(se.qty):-Number(se.qty)),0)}),h.jsx("td",{className:"px-4 py-3 dark:text-slate-200",children:h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"font-semibold",children:Oe((I.price||0)+(I.carriage||0),I.currency||"INR")}),I.carriage>0&&h.jsxs("span",{className:"text-[10px] text-slate-400",children:["Base: ",I.price," + Carr: ",I.carriage]})]})}),h.jsxs("td",{className:"px-4 py-3 flex gap-2 justify-end",children:[h.jsx("button",{onClick:()=>N(I),className:"text-blue-500 hover:text-blue-700 p-1 bg-blue-50 dark:bg-blue-900/30 rounded",children:h.jsx(Eo,{size:14})}),h.jsx("button",{onClick:()=>G(I.id),className:"text-red-400 hover:text-red-600 p-1 bg-red-50 dark:bg-red-900/30 rounded",children:h.jsx(ui,{size:14})})]})]},I.id))})]})}),t.length===0&&!b&&h.jsx("div",{className:"text-center py-12 text-slate-400 bg-white dark:bg-slate-800",children:"No items found."})]})]})},i3=({user:s,inventory:e=[],transactions:t=[]})=>{const[r,a]=mn.useState({date:new Date().toISOString().split("T")[0],type:"in",itemId:"",qty:"",remarks:""}),[l,u]=mn.useState(null),p=async()=>{if(!r.itemId||!r.qty)return alert("Select Item and Qty");try{const T=Vr.collection("artifacts").doc(Ms).collection("public").doc("data").collection("transactions");l?(await T.doc(l).update({...r,qty:Number(r.qty),updatedAt:new Date}),u(null)):await T.add({...r,qty:Number(r.qty),createdAt:new Date}),a({date:new Date().toISOString().split("T")[0],type:"in",itemId:"",qty:"",remarks:""})}catch(T){console.error(T)}},f=T=>{a({...T,qty:T.qty}),u(T.id),window.scrollTo({top:0,behavior:"smooth"})},y=()=>{u(null),a({date:new Date().toISOString().split("T")[0],type:"in",itemId:"",qty:"",remarks:""})},b=async T=>{confirm("Delete record?")&&await Vr.collection("artifacts").doc(Ms).collection("public").doc("data").collection("transactions").doc(T).delete()},E=[...t].sort((T,N)=>new Date(N.date)-new Date(T.date));return h.jsxs("div",{className:"p-4 md:p-6 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[h.jsx(uC,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"}),h.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:"Stock Ledger"})]}),h.jsxs("div",{className:`p-4 rounded-lg border mb-6 transition-colors ${l?"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-700":"bg-slate-50 dark:bg-slate-700/30 border-slate-200 dark:border-slate-700"}`,children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h3",{className:"text-xs font-bold uppercase text-slate-500 dark:text-slate-400",children:l?"Edit Transaction":"New Transaction"}),l&&h.jsxs("button",{onClick:y,className:"text-xs text-red-500 flex items-center gap-1",children:[h.jsx(N0,{size:14})," Cancel"]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Date & Action"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"date",value:r.date,onChange:T=>a({...r,date:T.target.value}),className:"flex-1 p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"}),h.jsxs("div",{className:"flex rounded overflow-hidden border border-slate-200 dark:border-slate-600",children:[h.jsx("button",{onClick:()=>a({...r,type:"in"}),className:`flex-1 py-2 text-xs font-bold transition-colors flex items-center justify-center gap-1 ${r.type==="in"?"bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-400":"bg-white dark:bg-slate-700 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-600"}`,children:"+ STOCK IN"}),h.jsx("button",{onClick:()=>a({...r,type:"out"}),className:`flex-1 py-2 text-xs font-bold transition-colors flex items-center justify-center gap-1 ${r.type==="out"?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400":"bg-white dark:bg-slate-700 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-600"}`,children:"- STOCK OUT"})]})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Component"}),h.jsxs("select",{value:r.itemId,onChange:T=>a({...r,itemId:T.target.value}),className:"w-full p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white",children:[h.jsx("option",{value:"",children:"Select Item..."}),e.sort((T,N)=>(T.brand+" "+T.model).localeCompare(N.brand+" "+N.model)).map(T=>h.jsxs("option",{value:T.id,children:[T.brand," ",T.model," (",T.type,")"]},T.id))]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Quantity"}),h.jsx("input",{type:"number",placeholder:"Qty",value:r.qty,onChange:T=>a({...r,qty:T.target.value}),className:"w-full p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Location / Source"}),h.jsx("input",{type:"text",placeholder:"Source/Loc",value:r.remarks,onChange:T=>a({...r,remarks:T.target.value}),className:"w-full p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"})]})]}),h.jsx("button",{onClick:p,className:`w-full md:w-auto text-white px-6 py-2 rounded-lg font-bold text-sm transition-colors shadow-sm ${l?"bg-amber-600 hover:bg-amber-700":"bg-teal-600 hover:bg-teal-700"}`,children:l?"Update Transaction":"Add Transaction"})]}),h.jsxs("div",{className:"mt-8",children:[h.jsx("h3",{className:"text-sm font-bold uppercase text-slate-500 dark:text-slate-400 mb-4",children:"Transaction History"}),h.jsxs("div",{className:"md:hidden space-y-3",children:[E.map(T=>{const N=e.find(B=>B.id===T.itemId)||{};return h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-200 dark:border-slate-700 shadow-sm flex items-center justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${T.type==="in"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:T.type==="in"?"IN":"OUT"}),h.jsx("span",{className:"text-xs text-slate-400",children:new Date(T.date).toLocaleDateString()})]}),h.jsxs("div",{className:"font-bold text-slate-800 dark:text-white text-sm mb-0.5",children:[N.brand," ",N.model]}),h.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:T.remarks||"-"})]}),h.jsxs("div",{className:"text-right pl-4 border-l border-slate-100 dark:border-slate-700 ml-2",children:[h.jsxs("span",{className:`block text-lg font-bold ${T.type==="in"?"text-green-600":"text-red-500"}`,children:[T.type==="in"?"+":"-",T.qty]}),h.jsxs("div",{className:"flex gap-3 justify-end mt-1",children:[h.jsx("button",{onClick:()=>f(T),className:"text-[10px] text-blue-500 hover:text-blue-700 underline",children:"Edit"}),h.jsx("button",{onClick:()=>b(T.id),className:"text-[10px] text-red-400 hover:text-red-600 underline",children:"Delete"})]})]})]},T.id)}),E.length===0&&h.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"No transactions yet."})]}),h.jsxs("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700",children:[h.jsxs("table",{className:"w-full text-sm text-left",children:[h.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700/50 text-slate-500 dark:text-slate-400 uppercase text-xs",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-4 py-3",children:"Date"}),h.jsx("th",{className:"px-4 py-3 text-center",children:"Type"}),h.jsx("th",{className:"px-4 py-3",children:"Component"}),h.jsx("th",{className:"px-4 py-3",children:"Specs"}),h.jsx("th",{className:"px-4 py-3 text-center",children:"Qty"}),h.jsx("th",{className:"px-4 py-3",children:"Loc/Source"}),h.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),h.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700 bg-white dark:bg-slate-800",children:E.map(T=>{const N=e.find(B=>B.id===T.itemId)||{};return h.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[h.jsx("td",{className:"px-4 py-3 whitespace-nowrap dark:text-slate-300",children:new Date(T.date).toLocaleDateString()}),h.jsx("td",{className:"px-4 py-3 text-center",children:h.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${T.type==="in"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:T.type.toUpperCase()})}),h.jsxs("td",{className:"px-4 py-3 font-medium dark:text-white",children:[N.brand," ",N.model]}),h.jsx("td",{className:"px-4 py-3 text-xs text-slate-500 dark:text-slate-400",children:N.type}),h.jsxs("td",{className:`px-4 py-3 text-center font-bold ${T.type==="in"?"text-green-600":"text-red-500"}`,children:[T.type==="in"?"+":"-",T.qty]}),h.jsx("td",{className:"px-4 py-3 text-slate-500 dark:text-slate-400 text-xs",children:T.remarks}),h.jsx("td",{className:"px-4 py-3 text-right",children:h.jsxs("div",{className:"flex justify-end gap-1",children:[h.jsx("button",{onClick:()=>f(T),className:"text-blue-400 hover:text-blue-600 p-1.5 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded",children:h.jsx(Eo,{size:14})}),h.jsx("button",{onClick:()=>b(T.id),className:"text-red-400 hover:text-red-600 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:h.jsx(ui,{size:14})})]})})]},T.id)})})]}),E.length===0&&h.jsx("div",{className:"text-center py-8 text-slate-400",children:"No transactions recorded."})]})]})]})};var a3=eI();const gN=S0(a3),o3=({cols:s,rows:e,module:t,cabinet:r,unit:a})=>{if(!t||!r)return null;const l=r.width,u=r.height,p=l*s,f=u*e,y=b=>{const E=(b/1e3).toFixed(2)+"m",T=(b/304.8).toFixed(2)+"ft";return`${E} / ${T}`};return h.jsx("div",{className:"w-full flex flex-col bg-white rounded-lg border border-slate-200 overflow-hidden",children:h.jsx("div",{className:"w-full h-full min-h-[300px] p-10 flex items-center justify-center",children:h.jsxs("div",{className:"relative",style:{aspectRatio:`${p}/${f}`,width:"100%",maxHeight:"400px"},children:[h.jsxs("div",{className:"absolute -top-8 left-0 right-0 text-center text-xs font-bold text-slate-600 flex items-center justify-center gap-2",children:[h.jsx("div",{className:"h-[1px] flex-1 bg-slate-300"}),h.jsxs("span",{className:"bg-white px-1 whitespace-nowrap",children:[y(p)," (",s," Cabinets)"]}),h.jsx("div",{className:"h-[1px] flex-1 bg-slate-300"})]}),h.jsxs("div",{className:"absolute -left-8 top-0 bottom-0 text-center text-xs font-bold text-slate-600 flex flex-col items-center justify-center gap-2",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"},children:[h.jsx("div",{className:"w-[1px] flex-1 bg-slate-300"}),h.jsxs("span",{className:"bg-white px-1 whitespace-nowrap",children:[y(f)," (",e," Cabinets)"]}),h.jsx("div",{className:"w-[1px] flex-1 bg-slate-300"})]}),h.jsx("div",{className:"w-full h-full grid bg-white border-2 border-slate-900 shadow-sm",style:{gridTemplateColumns:`repeat(${s}, 1fr)`,gridTemplateRows:`repeat(${e}, 1fr)`},children:Array.from({length:s*e}).map((b,E)=>h.jsx("div",{className:"border border-slate-300 relative"},E))})]})})})},yN=({data:s,allScreensData:e,currency:t="INR",exchangeRate:r,date:a})=>{const l=e&&e.calculations&&e.calculations.length>1,u=l?e.calculations:s?[s]:[];if(u.length===0)return null;const p=(l?e.clientName:s?.clientName)||"",f=(l?e.projectName:s?.projectName)||"",y=u[0].terms||{},b=l?e.totalProjectSell:s?.totalProjectSell,E=T=>h.jsxs("div",{className:`bg-white text-slate-800 font-sans text-xs ${T?"print-version-container p-0":"preview-version-container w-full h-full p-8"}`,children:[h.jsx("div",{className:"flex justify-between items-start mb-6 border-b-2 border-slate-800 pb-4",children:h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsx("img",{src:"/AdmireLED/logo.png",alt:"Company Logo",className:"h-16 w-auto object-contain"}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-slate-900 uppercase tracking-wide",children:Dt.COMPANY.NAME}),h.jsxs("div",{className:"text-[10px] text-slate-600 mt-1 space-y-0.5",children:[h.jsx("p",{children:Dt.COMPANY.ADDRESS_1}),h.jsx("p",{children:Dt.COMPANY.ADDRESS_2}),h.jsxs("p",{children:["Email: ",Dt.COMPANY.EMAIL," | Web: ",Dt.COMPANY.WEB]})]})]})]})}),u.map((N,B)=>{const{finalWidth:G,finalHeight:te,totalCabinets:I,moduleType:X={},cabinetType:se={},processor:fe,screenQty:H,totalProjectSell:ae,gridCols:A,gridRows:R,commercials:k}=N,j=Number(G),P=Number(te),L=j*P,C=L*10.7639,Me=Number(X.pitch||0),Pe=Me>0?Math.round(j*1e3/Me):0,Z=Me>0?Math.round(P*1e3/Me):0,pe=(X.weight||0)*L,Ee=(se.weight||0)*I,Ne=pe+Ee,Le=(X.avgPower||0)*L,V=(X.maxPower||0)*L,O=k||{sellProcTotal:0,sellInstallTotal:0,sellStructureTotal:0},q=ae/(H||1),ne=(O.sellProcTotal||0)/(H||1),de=(O.sellInstallTotal||0)/(H||1),me=(O.sellStructureTotal||0)/(H||1),_e=q-ne-de-me,it=_e*.02,ar=[{name:"LED Panel",rate:_e-it},{name:"Processor",rate:ne},{name:"Installation",rate:de},{name:"Spares (2%)",rate:it},{name:"Structure",rate:me}].filter(zt=>zt.rate>0);return h.jsxs("div",{className:"mb-10 pb-6 border-b-2 border-slate-100 break-inside-avoid print-break-avoid",children:[l&&h.jsx("div",{className:"mb-4 pb-2 border-b border-teal-500",children:h.jsxs("h2",{className:"text-lg font-bold text-teal-800 uppercase",children:["Configuration #",B+1]})}),h.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2",children:"Project Details"}),h.jsxs("div",{className:"grid grid-cols-3 gap-y-1 text-[11px]",children:[h.jsx("span",{className:"font-semibold text-slate-500",children:"Client:"})," ",h.jsx("span",{className:"col-span-2 font-bold",children:p}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Project:"})," ",h.jsx("span",{className:"col-span-2 font-bold",children:f}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Screen Size:"}),h.jsxs("span",{className:"col-span-2",children:[j,"m x ",P,"m ",h.jsxs("span",{className:"text-slate-400",children:["/ ",(j*3.28084).toFixed(2),"ft x ",(P*3.28084).toFixed(2),"ft"]})]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Quantity:"})," ",h.jsxs("span",{className:"col-span-2",children:[H," Nos"]})]}),h.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mt-4 mb-2",children:"Module & Cabinet"}),h.jsxs("div",{className:"grid grid-cols-3 gap-y-1 text-[11px]",children:[h.jsx("span",{className:"font-semibold text-slate-500",children:"Module:"})," ",h.jsxs("span",{className:"col-span-2",children:[X.brand," P",X.pitch]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Mod Size:"})," ",h.jsxs("span",{className:"col-span-2",children:[X.width," x ",X.height," mm"]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Lamp:"})," ",h.jsx("span",{className:"col-span-2",children:X.lampMake||"-"}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Cabinet:"})," ",h.jsx("span",{className:"col-span-2",children:se.material||"Standard"}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Cab Size:"})," ",h.jsxs("span",{className:"col-span-2",children:[se.width," x ",se.height," mm"]})]})]}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2",children:"Screen Specifications"}),h.jsxs("div",{className:"grid grid-cols-3 gap-y-1 text-[11px]",children:[h.jsx("span",{className:"font-semibold text-slate-500",children:"Resolution:"})," ",h.jsxs("span",{className:"col-span-2",children:[Pe," x ",Z," pixels"]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Total Area:"})," ",h.jsxs("span",{className:"col-span-2",children:[C.toFixed(2)," Sq.ft / ",L.toFixed(2)," Sq.m"]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Total Weight:"})," ",h.jsxs("span",{className:"col-span-2",children:[Ne.toFixed(1)," kg"]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Avg Power:"})," ",h.jsxs("span",{className:"col-span-2",children:[Le.toFixed(0)," Watts"]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Max Power:"})," ",h.jsxs("span",{className:"col-span-2",children:[V.toFixed(0)," Watts"]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Brightness:"})," ",h.jsxs("span",{className:"col-span-2",children:[X.brightness," nits"]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Refresh Rate:"})," ",h.jsxs("span",{className:"col-span-2",children:[X.refreshRate," Hz"]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Controller:"})," ",h.jsx("span",{className:"col-span-2",children:fe?`${fe.brand} ${fe.model}`:"Standard"}),h.jsx("span",{className:"font-semibold text-slate-500",children:"Viewing:"})," ",h.jsxs("span",{className:"col-span-2",children:["H: ",X.viewAngleH," / V: ",X.viewAngleV,""]}),h.jsx("span",{className:"font-semibold text-slate-500",children:"IP Rating:"})," ",h.jsxs("span",{className:"col-span-2",children:["Front: IP",X.ipFront," / Back: IP",X.ipBack]})]})]})]}),h.jsxs("div",{className:"mb-2 break-inside-avoid print-break-avoid",children:[h.jsxs("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2 pb-1",children:["Commercial Proposal ",l?`(Config #${B+1})`:""]}),h.jsxs("table",{className:"w-full border-collapse border border-slate-300 text-[11px]",children:[h.jsx("thead",{className:"bg-slate-800 text-white",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-2 border border-slate-600 text-left w-12",children:"#"}),h.jsx("th",{className:"p-2 border border-slate-600 text-left",children:"Item Description"}),h.jsx("th",{className:"p-2 border border-slate-600 text-right w-32",children:"Amount (1 Screen)"}),h.jsxs("th",{className:"p-2 border border-slate-600 text-right w-32",children:["Amount (",H," Screens)"]})]})}),h.jsxs("tbody",{children:[ar.map((zt,_n)=>h.jsxs("tr",{children:[h.jsx("td",{className:"p-2 border border-slate-300 text-center",children:_n+1}),h.jsx("td",{className:"p-2 border border-slate-300 font-bold",children:zt.name}),h.jsx("td",{className:"p-2 border border-slate-300 text-right",children:Oe(zt.rate,t)}),h.jsx("td",{className:"p-2 border border-slate-300 text-right font-bold",children:Oe(zt.rate*H,t)})]},_n)),h.jsxs("tr",{className:"bg-slate-100",children:[h.jsx("td",{colSpan:"3",className:"p-2 border border-slate-300 text-right font-bold uppercase",children:"Subtotal (Excl. GST)"}),h.jsx("td",{className:"p-2 border border-slate-300 text-right font-bold text-sm",children:Oe(ae,t)})]})]})]})]})]},B)}),l&&h.jsx("div",{className:"mb-8 break-inside-avoid print-break-avoid",children:h.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-lg flex justify-between items-center shadow-lg",children:[h.jsx("div",{className:"text-lg font-bold uppercase tracking-wide",children:"Grand Total"}),h.jsxs("div",{className:"text-2xl font-bold",children:[Oe(b,t)," ",h.jsx("span",{className:"text-xs font-normal opacity-70",children:"(Excl. GST)"})]})]})}),h.jsxs("div",{className:"mt-8 break-inside-avoid print-break-avoid",children:[h.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2 pb-1",children:"Terms & Conditions"}),h.jsx("div",{className:"text-[10px] text-slate-600 space-y-3",children:h.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-y-2 gap-x-4",children:[h.jsx("div",{className:"font-bold text-slate-800",children:"PRICE"}),h.jsx("div",{children:y.price}),h.jsx("div",{className:"font-bold text-slate-800",children:"PAYMENT"}),h.jsx("div",{children:(y.payment||[]).map((N,B)=>h.jsxs("span",{children:[N.percent,"% ",N.name,B<(y.payment||[]).length-1?", ":""]},B))}),h.jsx("div",{className:"font-bold text-slate-800",children:"DELIVERY"}),h.jsxs("div",{children:[y.deliveryWeeks," weeks"]}),h.jsx("div",{className:"font-bold text-slate-800",children:"GST"}),h.jsxs("div",{children:["Extra as applicable (currently ",Dt.DEFAULTS.GST_RATE,"%)"]}),h.jsx("div",{className:"font-bold text-slate-800",children:"WARRANTY"}),h.jsx("div",{className:"text-justify leading-snug",children:y.warranty||Dt.TEXT.WARRANTY})]})}),h.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mt-4 mb-2 pb-1",children:"Client's Scope"}),h.jsxs("div",{className:"text-[10px] text-slate-600 grid gap-y-2",children:[y.scope?.structure&&h.jsxs("div",{children:[h.jsx("span",{className:"font-bold text-slate-800 block",children:"Structure:"}),y.scope.structure]}),y.scope?.elec&&h.jsxs("div",{children:[h.jsx("span",{className:"font-bold text-slate-800 block",children:"Electricity:"}),y.scope.elec]}),y.scope?.net&&h.jsxs("div",{children:[h.jsx("span",{className:"font-bold text-slate-800 block",children:"Internet:"}),y.scope.net]}),y.scope?.soft&&h.jsxs("div",{children:[h.jsx("span",{className:"font-bold text-slate-800 block",children:"Software:"}),y.scope.soft]}),y.scope?.perm&&h.jsxs("div",{children:[h.jsx("span",{className:"font-bold text-slate-800 block",children:"Permissions:"}),y.scope.perm]}),y.scope?.pc&&h.jsxs("div",{children:[h.jsx("span",{className:"font-bold text-slate-800 block",children:"Computer:"}),y.scope.pc]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-bold text-slate-800 block",children:"Validity:"}),y.validity||Dt.TEXT.VALIDITY]})]}),h.jsxs("div",{className:"mt-8 pt-8 border-t border-slate-200 flex justify-between items-end",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"h-12 mb-2"}),h.jsx("p",{className:"text-[10px] font-bold border-t border-slate-400 px-4 pt-1",children:"Client Acceptance"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"h-12 mb-2"}),h.jsx("p",{className:"text-[10px] font-bold border-t border-slate-400 px-4 pt-1",children:"For Admire Sign & Display Pvt. Ltd."})]})]})]})]});return h.jsxs(sn.Fragment,{children:[h.jsx("div",{className:"screen-preview-wrapper",children:E(!1)}),gN.createPortal(h.jsx("div",{className:"print-only-portal",children:E(!0)}),document.body)]})},l3=({user:s,inventory:e,transactions:t,exchangeRate:r,onLoadQuote:a})=>{const[l,u]=sn.useState([]),[p,f]=sn.useState(null);sn.useEffect(()=>{if(!s)return;const T=Vr.collection("artifacts").doc(Ms).collection("public").doc("data").collection("quotes").orderBy("updatedAt","desc").onSnapshot(N=>{u(N.docs.map(B=>({id:B.id,...B.data()})))});return()=>T()},[s]);const y=async T=>{confirm("Are you sure you want to delete this quote?")&&await Vr.collection("artifacts").doc(Ms).collection("public").doc("data").collection("quotes").doc(T).delete()},b=T=>{if(T.allScreensData){f({allScreensData:T.allScreensData,client:T.client,project:T.project});return}const N=T.calculatorState;if(N.screens&&N.screens.length>0){const G=N.screens.map(te=>{const I={...N,...te};return xo(I,e,t,r)}).filter(te=>te!==null);if(G.length>0){const te={totalProjectCost:G.reduce((I,X)=>I+X.totalProjectCost,0),totalProjectSell:G.reduce((I,X)=>I+X.totalProjectSell,0),totalLEDSell:G.reduce((I,X)=>I+X.matrix.led.sell*X.screenQty,0),totalServicesSell:G.reduce((I,X)=>I+(X.matrix.sell.total-X.matrix.led.sell*X.screenQty),0),totalMargin:0,totalScreenQty:G.reduce((I,X)=>I+Number(X.screenQty),0),calculations:G,screenConfigs:N.screens};te.totalMargin=te.totalProjectSell-te.totalProjectCost,f({allScreensData:te,client:T.client,project:T.project});return}}const B=xo(N,e,t,r);B?f({data:B,client:T.client,project:T.project}):alert("Could not calculate quote. Inventory items might be missing.")},E=T=>{let N=[],B=0,G=0;if(T.allScreensData&&T.allScreensData.calculations)N=T.allScreensData.calculations,B=T.allScreensData.totalProjectSell,G=T.allScreensData.totalProjectCost;else{const ae=T.calculatorState;if(ae&&ae.screens&&ae.screens.length>0)N=ae.screens.map(A=>{const R={...ae,...A};return xo(R,e,t,r)}).filter(A=>A!==null);else{const A=xo(ae,e,t,r);A&&(N=[A])}N.length>0&&(G=N.reduce((A,R)=>A+R.totalProjectCost,0),B=N.reduce((A,R)=>A+R.totalProjectSell,0))}if(N.length===0)return alert("Calculation failed. Inventory items might be missing.");const te=(T.project||"").replace(/,/g," "),I=(T.client||"").replace(/,/g," ");let X=`Project,${te}
Client,${I}
Date,${new Date().toLocaleDateString()}

`;N.forEach((ae,A)=>{X+=`SCREEN CONFIGURATION #${A+1}
`,X+=`Dimensions,${ae.finalWidth}m x ${ae.finalHeight}m
`,X+=`Quantity,${ae.screenQty}
`,X+=`
Bill of Materials (Config #${A+1})
Component,Specification,Qty/Scrn,Total Qty,Rate,Total Amount
`,ae.detailedItems.forEach(R=>{const k=(R.name||"").replace(/"/g,'""'),j=(R.spec||"").replace(/"/g,'""'),P=R.qty*ae.screenQty,L=R.total*ae.screenQty;X+=`"${k}","${j}",${R.qty},${P},${R.unit.toFixed(2)},${L.toFixed(2)}
`}),X+=`
Subtotal (Cost),${ae.totalProjectCost.toFixed(2)}
`,X+=`Subtotal (Sell),${ae.totalProjectSell.toFixed(2)}
`,X+=`
--------------------------------

`}),X+=`PROJECT SUMMARY
`,X+=`Grand Total Cost,${G.toFixed(2)}
`,X+=`Grand Total Sell,${B.toFixed(2)}
`,X+=`Net Margin,${(B-G).toFixed(2)}
`;const se=new Blob([X],{type:"text/csv;charset=utf-8;"}),fe=window.URL.createObjectURL(se),H=document.createElement("a");H.href=fe,H.download=`${I.replace(/[^a-z0-9]/gi,"_")}_${te.replace(/[^a-z0-9]/gi,"_")}_BOM.csv`,H.click(),window.URL.revokeObjectURL(fe)};return h.jsxs("div",{className:"p-4 md:p-6 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[p&&h.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex justify-center items-center p-4",children:h.jsxs("div",{className:"bg-white max-w-4xl w-full h-[90vh] rounded-lg shadow-2xl flex flex-col",children:[h.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-slate-100 rounded-t-lg",children:[h.jsxs("h2",{className:"font-bold text-lg text-slate-800 flex items-center gap-2",children:[h.jsx(Vy,{size:20})," View Saved Quote"]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>f(null),className:"px-4 py-2 text-slate-600 hover:bg-slate-200 rounded",children:"Close"}),h.jsxs("button",{onClick:()=>{const T=document.title;document.title=`${p.client}_${p.project}_Quote`.replace(/[^a-zA-Z0-9_]/g,"_"),window.print(),document.title=T},className:"px-4 py-2 bg-teal-600 text-white hover:bg-teal-700 rounded flex items-center gap-2",children:[h.jsx(zf,{size:16})," Print / PDF"]})]})]}),h.jsx("div",{className:"flex-1 overflow-auto p-8 bg-slate-200",children:h.jsx(yN,{data:p.data?{...p.data,clientName:p.client,projectName:p.project}:null,allScreensData:p.allScreensData?{...p.allScreensData,clientName:p.client,projectName:p.project}:null,currency:"INR",exchangeRate:r})})]})}),h.jsx("div",{className:"flex justify-between items-center mb-6",children:h.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-slate-800 dark:text-white",children:[h.jsx(Oy,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"})," Saved Quotes"]})}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[l.map(T=>{const N=T.calculatorState||{};N.unit;const B=N.selectedPitch||"N/A",G=N.selectedIndoor==="true";return h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden flex flex-col",children:[h.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white line-clamp-1",title:T.project,children:T.project||"Untitled"}),h.jsx("div",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:T.client||"No Client"})]}),h.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${G?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"}`,children:G?"Indoor":"Outdoor"})]}),h.jsx("div",{className:"text-xs text-slate-400 mb-4",children:new Date(T.updatedAt?.seconds*1e3).toLocaleString()}),h.jsx("div",{className:"bg-slate-50 dark:bg-slate-700/30 p-2 rounded-lg mb-4 space-y-1.5 flex-1",children:T.allScreensData?.calculations?T.allScreensData.calculations.map((te,I)=>h.jsxs("div",{className:"flex justify-between items-center text-xs border-b border-slate-100 dark:border-slate-600 last:border-0 pb-1 last:pb-0",children:[h.jsxs("span",{className:"text-slate-600 dark:text-slate-300 font-medium",children:["Screen #",I+1," ",h.jsxs("span",{className:"text-slate-400 font-normal",children:["(",te.finalWidth,"x",te.finalHeight,"m / ",(Number(te.finalWidth)*3.28084).toFixed(2),"x",(Number(te.finalHeight)*3.28084).toFixed(2),"ft ",te.screenQty,")"]})]}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:Oe(te.totalProjectSell,"INR",!0)})]},I)):h.jsxs("div",{className:"flex justify-between items-center text-xs",children:[h.jsxs("span",{className:"text-slate-600 dark:text-slate-300 font-medium",children:["Screen #1 ",h.jsxs("span",{className:"text-slate-400 font-normal",children:["(P",B," ",N.screenQty||1,")"]})]}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:Oe(T.finalAmount,"INR",!0)})]})}),h.jsxs("div",{className:"flex justify-between items-end pt-2 border-t border-slate-100 dark:border-slate-700 mt-auto",children:[h.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:"Total Estimate"}),h.jsx("span",{className:"text-xl font-bold text-teal-600 dark:text-teal-400",children:Oe(T.finalAmount,"INR")})]})]}),h.jsxs("div",{className:"grid grid-cols-5 border-t border-slate-100 dark:border-slate-700 divide-x divide-slate-100 dark:divide-slate-700 bg-slate-50 dark:bg-slate-800",children:[h.jsxs("button",{onClick:()=>b(T),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"View",children:[h.jsx(Vy,{size:16})," ",h.jsx("span",{className:"hidden sm:inline",children:"View"})]}),h.jsxs("button",{onClick:()=>a(T,!1),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-blue-600 dark:text-blue-400 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"Edit",children:[h.jsx(Eo,{size:16})," ",h.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),h.jsxs("button",{onClick:()=>E(T),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-green-600 dark:text-green-400 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"Excel",children:[h.jsx(mC,{size:16})," ",h.jsx("span",{className:"hidden sm:inline",children:"Excel"})]}),h.jsxs("button",{onClick:()=>a(T,!0),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-slate-500 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"Clone",children:[h.jsx(jy,{size:16})," ",h.jsx("span",{className:"hidden sm:inline",children:"Clone"})]}),h.jsxs("button",{onClick:()=>y(T.id),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Delete",children:[h.jsx(ui,{size:16})," ",h.jsx("span",{className:"hidden sm:inline",children:"Del"})]})]})]},T.id)}),l.length===0&&h.jsx("p",{className:"text-center text-slate-400 py-10 col-span-full",children:"No saved quotes found."})]})]})},c3=({data:s,allScreensData:e,inventory:t=[],transactions:r=[]})=>{if(!s&&!e)return null;const a=e&&e.calculations&&e.calculations.length>1;if(!a&&!s)return null;const l=(a?e.clientName:s?.clientName)||"",u=(a?e.projectName:s?.projectName)||"",p=(b,E,T)=>{const{detailedItems:N,screenQty:B,moduleType:G,cabinetType:te,finalWidth:I,finalHeight:X}=b;return h.jsxs("div",{className:"mb-8 break-inside-avoid print-break-avoid",children:[a&&h.jsxs("div",{className:"bg-teal-50 dark:bg-teal-900/20 p-3 rounded-lg mb-3 border border-teal-200 dark:border-teal-800",children:[h.jsxs("h3",{className:"font-bold text-teal-800 dark:text-teal-300 text-sm",children:["Screen Configuration #",E+1]}),h.jsxs("div",{className:"flex flex-wrap gap-x-8 gap-y-3 mt-3 text-xs text-teal-800 dark:text-teal-300",children:[h.jsxs("div",{children:[h.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Target Size"}),T.targetWidth,"  ",T.targetHeight," ",T.unit||"m"]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Final Dimensions"}),I,"m  ",X,"m ",h.jsxs("span",{className:"text-teal-600/70",children:["/ ",(Number(I)*3.28084).toFixed(2),"ft  ",(Number(X)*3.28084).toFixed(2),"ft"]})]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Quantity"}),B," Screens"]}),G&&h.jsxs("div",{children:[h.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Type"}),"P",G.pitch," ",G.indoor?"Indoor":"Outdoor"]})]})]}),h.jsxs("table",{className:"w-full border-collapse border border-slate-300 text-[10px]",children:[h.jsx("thead",{className:"bg-slate-100 text-slate-700",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-2 border border-slate-300 text-left w-10",children:"#"}),h.jsx("th",{className:"p-2 border border-slate-300 text-left w-32",children:"Component"}),h.jsx("th",{className:"p-2 border border-slate-300 text-left",children:"Specification / Details"}),h.jsx("th",{className:"p-2 border border-slate-300 text-center w-16",children:"Qty/Scrn"}),h.jsx("th",{className:"p-2 border border-slate-300 text-center w-16",children:"Total Qty"})]})}),h.jsx("tbody",{children:N.map((se,fe)=>{const H=t.find(A=>A.id===se.inventoryId);let ae=null;return H&&(H.type==="module"?ae=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Size: ",H.width,"x",H.height,"mm"]}),h.jsxs("span",{children:["LED: ",H.ledType||"-"]}),h.jsxs("span",{children:["Bright: ",H.brightness," nits"]}),h.jsxs("span",{children:["Ref: ",H.refreshRate," Hz"]}),h.jsxs("span",{children:["Ang: ",H.viewAngleH,"/",H.viewAngleV]}),h.jsxs("span",{children:["IP: ",H.ipFront,"/",H.ipBack]}),h.jsxs("span",{children:["Pwr: ",H.avgPower,"/",H.maxPower," W"]}),h.jsxs("span",{children:["Wt: ",H.weight," kg"]})]}):H.type==="cabinet"?ae=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Size: ",H.width,"x",H.height,"mm"]}),h.jsxs("span",{children:["Mat: ",H.material]}),h.jsxs("span",{children:["Weight: ",H.weight," kg"]})]}):H.type==="ready"?ae=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Size: ",H.width,"x",H.height,"mm"]}),h.jsxs("span",{children:["Mat: ",H.material||"-"]}),h.jsxs("span",{children:["Bright: ",H.brightness," nits"]}),h.jsxs("span",{children:["Ref: ",H.refreshRate," Hz"]}),h.jsxs("span",{children:["IP: ",H.ipFront,"/",H.ipBack]})]}):H.type==="card"?ae=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Brand: ",H.brand]}),h.jsxs("span",{children:["Model: ",H.model]}),H.ports&&h.jsxs("span",{children:["Ports: ",H.ports]})]}):H.type==="smps"||H.type==="psu"?ae=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Brand: ",H.brand]}),h.jsxs("span",{children:["Model: ",H.model]}),H.amps&&h.jsxs("span",{children:["Amps: ",H.amps,"A"]})]}):H.type==="processor"&&(ae=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Brand: ",H.brand]}),h.jsxs("span",{children:["Model: ",H.model]}),H.ports&&h.jsxs("span",{children:["Ports: ",H.ports]})]}))),h.jsxs("tr",{children:[h.jsx("td",{className:"p-2 border border-slate-300 text-center",children:fe+1}),h.jsx("td",{className:"p-2 border border-slate-300 font-bold align-top",children:se.name}),h.jsxs("td",{className:"p-2 border border-slate-300 align-top",children:[h.jsx("div",{className:"font-semibold",children:se.spec}),ae]}),h.jsx("td",{className:"p-2 border border-slate-300 text-center align-top",children:se.qty}),h.jsx("td",{className:"p-2 border border-slate-300 text-center font-bold align-top",children:se.qty*B})]},fe)})})]})]},E)},f=()=>{if(!a)return null;const b={},E=N=>r?r.filter(B=>B.itemId===N).reduce((B,G)=>B+(G.type==="in"?Number(G.qty):-Number(G.qty)),0):0;e.calculations.forEach((N,B)=>{N.detailedItems.forEach(G=>{const te=G.inventoryId?G.inventoryId:`${G.name}_${G.spec}`;b[te]||(b[te]={name:G.name,spec:G.spec,inventoryId:G.inventoryId,id:G.id,totalQty:0});const I=G.qty*N.screenQty;b[te].totalQty+=I})});const T=Object.values(b);return h.jsxs("div",{className:"mt-8 break-inside-avoid print-break-avoid border-t-4 border-slate-800 pt-6",children:[h.jsx("div",{className:"bg-slate-800 text-white p-3 rounded-t-lg mb-0 flex justify-between items-center",children:h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-lg uppercase tracking-wide",children:"Consolidated Bill of Materials"}),h.jsx("p",{className:"text-xs text-slate-300 mt-1",children:"Combined quantities across all screen configurations"})]})}),h.jsxs("table",{className:"w-full border-collapse border border-slate-300 text-[10px]",children:[h.jsx("thead",{className:"bg-slate-700 text-white",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-2 border border-slate-600 text-left w-10",children:"#"}),h.jsx("th",{className:"p-2 border border-slate-600 text-left w-32",children:"Component"}),h.jsx("th",{className:"p-2 border border-slate-600 text-left",children:"Specification"}),h.jsx("th",{className:"p-2 border border-slate-600 text-center w-16",children:"Stock"}),h.jsx("th",{className:"p-2 border border-slate-600 text-center w-16",children:"Required"}),h.jsx("th",{className:"p-2 border border-slate-600 text-center w-16",children:"Balance"})]})}),h.jsx("tbody",{children:T.map((N,B)=>{const G=N.inventoryId?E(N.inventoryId):0,te=G-N.totalQty,I=N.inventoryId?t.find(se=>se.id===N.inventoryId):null;let X=null;return I&&(I.type==="module"?X=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Size: ",I.width,"x",I.height,"mm"]}),h.jsxs("span",{children:["LED: ",I.ledType||"-"]}),h.jsxs("span",{children:["Bright: ",I.brightness," nits"]}),h.jsxs("span",{children:["Ref: ",I.refreshRate," Hz"]}),h.jsxs("span",{children:["Ang: ",I.viewAngleH,"/",I.viewAngleV]}),h.jsxs("span",{children:["IP: ",I.ipFront,"/",I.ipBack]}),h.jsxs("span",{children:["Pwr: ",I.avgPower,"/",I.maxPower," W"]}),h.jsxs("span",{children:["Wt: ",I.weight," kg"]})]}):I.type==="cabinet"?X=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Size: ",I.width,"x",I.height,"mm"]}),h.jsxs("span",{children:["Mat: ",I.material]}),h.jsxs("span",{children:["Weight: ",I.weight," kg"]})]}):I.type==="ready"?X=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Size: ",I.width,"x",I.height,"mm"]}),h.jsxs("span",{children:["Mat: ",I.material||"-"]}),h.jsxs("span",{children:["Bright: ",I.brightness," nits"]}),h.jsxs("span",{children:["Ref: ",I.refreshRate," Hz"]}),h.jsxs("span",{children:["IP: ",I.ipFront,"/",I.ipBack]})]}):I.type==="card"?X=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Brand: ",I.brand]}),h.jsxs("span",{children:["Model: ",I.model]}),I.ports&&h.jsxs("span",{children:["Ports: ",I.ports]})]}):I.type==="smps"||I.type==="psu"?X=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Brand: ",I.brand]}),h.jsxs("span",{children:["Model: ",I.model]}),I.amps&&h.jsxs("span",{children:["Amps: ",I.amps,"A"]})]}):I.type==="processor"&&(X=h.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[h.jsxs("span",{children:["Brand: ",I.brand]}),h.jsxs("span",{children:["Model: ",I.model]}),I.ports&&h.jsxs("span",{children:["Ports: ",I.ports]})]}))),h.jsxs("tr",{className:B%2===0?"bg-slate-50":"bg-white",children:[h.jsx("td",{className:"p-2 border border-slate-300 text-center",children:B+1}),h.jsx("td",{className:"p-2 border border-slate-300 font-bold align-top",children:N.name}),h.jsxs("td",{className:"p-2 border border-slate-300 align-top",children:[h.jsx("div",{className:"font-semibold",children:N.spec}),X]}),h.jsx("td",{className:"p-2 border border-slate-300 text-center font-medium text-slate-600 align-top",children:N.inventoryId?G:"-"}),h.jsx("td",{className:"p-2 border border-slate-300 text-center font-bold align-top text-slate-800",children:N.totalQty}),h.jsx("td",{className:`p-2 border border-slate-300 text-center font-bold align-top ${te>=0?"text-green-600":"text-red-600"}`,children:N.inventoryId?te:"-"})]},B)})})]}),h.jsx("div",{className:"mt-4 p-3 bg-teal-50 dark:bg-teal-900/20 rounded-lg border border-teal-200 dark:border-teal-800",children:h.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs",children:[h.jsxs("div",{children:[h.jsx("span",{className:"font-bold text-teal-800 dark:text-teal-300",children:"Total Configurations:"}),h.jsx("span",{className:"ml-2 font-bold text-lg text-teal-600 dark:text-teal-400",children:e.calculations.length})]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-bold text-teal-800 dark:text-teal-300",children:"Total Screens:"}),h.jsx("span",{className:"ml-2 font-bold text-lg text-teal-600 dark:text-teal-400",children:e.totalScreenQty})]}),h.jsxs("div",{children:[h.jsx("span",{className:"font-bold text-teal-800 dark:text-teal-300",children:"Unique Components:"}),h.jsx("span",{className:"ml-2 font-bold text-lg text-teal-600 dark:text-teal-400",children:T.length})]})]})})]})},y=b=>h.jsxs("div",{className:`p-8 max-w-[210mm] mx-auto bg-white min-h-screen text-slate-800 font-sans text-xs ${b?"print-version-container p-0 w-full":""}`,children:[h.jsxs("div",{className:"flex justify-between items-start mb-6 border-b-2 border-slate-800 pb-4",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("img",{src:"/AdmireLED/logo.png",alt:"Logo",className:"h-12 w-auto"}),h.jsxs("div",{children:[h.jsx("h1",{className:"text-2xl font-bold text-slate-900 uppercase tracking-wide",children:"Bill of Materials"}),h.jsxs("div",{className:"mt-1 space-y-0.5",children:[h.jsxs("p",{className:"text-sm font-bold text-slate-700",children:["Project: ",h.jsx("span",{className:"font-normal",children:u})]}),h.jsxs("p",{className:"text-sm font-bold text-slate-700",children:["Client: ",h.jsx("span",{className:"font-normal",children:l})]}),a&&h.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[e.calculations.length," Configs  ",e.totalScreenQty," Screens"]}),!a&&s.moduleType&&h.jsxs("p",{className:"text-xs text-slate-500 mt-1 font-medium flex items-center gap-2",children:[h.jsxs("span",{className:"inline-block bg-slate-100 px-2 py-0.5 rounded text-slate-700 font-bold border border-slate-200",children:["P",s.moduleType.pitch," ",s.moduleType.indoor?"Indoor":"Outdoor"]}),h.jsxs("span",{children:[s.finalWidth,"m x ",s.finalHeight,"m ",h.jsxs("span",{className:"text-slate-400",children:["/ ",(Number(s.finalWidth)*3.28084).toFixed(2),"ft x ",(Number(s.finalHeight)*3.28084).toFixed(2),"ft"]})]}),h.jsxs("span",{className:"font-bold text-slate-700 border-l border-slate-300 pl-2 ml-1",children:[s.screenQty," Screens"]})]})]})]})]}),h.jsx("div",{className:"text-right",children:h.jsx("p",{className:"text-xs text-slate-500",children:new Date().toLocaleDateString()})})]}),a?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"mb-6",children:h.jsx("h2",{className:"text-sm font-bold text-slate-700 uppercase mb-3 pb-2 border-b border-slate-300",children:"Individual Screen Configurations"})}),e.calculations.map((E,T)=>p(E,T,e.screenConfigs?e.screenConfigs[T]:{})),f()]}):p(s,0,{}),h.jsx("div",{className:"mt-8 text-[10px] text-slate-400 border-t border-slate-200 pt-2 text-center",children:"Internal Document  Generated by Admire Sign LED Calculator"})]});return h.jsxs(sn.Fragment,{children:[h.jsx("div",{className:"screen-preview-wrapper",children:y(!1)}),gN.createPortal(h.jsx("div",{className:"print-only-portal",children:y(!0)}),document.body)]})},u3=(s,e)=>{const[t,r]=sn.useState(s);return sn.useEffect(()=>{const a=setTimeout(()=>{r(s)},e);return()=>{clearTimeout(a)}},[s,e]),t},d3=({calculation:s,state:e,updateState:t,updateExtra:r,updateScreenProp:a,inventory:l,getStock:u,overrides:p,onOverride:f,editingRow:y,setEditingRow:b,onClearOverride:E})=>{const T=e.screens[e.activeScreenIndex],{screenQty:N,selectedPitch:B,selectedModuleId:G,selectedCabinetId:te,selectedCardId:I,selectedSMPSId:X,selectedProcId:se,extraComponents:fe,extras:H,commercials:ae}=T,{assemblyMode:A,selectedIndoor:R}=e,k=()=>Math.random().toString(36).substr(2,9).toUpperCase(),j=R==="true",P=l.filter(Y=>Y.type==="module"&&Y.indoor===j),L=[...new Set(P.map(Y=>Y.pitch))].sort((Y,Ie)=>Y-Ie),C=B?P.filter(Y=>Y.pitch==B):[],Me=l.find(Y=>Y.id===G),Pe=l.filter(Y=>Y.type!=="cabinet"?!1:Me?Y.width%Me.width===0&&Y.height%Me.height===0:!0),Z=l.filter(Y=>Y.type==="ready"&&Y.indoor===j),pe=Y=>{const Ie=(ce,kt)=>a(e.activeScreenIndex,ce,kt);if(Y.id==="modules")return h.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[h.jsxs("select",{value:B,onChange:ce=>{Ie("selectedPitch",ce.target.value),Ie("selectedModuleId","")},className:"w-full md:w-20 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[h.jsx("option",{value:"",children:"Pitch"}),L.map(ce=>h.jsxs("option",{value:ce,children:["P",ce]},ce))]}),h.jsxs("select",{value:G,onChange:ce=>Ie("selectedModuleId",ce.target.value),disabled:!B,className:"w-full md:flex-1 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white disabled:opacity-50",children:[h.jsx("option",{value:"",children:"Select Module..."}),C.map(ce=>h.jsxs("option",{value:ce.id,children:[ce.brand," ",ce.model," (",u(ce.id),")"]},ce.id))]})]});if(Y.id==="cabinets")return h.jsxs("select",{value:te,onChange:ce=>Ie("selectedCabinetId",ce.target.value),disabled:!Me,className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white disabled:opacity-50",children:[h.jsx("option",{value:"",children:"Select Cabinet..."}),Pe.map(ce=>h.jsxs("option",{value:ce.id,children:[ce.brand," ",ce.model," (",ce.width,"x",ce.height,") - Stock: ",u(ce.id)]},ce.id))]});if(Y.id==="cards")return h.jsxs("select",{value:I,onChange:ce=>Ie("selectedCardId",ce.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[h.jsx("option",{value:"",children:"Select Card..."}),l.filter(ce=>ce.type==="card").map(ce=>h.jsxs("option",{value:ce.id,children:[ce.brand," ",ce.model," (",u(ce.id),")"]},ce.id))]});if(Y.id==="smps")return h.jsxs("select",{value:X,onChange:ce=>Ie("selectedSMPSId",ce.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[h.jsx("option",{value:"",children:"Select SMPS..."}),l.filter(ce=>ce.type==="smps").map(ce=>h.jsxs("option",{value:ce.id,children:[ce.brand," ",ce.model," (",u(ce.id),")"]},ce.id))]});if(Y.id==="processor")return h.jsxs("div",{className:"flex flex-col gap-2 md:gap-1",children:[h.jsxs("select",{value:se,onChange:ce=>Ie("selectedProcId",ce.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[h.jsx("option",{value:"",children:"Select Processor..."}),l.filter(ce=>ce.type==="processor").map(ce=>h.jsxs("option",{value:ce.id,children:[ce.brand," ",ce.model," (",u(ce.id),")"]},ce.id))]}),h.jsxs("div",{className:"flex items-center gap-2 md:gap-1",children:[h.jsx("span",{className:"text-xs md:text-[10px] text-green-600 font-bold",children:"Sell:"}),h.jsx("input",{type:"number",className:"flex-1 md:w-20 p-2 md:p-0.5 text-xs border border-green-200 rounded bg-green-50 text-green-800",value:ae.processor?.val||0,onChange:ce=>a(e.activeScreenIndex,"commercials",{...ae,processor:{...ae.processor,val:ce.target.value}})})]})]});if(Y.id==="ready")return h.jsxs("select",{value:T.readyId,onChange:ce=>Ie("readyId",ce.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[h.jsx("option",{value:"",children:"Select Screen Model..."}),Z.map(ce=>h.jsxs("option",{value:ce.id,children:[ce.brand," ",ce.model," (P",ce.pitch,")"]},ce.id))]});const qe=fe?fe.findIndex(ce=>ce.id===Y.id):-1;return qe!==-1?h.jsxs("div",{className:"flex gap-1 items-center",children:[h.jsxs("select",{value:fe[qe].componentId,onChange:ce=>{const kt=[...fe];kt[qe].componentId=ce.target.value,Ie("extraComponents",kt)},className:"flex-1 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[h.jsx("option",{value:"",children:"Select..."}),["module","cabinet","card","smps"].map(ce=>{const kt=l.filter(vn=>vn.type===ce).sort((vn,Kt)=>(vn.brand+" "+vn.model).localeCompare(Kt.brand+" "+Kt.model));return kt.length===0?null:h.jsx("optgroup",{label:ce==="smps"?"SMPS":ce.toUpperCase(),children:kt.map(vn=>h.jsxs("option",{value:vn.id,children:[vn.brand," ",vn.model]},vn.id))},ce)})]}),h.jsxs("select",{value:fe[qe].type,onChange:ce=>{const kt=[...fe];kt[qe].type=ce.target.value,Ie("extraComponents",kt)},className:"w-16 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[h.jsx("option",{value:"screen",children:"/Scrn"}),h.jsx("option",{value:"cabinet",children:"/Cab"})]}),h.jsx("button",{type:"button",onClick:()=>Ie("extraComponents",fe.filter((ce,kt)=>kt!==qe)),className:"text-red-400 hover:text-red-600",children:h.jsx(ui,{size:16})})]}):h.jsxs("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:[Y.name," ",h.jsxs("span",{className:"text-[10px] text-slate-400 font-normal",children:["(",Y.spec,")"]})]})},Ee=Y=>s?.calculatedExtras?.[Y]||0,Ne=s?.matrix?.sqft?.perScreen||1;let Le=s?s.detailedItems:A==="assembled"?[{id:"modules",type:"led",name:"Modules",qty:0,unit:0,total:0},{id:"cabinets",type:"led",name:"Cabinets",qty:0,unit:0,total:0},{id:"cards",type:"led",name:"Receiving Cards",qty:0,unit:0,total:0},{id:"smps",type:"led",name:"SMPS",qty:0,unit:0,total:0},{id:"processor",type:"service",name:"Processor",qty:1,unit:0,total:0}]:[{id:"ready",type:"led",name:"Ready Unit",qty:0,unit:0,total:0},{id:"processor",type:"service",name:"Processor",qty:1,unit:0,total:0}];!s&&fe?.length>0&&(Le=[...Le,...fe.map(Y=>({id:Y.id,type:"led",name:"Extra",spec:"Select...",qty:Y.qty,unit:0,total:0}))]);const V=Le.filter(Y=>Y.type==="led"),O=(Array.isArray(H)?H:[]).reduce((Y,Ie)=>Y+Ee(Ie.id),0),ne=V.reduce((Y,Ie)=>Y+Ie.total*N,0)+O*N,de=ne/(N||1),me=de/Ne,_e=Le.filter(Y=>Y.type!=="led"),it=Ee("install"),tt=Ee("structure"),zt=_e.reduce((Y,Ie)=>Y+Ie.total*N,0)+(it+tt)*N,_n=zt/(N||1),xr=_n/Ne,on=ne+zt,Qn=on/(N||1),Cn=Qn/Ne,Kn=()=>{const Y={id:k(),name:"New Cost",val:0,type:"abs"};a(e.activeScreenIndex,"extras",[...H||[],Y])},$n=Y=>{const Ie=[...H];Ie.splice(Y,1),a(e.activeScreenIndex,"extras",Ie)},$e=(Y,Ie,qe)=>{const ce=[...H];ce[Y]={...ce[Y],[Ie]:qe},a(e.activeScreenIndex,"extras",ce)},xt=Y=>h.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors ${Y.isOverridden?"bg-amber-50 dark:bg-amber-900/20":""}`,children:[h.jsx("td",{className:"p-2 pl-4",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"flex-1",children:pe(Y)}),s&&h.jsxs(h.Fragment,{children:[h.jsx("button",{type:"button",onClick:()=>b(y===Y.id?null:Y.id),className:`p-1 rounded ${y===Y.id?"bg-teal-100 text-teal-700":"text-slate-300 hover:text-teal-600"}`,children:h.jsx(Eo,{size:12})}),Y.isOverridden&&h.jsx("button",{type:"button",onClick:()=>E(Y.id),className:"text-amber-500 hover:text-red-500",children:h.jsx(My,{size:12})})]})]})}),h.jsx("td",{className:"p-2 text-right w-24",children:y===Y.id?h.jsx("input",{type:"number",className:"w-full p-1 text-right text-xs border rounded",value:p[Y.id]?.rate??Y.unit,onChange:Ie=>f(Y.id,"rate",Ie.target.value)}):Oe(Y.unit,"INR",!1)}),h.jsx("td",{className:"p-2 text-center border-l border-slate-100 dark:border-slate-700 w-16",children:y===Y.id?h.jsx("input",{type:"number",className:"w-full p-1 text-center text-xs border rounded",value:p[Y.id]?.qty??Y.qty,onChange:Ie=>f(Y.id,"qty",Ie.target.value)}):Y.qty}),h.jsx("td",{className:"p-2 text-right text-slate-500 w-24",children:Oe(Y.total,"INR",!1)}),h.jsx("td",{className:"p-2 text-right font-medium border-l border-slate-100 dark:border-slate-700 w-28",children:Oe(Y.total*N,"INR",!1)})]},Y.id),kn=Y=>h.jsxs("div",{className:`bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 mb-3 shadow-sm ${Y.isOverridden?"ring-1 ring-amber-400 bg-amber-50 dark:bg-amber-900/10":""}`,children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsx("span",{className:"text-xs font-bold uppercase text-slate-500",children:Y.name}),s&&h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{type:"button",onClick:()=>b(y===Y.id?null:Y.id),className:`p-1 rounded ${y===Y.id?"bg-teal-100 text-teal-700":"text-slate-300 hover:text-teal-600"}`,children:h.jsx(Eo,{size:14})}),Y.isOverridden&&h.jsx("button",{type:"button",onClick:()=>E(Y.id),className:"text-amber-500 hover:text-red-500",children:h.jsx(My,{size:14})})]})]}),h.jsx("div",{className:"mb-3",children:pe(Y)}),h.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs bg-slate-50 dark:bg-slate-700/50 p-2 rounded",children:[h.jsxs("div",{children:[h.jsx("span",{className:"block text-[9px] uppercase text-slate-400 font-bold mb-1",children:"Rate"}),y===Y.id?h.jsx("input",{type:"number",className:"w-full p-1 text-right text-xs border rounded",value:p[Y.id]?.rate??Y.unit,onChange:Ie=>f(Y.id,"rate",Ie.target.value)}):h.jsx("span",{className:"block font-medium dark:text-slate-200",children:Oe(Y.unit,"INR",!1)})]}),h.jsxs("div",{className:"text-center border-l border-slate-200 dark:border-slate-600",children:[h.jsx("span",{className:"block text-[9px] uppercase text-slate-400 font-bold mb-1",children:"Qty"}),y===Y.id?h.jsx("input",{type:"number",className:"w-full p-1 text-center text-xs border rounded",value:p[Y.id]?.qty??Y.qty,onChange:Ie=>f(Y.id,"qty",Ie.target.value)}):h.jsx("span",{className:"block font-medium dark:text-slate-200",children:Y.qty})]}),h.jsxs("div",{className:"text-right border-l border-slate-200 dark:border-slate-600",children:[h.jsx("span",{className:"block text-[9px] uppercase text-slate-400 font-bold mb-1",children:"Total"}),h.jsx("span",{className:"block font-bold text-teal-600 dark:text-teal-400",children:Oe(Y.total*N,"INR",!1)})]})]})]},Y.id);return h.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[h.jsx("div",{className:"hidden md:block overflow-x-auto",children:h.jsxs("table",{className:"w-full text-xs text-left border-collapse",children:[h.jsx("thead",{children:h.jsxs("tr",{className:"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold",children:[h.jsx("th",{className:"p-2",children:"Component Selection"}),h.jsx("th",{className:"p-2 text-right",children:"Rate (Cost)"}),h.jsx("th",{className:"p-2 text-center border-l border-slate-200 dark:border-slate-700",children:"Qty/Scrn"}),h.jsx("th",{className:"p-2 text-right",children:"Cost/Scrn"}),h.jsx("th",{className:"p-2 text-right border-l border-slate-200 dark:border-slate-700",children:"Total Cost"})]})}),h.jsxs("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:[h.jsx("tr",{className:"bg-slate-50 dark:bg-slate-800/50",children:h.jsx("td",{colSpan:"5",className:"p-2 font-bold text-teal-700 dark:text-teal-400 uppercase tracking-wider text-[10px]",children:"A. LED Panel & Logistics"})}),V.map(xt),h.jsx("tr",{className:"bg-white dark:bg-slate-900",children:h.jsx("td",{colSpan:"5",className:"p-2 text-center",children:h.jsxs("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"extraComponents",[...fe||[],{id:k(),componentId:"",qty:1,type:"screen"}]),className:"text-[10px] text-teal-600 hover:underline flex items-center justify-center gap-1 w-full",children:[h.jsx(go,{size:10})," Add Component to Panel"]})})}),(Array.isArray(H)?H:[]).map((Y,Ie)=>h.jsxs("tr",{className:"text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700/50 group",children:[h.jsx("td",{className:"p-2 pl-4",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>$n(Ie),className:"text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:h.jsx(ui,{size:12})}),h.jsx("input",{type:"text",value:Y.name,onChange:qe=>$e(Ie,"name",qe.target.value),className:"text-xs border-b border-transparent hover:border-slate-300 focus:border-teal-500 bg-transparent outline-none w-full text-slate-600 dark:text-slate-300 font-medium"})]})}),h.jsx("td",{className:"p-2 text-right",children:h.jsxs("div",{className:"flex items-center justify-end gap-1",children:[h.jsx("input",{type:"number",value:Y.val,onChange:qe=>$e(Ie,"val",qe.target.value),className:"w-16 p-1 text-right text-xs border rounded bg-white dark:bg-slate-800 dark:border-slate-600"}),h.jsx("button",{type:"button",onClick:()=>$e(Ie,"type",Y.type==="abs"?"pct":"abs"),className:"px-1 text-[10px] font-bold border rounded bg-slate-100 dark:bg-slate-700",children:Y.type==="abs"?"":"%"})]})}),h.jsx("td",{className:"p-2 text-center border-l border-slate-100 dark:border-slate-700 text-[10px] text-slate-400",children:Y.type==="pct"?`${Y.val}%`:"-"}),h.jsx("td",{className:"p-2 text-right",children:Oe(Ee(Y.id),"INR",!1)}),h.jsx("td",{className:"p-2 text-right border-l border-slate-100 dark:border-slate-700",children:Oe(Ee(Y.id)*N,"INR",!1)})]},Y.id)),h.jsx("tr",{className:"bg-slate-50 dark:bg-slate-800/20",children:h.jsx("td",{colSpan:"5",className:"p-1 text-center",children:h.jsxs("button",{onClick:Kn,className:"text-[10px] text-blue-600 hover:text-blue-700 font-bold uppercase tracking-wider flex items-center justify-center gap-1 py-1 w-full hover:bg-slate-100 dark:hover:bg-slate-700 rounded transition-colors",children:[h.jsx(go,{size:10})," Add Extra Cost"]})})}),h.jsxs("tr",{className:"bg-teal-50 dark:bg-teal-900/20 font-bold border-t border-teal-100 dark:border-teal-800",children:[h.jsx("td",{className:"p-2 text-right text-teal-800 dark:text-teal-300",children:"Sub-total (LED Panel)"}),h.jsxs("td",{className:"p-2 text-right text-teal-700 dark:text-teal-400 text-[10px] font-normal",children:[Oe(me,"INR"),"/sqft"]}),h.jsx("td",{className:"p-2 text-center border-l border-teal-100 dark:border-teal-800",children:"-"}),h.jsx("td",{className:"p-2 text-right text-teal-800 dark:text-teal-300",children:Oe(de,"INR",!1)}),h.jsx("td",{className:"p-2 text-right text-teal-800 dark:text-teal-300 border-l border-teal-100 dark:border-teal-800",children:Oe(ne,"INR",!1)})]}),h.jsx("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-700",children:h.jsx("td",{colSpan:"5",className:"p-2 font-bold text-blue-700 dark:text-blue-400 uppercase tracking-wider text-[10px]",children:"B. Additional Costs"})}),_e.map(xt),["installation","structure"].map(Y=>{const Ie=Y==="installation"?"install":"structure",qe=Y==="installation"?"Installation":"Structure";return h.jsxs("tr",{className:"text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[h.jsx("td",{className:"p-2 pl-4",children:h.jsxs("div",{className:"flex flex-col gap-1",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("span",{className:"text-xs font-medium",children:qe}),h.jsxs("select",{value:ae[Y]?.unit||"sqft",onChange:ce=>a(e.activeScreenIndex,"commercials",{...ae,[Y]:{...ae[Y],unit:ce.target.value}}),className:"text-[10px] p-0.5 border rounded bg-slate-50 dark:bg-slate-700",children:[h.jsx("option",{value:"sqft",children:"/Sq.Ft"}),h.jsx("option",{value:"screen",children:"/Screen"})]})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("span",{className:"text-[10px] text-green-600 font-bold",children:"Sell:"}),h.jsx("input",{type:"number",className:"w-20 p-0.5 text-xs border border-green-200 rounded bg-green-50 text-green-800",value:ae[Y]?.val||0,onChange:ce=>a(e.activeScreenIndex,"commercials",{...ae,[Y]:{...ae[Y],val:ce.target.value}})})]})]})}),h.jsx("td",{className:"p-2 text-right",children:h.jsxs("div",{className:"flex items-center justify-end gap-1",children:[h.jsx("span",{className:"text-[10px] text-slate-400 mr-1",children:"Cost:"}),h.jsx("input",{type:"number",value:ae[Y]?.cost||0,onChange:ce=>a(e.activeScreenIndex,"commercials",{...ae,[Y]:{...ae[Y],cost:ce.target.value}}),className:"w-16 p-1 text-right text-xs border rounded bg-white dark:bg-slate-800 dark:border-slate-600"}),h.jsx("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"commercials",{...ae,[Y]:{...ae[Y],costType:ae[Y]?.costType==="abs"?"pct":"abs"}}),className:"px-1 text-[10px] font-bold border rounded bg-slate-100 dark:bg-slate-700",children:ae[Y]?.costType==="abs"?"":"%"})]})}),h.jsx("td",{className:"p-2 text-center border-l border-slate-100 dark:border-slate-700 text-xs",children:ae[Y]?.unit==="sqft"?s?.matrix.sqft.perScreen.toFixed(1)||"-":"1"}),h.jsx("td",{className:"p-2 text-right",children:Oe(Ee(Ie),"INR",!1)}),h.jsx("td",{className:"p-2 text-right border-l border-slate-100 dark:border-slate-700",children:Oe(Ee(Ie)*N,"INR",!1)})]},Y)}),h.jsxs("tr",{className:"bg-blue-50 dark:bg-blue-900/20 font-bold border-t border-blue-100 dark:border-blue-800",children:[h.jsx("td",{className:"p-2 text-right text-blue-800 dark:text-blue-300",children:"Sub-total (Additional)"}),h.jsxs("td",{className:"p-2 text-right text-blue-700 dark:text-blue-400 text-[10px] font-normal",children:[Oe(xr,"INR"),"/sqft"]}),h.jsx("td",{className:"p-2 text-center border-l border-blue-100 dark:border-blue-800",children:"-"}),h.jsx("td",{className:"p-2 text-right text-blue-800 dark:text-blue-300",children:Oe(_n,"INR",!1)}),h.jsx("td",{className:"p-2 text-right text-blue-800 dark:text-blue-300 border-l border-blue-100 dark:border-blue-800",children:Oe(zt,"INR",!1)})]}),h.jsxs("tr",{className:"bg-slate-800 text-white font-bold border-t-2 border-slate-900 text-sm",children:[h.jsx("td",{className:"p-3 text-right uppercase",children:"Grand Total (Cost)"}),h.jsxs("td",{className:"p-3 text-right text-slate-300 text-xs font-normal",children:[Oe(Cn,"INR"),"/sqft"]}),h.jsx("td",{className:"p-3 text-center border-l border-slate-600",children:"-"}),h.jsx("td",{className:"p-3 text-right border-l border-slate-600",children:Oe(Qn,"INR",!1)}),h.jsx("td",{className:"p-3 text-right border-l border-slate-600",children:Oe(on,"INR",!1)})]})]})]})}),h.jsxs("div",{className:"md:hidden bg-slate-50 dark:bg-slate-800/20 p-3",children:[h.jsx("div",{className:"mb-2 font-bold text-teal-700 text-xs uppercase tracking-wider",children:"A. LED Panel & Logistics"}),V.map(kn),h.jsxs("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"extraComponents",[...fe||[],{id:k(),componentId:"",qty:1,type:"screen"}]),className:"w-full py-2 mb-4 bg-white dark:bg-slate-800 border border-teal-200 dark:border-teal-700 text-teal-600 dark:text-teal-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2",children:[h.jsx(go,{size:14})," Add Component"]}),(Array.isArray(H)?H:[]).map((Y,Ie)=>h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 mb-3 shadow-sm flex items-center justify-between",children:[h.jsx("div",{className:"flex-1",children:h.jsx("input",{type:"text",value:Y.name,onChange:qe=>$e(Ie,"name",qe.target.value),className:"text-xs font-bold border-b border-transparent focus:border-teal-500 bg-transparent outline-none w-full text-slate-600 dark:text-slate-300"})}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"number",value:Y.val,onChange:qe=>$e(Ie,"val",qe.target.value),className:"w-12 p-1 text-right text-xs border rounded bg-slate-50 dark:bg-slate-700"}),h.jsx("button",{type:"button",onClick:()=>$e(Ie,"type",Y.type==="abs"?"pct":"abs"),className:"px-1 text-[10px] font-bold border rounded bg-slate-100 dark:bg-slate-600",children:Y.type==="abs"?"":"%"}),h.jsx("button",{onClick:()=>$n(Ie),className:"text-red-400 p-1",children:h.jsx(ui,{size:14})})]})]},Y.id)),h.jsxs("button",{onClick:Kn,className:"w-full py-2 mb-4 bg-white dark:bg-slate-800 border border-blue-200 dark:border-blue-700 text-blue-600 dark:text-blue-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2",children:[h.jsx(go,{size:14})," Add Overhead Cost"]}),h.jsxs("div",{className:"bg-teal-50 dark:bg-teal-900/20 p-3 rounded-lg border border-teal-100 dark:border-teal-800 mb-6",children:[h.jsxs("div",{className:"flex justify-between items-center text-xs font-bold text-teal-800 dark:text-teal-300",children:[h.jsx("span",{children:"Sub-total (LED Panel)"}),h.jsx("span",{children:Oe(ne,"INR",!1)})]}),h.jsxs("div",{className:"text-[10px] text-right text-teal-600 dark:text-teal-400 mt-1",children:[Oe(me,"INR"),"/sqft"]})]}),h.jsx("div",{className:"mb-2 font-bold text-blue-700 text-xs uppercase tracking-wider",children:"B. Additional Costs"}),_e.map(kn),["installation","structure"].map(Y=>{const Ie=Y==="installation"?"install":"structure",qe=Y==="installation"?"Installation":"Structure";return h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 mb-3 shadow-sm",children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsx("span",{className:"text-xs font-bold uppercase text-slate-500",children:qe}),h.jsxs("select",{value:ae[Y]?.unit||"sqft",onChange:ce=>a(e.activeScreenIndex,"commercials",{...ae,[Y]:{...ae[Y],unit:ce.target.value}}),className:"text-[10px] p-0.5 border rounded bg-slate-50 dark:bg-slate-700",children:[h.jsx("option",{value:"sqft",children:"/Sq.Ft"}),h.jsx("option",{value:"screen",children:"/Screen"})]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[h.jsxs("div",{className:"flex items-center gap-1 bg-green-50 p-1 rounded border border-green-100",children:[h.jsx("span",{className:"text-[10px] text-green-600 font-bold",children:"Sell:"}),h.jsx("input",{type:"number",className:"w-full p-0.5 text-xs bg-transparent outline-none text-green-800 font-bold",value:ae[Y]?.val||0,onChange:ce=>a(e.activeScreenIndex,"commercials",{...ae,[Y]:{...ae[Y],val:ce.target.value}})})]}),h.jsxs("div",{className:"flex items-center gap-1 bg-slate-50 p-1 rounded border border-slate-100",children:[h.jsx("span",{className:"text-[10px] text-slate-400",children:"Cost:"}),h.jsx("input",{type:"number",className:"w-full p-0.5 text-xs bg-transparent outline-none",value:ae[Y]?.cost||0,onChange:ce=>a(e.activeScreenIndex,"commercials",{...ae,[Y]:{...ae[Y],cost:ce.target.value}})}),h.jsx("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"commercials",{...ae,[Y]:{...ae[Y],costType:ae[Y]?.costType==="abs"?"pct":"abs"}}),className:"px-1 text-[10px] font-bold",children:ae[Y]?.costType==="abs"?"":"%"})]})]}),h.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-slate-100 dark:border-slate-700",children:[h.jsx("span",{className:"text-[10px] text-slate-400 font-bold",children:"Total Cost"}),h.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-300",children:Oe(Ee(Ie)*N,"INR",!1)})]})]},Y)}),h.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-100 dark:border-blue-800 mb-6",children:h.jsxs("div",{className:"flex justify-between items-center text-xs font-bold text-blue-800 dark:text-blue-300",children:[h.jsx("span",{children:"Sub-total (Additional)"}),h.jsx("span",{children:Oe(zt,"INR",!1)})]})}),h.jsxs("div",{className:"bg-slate-900 p-4 rounded-lg text-white shadow-lg",children:[h.jsxs("div",{className:"flex justify-between items-end mb-1",children:[h.jsx("span",{className:"text-xs uppercase text-slate-400 font-bold",children:"Grand Total (Cost)"}),h.jsx("span",{className:"text-lg font-bold",children:Oe(on,"INR",!1)})]}),h.jsxs("div",{className:"text-[10px] text-right text-slate-500",children:[Oe(Cn,"INR"),"/sqft"]})]})]})]})},h3=({user:s,inventory:e,transactions:t,state:r,setState:a,exchangeRate:l,setExchangeRate:u,onSaveQuote:p})=>{const{client:f,project:y,screenQty:b,targetWidth:E,targetHeight:T,unit:N,selectedIndoor:B,assemblyMode:G,sizingMode:te,margin:I,extras:X,overrides:se,editingRow:fe}=r,[H,ae]=sn.useState(null),[A,R]=sn.useState(null),[k,j]=sn.useState(!1),[P,L]=sn.useState(!1),C=u3(r,300),Me=O=>t?t.filter(q=>q.itemId===O).reduce((q,ne)=>q+(ne.type==="in"?Number(ne.qty):-Number(ne.qty)),0):0,Pe=(O,q)=>a(ne=>({...ne,[O]:q})),Z=(O,q,ne)=>{const de=r.activeScreenIndex;a(me=>{const _e=[...me.screens];return _e[de]={..._e[de],extras:{..._e[de].extras,[O]:{..._e[de].extras[O],[q]:ne}}},{...me,screens:_e}})},pe=()=>{confirm("Reset calculator to defaults?")&&a({client:"",project:"",unit:"ft",screens:[{id:I0(),screenQty:0,targetWidth:0,targetHeight:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",extraComponents:[],overrides:{},editingRow:null,extras:[],commercials:{processor:{val:0,unit:"screen",cost:0,costType:"abs"},installation:{val:0,unit:"sqft",cost:0,costType:"abs"},structure:{val:0,unit:"sqft",cost:0,costType:"abs"}}}],activeScreenIndex:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",margin:0,pricingMode:"margin",targetSellPrice:0,extraComponents:[],commercials:{processor:{val:0,unit:"screen"},installation:{val:0,unit:"sqft"},structure:{val:0,unit:"sqft"}},terms:{price:Dt.DEFAULTS.PRICE_BASIS,deliveryWeeks:Dt.DEFAULTS.DELIVERY_WEEKS,payment:Dt.DEFAULTS.PAYMENT_TERMS},extras:[],overrides:{},editingRow:null})},Ee=()=>{const O={id:I0(),screenQty:1,targetWidth:0,targetHeight:0,selectedIndoor:r.selectedIndoor,assemblyMode:r.assemblyMode,selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedPSUId:"",selectedProcId:"",sizingMode:"closest",readyId:"",extraComponents:[],overrides:{},editingRow:null,extras:[],commercials:{processor:{val:0,unit:"screen",cost:0,costType:"abs"},installation:{val:0,unit:"sqft",cost:0,costType:"abs"},structure:{val:0,unit:"sqft",cost:0,costType:"abs"}}};a(q=>({...q,screens:[...q.screens,O],activeScreenIndex:q.screens.length}))},Ne=(O,q,ne)=>{a(de=>{const me=[...de.screens];return me[O]={...me[O],[q]:ne},{...de,screens:me}})},Le=(O,q,ne)=>{const de=r.screens[r.activeScreenIndex];Ne(r.activeScreenIndex,"overrides",{...de.overrides,[O]:{...de.overrides[O],[q]:ne}})},V=O=>{const ne={...r.screens[r.activeScreenIndex].overrides};delete ne[O],Ne(r.activeScreenIndex,"overrides",ne),Ne(r.activeScreenIndex,"editingRow",null)};return sn.useEffect(()=>{if(!C.screens||C.screens.length===0){ae(null);return}const O=C.screens[C.activeScreenIndex];if(!O){ae(null);return}const q={...C,...O},ne=xo(q,e,t,l);ae(ne)},[C,e,l]),sn.useEffect(()=>{const q=(()=>{if(!C.screens||C.screens.length===0)return null;const ne=C.screens.map(me=>{const _e={...C,...me};return xo(_e,e,t,l)}).filter(me=>me!==null);if(ne.length===0)return null;const de={totalProjectCost:ne.reduce((me,_e)=>me+_e.totalProjectCost,0),totalProjectSell:ne.reduce((me,_e)=>me+_e.totalProjectSell,0),totalLEDSell:ne.reduce((me,_e)=>me+_e.matrix.led.sell*_e.screenQty,0),totalServicesSell:ne.reduce((me,_e)=>me+(_e.matrix.sell.total-_e.matrix.led.sell*_e.screenQty),0),totalMargin:0,totalScreenQty:ne.reduce((me,_e)=>me+Number(_e.screenQty),0),calculations:ne,screenConfigs:C.screens};return de.totalMargin=de.totalProjectSell-de.totalProjectCost,de})();R(q)},[C,e,l]),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 relative items-start",children:[P&&(H||A)&&h.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex justify-center items-center p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-900 max-w-5xl w-full h-[90vh] rounded-lg shadow-2xl flex flex-col overflow-hidden",children:[h.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center bg-slate-50 dark:bg-slate-800",children:[h.jsx("div",{className:"flex items-center gap-4",children:h.jsxs("h2",{className:"font-bold text-lg text-slate-800 dark:text-white flex items-center gap-2",children:[h.jsx(Oy,{size:20,className:"text-teal-600"})," BOM"]})}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>L(!1),className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 rounded text-sm font-bold",children:"Close"}),h.jsxs("button",{onClick:()=>{const O=document.title;document.title=`${f}_${y}_BOM`.replace(/[^a-zA-Z0-9_]/g,"_"),window.print(),document.title=O},className:"px-4 py-2 bg-slate-800 text-white hover:bg-slate-700 rounded flex items-center gap-2 text-sm font-bold",children:[h.jsx(zf,{size:16})," Print"]})]})]}),h.jsx("div",{className:"flex-1 overflow-auto bg-slate-100 dark:bg-slate-800 p-8 flex justify-center",children:h.jsx(c3,{data:H?{...H,clientName:f,projectName:y}:null,allScreensData:A?{...A,clientName:f,projectName:y,screenConfigs:r.screens.map(O=>({targetWidth:O.targetWidth,targetHeight:O.targetHeight,unit:N}))}:null,inventory:e,transactions:t})})]})}),k&&(H||A)&&h.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex justify-center items-center p-4",children:h.jsxs("div",{className:"bg-white max-w-4xl w-full h-[90vh] rounded-lg shadow-2xl flex flex-col",children:[h.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-slate-100 rounded-t-lg",children:[h.jsxs("h2",{className:"font-bold text-lg text-slate-800 flex items-center gap-2",children:[h.jsx(Vy,{size:20})," Print Preview"]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>j(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-200 rounded",children:"Close"}),h.jsxs("button",{onClick:()=>{const O=document.title;document.title=`${f}_${y}_Quote`.replace(/[^a-zA-Z0-9_]/g,"_"),window.print(),document.title=O},className:"px-4 py-2 bg-teal-600 text-white hover:bg-teal-700 rounded flex items-center gap-2",children:[h.jsx(zf,{size:16})," Print / Save PDF"]})]})]}),h.jsx("div",{className:"flex-1 overflow-auto p-8 bg-slate-200",children:h.jsx(yN,{data:H?{...H,clientName:f,projectName:y,margin:I}:null,allScreensData:A?{...A,clientName:f,projectName:y}:null,currency:"INR",exchangeRate:l})})]})}),h.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden",children:[h.jsxs("div",{className:"bg-slate-50/50 dark:bg-slate-800/50 px-4 py-3 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[h.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2 text-sm",children:[h.jsx(AC,{className:"w-4 h-4 text-teal-600"})," Project Specs"]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("button",{onClick:pe,className:"text-[10px] font-bold text-red-500 hover:text-red-700 uppercase hover:bg-red-50 dark:hover:bg-red-900/20 px-2 py-1 rounded transition-colors mr-2 flex items-center gap-1",children:[h.jsx(My,{size:10})," Reset"]}),h.jsxs("div",{className:"flex bg-slate-200 dark:bg-slate-700 rounded-md p-0.5",children:[h.jsx("button",{onClick:()=>Pe("unit","m"),className:`px-2 py-0.5 text-[10px] font-bold rounded transition-all ${N==="m"?"bg-white dark:bg-slate-600 shadow text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400"}`,children:"M"}),h.jsx("button",{onClick:()=>Pe("unit","ft"),className:`px-2 py-0.5 text-[10px] font-bold rounded transition-all ${N==="ft"?"bg-white dark:bg-slate-600 shadow text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400"}`,children:"FT"})]})]})]}),h.jsxs("div",{className:"p-4 space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[h.jsxs("div",{className:"relative group",children:[h.jsx("label",{className:"absolute -top-1.5 left-2 bg-white dark:bg-slate-800 px-1 text-[10px] font-bold text-teal-600 dark:text-teal-400",children:"CLIENT"}),h.jsx("input",{value:f,onChange:O=>Pe("client",O.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded text-sm outline-none focus:border-teal-500 focus:ring-1 focus:ring-teal-500 dark:text-white transition-all",placeholder:"Client Name"})]}),h.jsxs("div",{className:"relative group",children:[h.jsx("label",{className:"absolute -top-1.5 left-2 bg-white dark:bg-slate-800 px-1 text-[10px] font-bold text-teal-600 dark:text-teal-400",children:"PROJECT"}),h.jsx("input",{value:y,onChange:O=>Pe("project",O.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded text-sm outline-none focus:border-teal-500 focus:ring-1 focus:ring-teal-500 dark:text-white transition-all",placeholder:"Project Ref"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[h.jsxs("div",{className:"flex items-center border border-slate-200 dark:border-slate-600 rounded-md overflow-hidden h-8",children:[h.jsx("div",{className:"bg-slate-100 dark:bg-slate-700 px-3 h-full flex items-center border-r border-slate-200 dark:border-slate-600 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase w-20 justify-center",children:"Type"}),h.jsxs("div",{className:"flex-1 flex p-0.5 bg-slate-50 dark:bg-slate-800 h-full",children:[h.jsx("button",{onClick:()=>{Pe("selectedIndoor","true"),Ne(r.activeScreenIndex,"selectedIndoor","true")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${B==="true"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Indoor"}),h.jsx("button",{onClick:()=>{Pe("selectedIndoor","false"),Ne(r.activeScreenIndex,"selectedIndoor","false")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${B==="false"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Outdoor"})]})]}),h.jsxs("div",{className:"flex items-center border border-slate-200 dark:border-slate-600 rounded-md overflow-hidden h-8",children:[h.jsx("div",{className:"bg-slate-100 dark:bg-slate-700 px-3 h-full flex items-center border-r border-slate-200 dark:border-slate-600 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase w-20 justify-center",children:"Supply"}),h.jsxs("div",{className:"flex-1 flex p-0.5 bg-slate-50 dark:bg-slate-800 h-full",children:[h.jsx("button",{onClick:()=>{Pe("assemblyMode","assembled"),Ne(r.activeScreenIndex,"assemblyMode","assembled")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${G==="assembled"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Assm"}),h.jsx("button",{onClick:()=>{Pe("assemblyMode","ready"),Ne(r.activeScreenIndex,"assemblyMode","ready")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${G==="ready"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Ready"})]})]})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Screen Configurations"}),h.jsxs("button",{onClick:Ee,className:"text-[10px] font-bold text-teal-600 dark:text-teal-400 hover:text-teal-700 dark:hover:text-teal-300 flex items-center gap-1 bg-teal-50 dark:bg-teal-900/30 px-2 py-1 rounded transition-colors border border-teal-100 dark:border-teal-800",children:[h.jsx(go,{size:12})," Add Size"]})]}),h.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-12 gap-2 mb-1 px-2 text-[9px] font-bold text-slate-400 uppercase tracking-wider hidden md:grid",children:[h.jsx("div",{className:"col-span-1 text-center",children:"#"}),h.jsxs("div",{className:"col-span-3",children:["Width (",N,")"]}),h.jsxs("div",{className:"col-span-3",children:["Height (",N,")"]}),h.jsx("div",{className:"col-span-2 text-center",children:"Qty"}),h.jsx("div",{className:"col-span-2",children:"Sizing"}),h.jsx("div",{className:"col-span-1 text-right",children:"Actions"})]}),h.jsx("div",{className:"space-y-1 max-h-[300px] overflow-y-auto pr-1 custom-scrollbar",children:r.screens.map((O,q)=>h.jsxs("div",{onClick:()=>a({...r,activeScreenIndex:q}),className:`grid grid-cols-4 md:grid-cols-12 gap-3 items-start p-3 rounded-lg border transition-all cursor-pointer ${r.activeScreenIndex===q?"border-teal-500 ring-1 ring-teal-500 bg-teal-50/50 dark:bg-teal-900/10":"border-slate-200 dark:border-slate-700 hover:border-teal-300"}`,children:[h.jsxs("div",{className:"col-span-4 md:col-span-1 flex justify-between md:justify-center items-center border-b md:border-b-0 pb-2 md:pb-0 mb-1 md:mb-0",children:[h.jsxs("span",{className:"text-xs font-bold text-slate-500 bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded",children:["#",q+1]}),h.jsxs("div",{className:"md:hidden flex gap-3",children:[h.jsx("button",{onClick:ne=>{ne.stopPropagation();const de=[...r.screens],me=Math.random().toString(36).substr(2,9);de.splice(q+1,0,{...de[q],id:me}),a({...r,screens:de,activeScreenIndex:q+1})},className:"text-blue-500 hover:text-blue-700 bg-blue-50 p-1.5 rounded",children:h.jsx(jy,{size:16})}),r.screens.length>1&&h.jsx("button",{onClick:ne=>{ne.stopPropagation();const de=r.screens.filter((me,_e)=>_e!==q);a({...r,screens:de,activeScreenIndex:Math.max(0,q-1)})},className:"text-red-400 hover:text-red-600 bg-red-50 p-1.5 rounded",children:h.jsx(ui,{size:16})})]})]}),h.jsxs("div",{className:"col-span-2 md:col-span-3",children:[h.jsxs("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:["Width (",r.unit,")"]}),h.jsx("input",{type:"number",value:O.targetWidth,onChange:ne=>Ne(q,"targetWidth",ne.target.value),className:"w-full p-2 text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white focus:border-teal-500 outline-none",placeholder:"W"})]}),h.jsxs("div",{className:"col-span-2 md:col-span-3",children:[h.jsxs("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:["Height (",r.unit,")"]}),h.jsx("input",{type:"number",value:O.targetHeight,onChange:ne=>Ne(q,"targetHeight",ne.target.value),className:"w-full p-2 text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white focus:border-teal-500 outline-none",placeholder:"H"})]}),h.jsxs("div",{className:"col-span-2 md:col-span-2",children:[h.jsx("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:"Qty"}),h.jsx("input",{type:"number",value:O.screenQty,onChange:ne=>Ne(q,"screenQty",ne.target.value),className:"w-full p-2 text-center text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white focus:border-teal-500 outline-none",placeholder:"Qty"})]}),h.jsxs("div",{className:"col-span-2 md:col-span-2",children:[h.jsx("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:"Sizing"}),h.jsxs("select",{value:O.sizingMode,onChange:ne=>Ne(q,"sizingMode",ne.target.value),className:"w-full p-2 text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white bg-white outline-none",children:[h.jsx("option",{value:"closest",children:"Auto"}),h.jsx("option",{value:"exact",children:"Exact"})]})]}),h.jsxs("div",{className:"hidden md:flex col-span-1 justify-end gap-1",children:[h.jsx("button",{onClick:ne=>{ne.stopPropagation();const de=[...r.screens],me=Math.random().toString(36).substr(2,9);de.splice(q+1,0,{...de[q],id:me}),a({...r,screens:de,activeScreenIndex:q+1})},className:"p-1.5 text-slate-400 hover:text-blue-500 hover:bg-blue-50 rounded transition-colors",title:"Duplicate",children:h.jsx(jy,{size:14})}),r.screens.length>1&&h.jsx("button",{onClick:ne=>{ne.stopPropagation();const de=r.screens.filter((me,_e)=>_e!==q);a({...r,screens:de,activeScreenIndex:Math.max(0,q-1)})},className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Remove",children:h.jsx(ui,{size:14})})]})]},O.id))})]})]})]}),h.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:h.jsxs("details",{className:"group p-4",open:!0,children:[h.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[h.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[h.jsx(nI,{className:"w-4 h-4 text-teal-600"})," Hardware & Cost Breakdown",r.screens.length>1&&h.jsxs("span",{className:"text-xs font-normal text-slate-500 dark:text-slate-400",children:["(Screen #",r.activeScreenIndex+1," of ",r.screens.length,")"]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"text-teal-600 text-xs font-bold group-open:hidden",children:"Show Table"}),h.jsx("span",{className:"text-slate-400 text-xs hidden group-open:block",children:"Hide Table"})]})]}),h.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 dark:border-slate-700",children:[r.screens.length>1&&h.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:r.screens.map((O,q)=>{const ne=r.activeScreenIndex===q,de=O.targetWidth&&O.targetHeight?`${O.targetWidth}${O.targetHeight}${N} (${O.screenQty})`:`Screen #${q+1}`;return h.jsx("button",{onClick:()=>Pe("activeScreenIndex",q),className:`flex-shrink-0 px-4 py-2 rounded-lg text-xs font-bold transition-all ${ne?"bg-teal-600 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("span",{children:["#",q+1]}),h.jsx("span",{className:"text-[10px] opacity-75",children:de})]})},O.id)})}),r.screens[r.activeScreenIndex]&&h.jsx("div",{className:"mb-4 p-3 bg-slate-50 dark:bg-slate-700/30 rounded-lg border border-slate-200 dark:border-slate-600",children:h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[h.jsxs("div",{children:[h.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Dimensions:"}),h.jsxs("span",{className:"ml-2 font-bold text-slate-800 dark:text-white",children:[r.screens[r.activeScreenIndex].targetWidth||0,"  ",r.screens[r.activeScreenIndex].targetHeight||0," ",N]})]}),h.jsxs("div",{children:[h.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Quantity:"}),h.jsxs("span",{className:"ml-2 font-bold text-teal-600 dark:text-teal-400",children:[r.screens[r.activeScreenIndex].screenQty||0," screens"]})]}),h.jsxs("div",{children:[h.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Sizing:"}),h.jsx("span",{className:"ml-2 font-bold text-slate-800 dark:text-white capitalize",children:r.screens[r.activeScreenIndex].sizingMode})]}),H&&h.jsxs("div",{children:[h.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Final Size:"}),h.jsxs("span",{className:"ml-2 font-bold text-slate-800 dark:text-white",children:[H.finalWidth,"  ",H.finalHeight," m"]})]})]})}),h.jsx(d3,{calculation:H,state:r,updateState:Pe,updateExtra:Z,updateScreenProp:Ne,inventory:e,getStock:Me,overrides:r.screens[r.activeScreenIndex]?.overrides||{},onOverride:Le,editingRow:r.screens[r.activeScreenIndex]?.editingRow,setEditingRow:O=>Ne(r.activeScreenIndex,"editingRow",O),onClearOverride:V})]})]})}),h.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:h.jsxs("details",{className:"group p-4",children:[h.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[h.jsx("span",{className:"text-sm font-bold text-slate-600 dark:text-slate-300",children:"Terms & Conditions"}),h.jsx("span",{className:"text-teal-600 text-xs group-open:hidden",children:"Show Details"})]}),h.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-slate-100 dark:border-slate-700",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Price Basis"}),h.jsx("input",{value:r.terms?.price,onChange:O=>a(q=>({...q,terms:{...q.terms,price:O.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Delivery Weeks"}),h.jsx("input",{type:"number",value:r.terms?.deliveryWeeks,onChange:O=>a(q=>({...q,terms:{...q.terms,deliveryWeeks:O.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),h.jsxs("div",{className:"col-span-1 md:col-span-2",children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 block mb-2",children:"Payment Milestones"}),(r.terms?.payment||[]).map((O,q)=>h.jsxs("div",{className:"flex gap-2 mb-2",children:[h.jsx("input",{value:O.name,onChange:ne=>{const de=[...r.terms.payment];de[q].name=ne.target.value,a(me=>({...me,terms:{...me.terms,payment:de}}))},className:"flex-1 p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white",placeholder:"Milestone Name"}),h.jsx("input",{type:"number",value:O.percent,onChange:ne=>{const de=[...r.terms.payment];de[q].percent=Number(ne.target.value),a(me=>({...me,terms:{...me.terms,payment:de}}))},className:"w-16 p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white",placeholder:"%"}),h.jsx("button",{onClick:()=>{const ne=r.terms.payment.filter((de,me)=>me!==q);a(de=>({...de,terms:{...de.terms,payment:ne}}))},className:"text-red-400",children:h.jsx(N0,{size:14})})]},q)),h.jsx("button",{onClick:()=>a(O=>({...O,terms:{...O.terms,payment:[...O.terms.payment||[],{name:"",percent:0}]}})),className:"text-xs text-teal-600 font-bold",children:"+ Add Milestone"})]}),h.jsxs("div",{className:"col-span-1 md:col-span-2 space-y-4 pt-4 border-t border-slate-100 dark:border-slate-700",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Validity"}),h.jsx("input",{value:r.terms?.validity,onChange:O=>a(q=>({...q,terms:{...q.terms,validity:O.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Warranty Terms"}),h.jsx("textarea",{rows:4,value:r.terms?.warranty,onChange:O=>a(q=>({...q,terms:{...q.terms,warranty:O.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] uppercase font-bold text-teal-600 dark:text-teal-400 mb-2 block",children:"Client Scope of Work"}),h.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(r.terms?.scope||{}).map(([O,q])=>h.jsxs("div",{children:[h.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase",children:O==="elec"?"Electricity":O==="net"?"Internet":O==="soft"?"Software":O==="perm"?"Permissions":O==="pc"?"Computer":O}),h.jsx("textarea",{rows:2,value:q,onChange:ne=>a(de=>({...de,terms:{...de.terms,scope:{...de.terms.scope,[O]:ne.target.value}}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]},O))})]})]})]})]})}),h.jsx("div",{className:"h-10"})]}),h.jsxs("div",{className:"lg:col-span-4 space-y-6 lg:sticky lg:top-24",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700 overflow-hidden",children:[h.jsxs("div",{className:"p-5 bg-gradient-to-br from-slate-50 to-white dark:from-slate-700 dark:to-slate-800",children:[r.screens.length>1&&A&&h.jsxs("div",{className:"mb-4 pb-4 border-b border-slate-200 dark:border-slate-600",children:[h.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400 mb-2",children:"Project Summary"}),h.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[h.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-2 rounded",children:[h.jsx("div",{className:"text-[10px] text-blue-600 dark:text-blue-400 font-semibold",children:"Screen Types"}),h.jsx("div",{className:"font-bold text-blue-800 dark:text-blue-300",children:r.screens.length})]}),h.jsxs("div",{className:"bg-teal-50 dark:bg-teal-900/20 p-2 rounded",children:[h.jsx("div",{className:"text-[10px] text-teal-600 dark:text-teal-400 font-semibold",children:"Total Qty"}),h.jsx("div",{className:"font-bold text-teal-800 dark:text-teal-300",children:A.totalScreenQty})]})]})]}),h.jsxs("div",{className:"flex justify-between items-center mb-2",children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Margin Strategy"}),h.jsxs("select",{value:r.pricingMode||"margin",onChange:O=>{const q=O.target.value;if(Pe("pricingMode",q),q!=="margin"&&H){let ne=0;q==="screen"?ne=H.matrix.sell.unit:q==="sqft"?ne=H.matrix.sell.sqft:q==="sqm"&&(ne=H.matrix.sell.sqft*10.7639),Pe("targetSellPrice",Math.round(ne))}},className:"text-xs border-none bg-transparent font-bold text-teal-600 dark:text-teal-400 focus:ring-0 cursor-pointer outline-none",children:[h.jsx("option",{value:"margin",children:"Margin %"}),h.jsx("option",{value:"sqft",children:"Price / Sq.Ft"}),h.jsx("option",{value:"sqm",children:"Price / Sq.Mtr"}),h.jsx("option",{value:"screen",children:"Price / Screen"})]})]}),h.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[h.jsx("input",{type:"number",value:r.pricingMode==="margin"?I:r.targetSellPrice,onChange:O=>{const q=parseFloat(O.target.value)||0;r.pricingMode==="margin"?Pe("margin",q):Pe("targetSellPrice",q)},className:"w-24 text-center text-xl font-bold p-2 border rounded-lg bg-white dark:bg-slate-600 dark:border-slate-500 shadow-sm focus:ring-2 focus:ring-teal-500/50 outline-none dark:text-white"}),h.jsx("span",{className:"text-lg font-bold text-slate-400",children:r.pricingMode==="margin"?"%":""}),h.jsxs("div",{className:"flex-1 text-right",children:[h.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold",children:r.screens.length>1?"Total Profit":"Est. Profit"}),h.jsx("div",{className:`text-sm font-bold ${(A?A.totalMargin:H?.matrix.margin.total||0)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:A?Oe(A.totalMargin,"INR"):H?Oe(H.matrix.margin.total,"INR"):"-"})]})]}),h.jsx("div",{className:"space-y-3 pt-4 border-t border-slate-100 dark:border-slate-600",children:r.screens.length>1?h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex justify-between items-end",children:[h.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"LED Panels (All)"}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:A?Oe(A.totalLEDSell,"INR"):"-"})]}),h.jsxs("div",{className:"flex justify-between items-end",children:[h.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Services & Extras"}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:A?Oe(A.totalServicesSell,"INR"):"-"})]}),h.jsxs("details",{className:"group",children:[h.jsx("summary",{className:"text-[10px] text-teal-600 dark:text-teal-400 font-bold uppercase cursor-pointer hover:underline",children:"View Screen Breakdown"}),h.jsx("div",{className:"mt-2 space-y-2 pl-2 border-l-2 border-slate-200 dark:border-slate-600",children:A?.calculations.map((O,q)=>h.jsx("div",{className:"text-xs",children:h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:["Screen #",q+1,h.jsxs("span",{className:"text-[10px] ml-1",children:["(",r.screens[q].targetWidth,"",r.screens[q].targetHeight,N," ",O.screenQty,")"]})]}),h.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-300",children:Oe(O.totalProjectSell,"INR")})]})},q))})]})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex justify-between items-end",children:[h.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"LED Panel Price"}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:H?Oe(H.matrix.led.sell*H.screenQty,"INR"):"-"})]}),h.jsxs("div",{className:"flex justify-between items-end",children:[h.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Services & Extras"}),h.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:H?Oe(H.matrix.sell.total-H.matrix.led.sell*H.screenQty,"INR"):"-"})]}),h.jsxs("div",{className:"flex justify-between items-end pt-2 mt-2 border-t border-dashed border-slate-200 dark:border-slate-600",children:[h.jsx("span",{className:"text-sm font-bold text-slate-600 dark:text-slate-300",children:"Rate / Sq.Ft"}),h.jsx("span",{className:"font-bold text-slate-500 dark:text-slate-400",children:H?Oe(H.matrix.sell.sqft,"INR"):"-"})]})]})})]}),h.jsxs("div",{className:"bg-slate-900 p-5 text-white",children:[h.jsxs("div",{className:"flex justify-between items-center mb-1",children:[h.jsx("span",{className:"text-sm text-slate-400",children:"Grand Total (Ex. GST)"}),r.screens.length>1&&h.jsxs("span",{className:"text-xs text-teal-400 font-bold",children:[A?.totalScreenQty||0," screens"]})]}),h.jsx("div",{className:"flex justify-between items-baseline",children:h.jsx("span",{className:"text-3xl font-bold tracking-tight",children:A?Oe(A.totalProjectSell,"INR"):H?Oe(H.totalProjectSell,"INR"):"-"})}),h.jsxs("div",{className:"flex gap-2 mt-4",children:[h.jsxs("button",{onClick:()=>L(!0),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 transition-colors border border-slate-700 py-2",children:[h.jsx(Oy,{size:16,className:"text-blue-400"})," BOM"]}),h.jsxs("button",{onClick:()=>j(!0),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 transition-colors border border-slate-700 py-2",children:[h.jsx(zf,{size:16})," Print"]}),h.jsxs("button",{onClick:()=>p(A?A.totalProjectSell:H?.totalProjectSell),className:"flex-[2] bg-teal-600 hover:bg-teal-500 text-white font-bold rounded-lg shadow-lg shadow-teal-900/20 transition-all flex justify-center items-center gap-2 py-2",children:[h.jsx(IC,{size:18})," Save"]})]})]})]}),h.jsx("div",{className:"bg-slate-900 rounded-xl shadow-lg p-6 text-white overflow-hidden relative min-h-[250px] flex items-center justify-center",children:H?h.jsx("div",{className:"w-full h-full flex items-center justify-center p-4",children:h.jsx(o3,{cols:H.gridCols,rows:H.gridRows,module:H.moduleType,cabinet:H.cabinetType,unit:N})}):h.jsxs("div",{className:"text-slate-500 flex flex-col items-center",children:[h.jsx(_C,{size:32,className:"mb-2 opacity-50"}),h.jsx("span",{children:"Enter dimensions"})]})})]})]})},f3=()=>{const[s,e]=mn.useState(null),[t,r]=mn.useState("quote"),[a,l]=mn.useState([]),[u,p]=mn.useState([]),[f,y]=mn.useState(!1),[b,E]=mn.useState(Dt.DEFAULTS.EXCHANGE_RATE),T={client:"",project:"",unit:"m",screens:[{id:I0(),screenQty:0,targetWidth:0,targetHeight:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",extraComponents:[],overrides:{},editingRow:null,extras:[],commercials:{processor:{val:0,unit:"screen",cost:0,costType:"abs"},installation:{val:0,unit:"sqft",cost:0,costType:"abs"},structure:{val:0,unit:"sqft",cost:0,costType:"abs"}}}],activeScreenIndex:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",margin:0,targetSellPrice:0,pricingMode:"margin",commercials:{processor:{val:0,unit:"screen"},installation:{val:0,unit:"sqft"},structure:{val:0,unit:"sqft"}},terms:{price:Dt.DEFAULTS.PRICE_BASIS,deliveryWeeks:Dt.DEFAULTS.DELIVERY_WEEKS,payment:Dt.DEFAULTS.PAYMENT_TERMS,validity:Dt.TEXT.VALIDITY,warranty:Dt.TEXT.WARRANTY,scope:{structure:Dt.TEXT.SCOPE_STRUCTURE,elec:Dt.TEXT.SCOPE_ELEC,net:Dt.TEXT.SCOPE_NET,soft:Dt.TEXT.SCOPE_SOFT,perm:Dt.TEXT.SCOPE_PERM,pc:Dt.TEXT.SCOPE_PC}},extraComponents:[],extras:[],overrides:{},editingRow:null},[N,B]=mn.useState(T);mn.useEffect(()=>{Zw.onAuthStateChanged(e),Zw.signInAnonymously().catch(console.error)},[]),mn.useEffect(()=>{document.documentElement.classList.toggle("dark",f)},[f]),mn.useEffect(()=>{if(!s||!Vr)return;const I=Vr.collection("artifacts").doc(Ms).collection("public").doc("data").collection("inventory").onSnapshot(se=>l(se.docs.map(fe=>({id:fe.id,...fe.data()})))),X=Vr.collection("artifacts").doc(Ms).collection("public").doc("data").collection("transactions").onSnapshot(se=>p(se.docs.map(fe=>({id:fe.id,...fe.data()}))));return()=>{I(),X()}},[s]);const G=async I=>{if(!N.client||!N.project)return alert("Please enter Client and Project names.");let X=null;if(N.screens&&N.screens.length>0){const se=N.screens.map(fe=>{const H={...N,...fe};return xo(H,a,u,b)}).filter(fe=>fe!==null);se.length>0&&(X={totalProjectCost:se.reduce((fe,H)=>fe+H.totalProjectCost,0),totalProjectSell:se.reduce((fe,H)=>fe+H.totalProjectSell,0),totalLEDSell:se.reduce((fe,H)=>fe+H.matrix.led.sell*H.screenQty,0),totalServicesSell:se.reduce((fe,H)=>fe+(H.matrix.sell.total-H.matrix.led.sell*H.screenQty),0),totalMargin:0,totalScreenQty:se.reduce((fe,H)=>fe+H.screenQty,0),calculations:se,screenConfigs:N.screens},X.totalMargin=X.totalProjectSell-X.totalProjectCost)}try{await Vr.collection("artifacts").doc(Ms).collection("public").doc("data").collection("quotes").add({client:N.client,project:N.project,calculatorState:N,finalAmount:I||0,screenCount:N.screens.length,totalScreenQty:X?.totalScreenQty||0,allScreensData:X,updatedAt:new Date}),alert("Quote Saved Successfully!")}catch(se){console.error(se),alert("Error saving quote.")}},te=(I,X)=>{const se={...T,...I.calculatorState};se.terms={...T.terms,...I.calculatorState.terms||{},scope:{...T.terms.scope,...I.calculatorState.terms?.scope||{}}},X&&(se.client=se.client+" (Copy)",se.project=se.project+" (Copy)"),B(se),r("quote")};return s?h.jsxs("div",{className:"min-h-screen no-print pb-20 bg-slate-50 dark:bg-slate-900 transition-colors font-sans",children:[h.jsxs("nav",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-0 z-50 px-4 md:px-6 h-16 flex items-center justify-between shadow-sm",children:[h.jsx("div",{className:"flex items-center gap-3",children:h.jsx("img",{src:"/AdmireLED/logo.png",alt:"Logo",className:"h-10 w-auto"})}),h.jsxs("div",{className:"flex gap-4 items-center",children:[h.jsxs("div",{className:"hidden md:flex gap-1 bg-slate-100 dark:bg-slate-700 p-1 rounded-lg",children:[h.jsx("button",{onClick:()=>r("quote"),className:`px-4 py-1.5 rounded-md text-sm font-semibold transition-all ${t==="quote"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Calculator"}),h.jsx("button",{onClick:()=>r("inventory"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${t==="inventory"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Components"}),h.jsx("button",{onClick:()=>r("ledger"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${t==="ledger"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Stock"}),h.jsx("button",{onClick:()=>r("saved"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${t==="saved"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Quotes"})]}),h.jsxs("div",{className:"flex items-center gap-2 pl-4 border-l border-slate-200 dark:border-slate-700",children:[h.jsxs("div",{className:"flex items-center bg-slate-100 dark:bg-slate-700 rounded px-2 py-1",title:"Exchange rate for USD items",children:[h.jsx("span",{className:"text-[10px] text-slate-500 font-bold mr-1",children:"$1="}),h.jsx("input",{type:"number",value:b,onChange:I=>E(Number(I.target.value)),className:"w-8 bg-transparent text-xs outline-none font-bold dark:text-white"})]}),h.jsx("button",{onClick:()=>y(!f),className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-400 transition-colors",children:f?h.jsx(CC,{size:18}):h.jsx(bC,{size:18})})]})]})]}),h.jsxs("div",{className:"md:hidden bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-16 z-40 flex shadow-sm",children:[h.jsx("button",{onClick:()=>r("quote"),className:`flex-1 py-3 text-xs font-bold text-center border-b-2 transition-colors ${t==="quote"?"border-teal-600 text-teal-600 dark:text-teal-400":"border-transparent text-slate-500 dark:text-slate-400"}`,children:"Calculator"}),h.jsx("button",{onClick:()=>r("inventory"),className:`flex-1 py-3 text-xs font-bold text-center border-b-2 transition-colors ${t==="inventory"?"border-teal-600 text-teal-600 dark:text-teal-400":"border-transparent text-slate-500 dark:text-slate-400"}`,children:"Components"}),h.jsx("button",{onClick:()=>r("ledger"),className:`flex-1 py-3 text-xs font-bold text-center border-b-2 transition-colors ${t==="ledger"?"border-teal-600 text-teal-600 dark:text-teal-400":"border-transparent text-slate-500 dark:text-slate-400"}`,children:"Stock"}),h.jsx("button",{onClick:()=>r("saved"),className:`flex-1 py-3 text-xs font-bold text-center border-b-2 transition-colors ${t==="saved"?"border-teal-600 text-teal-600 dark:text-teal-400":"border-transparent text-slate-500 dark:text-slate-400"}`,children:"Quotes"})]}),h.jsxs("main",{className:"max-w-[1600px] mx-auto p-4 md:p-6",children:[t==="inventory"&&h.jsx(s3,{user:s,transactions:u}),t==="ledger"&&h.jsx(i3,{user:s,inventory:a,transactions:u}),t==="saved"&&h.jsx(l3,{user:s,inventory:a,transactions:u,exchangeRate:b,onLoadQuote:te}),t==="quote"&&h.jsx(h3,{user:s,inventory:a,transactions:u,state:N,setState:B,exchangeRate:b,setExchangeRate:E,onSaveQuote:G})]})]}):h.jsx("div",{className:"h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900",children:h.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})})};rC.createRoot(document.getElementById("root")).render(h.jsx(sn.StrictMode,{children:h.jsx(f3,{})}));
