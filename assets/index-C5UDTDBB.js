(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function Ry(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var u0={exports:{}},Ou={};var Ow;function t2(){if(Ow)return Ou;Ow=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var m in a)m!=="key"&&(l[m]=a[m])}else l=a;return a=l.ref,{$$typeof:s,type:r,key:u,ref:a!==void 0?a:null,props:l}}return Ou.Fragment=e,Ou.jsx=t,Ou.jsxs=t,Ou}var Mw;function n2(){return Mw||(Mw=1,u0.exports=t2()),u0.exports}var d=n2(),d0={exports:{}},Le={};var Lw;function r2(){if(Lw)return Le;Lw=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),T=Symbol.iterator;function S(O){return O===null||typeof O!="object"?null:(O=T&&O[T]||O["@@iterator"],typeof O=="function"?O:null)}var V={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,$={};function H(O,ne,q){this.props=O,this.context=ne,this.refs=$,this.updater=q||V}H.prototype.isReactComponent={},H.prototype.setState=function(O,ne){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,ne,"setState")},H.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function se(){}se.prototype=H.prototype;function te(O,ne,q){this.props=O,this.context=ne,this.refs=$,this.updater=q||V}var be=te.prototype=new se;be.constructor=te,U(be,H.prototype),be.isPureReactComponent=!0;var ae=Array.isArray;function ee(){}var C={H:null,A:null,T:null,S:null},N=Object.prototype.hasOwnProperty;function E(O,ne,q){var K=q.ref;return{$$typeof:s,type:O,key:ne,ref:K!==void 0?K:null,props:q}}function D(O,ne){return E(O.type,ne,O.props)}function k(O){return typeof O=="object"&&O!==null&&O.$$typeof===s}function j(O){var ne={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(q){return ne[q]})}var R=/\/+/g;function _e(O,ne){return typeof O=="object"&&O!==null&&O.key!=null?j(""+O.key):ne.toString(36)}function Ne(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(ee,ee):(O.status="pending",O.then(function(ne){O.status==="pending"&&(O.status="fulfilled",O.value=ne)},function(ne){O.status==="pending"&&(O.status="rejected",O.reason=ne)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function z(O,ne,q,K,le){var de=typeof O;(de==="undefined"||de==="boolean")&&(O=null);var pe=!1;if(O===null)pe=!0;else switch(de){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(O.$$typeof){case s:case e:pe=!0;break;case _:return pe=O._init,z(pe(O._payload),ne,q,K,le)}}if(pe)return le=le(O),pe=K===""?"."+_e(O,0):K,ae(le)?(q="",pe!=null&&(q=pe.replace(R,"$&/")+"/"),z(le,ne,q,"",function(lr){return lr})):le!=null&&(k(le)&&(le=D(le,q+(le.key==null||O&&O.key===le.key?"":(""+le.key).replace(R,"$&/")+"/")+pe)),ne.push(le)),1;pe=0;var Ce=K===""?".":K+":";if(ae(O))for(var nt=0;nt<O.length;nt++)K=O[nt],de=Ce+_e(K,nt),pe+=z(K,ne,q,de,le);else if(nt=S(O),typeof nt=="function")for(O=nt.call(O),nt=0;!(K=O.next()).done;)K=K.value,de=Ce+_e(K,nt++),pe+=z(K,ne,q,de,le);else if(de==="object"){if(typeof O.then=="function")return z(Ne(O),ne,q,K,le);throw ne=String(O),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return pe}function me(O,ne,q){if(O==null)return O;var K=[],le=0;return z(O,K,"","",function(de){return ne.call(q,de,le++)}),K}function Ee(O){if(O._status===-1){var ne=O._result;ne=ne(),ne.then(function(q){(O._status===0||O._status===-1)&&(O._status=1,O._result=q)},function(q){(O._status===0||O._status===-1)&&(O._status=2,O._result=q)}),O._status===-1&&(O._status=0,O._result=ne)}if(O._status===1)return O._result.default;throw O._result}var Ue=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}},De={map:me,forEach:function(O,ne,q){me(O,function(){ne.apply(this,arguments)},q)},count:function(O){var ne=0;return me(O,function(){ne++}),ne},toArray:function(O){return me(O,function(ne){return ne})||[]},only:function(O){if(!k(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return Le.Activity=x,Le.Children=De,Le.Component=H,Le.Fragment=t,Le.Profiler=a,Le.PureComponent=te,Le.StrictMode=r,Le.Suspense=g,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Le.__COMPILER_RUNTIME={__proto__:null,c:function(O){return C.H.useMemoCache(O)}},Le.cache=function(O){return function(){return O.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(O,ne,q){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var K=U({},O.props),le=O.key;if(ne!=null)for(de in ne.key!==void 0&&(le=""+ne.key),ne)!N.call(ne,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&ne.ref===void 0||(K[de]=ne[de]);var de=arguments.length-2;if(de===1)K.children=q;else if(1<de){for(var pe=Array(de),Ce=0;Ce<de;Ce++)pe[Ce]=arguments[Ce+2];K.children=pe}return E(O.type,le,K)},Le.createContext=function(O){return O={$$typeof:u,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:l,_context:O},O},Le.createElement=function(O,ne,q){var K,le={},de=null;if(ne!=null)for(K in ne.key!==void 0&&(de=""+ne.key),ne)N.call(ne,K)&&K!=="key"&&K!=="__self"&&K!=="__source"&&(le[K]=ne[K]);var pe=arguments.length-2;if(pe===1)le.children=q;else if(1<pe){for(var Ce=Array(pe),nt=0;nt<pe;nt++)Ce[nt]=arguments[nt+2];le.children=Ce}if(O&&O.defaultProps)for(K in pe=O.defaultProps,pe)le[K]===void 0&&(le[K]=pe[K]);return E(O,de,le)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(O){return{$$typeof:m,render:O}},Le.isValidElement=k,Le.lazy=function(O){return{$$typeof:_,_payload:{_status:-1,_result:O},_init:Ee}},Le.memo=function(O,ne){return{$$typeof:y,type:O,compare:ne===void 0?null:ne}},Le.startTransition=function(O){var ne=C.T,q={};C.T=q;try{var K=O(),le=C.S;le!==null&&le(q,K),typeof K=="object"&&K!==null&&typeof K.then=="function"&&K.then(ee,Ue)}catch(de){Ue(de)}finally{ne!==null&&q.types!==null&&(ne.types=q.types),C.T=ne}},Le.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Le.use=function(O){return C.H.use(O)},Le.useActionState=function(O,ne,q){return C.H.useActionState(O,ne,q)},Le.useCallback=function(O,ne){return C.H.useCallback(O,ne)},Le.useContext=function(O){return C.H.useContext(O)},Le.useDebugValue=function(){},Le.useDeferredValue=function(O,ne){return C.H.useDeferredValue(O,ne)},Le.useEffect=function(O,ne){return C.H.useEffect(O,ne)},Le.useEffectEvent=function(O){return C.H.useEffectEvent(O)},Le.useId=function(){return C.H.useId()},Le.useImperativeHandle=function(O,ne,q){return C.H.useImperativeHandle(O,ne,q)},Le.useInsertionEffect=function(O,ne){return C.H.useInsertionEffect(O,ne)},Le.useLayoutEffect=function(O,ne){return C.H.useLayoutEffect(O,ne)},Le.useMemo=function(O,ne){return C.H.useMemo(O,ne)},Le.useOptimistic=function(O,ne){return C.H.useOptimistic(O,ne)},Le.useReducer=function(O,ne,q){return C.H.useReducer(O,ne,q)},Le.useRef=function(O){return C.H.useRef(O)},Le.useState=function(O){return C.H.useState(O)},Le.useSyncExternalStore=function(O,ne,q){return C.H.useSyncExternalStore(O,ne,q)},Le.useTransition=function(){return C.H.useTransition()},Le.version="19.2.3",Le}var Uw;function Cy(){return Uw||(Uw=1,d0.exports=r2()),d0.exports}var lt=Cy();const zt=Ry(lt);var h0={exports:{}},Mu={},f0={exports:{}},m0={};var zw;function s2(){return zw||(zw=1,(function(s){function e(z,me){var Ee=z.length;z.push(me);e:for(;0<Ee;){var Ue=Ee-1>>>1,De=z[Ue];if(0<a(De,me))z[Ue]=me,z[Ee]=De,Ee=Ue;else break e}}function t(z){return z.length===0?null:z[0]}function r(z){if(z.length===0)return null;var me=z[0],Ee=z.pop();if(Ee!==me){z[0]=Ee;e:for(var Ue=0,De=z.length,O=De>>>1;Ue<O;){var ne=2*(Ue+1)-1,q=z[ne],K=ne+1,le=z[K];if(0>a(q,Ee))K<De&&0>a(le,q)?(z[Ue]=le,z[K]=Ee,Ue=K):(z[Ue]=q,z[ne]=Ee,Ue=ne);else if(K<De&&0>a(le,Ee))z[Ue]=le,z[K]=Ee,Ue=K;else break e}}return me}function a(z,me){var Ee=z.sortIndex-me.sortIndex;return Ee!==0?Ee:z.id-me.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var u=Date,m=u.now();s.unstable_now=function(){return u.now()-m}}var g=[],y=[],_=1,x=null,T=3,S=!1,V=!1,U=!1,$=!1,H=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;function be(z){for(var me=t(y);me!==null;){if(me.callback===null)r(y);else if(me.startTime<=z)r(y),me.sortIndex=me.expirationTime,e(g,me);else break;me=t(y)}}function ae(z){if(U=!1,be(z),!V)if(t(g)!==null)V=!0,ee||(ee=!0,j());else{var me=t(y);me!==null&&Ne(ae,me.startTime-z)}}var ee=!1,C=-1,N=5,E=-1;function D(){return $?!0:!(s.unstable_now()-E<N)}function k(){if($=!1,ee){var z=s.unstable_now();E=z;var me=!0;try{e:{V=!1,U&&(U=!1,se(C),C=-1),S=!0;var Ee=T;try{t:{for(be(z),x=t(g);x!==null&&!(x.expirationTime>z&&D());){var Ue=x.callback;if(typeof Ue=="function"){x.callback=null,T=x.priorityLevel;var De=Ue(x.expirationTime<=z);if(z=s.unstable_now(),typeof De=="function"){x.callback=De,be(z),me=!0;break t}x===t(g)&&r(g),be(z)}else r(g);x=t(g)}if(x!==null)me=!0;else{var O=t(y);O!==null&&Ne(ae,O.startTime-z),me=!1}}break e}finally{x=null,T=Ee,S=!1}me=void 0}}finally{me?j():ee=!1}}}var j;if(typeof te=="function")j=function(){te(k)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,_e=R.port2;R.port1.onmessage=k,j=function(){_e.postMessage(null)}}else j=function(){H(k,0)};function Ne(z,me){C=H(function(){z(s.unstable_now())},me)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(z){z.callback=null},s.unstable_forceFrameRate=function(z){0>z||125<z||(N=0<z?Math.floor(1e3/z):5)},s.unstable_getCurrentPriorityLevel=function(){return T},s.unstable_next=function(z){switch(T){case 1:case 2:case 3:var me=3;break;default:me=T}var Ee=T;T=me;try{return z()}finally{T=Ee}},s.unstable_requestPaint=function(){$=!0},s.unstable_runWithPriority=function(z,me){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var Ee=T;T=z;try{return me()}finally{T=Ee}},s.unstable_scheduleCallback=function(z,me,Ee){var Ue=s.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?Ue+Ee:Ue):Ee=Ue,z){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=Ee+De,z={id:_++,callback:me,priorityLevel:z,startTime:Ee,expirationTime:De,sortIndex:-1},Ee>Ue?(z.sortIndex=Ee,e(y,z),t(g)===null&&z===t(y)&&(U?(se(C),C=-1):U=!0,Ne(ae,Ee-Ue))):(z.sortIndex=De,e(g,z),V||S||(V=!0,ee||(ee=!0,j()))),z},s.unstable_shouldYield=D,s.unstable_wrapCallback=function(z){var me=T;return function(){var Ee=T;T=me;try{return z.apply(this,arguments)}finally{T=Ee}}}})(m0)),m0}var Bw;function i2(){return Bw||(Bw=1,f0.exports=s2()),f0.exports}var p0={exports:{}},Pn={};var qw;function a2(){if(qw)return Pn;qw=1;var s=Cy();function e(g){var y="https://react.dev/errors/"+g;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)y+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+g+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(g,y,_){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:g,containerInfo:y,implementation:_}}var u=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(g,y){if(g==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Pn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Pn.createPortal=function(g,y){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(g,y,null,_)},Pn.flushSync=function(g){var y=u.T,_=r.p;try{if(u.T=null,r.p=2,g)return g()}finally{u.T=y,r.p=_,r.d.f()}},Pn.preconnect=function(g,y){typeof g=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,r.d.C(g,y))},Pn.prefetchDNS=function(g){typeof g=="string"&&r.d.D(g)},Pn.preinit=function(g,y){if(typeof g=="string"&&y&&typeof y.as=="string"){var _=y.as,x=m(_,y.crossOrigin),T=typeof y.integrity=="string"?y.integrity:void 0,S=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;_==="style"?r.d.S(g,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:x,integrity:T,fetchPriority:S}):_==="script"&&r.d.X(g,{crossOrigin:x,integrity:T,fetchPriority:S,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Pn.preinitModule=function(g,y){if(typeof g=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var _=m(y.as,y.crossOrigin);r.d.M(g,{crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&r.d.M(g)},Pn.preload=function(g,y){if(typeof g=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var _=y.as,x=m(_,y.crossOrigin);r.d.L(g,_,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Pn.preloadModule=function(g,y){if(typeof g=="string")if(y){var _=m(y.as,y.crossOrigin);r.d.m(g,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else r.d.m(g)},Pn.requestFormReset=function(g){r.d.r(g)},Pn.unstable_batchedUpdates=function(g,y){return g(y)},Pn.useFormState=function(g,y,_){return u.H.useFormState(g,y,_)},Pn.useFormStatus=function(){return u.H.useHostTransitionStatus()},Pn.version="19.2.3",Pn}var Fw;function iI(){if(Fw)return p0.exports;Fw=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch{}}return s(),p0.exports=a2(),p0.exports}var Hw;function o2(){if(Hw)return Mu;Hw=1;var s=i2(),e=Cy(),t=iI();function r(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,o=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(o=i.return),n=i.return;while(n)}return i.tag===3?o:null}function u(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function m(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function g(n){if(l(n)!==n)throw Error(r(188))}function y(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(r(188));return i!==n?null:n}for(var o=n,c=i;;){var f=o.return;if(f===null)break;var p=f.alternate;if(p===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===p.child){for(p=f.child;p;){if(p===o)return g(f),n;if(p===c)return g(f),i;p=p.sibling}throw Error(r(188))}if(o.return!==c.return)o=f,c=p;else{for(var v=!1,I=f.child;I;){if(I===o){v=!0,o=f,c=p;break}if(I===c){v=!0,c=f,o=p;break}I=I.sibling}if(!v){for(I=p.child;I;){if(I===o){v=!0,o=p,c=f;break}if(I===c){v=!0,c=p,o=f;break}I=I.sibling}if(!v)throw Error(r(189))}}if(o.alternate!==c)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?n:i}function _(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=_(n),i!==null)return i;n=n.sibling}return null}var x=Object.assign,T=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),V=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),se=Symbol.for("react.consumer"),te=Symbol.for("react.context"),be=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function j(n){return n===null||typeof n!="object"?null:(n=k&&n[k]||n["@@iterator"],typeof n=="function"?n:null)}var R=Symbol.for("react.client.reference");function _e(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===R?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case U:return"Fragment";case H:return"Profiler";case $:return"StrictMode";case ae:return"Suspense";case ee:return"SuspenseList";case E:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case V:return"Portal";case te:return n.displayName||"Context";case se:return(n._context.displayName||"Context")+".Consumer";case be:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case C:return i=n.displayName||null,i!==null?i:_e(n.type)||"Memo";case N:i=n._payload,n=n._init;try{return _e(n(i))}catch{}}return null}var Ne=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ee={pending:!1,data:null,method:null,action:null},Ue=[],De=-1;function O(n){return{current:n}}function ne(n){0>De||(n.current=Ue[De],Ue[De]=null,De--)}function q(n,i){De++,Ue[De]=n.current,n.current=i}var K=O(null),le=O(null),de=O(null),pe=O(null);function Ce(n,i){switch(q(de,i),q(le,n),q(K,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?iw(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=iw(i),n=aw(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ne(K),q(K,n)}function nt(){ne(K),ne(le),ne(de)}function lr(n){n.memoizedState!==null&&q(pe,n);var i=K.current,o=aw(i,n.type);i!==o&&(q(le,n),q(K,o))}function Ht(n){le.current===n&&(ne(K),ne(le)),pe.current===n&&(ne(pe),Du._currentValue=Ee)}var xn,Er;function un(n){if(xn===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);xn=i&&i[1]||"",Er=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xn+n+Er}var $n=!1;function Dn(n,i){if(!n||$n)return"";$n=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(i){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(Z){var Y=Z}Reflect.construct(n,[],oe)}else{try{oe.call()}catch(Z){Y=Z}n.call(oe.prototype)}}else{try{throw Error()}catch(Z){Y=Z}(oe=n())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(Z){if(Z&&Y&&typeof Z.stack=="string")return[Z.stack,Y.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var p=c.DetermineComponentFrameRoot(),v=p[0],I=p[1];if(v&&I){var P=v.split(`
`),Q=I.split(`
`);for(f=c=0;c<P.length&&!P[c].includes("DetermineComponentFrameRoot");)c++;for(;f<Q.length&&!Q[f].includes("DetermineComponentFrameRoot");)f++;if(c===P.length||f===Q.length)for(c=P.length-1,f=Q.length-1;1<=c&&0<=f&&P[c]!==Q[f];)f--;for(;1<=c&&0<=f;c--,f--)if(P[c]!==Q[f]){if(c!==1||f!==1)do if(c--,f--,0>f||P[c]!==Q[f]){var re=`
`+P[c].replace(" at new "," at ");return n.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",n.displayName)),re}while(1<=c&&0<=f);break}}}finally{$n=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?un(o):""}function Yn(n,i){switch(n.tag){case 26:case 27:case 5:return un(n.type);case 16:return un("Lazy");case 13:return n.child!==i&&i!==null?un("Suspense Fallback"):un("Suspense");case 19:return un("SuspenseList");case 0:case 15:return Dn(n.type,!1);case 11:return Dn(n.type.render,!1);case 1:return Dn(n.type,!0);case 31:return un("Activity");default:return""}}function Wn(n){try{var i="",o=null;do i+=Yn(n,o),o=n,n=n.return;while(n);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var We=Object.prototype.hasOwnProperty,Et=s.unstable_scheduleCallback,jn=s.unstable_cancelCallback,W=s.unstable_shouldYield,Se=s.unstable_requestPaint,Fe=s.unstable_now,ue=s.unstable_getCurrentPriorityLevel,jt=s.unstable_ImmediatePriority,wn=s.unstable_UserBlockingPriority,Xt=s.unstable_NormalPriority,ja=s.unstable_LowPriority,Fs=s.unstable_IdlePriority,Oc=s.log,Ur=s.unstable_setDisableYieldValue,zn=null,xe=null;function Ve(n){if(typeof Oc=="function"&&Ur(n),xe&&typeof xe.setStrictMode=="function")try{xe.setStrictMode(zn,n)}catch{}}var Ge=Math.clz32?Math.clz32:Pa,zr=Math.log,wi=Math.LN2;function Pa(n){return n>>>=0,n===0?32:31-(zr(n)/wi|0)|0}var as=256,Va=262144,Jt=4194304;function os(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function ls(n,i,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,p=n.suspendedLanes,v=n.pingedLanes;n=n.warmLanes;var I=c&134217727;return I!==0?(c=I&~p,c!==0?f=os(c):(v&=I,v!==0?f=os(v):o||(o=I&~n,o!==0&&(f=os(o))))):(I=c&~p,I!==0?f=os(I):v!==0?f=os(v):o||(o=c&~n,o!==0&&(f=os(o)))),f===0?0:i!==0&&i!==f&&(i&p)===0&&(p=f&-f,o=i&-i,p>=o||p===32&&(o&4194048)!==0)?i:f}function Br(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function mp(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ch(){var n=Jt;return Jt<<=1,(Jt&62914560)===0&&(Jt=4194304),n}function cs(n){for(var i=[],o=0;31>o;o++)i.push(n);return i}function Oa(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function pp(n,i,o,c,f,p){var v=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var I=n.entanglements,P=n.expirationTimes,Q=n.hiddenUpdates;for(o=v&~o;0<o;){var re=31-Ge(o),oe=1<<re;I[re]=0,P[re]=-1;var Y=Q[re];if(Y!==null)for(Q[re]=null,re=0;re<Y.length;re++){var Z=Y[re];Z!==null&&(Z.lane&=-536870913)}o&=~oe}c!==0&&Ma(n,c,0),p!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=p&~(v&~i))}function Ma(n,i,o){n.pendingLanes|=i,n.suspendedLanes&=~i;var c=31-Ge(i);n.entangledLanes|=i,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function Mc(n,i){var o=n.entangledLanes|=i;for(n=n.entanglements;o;){var c=31-Ge(o),f=1<<c;f&i|n[c]&i&&(n[c]|=i),o&=~f}}function Lc(n,i){var o=i&-i;return o=(o&42)!==0?1:La(o),(o&(n.suspendedLanes|i))!==0?0:o}function La(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Hs(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function uh(){var n=me.p;return n!==0?n:(n=window.event,n===void 0?32:Rw(n.type))}function qr(n,i){var o=me.p;try{return me.p=n,i()}finally{me.p=o}}var Fr=Math.random().toString(36).slice(2),Zt="__reactFiber$"+Fr,pn="__reactProps$"+Fr,us="__reactContainer$"+Fr,$o="__reactEvents$"+Fr,gp="__reactListeners$"+Fr,dh="__reactHandles$"+Fr,hh="__reactResources$"+Fr,ds="__reactMarker$"+Fr;function Yo(n){delete n[Zt],delete n[pn],delete n[$o],delete n[gp],delete n[dh]}function hs(n){var i=n[Zt];if(i)return i;for(var o=n.parentNode;o;){if(i=o[us]||o[Zt]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(n=fw(n);n!==null;){if(o=n[Zt])return o;n=fw(n)}return i}n=o,o=n.parentNode}return null}function Tr(n){if(n=n[Zt]||n[us]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function cr(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(r(33))}function fs(n){var i=n[hh];return i||(i=n[hh]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function en(n){n[ds]=!0}var Uc=new Set,zc={};function ms(n,i){ps(n,i),ps(n+"Capture",i)}function ps(n,i){for(zc[n]=i,n=0;n<i.length;n++)Uc.add(i[n])}var Bc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qc={},Fc={};function fh(n){return We.call(Fc,n)?!0:We.call(qc,n)?!1:Bc.test(n)?Fc[n]=!0:(qc[n]=!0,!1)}function Wo(n,i,o){if(fh(i))if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var c=i.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+o)}}function ur(n,i,o){if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+o)}}function tn(n,i,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(i,o,""+c)}}function gn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ei(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Hc(n,i,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,p=c.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return f.call(this)},set:function(v){o=""+v,p.call(this,v)}}),Object.defineProperty(n,i,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(v){o=""+v},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function ut(n){if(!n._valueTracker){var i=Ei(n)?"checked":"value";n._valueTracker=Hc(n,i,""+n[i])}}function Ua(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var o=i.getValue(),c="";return n&&(c=Ei(n)?n.checked?"true":"false":n.value),n=c,n!==o?(i.setValue(n),!0):!1}function gs(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var za=/[\n"\\]/g;function Xn(n){return n.replace(za,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Xo(n,i,o,c,f,p,v,I){n.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?n.type=v:n.removeAttribute("type"),i!=null?v==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+gn(i)):n.value!==""+gn(i)&&(n.value=""+gn(i)):v!=="submit"&&v!=="reset"||n.removeAttribute("value"),i!=null?Gc(n,v,gn(i)):o!=null?Gc(n,v,gn(o)):c!=null&&n.removeAttribute("value"),f==null&&p!=null&&(n.defaultChecked=!!p),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?n.name=""+gn(I):n.removeAttribute("name")}function mh(n,i,o,c,f,p,v,I){if(p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"&&(n.type=p),i!=null||o!=null){if(!(p!=="submit"&&p!=="reset"||i!=null)){ut(n);return}o=o!=null?""+gn(o):"",i=i!=null?""+gn(i):o,I||i===n.value||(n.value=i),n.defaultValue=i}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=I?n.checked:!!c,n.defaultChecked=!!c,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(n.name=v),ut(n)}function Gc(n,i,o){i==="number"&&gs(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Ti(n,i,o,c){if(n=n.options,i){i={};for(var f=0;f<o.length;f++)i["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=i.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+gn(o),i=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}i!==null||n[f].disabled||(i=n[f])}i!==null&&(i.selected=!0)}}function ph(n,i,o){if(i!=null&&(i=""+gn(i),i!==n.value&&(n.value=i),o==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=o!=null?""+gn(o):""}function Ii(n,i,o,c){if(i==null){if(c!=null){if(o!=null)throw Error(r(92));if(Ne(c)){if(1<c.length)throw Error(r(93));c=c[0]}o=c}o==null&&(o=""),i=o}o=gn(i),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),ut(n)}function Jn(n,i){if(i){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=i;return}}n.textContent=i}var gh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Qc(n,i,o){var c=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":c?n.setProperty(i,o):typeof o!="number"||o===0||gh.has(i)?i==="float"?n.cssFloat=o:n[i]=(""+o).trim():n[i]=o+"px"}function Kc(n,i,o){if(i!=null&&typeof i!="object")throw Error(r(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||i!=null&&i.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in i)c=i[f],i.hasOwnProperty(f)&&o[f]!==c&&Qc(n,f,c)}else for(var p in i)i.hasOwnProperty(p)&&Qc(n,p,i[p])}function Jo(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Si=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zo(n){return Si.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Hr(){}var $c=null;function Ir(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ai=null,ys=null;function Ba(n){var i=Tr(n);if(i&&(n=i.stateNode)){var o=n[pn]||null;e:switch(n=i.stateNode,i.type){case"input":if(Xo(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Xn(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var c=o[i];if(c!==n&&c.form===n.form){var f=c[pn]||null;if(!f)throw Error(r(90));Xo(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(i=0;i<o.length;i++)c=o[i],c.form===n.form&&Ua(c)}break e;case"textarea":ph(n,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&Ti(n,!!o.multiple,i,!1)}}}var el=!1;function Ni(n,i,o){if(el)return n(i,o);el=!0;try{var c=n(i);return c}finally{if(el=!1,(Ai!==null||ys!==null)&&(df(),Ai&&(i=Ai,n=ys,ys=Ai=null,Ba(i),n)))for(i=0;i<n.length;i++)Ba(n[i])}}function Gr(n,i){var o=n.stateNode;if(o===null)return null;var c=o[pn]||null;if(c===null)return null;o=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(r(231,i,typeof o));return o}var Sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qa=!1;if(Sr)try{var gt={};Object.defineProperty(gt,"passive",{get:function(){qa=!0}}),window.addEventListener("test",gt,gt),window.removeEventListener("test",gt,gt)}catch{qa=!1}var _s=null,Yc=null,Fa=null;function Wc(){if(Fa)return Fa;var n,i=Yc,o=i.length,c,f="value"in _s?_s.value:_s.textContent,p=f.length;for(n=0;n<o&&i[n]===f[n];n++);var v=o-n;for(c=1;c<=v&&i[o-c]===f[p-c];c++);return Fa=f.slice(n,1<c?1-c:void 0)}function Ha(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Gs(){return!0}function Qr(){return!1}function En(n){function i(o,c,f,p,v){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=p,this.target=v,this.currentTarget=null;for(var I in n)n.hasOwnProperty(I)&&(o=n[I],this[I]=o?o(p):p[I]);return this.isDefaultPrevented=(p.defaultPrevented!=null?p.defaultPrevented:p.returnValue===!1)?Gs:Qr,this.isPropagationStopped=Qr,this}return x(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Gs)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Gs)},persist:function(){},isPersistent:Gs}),i}var Qs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bs=En(Qs),Ri=x({},Qs,{view:0,detail:0}),Xc=En(Ri),Ci,tl,vs,nl=x({},Ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ki,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==vs&&(vs&&n.type==="mousemove"?(Ci=n.screenX-vs.screenX,tl=n.screenY-vs.screenY):tl=Ci=0,vs=n),Ci)},movementY:function(n){return"movementY"in n?n.movementY:tl}}),Jc=En(nl),Ga=x({},nl,{dataTransfer:0}),_h=En(Ga),bh=x({},Ri,{relatedTarget:0}),Qa=En(bh),Zc=x({},Qs,{animationName:0,elapsedTime:0,pseudoElement:0}),vh=En(Zc),rl=x({},Qs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),xh=En(rl),wh=x({},Qs,{data:0}),xs=En(wh),Eh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Th={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ih={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sh(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=Ih[n])?!!i[n]:!1}function ki(){return Sh}var Bn=x({},Ri,{key:function(n){if(n.key){var i=Eh[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Ha(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Th[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ki,charCode:function(n){return n.type==="keypress"?Ha(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ha(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Ah=En(Bn),Nh=x({},nl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ks=En(Nh),h=x({},Ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ki}),b=En(h),w=x({},Qs,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=En(w),F=x({},nl,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),J=En(F),ge=x({},Qs,{newState:0,oldState:0}),ze=En(ge),Gt=[9,13,27,32],at=Sr&&"CompositionEvent"in window,At=null;Sr&&"documentMode"in document&&(At=document.documentMode);var Ar=Sr&&"TextEvent"in window&&!At,ws=Sr&&(!at||At&&8<At&&11>=At),Kr=" ",$r=!1;function Ka(n,i){switch(n){case"keyup":return Gt.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sl(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var il=!1;function IN(n,i){switch(n){case"compositionend":return sl(i);case"keypress":return i.which!==32?null:($r=!0,Kr);case"textInput":return n=i.data,n===Kr&&$r?null:n;default:return null}}function SN(n,i){if(il)return n==="compositionend"||!at&&Ka(n,i)?(n=Wc(),Fa=Yc=_s=null,il=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return ws&&i.locale!=="ko"?null:i.data;default:return null}}var AN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gb(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!AN[n.type]:i==="textarea"}function yb(n,i,o,c){Ai?ys?ys.push(c):ys=[c]:Ai=c,i=_f(i,"onChange"),0<i.length&&(o=new bs("onChange","change",null,o,c),n.push({event:o,listeners:i}))}var eu=null,tu=null;function NN(n){Zx(n,0)}function Rh(n){var i=cr(n);if(Ua(i))return n}function _b(n,i){if(n==="change")return i}var bb=!1;if(Sr){var yp;if(Sr){var _p="oninput"in document;if(!_p){var vb=document.createElement("div");vb.setAttribute("oninput","return;"),_p=typeof vb.oninput=="function"}yp=_p}else yp=!1;bb=yp&&(!document.documentMode||9<document.documentMode)}function xb(){eu&&(eu.detachEvent("onpropertychange",wb),tu=eu=null)}function wb(n){if(n.propertyName==="value"&&Rh(tu)){var i=[];yb(i,tu,n,Ir(n)),Ni(NN,i)}}function RN(n,i,o){n==="focusin"?(xb(),eu=i,tu=o,eu.attachEvent("onpropertychange",wb)):n==="focusout"&&xb()}function CN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Rh(tu)}function kN(n,i){if(n==="click")return Rh(i)}function DN(n,i){if(n==="input"||n==="change")return Rh(i)}function jN(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var dr=typeof Object.is=="function"?Object.is:jN;function nu(n,i){if(dr(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var o=Object.keys(n),c=Object.keys(i);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!We.call(i,f)||!dr(n[f],i[f]))return!1}return!0}function Eb(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Tb(n,i){var o=Eb(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=i&&c>=i)return{node:o,offset:i-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Eb(o)}}function Ib(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?Ib(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Sb(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=gs(n.document);i instanceof n.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)n=i.contentWindow;else break;i=gs(n.document)}return i}function bp(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var PN=Sr&&"documentMode"in document&&11>=document.documentMode,al=null,vp=null,ru=null,xp=!1;function Ab(n,i,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;xp||al==null||al!==gs(c)||(c=al,"selectionStart"in c&&bp(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ru&&nu(ru,c)||(ru=c,c=_f(vp,"onSelect"),0<c.length&&(i=new bs("onSelect","select",null,i,o),n.push({event:i,listeners:c}),i.target=al)))}function $a(n,i){var o={};return o[n.toLowerCase()]=i.toLowerCase(),o["Webkit"+n]="webkit"+i,o["Moz"+n]="moz"+i,o}var ol={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionrun:$a("Transition","TransitionRun"),transitionstart:$a("Transition","TransitionStart"),transitioncancel:$a("Transition","TransitionCancel"),transitionend:$a("Transition","TransitionEnd")},wp={},Nb={};Sr&&(Nb=document.createElement("div").style,"AnimationEvent"in window||(delete ol.animationend.animation,delete ol.animationiteration.animation,delete ol.animationstart.animation),"TransitionEvent"in window||delete ol.transitionend.transition);function Ya(n){if(wp[n])return wp[n];if(!ol[n])return n;var i=ol[n],o;for(o in i)if(i.hasOwnProperty(o)&&o in Nb)return wp[n]=i[o];return n}var Rb=Ya("animationend"),Cb=Ya("animationiteration"),kb=Ya("animationstart"),VN=Ya("transitionrun"),ON=Ya("transitionstart"),MN=Ya("transitioncancel"),Db=Ya("transitionend"),jb=new Map,Ep="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ep.push("scrollEnd");function Yr(n,i){jb.set(n,i),ms(i,[n])}var Ch=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}},Nr=[],ll=0,Tp=0;function kh(){for(var n=ll,i=Tp=ll=0;i<n;){var o=Nr[i];Nr[i++]=null;var c=Nr[i];Nr[i++]=null;var f=Nr[i];Nr[i++]=null;var p=Nr[i];if(Nr[i++]=null,c!==null&&f!==null){var v=c.pending;v===null?f.next=f:(f.next=v.next,v.next=f),c.pending=f}p!==0&&Pb(o,f,p)}}function Dh(n,i,o,c){Nr[ll++]=n,Nr[ll++]=i,Nr[ll++]=o,Nr[ll++]=c,Tp|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Ip(n,i,o,c){return Dh(n,i,o,c),jh(n)}function Wa(n,i){return Dh(n,null,null,i),jh(n)}function Pb(n,i,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,p=n.return;p!==null;)p.childLanes|=o,c=p.alternate,c!==null&&(c.childLanes|=o),p.tag===22&&(n=p.stateNode,n===null||n._visibility&1||(f=!0)),n=p,p=p.return;return n.tag===3?(p=n.stateNode,f&&i!==null&&(f=31-Ge(o),n=p.hiddenUpdates,c=n[f],c===null?n[f]=[i]:c.push(i),i.lane=o|536870912),p):null}function jh(n){if(50<Iu)throw Iu=0,Pg=null,Error(r(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var cl={};function LN(n,i,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(n,i,o,c){return new LN(n,i,o,c)}function Sp(n){return n=n.prototype,!(!n||!n.isReactComponent)}function $s(n,i){var o=n.alternate;return o===null?(o=hr(n.tag,i,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=i,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,i=n.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Vb(n,i){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function Ph(n,i,o,c,f,p){var v=0;if(c=n,typeof n=="function")Sp(n)&&(v=1);else if(typeof n=="string")v=FR(n,o,K.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case E:return n=hr(31,o,i,f),n.elementType=E,n.lanes=p,n;case U:return Xa(o.children,f,p,i);case $:v=8,f|=24;break;case H:return n=hr(12,o,i,f|2),n.elementType=H,n.lanes=p,n;case ae:return n=hr(13,o,i,f),n.elementType=ae,n.lanes=p,n;case ee:return n=hr(19,o,i,f),n.elementType=ee,n.lanes=p,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case te:v=10;break e;case se:v=9;break e;case be:v=11;break e;case C:v=14;break e;case N:v=16,c=null;break e}v=29,o=Error(r(130,n===null?"null":typeof n,"")),c=null}return i=hr(v,o,i,f),i.elementType=n,i.type=c,i.lanes=p,i}function Xa(n,i,o,c){return n=hr(7,n,c,i),n.lanes=o,n}function Ap(n,i,o){return n=hr(6,n,null,i),n.lanes=o,n}function Ob(n){var i=hr(18,null,null,0);return i.stateNode=n,i}function Np(n,i,o){return i=hr(4,n.children!==null?n.children:[],n.key,i),i.lanes=o,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var Mb=new WeakMap;function Rr(n,i){if(typeof n=="object"&&n!==null){var o=Mb.get(n);return o!==void 0?o:(i={value:n,source:i,stack:Wn(i)},Mb.set(n,i),i)}return{value:n,source:i,stack:Wn(i)}}var ul=[],dl=0,Vh=null,su=0,Cr=[],kr=0,Di=null,Es=1,Ts="";function Ys(n,i){ul[dl++]=su,ul[dl++]=Vh,Vh=n,su=i}function Lb(n,i,o){Cr[kr++]=Es,Cr[kr++]=Ts,Cr[kr++]=Di,Di=n;var c=Es;n=Ts;var f=32-Ge(c)-1;c&=~(1<<f),o+=1;var p=32-Ge(i)+f;if(30<p){var v=f-f%5;p=(c&(1<<v)-1).toString(32),c>>=v,f-=v,Es=1<<32-Ge(i)+f|o<<f|c,Ts=p+n}else Es=1<<p|o<<f|c,Ts=n}function Rp(n){n.return!==null&&(Ys(n,1),Lb(n,1,0))}function Cp(n){for(;n===Vh;)Vh=ul[--dl],ul[dl]=null,su=ul[--dl],ul[dl]=null;for(;n===Di;)Di=Cr[--kr],Cr[kr]=null,Ts=Cr[--kr],Cr[kr]=null,Es=Cr[--kr],Cr[kr]=null}function Ub(n,i){Cr[kr++]=Es,Cr[kr++]=Ts,Cr[kr++]=Di,Es=i.id,Ts=i.overflow,Di=n}var Tn=null,Tt=null,et=!1,ji=null,Dr=!1,kp=Error(r(519));function Pi(n){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw iu(Rr(i,n)),kp}function zb(n){var i=n.stateNode,o=n.type,c=n.memoizedProps;switch(i[Zt]=n,i[pn]=c,o){case"dialog":Ke("cancel",i),Ke("close",i);break;case"iframe":case"object":case"embed":Ke("load",i);break;case"video":case"audio":for(o=0;o<Au.length;o++)Ke(Au[o],i);break;case"source":Ke("error",i);break;case"img":case"image":case"link":Ke("error",i),Ke("load",i);break;case"details":Ke("toggle",i);break;case"input":Ke("invalid",i),mh(i,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Ke("invalid",i);break;case"textarea":Ke("invalid",i),Ii(i,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||c.suppressHydrationWarning===!0||rw(i.textContent,o)?(c.popover!=null&&(Ke("beforetoggle",i),Ke("toggle",i)),c.onScroll!=null&&Ke("scroll",i),c.onScrollEnd!=null&&Ke("scrollend",i),c.onClick!=null&&(i.onclick=Hr),i=!0):i=!1,i||Pi(n,!0)}function Bb(n){for(Tn=n.return;Tn;)switch(Tn.tag){case 5:case 31:case 13:Dr=!1;return;case 27:case 3:Dr=!0;return;default:Tn=Tn.return}}function hl(n){if(n!==Tn)return!1;if(!et)return Bb(n),et=!0,!1;var i=n.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Yg(n.type,n.memoizedProps)),o=!o),o&&Tt&&Pi(n),Bb(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Tt=hw(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Tt=hw(n)}else i===27?(i=Tt,$i(n.type)?(n=e0,e0=null,Tt=n):Tt=i):Tt=Tn?Pr(n.stateNode.nextSibling):null;return!0}function Ja(){Tt=Tn=null,et=!1}function Dp(){var n=ji;return n!==null&&(nr===null?nr=n:nr.push.apply(nr,n),ji=null),n}function iu(n){ji===null?ji=[n]:ji.push(n)}var jp=O(null),Za=null,Ws=null;function Vi(n,i,o){q(jp,i._currentValue),i._currentValue=o}function Xs(n){n._currentValue=jp.current,ne(jp)}function Pp(n,i,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),n===o)break;n=n.return}}function Vp(n,i,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var p=f.dependencies;if(p!==null){var v=f.child;p=p.firstContext;e:for(;p!==null;){var I=p;p=f;for(var P=0;P<i.length;P++)if(I.context===i[P]){p.lanes|=o,I=p.alternate,I!==null&&(I.lanes|=o),Pp(p.return,o,n),c||(v=null);break e}p=I.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(r(341));v.lanes|=o,p=v.alternate,p!==null&&(p.lanes|=o),Pp(v,o,n),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===n){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function fl(n,i,o,c){n=null;for(var f=i,p=!1;f!==null;){if(!p){if((f.flags&524288)!==0)p=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(r(387));if(v=v.memoizedProps,v!==null){var I=f.type;dr(f.pendingProps.value,v.value)||(n!==null?n.push(I):n=[I])}}else if(f===pe.current){if(v=f.alternate,v===null)throw Error(r(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Du):n=[Du])}f=f.return}n!==null&&Vp(i,n,o,c),i.flags|=262144}function Oh(n){for(n=n.firstContext;n!==null;){if(!dr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function eo(n){Za=n,Ws=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function In(n){return qb(Za,n)}function Mh(n,i){return Za===null&&eo(n),qb(n,i)}function qb(n,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Ws===null){if(n===null)throw Error(r(308));Ws=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else Ws=Ws.next=i;return o}var UN=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){i.aborted=!0,n.forEach(function(o){return o()})}},zN=s.unstable_scheduleCallback,BN=s.unstable_NormalPriority,nn={$$typeof:te,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Op(){return{controller:new UN,data:new Map,refCount:0}}function au(n){n.refCount--,n.refCount===0&&zN(BN,function(){n.controller.abort()})}var ou=null,Mp=0,ml=0,pl=null;function qN(n,i){if(ou===null){var o=ou=[];Mp=0,ml=zg(),pl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Mp++,i.then(Fb,Fb),i}function Fb(){if(--Mp===0&&ou!==null){pl!==null&&(pl.status="fulfilled");var n=ou;ou=null,ml=0,pl=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function FN(n,i){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=i;for(var f=0;f<o.length;f++)(0,o[f])(i)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var Hb=z.S;z.S=function(n,i){Ax=Fe(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&qN(n,i),Hb!==null&&Hb(n,i)};var to=O(null);function Lp(){var n=to.current;return n!==null?n:vt.pooledCache}function Lh(n,i){i===null?q(to,to.current):q(to,i.pool)}function Gb(){var n=Lp();return n===null?null:{parent:nn._currentValue,pool:n}}var gl=Error(r(460)),Up=Error(r(474)),Uh=Error(r(542)),zh={then:function(){}};function Qb(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Kb(n,i,o){switch(o=n[o],o===void 0?n.push(i):o!==i&&(i.then(Hr,Hr),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Yb(n),n;default:if(typeof i.status=="string")i.then(Hr,Hr);else{if(n=vt,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=i,n.status="pending",n.then(function(c){if(i.status==="pending"){var f=i;f.status="fulfilled",f.value=c}},function(c){if(i.status==="pending"){var f=i;f.status="rejected",f.reason=c}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Yb(n),n}throw ro=i,gl}}function no(n){try{var i=n._init;return i(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ro=o,gl):o}}var ro=null;function $b(){if(ro===null)throw Error(r(459));var n=ro;return ro=null,n}function Yb(n){if(n===gl||n===Uh)throw Error(r(483))}var yl=null,lu=0;function Bh(n){var i=lu;return lu+=1,yl===null&&(yl=[]),Kb(yl,n,i)}function cu(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function qh(n,i){throw i.$$typeof===T?Error(r(525)):(n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Wb(n){function i(L,M){if(n){var G=L.deletions;G===null?(L.deletions=[M],L.flags|=16):G.push(M)}}function o(L,M){if(!n)return null;for(;M!==null;)i(L,M),M=M.sibling;return null}function c(L){for(var M=new Map;L!==null;)L.key!==null?M.set(L.key,L):M.set(L.index,L),L=L.sibling;return M}function f(L,M){return L=$s(L,M),L.index=0,L.sibling=null,L}function p(L,M,G){return L.index=G,n?(G=L.alternate,G!==null?(G=G.index,G<M?(L.flags|=67108866,M):G):(L.flags|=67108866,M)):(L.flags|=1048576,M)}function v(L){return n&&L.alternate===null&&(L.flags|=67108866),L}function I(L,M,G,ie){return M===null||M.tag!==6?(M=Ap(G,L.mode,ie),M.return=L,M):(M=f(M,G),M.return=L,M)}function P(L,M,G,ie){var ke=G.type;return ke===U?re(L,M,G.props.children,ie,G.key):M!==null&&(M.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===N&&no(ke)===M.type)?(M=f(M,G.props),cu(M,G),M.return=L,M):(M=Ph(G.type,G.key,G.props,null,L.mode,ie),cu(M,G),M.return=L,M)}function Q(L,M,G,ie){return M===null||M.tag!==4||M.stateNode.containerInfo!==G.containerInfo||M.stateNode.implementation!==G.implementation?(M=Np(G,L.mode,ie),M.return=L,M):(M=f(M,G.children||[]),M.return=L,M)}function re(L,M,G,ie,ke){return M===null||M.tag!==7?(M=Xa(G,L.mode,ie,ke),M.return=L,M):(M=f(M,G),M.return=L,M)}function oe(L,M,G){if(typeof M=="string"&&M!==""||typeof M=="number"||typeof M=="bigint")return M=Ap(""+M,L.mode,G),M.return=L,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case S:return G=Ph(M.type,M.key,M.props,null,L.mode,G),cu(G,M),G.return=L,G;case V:return M=Np(M,L.mode,G),M.return=L,M;case N:return M=no(M),oe(L,M,G)}if(Ne(M)||j(M))return M=Xa(M,L.mode,G,null),M.return=L,M;if(typeof M.then=="function")return oe(L,Bh(M),G);if(M.$$typeof===te)return oe(L,Mh(L,M),G);qh(L,M)}return null}function Y(L,M,G,ie){var ke=M!==null?M.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return ke!==null?null:I(L,M,""+G,ie);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case S:return G.key===ke?P(L,M,G,ie):null;case V:return G.key===ke?Q(L,M,G,ie):null;case N:return G=no(G),Y(L,M,G,ie)}if(Ne(G)||j(G))return ke!==null?null:re(L,M,G,ie,null);if(typeof G.then=="function")return Y(L,M,Bh(G),ie);if(G.$$typeof===te)return Y(L,M,Mh(L,G),ie);qh(L,G)}return null}function Z(L,M,G,ie,ke){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return L=L.get(G)||null,I(M,L,""+ie,ke);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case S:return L=L.get(ie.key===null?G:ie.key)||null,P(M,L,ie,ke);case V:return L=L.get(ie.key===null?G:ie.key)||null,Q(M,L,ie,ke);case N:return ie=no(ie),Z(L,M,G,ie,ke)}if(Ne(ie)||j(ie))return L=L.get(G)||null,re(M,L,ie,ke,null);if(typeof ie.then=="function")return Z(L,M,G,Bh(ie),ke);if(ie.$$typeof===te)return Z(L,M,G,Mh(M,ie),ke);qh(M,ie)}return null}function Te(L,M,G,ie){for(var ke=null,rt=null,Ae=M,He=M=0,Je=null;Ae!==null&&He<G.length;He++){Ae.index>He?(Je=Ae,Ae=null):Je=Ae.sibling;var st=Y(L,Ae,G[He],ie);if(st===null){Ae===null&&(Ae=Je);break}n&&Ae&&st.alternate===null&&i(L,Ae),M=p(st,M,He),rt===null?ke=st:rt.sibling=st,rt=st,Ae=Je}if(He===G.length)return o(L,Ae),et&&Ys(L,He),ke;if(Ae===null){for(;He<G.length;He++)Ae=oe(L,G[He],ie),Ae!==null&&(M=p(Ae,M,He),rt===null?ke=Ae:rt.sibling=Ae,rt=Ae);return et&&Ys(L,He),ke}for(Ae=c(Ae);He<G.length;He++)Je=Z(Ae,L,He,G[He],ie),Je!==null&&(n&&Je.alternate!==null&&Ae.delete(Je.key===null?He:Je.key),M=p(Je,M,He),rt===null?ke=Je:rt.sibling=Je,rt=Je);return n&&Ae.forEach(function(Zi){return i(L,Zi)}),et&&Ys(L,He),ke}function Pe(L,M,G,ie){if(G==null)throw Error(r(151));for(var ke=null,rt=null,Ae=M,He=M=0,Je=null,st=G.next();Ae!==null&&!st.done;He++,st=G.next()){Ae.index>He?(Je=Ae,Ae=null):Je=Ae.sibling;var Zi=Y(L,Ae,st.value,ie);if(Zi===null){Ae===null&&(Ae=Je);break}n&&Ae&&Zi.alternate===null&&i(L,Ae),M=p(Zi,M,He),rt===null?ke=Zi:rt.sibling=Zi,rt=Zi,Ae=Je}if(st.done)return o(L,Ae),et&&Ys(L,He),ke;if(Ae===null){for(;!st.done;He++,st=G.next())st=oe(L,st.value,ie),st!==null&&(M=p(st,M,He),rt===null?ke=st:rt.sibling=st,rt=st);return et&&Ys(L,He),ke}for(Ae=c(Ae);!st.done;He++,st=G.next())st=Z(Ae,L,He,st.value,ie),st!==null&&(n&&st.alternate!==null&&Ae.delete(st.key===null?He:st.key),M=p(st,M,He),rt===null?ke=st:rt.sibling=st,rt=st);return n&&Ae.forEach(function(e2){return i(L,e2)}),et&&Ys(L,He),ke}function bt(L,M,G,ie){if(typeof G=="object"&&G!==null&&G.type===U&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case S:e:{for(var ke=G.key;M!==null;){if(M.key===ke){if(ke=G.type,ke===U){if(M.tag===7){o(L,M.sibling),ie=f(M,G.props.children),ie.return=L,L=ie;break e}}else if(M.elementType===ke||typeof ke=="object"&&ke!==null&&ke.$$typeof===N&&no(ke)===M.type){o(L,M.sibling),ie=f(M,G.props),cu(ie,G),ie.return=L,L=ie;break e}o(L,M);break}else i(L,M);M=M.sibling}G.type===U?(ie=Xa(G.props.children,L.mode,ie,G.key),ie.return=L,L=ie):(ie=Ph(G.type,G.key,G.props,null,L.mode,ie),cu(ie,G),ie.return=L,L=ie)}return v(L);case V:e:{for(ke=G.key;M!==null;){if(M.key===ke)if(M.tag===4&&M.stateNode.containerInfo===G.containerInfo&&M.stateNode.implementation===G.implementation){o(L,M.sibling),ie=f(M,G.children||[]),ie.return=L,L=ie;break e}else{o(L,M);break}else i(L,M);M=M.sibling}ie=Np(G,L.mode,ie),ie.return=L,L=ie}return v(L);case N:return G=no(G),bt(L,M,G,ie)}if(Ne(G))return Te(L,M,G,ie);if(j(G)){if(ke=j(G),typeof ke!="function")throw Error(r(150));return G=ke.call(G),Pe(L,M,G,ie)}if(typeof G.then=="function")return bt(L,M,Bh(G),ie);if(G.$$typeof===te)return bt(L,M,Mh(L,G),ie);qh(L,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,M!==null&&M.tag===6?(o(L,M.sibling),ie=f(M,G),ie.return=L,L=ie):(o(L,M),ie=Ap(G,L.mode,ie),ie.return=L,L=ie),v(L)):o(L,M)}return function(L,M,G,ie){try{lu=0;var ke=bt(L,M,G,ie);return yl=null,ke}catch(Ae){if(Ae===gl||Ae===Uh)throw Ae;var rt=hr(29,Ae,null,L.mode);return rt.lanes=ie,rt.return=L,rt}}}var so=Wb(!0),Xb=Wb(!1),Oi=!1;function zp(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Bp(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Mi(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Li(n,i,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(ot&2)!==0){var f=c.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),c.pending=i,i=jh(n),Pb(n,null,o),i}return Dh(n,c,i,o),jh(n)}function uu(n,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var c=i.lanes;c&=n.pendingLanes,o|=c,i.lanes=o,Mc(n,o)}}function qp(n,i){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,p=null;if(o=o.firstBaseUpdate,o!==null){do{var v={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};p===null?f=p=v:p=p.next=v,o=o.next}while(o!==null);p===null?f=p=i:p=p.next=i}else f=p=i;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:p,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=i:n.next=i,o.lastBaseUpdate=i}var Fp=!1;function du(){if(Fp){var n=pl;if(n!==null)throw n}}function hu(n,i,o,c){Fp=!1;var f=n.updateQueue;Oi=!1;var p=f.firstBaseUpdate,v=f.lastBaseUpdate,I=f.shared.pending;if(I!==null){f.shared.pending=null;var P=I,Q=P.next;P.next=null,v===null?p=Q:v.next=Q,v=P;var re=n.alternate;re!==null&&(re=re.updateQueue,I=re.lastBaseUpdate,I!==v&&(I===null?re.firstBaseUpdate=Q:I.next=Q,re.lastBaseUpdate=P))}if(p!==null){var oe=f.baseState;v=0,re=Q=P=null,I=p;do{var Y=I.lane&-536870913,Z=Y!==I.lane;if(Z?(Xe&Y)===Y:(c&Y)===Y){Y!==0&&Y===ml&&(Fp=!0),re!==null&&(re=re.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var Te=n,Pe=I;Y=i;var bt=o;switch(Pe.tag){case 1:if(Te=Pe.payload,typeof Te=="function"){oe=Te.call(bt,oe,Y);break e}oe=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=Pe.payload,Y=typeof Te=="function"?Te.call(bt,oe,Y):Te,Y==null)break e;oe=x({},oe,Y);break e;case 2:Oi=!0}}Y=I.callback,Y!==null&&(n.flags|=64,Z&&(n.flags|=8192),Z=f.callbacks,Z===null?f.callbacks=[Y]:Z.push(Y))}else Z={lane:Y,tag:I.tag,payload:I.payload,callback:I.callback,next:null},re===null?(Q=re=Z,P=oe):re=re.next=Z,v|=Y;if(I=I.next,I===null){if(I=f.shared.pending,I===null)break;Z=I,I=Z.next,Z.next=null,f.lastBaseUpdate=Z,f.shared.pending=null}}while(!0);re===null&&(P=oe),f.baseState=P,f.firstBaseUpdate=Q,f.lastBaseUpdate=re,p===null&&(f.shared.lanes=0),Fi|=v,n.lanes=v,n.memoizedState=oe}}function Jb(n,i){if(typeof n!="function")throw Error(r(191,n));n.call(i)}function Zb(n,i){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)Jb(o[n],i)}var _l=O(null),Fh=O(0);function ev(n,i){n=ai,q(Fh,n),q(_l,i),ai=n|i.baseLanes}function Hp(){q(Fh,ai),q(_l,_l.current)}function Gp(){ai=Fh.current,ne(_l),ne(Fh)}var fr=O(null),jr=null;function Ui(n){var i=n.alternate;q(Qt,Qt.current&1),q(fr,n),jr===null&&(i===null||_l.current!==null||i.memoizedState!==null)&&(jr=n)}function Qp(n){q(Qt,Qt.current),q(fr,n),jr===null&&(jr=n)}function tv(n){n.tag===22?(q(Qt,Qt.current),q(fr,n),jr===null&&(jr=n)):zi()}function zi(){q(Qt,Qt.current),q(fr,fr.current)}function mr(n){ne(fr),jr===n&&(jr=null),ne(Qt)}var Qt=O(0);function Hh(n){for(var i=n;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Jg(o)||Zg(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Js=0,Be=null,yt=null,rn=null,Gh=!1,bl=!1,io=!1,Qh=0,fu=0,vl=null,HN=0;function Lt(){throw Error(r(321))}function Kp(n,i){if(i===null)return!1;for(var o=0;o<i.length&&o<n.length;o++)if(!dr(n[o],i[o]))return!1;return!0}function $p(n,i,o,c,f,p){return Js=p,Be=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,z.H=n===null||n.memoizedState===null?Lv:cg,io=!1,p=o(c,f),io=!1,bl&&(p=rv(i,o,c,f)),nv(n),p}function nv(n){z.H=gu;var i=yt!==null&&yt.next!==null;if(Js=0,rn=yt=Be=null,Gh=!1,fu=0,vl=null,i)throw Error(r(300));n===null||sn||(n=n.dependencies,n!==null&&Oh(n)&&(sn=!0))}function rv(n,i,o,c){Be=n;var f=0;do{if(bl&&(vl=null),fu=0,bl=!1,25<=f)throw Error(r(301));if(f+=1,rn=yt=null,n.updateQueue!=null){var p=n.updateQueue;p.lastEffect=null,p.events=null,p.stores=null,p.memoCache!=null&&(p.memoCache.index=0)}z.H=Uv,p=i(o,c)}while(bl);return p}function GN(){var n=z.H,i=n.useState()[0];return i=typeof i.then=="function"?mu(i):i,n=n.useState()[0],(yt!==null?yt.memoizedState:null)!==n&&(Be.flags|=1024),i}function Yp(){var n=Qh!==0;return Qh=0,n}function Wp(n,i,o){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~o}function Xp(n){if(Gh){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Gh=!1}Js=0,rn=yt=Be=null,bl=!1,fu=Qh=0,vl=null}function qn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rn===null?Be.memoizedState=rn=n:rn=rn.next=n,rn}function Kt(){if(yt===null){var n=Be.alternate;n=n!==null?n.memoizedState:null}else n=yt.next;var i=rn===null?Be.memoizedState:rn.next;if(i!==null)rn=i,yt=n;else{if(n===null)throw Be.alternate===null?Error(r(467)):Error(r(310));yt=n,n={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},rn===null?Be.memoizedState=rn=n:rn=rn.next=n}return rn}function Kh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function mu(n){var i=fu;return fu+=1,vl===null&&(vl=[]),n=Kb(vl,n,i),i=Be,(rn===null?i.memoizedState:rn.next)===null&&(i=i.alternate,z.H=i===null||i.memoizedState===null?Lv:cg),n}function $h(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return mu(n);if(n.$$typeof===te)return In(n)}throw Error(r(438,String(n)))}function Jp(n){var i=null,o=Be.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var c=Be.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(i={data:c.data.map(function(f){return f.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Kh(),Be.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(n),c=0;c<n;c++)o[c]=D;return i.index++,o}function Zs(n,i){return typeof i=="function"?i(n):i}function Yh(n){var i=Kt();return Zp(i,yt,n)}function Zp(n,i,o){var c=n.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=o;var f=n.baseQueue,p=c.pending;if(p!==null){if(f!==null){var v=f.next;f.next=p.next,p.next=v}i.baseQueue=f=p,c.pending=null}if(p=n.baseState,f===null)n.memoizedState=p;else{i=f.next;var I=v=null,P=null,Q=i,re=!1;do{var oe=Q.lane&-536870913;if(oe!==Q.lane?(Xe&oe)===oe:(Js&oe)===oe){var Y=Q.revertLane;if(Y===0)P!==null&&(P=P.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),oe===ml&&(re=!0);else if((Js&Y)===Y){Q=Q.next,Y===ml&&(re=!0);continue}else oe={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},P===null?(I=P=oe,v=p):P=P.next=oe,Be.lanes|=Y,Fi|=Y;oe=Q.action,io&&o(p,oe),p=Q.hasEagerState?Q.eagerState:o(p,oe)}else Y={lane:oe,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},P===null?(I=P=Y,v=p):P=P.next=Y,Be.lanes|=oe,Fi|=oe;Q=Q.next}while(Q!==null&&Q!==i);if(P===null?v=p:P.next=I,!dr(p,n.memoizedState)&&(sn=!0,re&&(o=pl,o!==null)))throw o;n.memoizedState=p,n.baseState=v,n.baseQueue=P,c.lastRenderedState=p}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function eg(n){var i=Kt(),o=i.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,p=i.memoizedState;if(f!==null){o.pending=null;var v=f=f.next;do p=n(p,v.action),v=v.next;while(v!==f);dr(p,i.memoizedState)||(sn=!0),i.memoizedState=p,i.baseQueue===null&&(i.baseState=p),o.lastRenderedState=p}return[p,c]}function sv(n,i,o){var c=Be,f=Kt(),p=et;if(p){if(o===void 0)throw Error(r(407));o=o()}else o=i();var v=!dr((yt||f).memoizedState,o);if(v&&(f.memoizedState=o,sn=!0),f=f.queue,rg(ov.bind(null,c,f,n),[n]),f.getSnapshot!==i||v||rn!==null&&rn.memoizedState.tag&1){if(c.flags|=2048,xl(9,{destroy:void 0},av.bind(null,c,f,o,i),null),vt===null)throw Error(r(349));p||(Js&127)!==0||iv(c,i,o)}return o}function iv(n,i,o){n.flags|=16384,n={getSnapshot:i,value:o},i=Be.updateQueue,i===null?(i=Kh(),Be.updateQueue=i,i.stores=[n]):(o=i.stores,o===null?i.stores=[n]:o.push(n))}function av(n,i,o,c){i.value=o,i.getSnapshot=c,lv(i)&&cv(n)}function ov(n,i,o){return o(function(){lv(i)&&cv(n)})}function lv(n){var i=n.getSnapshot;n=n.value;try{var o=i();return!dr(n,o)}catch{return!0}}function cv(n){var i=Wa(n,2);i!==null&&rr(i,n,2)}function tg(n){var i=qn();if(typeof n=="function"){var o=n;if(n=o(),io){Ve(!0);try{o()}finally{Ve(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:n},i}function uv(n,i,o,c){return n.baseState=o,Zp(n,yt,typeof c=="function"?c:Zs)}function QN(n,i,o,c,f){if(Jh(n))throw Error(r(485));if(n=i.action,n!==null){var p={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){p.listeners.push(v)}};z.T!==null?o(!0):p.isTransition=!1,c(p),o=i.pending,o===null?(p.next=i.pending=p,dv(i,p)):(p.next=o.next,i.pending=o.next=p)}}function dv(n,i){var o=i.action,c=i.payload,f=n.state;if(i.isTransition){var p=z.T,v={};z.T=v;try{var I=o(f,c),P=z.S;P!==null&&P(v,I),hv(n,i,I)}catch(Q){ng(n,i,Q)}finally{p!==null&&v.types!==null&&(p.types=v.types),z.T=p}}else try{p=o(f,c),hv(n,i,p)}catch(Q){ng(n,i,Q)}}function hv(n,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){fv(n,i,c)},function(c){return ng(n,i,c)}):fv(n,i,o)}function fv(n,i,o){i.status="fulfilled",i.value=o,mv(i),n.state=o,i=n.pending,i!==null&&(o=i.next,o===i?n.pending=null:(o=o.next,i.next=o,dv(n,o)))}function ng(n,i,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do i.status="rejected",i.reason=o,mv(i),i=i.next;while(i!==c)}n.action=null}function mv(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function pv(n,i){return i}function gv(n,i){if(et){var o=vt.formState;if(o!==null){e:{var c=Be;if(et){if(Tt){t:{for(var f=Tt,p=Dr;f.nodeType!==8;){if(!p){f=null;break t}if(f=Pr(f.nextSibling),f===null){f=null;break t}}p=f.data,f=p==="F!"||p==="F"?f:null}if(f){Tt=Pr(f.nextSibling),c=f.data==="F!";break e}}Pi(c)}c=!1}c&&(i=o[0])}}return o=qn(),o.memoizedState=o.baseState=i,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pv,lastRenderedState:i},o.queue=c,o=Vv.bind(null,Be,c),c.dispatch=o,c=tg(!1),p=lg.bind(null,Be,!1,c.queue),c=qn(),f={state:i,dispatch:null,action:n,pending:null},c.queue=f,o=QN.bind(null,Be,f,p,o),f.dispatch=o,c.memoizedState=n,[i,o,!1]}function yv(n){var i=Kt();return _v(i,yt,n)}function _v(n,i,o){if(i=Zp(n,i,pv)[0],n=Yh(Zs)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var c=mu(i)}catch(v){throw v===gl?Uh:v}else c=i;i=Kt();var f=i.queue,p=f.dispatch;return o!==i.memoizedState&&(Be.flags|=2048,xl(9,{destroy:void 0},KN.bind(null,f,o),null)),[c,p,n]}function KN(n,i){n.action=i}function bv(n){var i=Kt(),o=yt;if(o!==null)return _v(i,o,n);Kt(),i=i.memoizedState,o=Kt();var c=o.queue.dispatch;return o.memoizedState=n,[i,c,!1]}function xl(n,i,o,c){return n={tag:n,create:o,deps:c,inst:i,next:null},i=Be.updateQueue,i===null&&(i=Kh(),Be.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,i.lastEffect=n),n}function vv(){return Kt().memoizedState}function Wh(n,i,o,c){var f=qn();Be.flags|=n,f.memoizedState=xl(1|i,{destroy:void 0},o,c===void 0?null:c)}function Xh(n,i,o,c){var f=Kt();c=c===void 0?null:c;var p=f.memoizedState.inst;yt!==null&&c!==null&&Kp(c,yt.memoizedState.deps)?f.memoizedState=xl(i,p,o,c):(Be.flags|=n,f.memoizedState=xl(1|i,p,o,c))}function xv(n,i){Wh(8390656,8,n,i)}function rg(n,i){Xh(2048,8,n,i)}function $N(n){Be.flags|=4;var i=Be.updateQueue;if(i===null)i=Kh(),Be.updateQueue=i,i.events=[n];else{var o=i.events;o===null?i.events=[n]:o.push(n)}}function wv(n){var i=Kt().memoizedState;return $N({ref:i,nextImpl:n}),function(){if((ot&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function Ev(n,i){return Xh(4,2,n,i)}function Tv(n,i){return Xh(4,4,n,i)}function Iv(n,i){if(typeof i=="function"){n=n();var o=i(n);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Sv(n,i,o){o=o!=null?o.concat([n]):null,Xh(4,4,Iv.bind(null,i,n),o)}function sg(){}function Av(n,i){var o=Kt();i=i===void 0?null:i;var c=o.memoizedState;return i!==null&&Kp(i,c[1])?c[0]:(o.memoizedState=[n,i],n)}function Nv(n,i){var o=Kt();i=i===void 0?null:i;var c=o.memoizedState;if(i!==null&&Kp(i,c[1]))return c[0];if(c=n(),io){Ve(!0);try{n()}finally{Ve(!1)}}return o.memoizedState=[c,i],c}function ig(n,i,o){return o===void 0||(Js&1073741824)!==0&&(Xe&261930)===0?n.memoizedState=i:(n.memoizedState=o,n=Rx(),Be.lanes|=n,Fi|=n,o)}function Rv(n,i,o,c){return dr(o,i)?o:_l.current!==null?(n=ig(n,o,c),dr(n,i)||(sn=!0),n):(Js&42)===0||(Js&1073741824)!==0&&(Xe&261930)===0?(sn=!0,n.memoizedState=o):(n=Rx(),Be.lanes|=n,Fi|=n,i)}function Cv(n,i,o,c,f){var p=me.p;me.p=p!==0&&8>p?p:8;var v=z.T,I={};z.T=I,lg(n,!1,i,o);try{var P=f(),Q=z.S;if(Q!==null&&Q(I,P),P!==null&&typeof P=="object"&&typeof P.then=="function"){var re=FN(P,c);pu(n,i,re,yr(n))}else pu(n,i,c,yr(n))}catch(oe){pu(n,i,{then:function(){},status:"rejected",reason:oe},yr())}finally{me.p=p,v!==null&&I.types!==null&&(v.types=I.types),z.T=v}}function YN(){}function ag(n,i,o,c){if(n.tag!==5)throw Error(r(476));var f=kv(n).queue;Cv(n,f,i,Ee,o===null?YN:function(){return Dv(n),o(c)})}function kv(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:Ee,baseState:Ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:Ee},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:o},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function Dv(n){var i=kv(n);i.next===null&&(i=n.alternate.memoizedState),pu(n,i.next.queue,{},yr())}function og(){return In(Du)}function jv(){return Kt().memoizedState}function Pv(){return Kt().memoizedState}function WN(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var o=yr();n=Mi(o);var c=Li(i,n,o);c!==null&&(rr(c,i,o),uu(c,i,o)),i={cache:Op()},n.payload=i;return}i=i.return}}function XN(n,i,o){var c=yr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Jh(n)?Ov(i,o):(o=Ip(n,i,o,c),o!==null&&(rr(o,n,c),Mv(o,i,c)))}function Vv(n,i,o){var c=yr();pu(n,i,o,c)}function pu(n,i,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Jh(n))Ov(i,f);else{var p=n.alternate;if(n.lanes===0&&(p===null||p.lanes===0)&&(p=i.lastRenderedReducer,p!==null))try{var v=i.lastRenderedState,I=p(v,o);if(f.hasEagerState=!0,f.eagerState=I,dr(I,v))return Dh(n,i,f,0),vt===null&&kh(),!1}catch{}if(o=Ip(n,i,f,c),o!==null)return rr(o,n,c),Mv(o,i,c),!0}return!1}function lg(n,i,o,c){if(c={lane:2,revertLane:zg(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Jh(n)){if(i)throw Error(r(479))}else i=Ip(n,o,c,2),i!==null&&rr(i,n,2)}function Jh(n){var i=n.alternate;return n===Be||i!==null&&i===Be}function Ov(n,i){bl=Gh=!0;var o=n.pending;o===null?i.next=i:(i.next=o.next,o.next=i),n.pending=i}function Mv(n,i,o){if((o&4194048)!==0){var c=i.lanes;c&=n.pendingLanes,o|=c,i.lanes=o,Mc(n,o)}}var gu={readContext:In,use:$h,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useLayoutEffect:Lt,useInsertionEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useSyncExternalStore:Lt,useId:Lt,useHostTransitionStatus:Lt,useFormState:Lt,useActionState:Lt,useOptimistic:Lt,useMemoCache:Lt,useCacheRefresh:Lt};gu.useEffectEvent=Lt;var Lv={readContext:In,use:$h,useCallback:function(n,i){return qn().memoizedState=[n,i===void 0?null:i],n},useContext:In,useEffect:xv,useImperativeHandle:function(n,i,o){o=o!=null?o.concat([n]):null,Wh(4194308,4,Iv.bind(null,i,n),o)},useLayoutEffect:function(n,i){return Wh(4194308,4,n,i)},useInsertionEffect:function(n,i){Wh(4,2,n,i)},useMemo:function(n,i){var o=qn();i=i===void 0?null:i;var c=n();if(io){Ve(!0);try{n()}finally{Ve(!1)}}return o.memoizedState=[c,i],c},useReducer:function(n,i,o){var c=qn();if(o!==void 0){var f=o(i);if(io){Ve(!0);try{o(i)}finally{Ve(!1)}}}else f=i;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=XN.bind(null,Be,n),[c.memoizedState,n]},useRef:function(n){var i=qn();return n={current:n},i.memoizedState=n},useState:function(n){n=tg(n);var i=n.queue,o=Vv.bind(null,Be,i);return i.dispatch=o,[n.memoizedState,o]},useDebugValue:sg,useDeferredValue:function(n,i){var o=qn();return ig(o,n,i)},useTransition:function(){var n=tg(!1);return n=Cv.bind(null,Be,n.queue,!0,!1),qn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,o){var c=Be,f=qn();if(et){if(o===void 0)throw Error(r(407));o=o()}else{if(o=i(),vt===null)throw Error(r(349));(Xe&127)!==0||iv(c,i,o)}f.memoizedState=o;var p={value:o,getSnapshot:i};return f.queue=p,xv(ov.bind(null,c,p,n),[n]),c.flags|=2048,xl(9,{destroy:void 0},av.bind(null,c,p,o,i),null),o},useId:function(){var n=qn(),i=vt.identifierPrefix;if(et){var o=Ts,c=Es;o=(c&~(1<<32-Ge(c)-1)).toString(32)+o,i="_"+i+"R_"+o,o=Qh++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=HN++,i="_"+i+"r_"+o.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:og,useFormState:gv,useActionState:gv,useOptimistic:function(n){var i=qn();i.memoizedState=i.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=lg.bind(null,Be,!0,o),o.dispatch=i,[n,i]},useMemoCache:Jp,useCacheRefresh:function(){return qn().memoizedState=WN.bind(null,Be)},useEffectEvent:function(n){var i=qn(),o={impl:n};return i.memoizedState=o,function(){if((ot&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}},cg={readContext:In,use:$h,useCallback:Av,useContext:In,useEffect:rg,useImperativeHandle:Sv,useInsertionEffect:Ev,useLayoutEffect:Tv,useMemo:Nv,useReducer:Yh,useRef:vv,useState:function(){return Yh(Zs)},useDebugValue:sg,useDeferredValue:function(n,i){var o=Kt();return Rv(o,yt.memoizedState,n,i)},useTransition:function(){var n=Yh(Zs)[0],i=Kt().memoizedState;return[typeof n=="boolean"?n:mu(n),i]},useSyncExternalStore:sv,useId:jv,useHostTransitionStatus:og,useFormState:yv,useActionState:yv,useOptimistic:function(n,i){var o=Kt();return uv(o,yt,n,i)},useMemoCache:Jp,useCacheRefresh:Pv};cg.useEffectEvent=wv;var Uv={readContext:In,use:$h,useCallback:Av,useContext:In,useEffect:rg,useImperativeHandle:Sv,useInsertionEffect:Ev,useLayoutEffect:Tv,useMemo:Nv,useReducer:eg,useRef:vv,useState:function(){return eg(Zs)},useDebugValue:sg,useDeferredValue:function(n,i){var o=Kt();return yt===null?ig(o,n,i):Rv(o,yt.memoizedState,n,i)},useTransition:function(){var n=eg(Zs)[0],i=Kt().memoizedState;return[typeof n=="boolean"?n:mu(n),i]},useSyncExternalStore:sv,useId:jv,useHostTransitionStatus:og,useFormState:bv,useActionState:bv,useOptimistic:function(n,i){var o=Kt();return yt!==null?uv(o,yt,n,i):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:Jp,useCacheRefresh:Pv};Uv.useEffectEvent=wv;function ug(n,i,o,c){i=n.memoizedState,o=o(c,i),o=o==null?i:x({},i,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var dg={enqueueSetState:function(n,i,o){n=n._reactInternals;var c=yr(),f=Mi(c);f.payload=i,o!=null&&(f.callback=o),i=Li(n,f,c),i!==null&&(rr(i,n,c),uu(i,n,c))},enqueueReplaceState:function(n,i,o){n=n._reactInternals;var c=yr(),f=Mi(c);f.tag=1,f.payload=i,o!=null&&(f.callback=o),i=Li(n,f,c),i!==null&&(rr(i,n,c),uu(i,n,c))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var o=yr(),c=Mi(o);c.tag=2,i!=null&&(c.callback=i),i=Li(n,c,o),i!==null&&(rr(i,n,o),uu(i,n,o))}};function zv(n,i,o,c,f,p,v){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,p,v):i.prototype&&i.prototype.isPureReactComponent?!nu(o,c)||!nu(f,p):!0}function Bv(n,i,o,c){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,c),i.state!==n&&dg.enqueueReplaceState(i,i.state,null)}function ao(n,i){var o=i;if("ref"in i){o={};for(var c in i)c!=="ref"&&(o[c]=i[c])}if(n=n.defaultProps){o===i&&(o=x({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function qv(n){Ch(n)}function Fv(n){}function Hv(n){Ch(n)}function Zh(n,i){try{var o=n.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(c){setTimeout(function(){throw c})}}function Gv(n,i,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function hg(n,i,o){return o=Mi(o),o.tag=3,o.payload={element:null},o.callback=function(){Zh(n,i)},o}function Qv(n){return n=Mi(n),n.tag=3,n}function Kv(n,i,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var p=c.value;n.payload=function(){return f(p)},n.callback=function(){Gv(i,o,c)}}var v=o.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(n.callback=function(){Gv(i,o,c),typeof f!="function"&&(Hi===null?Hi=new Set([this]):Hi.add(this));var I=c.stack;this.componentDidCatch(c.value,{componentStack:I!==null?I:""})})}function JN(n,i,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(i=o.alternate,i!==null&&fl(i,o,f,!0),o=fr.current,o!==null){switch(o.tag){case 31:case 13:return jr===null?hf():o.alternate===null&&Ut===0&&(Ut=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===zh?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([c]):i.add(c),Mg(n,c,f)),!1;case 22:return o.flags|=65536,c===zh?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([c]):o.add(c)),Mg(n,c,f)),!1}throw Error(r(435,o.tag))}return Mg(n,c,f),hf(),!1}if(et)return i=fr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=f,c!==kp&&(n=Error(r(422),{cause:c}),iu(Rr(n,o)))):(c!==kp&&(i=Error(r(423),{cause:c}),iu(Rr(i,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Rr(c,o),f=hg(n.stateNode,c,f),qp(n,f),Ut!==4&&(Ut=2)),!1;var p=Error(r(520),{cause:c});if(p=Rr(p,o),Tu===null?Tu=[p]:Tu.push(p),Ut!==4&&(Ut=2),i===null)return!0;c=Rr(c,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=hg(o.stateNode,c,n),qp(o,n),!1;case 1:if(i=o.type,p=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(Hi===null||!Hi.has(p))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Qv(f),Kv(f,n,o,c),qp(o,f),!1}o=o.return}while(o!==null);return!1}var fg=Error(r(461)),sn=!1;function Sn(n,i,o,c){i.child=n===null?Xb(i,null,o,c):so(i,n.child,o,c)}function $v(n,i,o,c,f){o=o.render;var p=i.ref;if("ref"in c){var v={};for(var I in c)I!=="ref"&&(v[I]=c[I])}else v=c;return eo(i),c=$p(n,i,o,v,p,f),I=Yp(),n!==null&&!sn?(Wp(n,i,f),ei(n,i,f)):(et&&I&&Rp(i),i.flags|=1,Sn(n,i,c,f),i.child)}function Yv(n,i,o,c,f){if(n===null){var p=o.type;return typeof p=="function"&&!Sp(p)&&p.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=p,Wv(n,i,p,c,f)):(n=Ph(o.type,null,c,i,i.mode,f),n.ref=i.ref,n.return=i,i.child=n)}if(p=n.child,!xg(n,f)){var v=p.memoizedProps;if(o=o.compare,o=o!==null?o:nu,o(v,c)&&n.ref===i.ref)return ei(n,i,f)}return i.flags|=1,n=$s(p,c),n.ref=i.ref,n.return=i,i.child=n}function Wv(n,i,o,c,f){if(n!==null){var p=n.memoizedProps;if(nu(p,c)&&n.ref===i.ref)if(sn=!1,i.pendingProps=c=p,xg(n,f))(n.flags&131072)!==0&&(sn=!0);else return i.lanes=n.lanes,ei(n,i,f)}return mg(n,i,o,c,f)}function Xv(n,i,o,c){var f=c.children,p=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((i.flags&128)!==0){if(p=p!==null?p.baseLanes|o:o,n!==null){for(c=i.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~p}else c=0,i.child=null;return Jv(n,i,p,o,c)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&Lh(i,p!==null?p.cachePool:null),p!==null?ev(i,p):Hp(),tv(i);else return c=i.lanes=536870912,Jv(n,i,p!==null?p.baseLanes|o:o,o,c)}else p!==null?(Lh(i,p.cachePool),ev(i,p),zi(),i.memoizedState=null):(n!==null&&Lh(i,null),Hp(),zi());return Sn(n,i,f,o),i.child}function yu(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Jv(n,i,o,c,f){var p=Lp();return p=p===null?null:{parent:nn._currentValue,pool:p},i.memoizedState={baseLanes:o,cachePool:p},n!==null&&Lh(i,null),Hp(),tv(i),n!==null&&fl(n,i,c,!0),i.childLanes=f,null}function ef(n,i){return i=nf({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function Zv(n,i,o){return so(i,n.child,null,o),n=ef(i,i.pendingProps),n.flags|=2,mr(i),i.memoizedState=null,n}function ZN(n,i,o){var c=i.pendingProps,f=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(et){if(c.mode==="hidden")return n=ef(i,c),i.lanes=536870912,yu(null,n);if(Qp(i),(n=Tt)?(n=dw(n,Dr),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Di!==null?{id:Es,overflow:Ts}:null,retryLane:536870912,hydrationErrors:null},o=Ob(n),o.return=i,i.child=o,Tn=i,Tt=null)):n=null,n===null)throw Pi(i);return i.lanes=536870912,null}return ef(i,c)}var p=n.memoizedState;if(p!==null){var v=p.dehydrated;if(Qp(i),f)if(i.flags&256)i.flags&=-257,i=Zv(n,i,o);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(r(558));else if(sn||fl(n,i,o,!1),f=(o&n.childLanes)!==0,sn||f){if(c=vt,c!==null&&(v=Lc(c,o),v!==0&&v!==p.retryLane))throw p.retryLane=v,Wa(n,v),rr(c,n,v),fg;hf(),i=Zv(n,i,o)}else n=p.treeContext,Tt=Pr(v.nextSibling),Tn=i,et=!0,ji=null,Dr=!1,n!==null&&Ub(i,n),i=ef(i,c),i.flags|=4096;return i}return n=$s(n.child,{mode:c.mode,children:c.children}),n.ref=i.ref,i.child=n,n.return=i,n}function tf(n,i){var o=i.ref;if(o===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(n===null||n.ref!==o)&&(i.flags|=4194816)}}function mg(n,i,o,c,f){return eo(i),o=$p(n,i,o,c,void 0,f),c=Yp(),n!==null&&!sn?(Wp(n,i,f),ei(n,i,f)):(et&&c&&Rp(i),i.flags|=1,Sn(n,i,o,f),i.child)}function ex(n,i,o,c,f,p){return eo(i),i.updateQueue=null,o=rv(i,c,o,f),nv(n),c=Yp(),n!==null&&!sn?(Wp(n,i,p),ei(n,i,p)):(et&&c&&Rp(i),i.flags|=1,Sn(n,i,o,p),i.child)}function tx(n,i,o,c,f){if(eo(i),i.stateNode===null){var p=cl,v=o.contextType;typeof v=="object"&&v!==null&&(p=In(v)),p=new o(c,p),i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=dg,i.stateNode=p,p._reactInternals=i,p=i.stateNode,p.props=c,p.state=i.memoizedState,p.refs={},zp(i),v=o.contextType,p.context=typeof v=="object"&&v!==null?In(v):cl,p.state=i.memoizedState,v=o.getDerivedStateFromProps,typeof v=="function"&&(ug(i,o,v,c),p.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(v=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),v!==p.state&&dg.enqueueReplaceState(p,p.state,null),hu(i,c,p,f),du(),p.state=i.memoizedState),typeof p.componentDidMount=="function"&&(i.flags|=4194308),c=!0}else if(n===null){p=i.stateNode;var I=i.memoizedProps,P=ao(o,I);p.props=P;var Q=p.context,re=o.contextType;v=cl,typeof re=="object"&&re!==null&&(v=In(re));var oe=o.getDerivedStateFromProps;re=typeof oe=="function"||typeof p.getSnapshotBeforeUpdate=="function",I=i.pendingProps!==I,re||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(I||Q!==v)&&Bv(i,p,c,v),Oi=!1;var Y=i.memoizedState;p.state=Y,hu(i,c,p,f),du(),Q=i.memoizedState,I||Y!==Q||Oi?(typeof oe=="function"&&(ug(i,o,oe,c),Q=i.memoizedState),(P=Oi||zv(i,o,P,c,Y,Q,v))?(re||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount()),typeof p.componentDidMount=="function"&&(i.flags|=4194308)):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=Q),p.props=c,p.state=Q,p.context=v,c=P):(typeof p.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{p=i.stateNode,Bp(n,i),v=i.memoizedProps,re=ao(o,v),p.props=re,oe=i.pendingProps,Y=p.context,Q=o.contextType,P=cl,typeof Q=="object"&&Q!==null&&(P=In(Q)),I=o.getDerivedStateFromProps,(Q=typeof I=="function"||typeof p.getSnapshotBeforeUpdate=="function")||typeof p.UNSAFE_componentWillReceiveProps!="function"&&typeof p.componentWillReceiveProps!="function"||(v!==oe||Y!==P)&&Bv(i,p,c,P),Oi=!1,Y=i.memoizedState,p.state=Y,hu(i,c,p,f),du();var Z=i.memoizedState;v!==oe||Y!==Z||Oi||n!==null&&n.dependencies!==null&&Oh(n.dependencies)?(typeof I=="function"&&(ug(i,o,I,c),Z=i.memoizedState),(re=Oi||zv(i,o,re,c,Y,Z,P)||n!==null&&n.dependencies!==null&&Oh(n.dependencies))?(Q||typeof p.UNSAFE_componentWillUpdate!="function"&&typeof p.componentWillUpdate!="function"||(typeof p.componentWillUpdate=="function"&&p.componentWillUpdate(c,Z,P),typeof p.UNSAFE_componentWillUpdate=="function"&&p.UNSAFE_componentWillUpdate(c,Z,P)),typeof p.componentDidUpdate=="function"&&(i.flags|=4),typeof p.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof p.componentDidUpdate!="function"||v===n.memoizedProps&&Y===n.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&Y===n.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=Z),p.props=c,p.state=Z,p.context=P,c=re):(typeof p.componentDidUpdate!="function"||v===n.memoizedProps&&Y===n.memoizedState||(i.flags|=4),typeof p.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&Y===n.memoizedState||(i.flags|=1024),c=!1)}return p=c,tf(n,i),c=(i.flags&128)!==0,p||c?(p=i.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:p.render(),i.flags|=1,n!==null&&c?(i.child=so(i,n.child,null,f),i.child=so(i,null,o,f)):Sn(n,i,o,f),i.memoizedState=p.state,n=i.child):n=ei(n,i,f),n}function nx(n,i,o,c){return Ja(),i.flags|=256,Sn(n,i,o,c),i.child}var pg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function gg(n){return{baseLanes:n,cachePool:Gb()}}function yg(n,i,o){return n=n!==null?n.childLanes&~o:0,i&&(n|=gr),n}function rx(n,i,o){var c=i.pendingProps,f=!1,p=(i.flags&128)!==0,v;if((v=p)||(v=n!==null&&n.memoizedState===null?!1:(Qt.current&2)!==0),v&&(f=!0,i.flags&=-129),v=(i.flags&32)!==0,i.flags&=-33,n===null){if(et){if(f?Ui(i):zi(),(n=Tt)?(n=dw(n,Dr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Di!==null?{id:Es,overflow:Ts}:null,retryLane:536870912,hydrationErrors:null},o=Ob(n),o.return=i,i.child=o,Tn=i,Tt=null)):n=null,n===null)throw Pi(i);return Zg(n)?i.lanes=32:i.lanes=536870912,null}var I=c.children;return c=c.fallback,f?(zi(),f=i.mode,I=nf({mode:"hidden",children:I},f),c=Xa(c,f,o,null),I.return=i,c.return=i,I.sibling=c,i.child=I,c=i.child,c.memoizedState=gg(o),c.childLanes=yg(n,v,o),i.memoizedState=pg,yu(null,c)):(Ui(i),_g(i,I))}var P=n.memoizedState;if(P!==null&&(I=P.dehydrated,I!==null)){if(p)i.flags&256?(Ui(i),i.flags&=-257,i=bg(n,i,o)):i.memoizedState!==null?(zi(),i.child=n.child,i.flags|=128,i=null):(zi(),I=c.fallback,f=i.mode,c=nf({mode:"visible",children:c.children},f),I=Xa(I,f,o,null),I.flags|=2,c.return=i,I.return=i,c.sibling=I,i.child=c,so(i,n.child,null,o),c=i.child,c.memoizedState=gg(o),c.childLanes=yg(n,v,o),i.memoizedState=pg,i=yu(null,c));else if(Ui(i),Zg(I)){if(v=I.nextSibling&&I.nextSibling.dataset,v)var Q=v.dgst;v=Q,c=Error(r(419)),c.stack="",c.digest=v,iu({value:c,source:null,stack:null}),i=bg(n,i,o)}else if(sn||fl(n,i,o,!1),v=(o&n.childLanes)!==0,sn||v){if(v=vt,v!==null&&(c=Lc(v,o),c!==0&&c!==P.retryLane))throw P.retryLane=c,Wa(n,c),rr(v,n,c),fg;Jg(I)||hf(),i=bg(n,i,o)}else Jg(I)?(i.flags|=192,i.child=n.child,i=null):(n=P.treeContext,Tt=Pr(I.nextSibling),Tn=i,et=!0,ji=null,Dr=!1,n!==null&&Ub(i,n),i=_g(i,c.children),i.flags|=4096);return i}return f?(zi(),I=c.fallback,f=i.mode,P=n.child,Q=P.sibling,c=$s(P,{mode:"hidden",children:c.children}),c.subtreeFlags=P.subtreeFlags&65011712,Q!==null?I=$s(Q,I):(I=Xa(I,f,o,null),I.flags|=2),I.return=i,c.return=i,c.sibling=I,i.child=c,yu(null,c),c=i.child,I=n.child.memoizedState,I===null?I=gg(o):(f=I.cachePool,f!==null?(P=nn._currentValue,f=f.parent!==P?{parent:P,pool:P}:f):f=Gb(),I={baseLanes:I.baseLanes|o,cachePool:f}),c.memoizedState=I,c.childLanes=yg(n,v,o),i.memoizedState=pg,yu(n.child,c)):(Ui(i),o=n.child,n=o.sibling,o=$s(o,{mode:"visible",children:c.children}),o.return=i,o.sibling=null,n!==null&&(v=i.deletions,v===null?(i.deletions=[n],i.flags|=16):v.push(n)),i.child=o,i.memoizedState=null,o)}function _g(n,i){return i=nf({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function nf(n,i){return n=hr(22,n,null,i),n.lanes=0,n}function bg(n,i,o){return so(i,n.child,null,o),n=_g(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function sx(n,i,o){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i),Pp(n.return,i,o)}function vg(n,i,o,c,f,p){var v=n.memoizedState;v===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:p}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=o,v.tailMode=f,v.treeForkCount=p)}function ix(n,i,o){var c=i.pendingProps,f=c.revealOrder,p=c.tail;c=c.children;var v=Qt.current,I=(v&2)!==0;if(I?(v=v&1|2,i.flags|=128):v&=1,q(Qt,v),Sn(n,i,c,o),c=et?su:0,!I&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&sx(n,o,i);else if(n.tag===19)sx(n,o,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=i.child,f=null;o!==null;)n=o.alternate,n!==null&&Hh(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=i.child,i.child=null):(f=o.sibling,o.sibling=null),vg(i,!1,f,o,p,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=i.child,i.child=null;f!==null;){if(n=f.alternate,n!==null&&Hh(n)===null){i.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}vg(i,!0,o,null,p,c);break;case"together":vg(i,!1,null,null,void 0,c);break;default:i.memoizedState=null}return i.child}function ei(n,i,o){if(n!==null&&(i.dependencies=n.dependencies),Fi|=i.lanes,(o&i.childLanes)===0)if(n!==null){if(fl(n,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,o=$s(n,n.pendingProps),i.child=o,o.return=i;n.sibling!==null;)n=n.sibling,o=o.sibling=$s(n,n.pendingProps),o.return=i;o.sibling=null}return i.child}function xg(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&Oh(n)))}function eR(n,i,o){switch(i.tag){case 3:Ce(i,i.stateNode.containerInfo),Vi(i,nn,n.memoizedState.cache),Ja();break;case 27:case 5:lr(i);break;case 4:Ce(i,i.stateNode.containerInfo);break;case 10:Vi(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Qp(i),null;break;case 13:var c=i.memoizedState;if(c!==null)return c.dehydrated!==null?(Ui(i),i.flags|=128,null):(o&i.child.childLanes)!==0?rx(n,i,o):(Ui(i),n=ei(n,i,o),n!==null?n.sibling:null);Ui(i);break;case 19:var f=(n.flags&128)!==0;if(c=(o&i.childLanes)!==0,c||(fl(n,i,o,!1),c=(o&i.childLanes)!==0),f){if(c)return ix(n,i,o);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),q(Qt,Qt.current),c)break;return null;case 22:return i.lanes=0,Xv(n,i,o,i.pendingProps);case 24:Vi(i,nn,n.memoizedState.cache)}return ei(n,i,o)}function ax(n,i,o){if(n!==null)if(n.memoizedProps!==i.pendingProps)sn=!0;else{if(!xg(n,o)&&(i.flags&128)===0)return sn=!1,eR(n,i,o);sn=(n.flags&131072)!==0}else sn=!1,et&&(i.flags&1048576)!==0&&Lb(i,su,i.index);switch(i.lanes=0,i.tag){case 16:e:{var c=i.pendingProps;if(n=no(i.elementType),i.type=n,typeof n=="function")Sp(n)?(c=ao(n,c),i.tag=1,i=tx(null,i,n,c,o)):(i.tag=0,i=mg(null,i,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===be){i.tag=11,i=$v(null,i,n,c,o);break e}else if(f===C){i.tag=14,i=Yv(null,i,n,c,o);break e}}throw i=_e(n)||n,Error(r(306,i,""))}}return i;case 0:return mg(n,i,i.type,i.pendingProps,o);case 1:return c=i.type,f=ao(c,i.pendingProps),tx(n,i,c,f,o);case 3:e:{if(Ce(i,i.stateNode.containerInfo),n===null)throw Error(r(387));c=i.pendingProps;var p=i.memoizedState;f=p.element,Bp(n,i),hu(i,c,null,o);var v=i.memoizedState;if(c=v.cache,Vi(i,nn,c),c!==p.cache&&Vp(i,[nn],o,!0),du(),c=v.element,p.isDehydrated)if(p={element:c,isDehydrated:!1,cache:v.cache},i.updateQueue.baseState=p,i.memoizedState=p,i.flags&256){i=nx(n,i,c,o);break e}else if(c!==f){f=Rr(Error(r(424)),i),iu(f),i=nx(n,i,c,o);break e}else for(n=i.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Tt=Pr(n.firstChild),Tn=i,et=!0,ji=null,Dr=!0,o=Xb(i,null,c,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ja(),c===f){i=ei(n,i,o);break e}Sn(n,i,c,o)}i=i.child}return i;case 26:return tf(n,i),n===null?(o=yw(i.type,null,i.pendingProps,null))?i.memoizedState=o:et||(o=i.type,n=i.pendingProps,c=bf(de.current).createElement(o),c[Zt]=i,c[pn]=n,An(c,o,n),en(c),i.stateNode=c):i.memoizedState=yw(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return lr(i),n===null&&et&&(c=i.stateNode=mw(i.type,i.pendingProps,de.current),Tn=i,Dr=!0,f=Tt,$i(i.type)?(e0=f,Tt=Pr(c.firstChild)):Tt=f),Sn(n,i,i.pendingProps.children,o),tf(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&et&&((f=c=Tt)&&(c=CR(c,i.type,i.pendingProps,Dr),c!==null?(i.stateNode=c,Tn=i,Tt=Pr(c.firstChild),Dr=!1,f=!0):f=!1),f||Pi(i)),lr(i),f=i.type,p=i.pendingProps,v=n!==null?n.memoizedProps:null,c=p.children,Yg(f,p)?c=null:v!==null&&Yg(f,v)&&(i.flags|=32),i.memoizedState!==null&&(f=$p(n,i,GN,null,null,o),Du._currentValue=f),tf(n,i),Sn(n,i,c,o),i.child;case 6:return n===null&&et&&((n=o=Tt)&&(o=kR(o,i.pendingProps,Dr),o!==null?(i.stateNode=o,Tn=i,Tt=null,n=!0):n=!1),n||Pi(i)),null;case 13:return rx(n,i,o);case 4:return Ce(i,i.stateNode.containerInfo),c=i.pendingProps,n===null?i.child=so(i,null,c,o):Sn(n,i,c,o),i.child;case 11:return $v(n,i,i.type,i.pendingProps,o);case 7:return Sn(n,i,i.pendingProps,o),i.child;case 8:return Sn(n,i,i.pendingProps.children,o),i.child;case 12:return Sn(n,i,i.pendingProps.children,o),i.child;case 10:return c=i.pendingProps,Vi(i,i.type,c.value),Sn(n,i,c.children,o),i.child;case 9:return f=i.type._context,c=i.pendingProps.children,eo(i),f=In(f),c=c(f),i.flags|=1,Sn(n,i,c,o),i.child;case 14:return Yv(n,i,i.type,i.pendingProps,o);case 15:return Wv(n,i,i.type,i.pendingProps,o);case 19:return ix(n,i,o);case 31:return ZN(n,i,o);case 22:return Xv(n,i,o,i.pendingProps);case 24:return eo(i),c=In(nn),n===null?(f=Lp(),f===null&&(f=vt,p=Op(),f.pooledCache=p,p.refCount++,p!==null&&(f.pooledCacheLanes|=o),f=p),i.memoizedState={parent:c,cache:f},zp(i),Vi(i,nn,f)):((n.lanes&o)!==0&&(Bp(n,i),hu(i,null,null,o),du()),f=n.memoizedState,p=i.memoizedState,f.parent!==c?(f={parent:c,cache:c},i.memoizedState=f,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=f),Vi(i,nn,c)):(c=p.cache,Vi(i,nn,c),c!==f.cache&&Vp(i,[nn],o,!0))),Sn(n,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function ti(n){n.flags|=4}function wg(n,i,o,c,f){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(jx())n.flags|=8192;else throw ro=zh,Up}else n.flags&=-16777217}function ox(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!ww(i))if(jx())n.flags|=8192;else throw ro=zh,Up}function rf(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?ch():536870912,n.lanes|=i,Il|=i)}function _u(n,i){if(!et)switch(n.tailMode){case"hidden":i=n.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function It(n){var i=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(i)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,i}function tR(n,i,o){var c=i.pendingProps;switch(Cp(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return It(i),null;case 1:return It(i),null;case 3:return o=i.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Xs(nn),nt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(hl(i)?ti(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Dp())),It(i),null;case 26:var f=i.type,p=i.memoizedState;return n===null?(ti(i),p!==null?(It(i),ox(i,p)):(It(i),wg(i,f,null,c,o))):p?p!==n.memoizedState?(ti(i),It(i),ox(i,p)):(It(i),i.flags&=-16777217):(n=n.memoizedProps,n!==c&&ti(i),It(i),wg(i,f,n,c,o)),null;case 27:if(Ht(i),o=de.current,f=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==c&&ti(i);else{if(!c){if(i.stateNode===null)throw Error(r(166));return It(i),null}n=K.current,hl(i)?zb(i):(n=mw(f,c,o),i.stateNode=n,ti(i))}return It(i),null;case 5:if(Ht(i),f=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==c&&ti(i);else{if(!c){if(i.stateNode===null)throw Error(r(166));return It(i),null}if(p=K.current,hl(i))zb(i);else{var v=bf(de.current);switch(p){case 1:p=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:p=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":p=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":p=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":p=v.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof c.is=="string"?v.createElement("select",{is:c.is}):v.createElement("select"),c.multiple?p.multiple=!0:c.size&&(p.size=c.size);break;default:p=typeof c.is=="string"?v.createElement(f,{is:c.is}):v.createElement(f)}}p[Zt]=i,p[pn]=c;e:for(v=i.child;v!==null;){if(v.tag===5||v.tag===6)p.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===i)break e;for(;v.sibling===null;){if(v.return===null||v.return===i)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}i.stateNode=p;e:switch(An(p,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ti(i)}}return It(i),wg(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,o),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==c&&ti(i);else{if(typeof c!="string"&&i.stateNode===null)throw Error(r(166));if(n=de.current,hl(i)){if(n=i.stateNode,o=i.memoizedProps,c=null,f=Tn,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[Zt]=i,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||rw(n.nodeValue,o)),n||Pi(i,!0)}else n=bf(n).createTextNode(c),n[Zt]=i,i.stateNode=n}return It(i),null;case 31:if(o=i.memoizedState,n===null||n.memoizedState!==null){if(c=hl(i),o!==null){if(n===null){if(!c)throw Error(r(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(557));n[Zt]=i}else Ja(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;It(i),n=!1}else o=Dp(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return i.flags&256?(mr(i),i):(mr(i),null);if((i.flags&128)!==0)throw Error(r(558))}return It(i),null;case 13:if(c=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=hl(i),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(r(318));if(f=i.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));f[Zt]=i}else Ja(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;It(i),f=!1}else f=Dp(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return i.flags&256?(mr(i),i):(mr(i),null)}return mr(i),(i.flags&128)!==0?(i.lanes=o,i):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=i.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),p=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(p=c.memoizedState.cachePool.pool),p!==f&&(c.flags|=2048)),o!==n&&o&&(i.child.flags|=8192),rf(i,i.updateQueue),It(i),null);case 4:return nt(),n===null&&Hg(i.stateNode.containerInfo),It(i),null;case 10:return Xs(i.type),It(i),null;case 19:if(ne(Qt),c=i.memoizedState,c===null)return It(i),null;if(f=(i.flags&128)!==0,p=c.rendering,p===null)if(f)_u(c,!1);else{if(Ut!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(p=Hh(n),p!==null){for(i.flags|=128,_u(c,!1),n=p.updateQueue,i.updateQueue=n,rf(i,n),i.subtreeFlags=0,n=o,o=i.child;o!==null;)Vb(o,n),o=o.sibling;return q(Qt,Qt.current&1|2),et&&Ys(i,c.treeForkCount),i.child}n=n.sibling}c.tail!==null&&Fe()>cf&&(i.flags|=128,f=!0,_u(c,!1),i.lanes=4194304)}else{if(!f)if(n=Hh(p),n!==null){if(i.flags|=128,f=!0,n=n.updateQueue,i.updateQueue=n,rf(i,n),_u(c,!0),c.tail===null&&c.tailMode==="hidden"&&!p.alternate&&!et)return It(i),null}else 2*Fe()-c.renderingStartTime>cf&&o!==536870912&&(i.flags|=128,f=!0,_u(c,!1),i.lanes=4194304);c.isBackwards?(p.sibling=i.child,i.child=p):(n=c.last,n!==null?n.sibling=p:i.child=p,c.last=p)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=Fe(),n.sibling=null,o=Qt.current,q(Qt,f?o&1|2:o&1),et&&Ys(i,c.treeForkCount),n):(It(i),null);case 22:case 23:return mr(i),Gp(),c=i.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(i.flags|=8192):c&&(i.flags|=8192),c?(o&536870912)!==0&&(i.flags&128)===0&&(It(i),i.subtreeFlags&6&&(i.flags|=8192)):It(i),o=i.updateQueue,o!==null&&rf(i,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),c!==o&&(i.flags|=2048),n!==null&&ne(to),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Xs(nn),It(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function nR(n,i){switch(Cp(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Xs(nn),nt(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return Ht(i),null;case 31:if(i.memoizedState!==null){if(mr(i),i.alternate===null)throw Error(r(340));Ja()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(mr(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Ja()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return ne(Qt),null;case 4:return nt(),null;case 10:return Xs(i.type),null;case 22:case 23:return mr(i),Gp(),n!==null&&ne(to),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Xs(nn),null;case 25:return null;default:return null}}function lx(n,i){switch(Cp(i),i.tag){case 3:Xs(nn),nt();break;case 26:case 27:case 5:Ht(i);break;case 4:nt();break;case 31:i.memoizedState!==null&&mr(i);break;case 13:mr(i);break;case 19:ne(Qt);break;case 10:Xs(i.type);break;case 22:case 23:mr(i),Gp(),n!==null&&ne(to);break;case 24:Xs(nn)}}function bu(n,i){try{var o=i.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var p=o.create,v=o.inst;c=p(),v.destroy=c}o=o.next}while(o!==f)}}catch(I){ht(i,i.return,I)}}function Bi(n,i,o){try{var c=i.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var p=f.next;c=p;do{if((c.tag&n)===n){var v=c.inst,I=v.destroy;if(I!==void 0){v.destroy=void 0,f=i;var P=o,Q=I;try{Q()}catch(re){ht(f,P,re)}}}c=c.next}while(c!==p)}}catch(re){ht(i,i.return,re)}}function cx(n){var i=n.updateQueue;if(i!==null){var o=n.stateNode;try{Zb(i,o)}catch(c){ht(n,n.return,c)}}}function ux(n,i,o){o.props=ao(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){ht(n,i,c)}}function vu(n,i){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){ht(n,i,f)}}function Is(n,i){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){ht(n,i,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){ht(n,i,f)}else o.current=null}function dx(n){var i=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){ht(n,n.return,f)}}function Eg(n,i,o){try{var c=n.stateNode;TR(c,n.type,o,i),c[pn]=i}catch(f){ht(n,n.return,f)}}function hx(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&$i(n.type)||n.tag===4}function Tg(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||hx(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&$i(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Ig(n,i,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(n),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Hr));else if(c!==4&&(c===27&&$i(n.type)&&(o=n.stateNode,i=null),n=n.child,n!==null))for(Ig(n,i,o),n=n.sibling;n!==null;)Ig(n,i,o),n=n.sibling}function sf(n,i,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?o.insertBefore(n,i):o.appendChild(n);else if(c!==4&&(c===27&&$i(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(sf(n,i,o),n=n.sibling;n!==null;)sf(n,i,o),n=n.sibling}function fx(n){var i=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);An(i,c,o),i[Zt]=n,i[pn]=o}catch(p){ht(n,n.return,p)}}var ni=!1,an=!1,Sg=!1,mx=typeof WeakSet=="function"?WeakSet:Set,yn=null;function rR(n,i){if(n=n.containerInfo,Kg=Sf,n=Sb(n),bp(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,p=c.focusNode;c=c.focusOffset;try{o.nodeType,p.nodeType}catch{o=null;break e}var v=0,I=-1,P=-1,Q=0,re=0,oe=n,Y=null;t:for(;;){for(var Z;oe!==o||f!==0&&oe.nodeType!==3||(I=v+f),oe!==p||c!==0&&oe.nodeType!==3||(P=v+c),oe.nodeType===3&&(v+=oe.nodeValue.length),(Z=oe.firstChild)!==null;)Y=oe,oe=Z;for(;;){if(oe===n)break t;if(Y===o&&++Q===f&&(I=v),Y===p&&++re===c&&(P=v),(Z=oe.nextSibling)!==null)break;oe=Y,Y=oe.parentNode}oe=Z}o=I===-1||P===-1?null:{start:I,end:P}}else o=null}o=o||{start:0,end:0}}else o=null;for($g={focusedElem:n,selectionRange:o},Sf=!1,yn=i;yn!==null;)if(i=yn,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,yn=n;else for(;yn!==null;){switch(i=yn,p=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&p!==null){n=void 0,o=i,f=p.memoizedProps,p=p.memoizedState,c=o.stateNode;try{var Te=ao(o.type,f);n=c.getSnapshotBeforeUpdate(Te,p),c.__reactInternalSnapshotBeforeUpdate=n}catch(Pe){ht(o,o.return,Pe)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,o=n.nodeType,o===9)Xg(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Xg(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=i.sibling,n!==null){n.return=i.return,yn=n;break}yn=i.return}}function px(n,i,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:si(n,o),c&4&&bu(5,o);break;case 1:if(si(n,o),c&4)if(n=o.stateNode,i===null)try{n.componentDidMount()}catch(v){ht(o,o.return,v)}else{var f=ao(o.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(f,i,n.__reactInternalSnapshotBeforeUpdate)}catch(v){ht(o,o.return,v)}}c&64&&cx(o),c&512&&vu(o,o.return);break;case 3:if(si(n,o),c&64&&(n=o.updateQueue,n!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{Zb(n,i)}catch(v){ht(o,o.return,v)}}break;case 27:i===null&&c&4&&fx(o);case 26:case 5:si(n,o),i===null&&c&4&&dx(o),c&512&&vu(o,o.return);break;case 12:si(n,o);break;case 31:si(n,o),c&4&&_x(n,o);break;case 13:si(n,o),c&4&&bx(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=hR.bind(null,o),DR(n,o))));break;case 22:if(c=o.memoizedState!==null||ni,!c){i=i!==null&&i.memoizedState!==null||an,f=ni;var p=an;ni=c,(an=i)&&!p?ii(n,o,(o.subtreeFlags&8772)!==0):si(n,o),ni=f,an=p}break;case 30:break;default:si(n,o)}}function gx(n){var i=n.alternate;i!==null&&(n.alternate=null,gx(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Yo(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Nt=null,Zn=!1;function ri(n,i,o){for(o=o.child;o!==null;)yx(n,i,o),o=o.sibling}function yx(n,i,o){if(xe&&typeof xe.onCommitFiberUnmount=="function")try{xe.onCommitFiberUnmount(zn,o)}catch{}switch(o.tag){case 26:an||Is(o,i),ri(n,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:an||Is(o,i);var c=Nt,f=Zn;$i(o.type)&&(Nt=o.stateNode,Zn=!1),ri(n,i,o),Ru(o.stateNode),Nt=c,Zn=f;break;case 5:an||Is(o,i);case 6:if(c=Nt,f=Zn,Nt=null,ri(n,i,o),Nt=c,Zn=f,Nt!==null)if(Zn)try{(Nt.nodeType===9?Nt.body:Nt.nodeName==="HTML"?Nt.ownerDocument.body:Nt).removeChild(o.stateNode)}catch(p){ht(o,i,p)}else try{Nt.removeChild(o.stateNode)}catch(p){ht(o,i,p)}break;case 18:Nt!==null&&(Zn?(n=Nt,cw(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),jl(n)):cw(Nt,o.stateNode));break;case 4:c=Nt,f=Zn,Nt=o.stateNode.containerInfo,Zn=!0,ri(n,i,o),Nt=c,Zn=f;break;case 0:case 11:case 14:case 15:Bi(2,o,i),an||Bi(4,o,i),ri(n,i,o);break;case 1:an||(Is(o,i),c=o.stateNode,typeof c.componentWillUnmount=="function"&&ux(o,i,c)),ri(n,i,o);break;case 21:ri(n,i,o);break;case 22:an=(c=an)||o.memoizedState!==null,ri(n,i,o),an=c;break;default:ri(n,i,o)}}function _x(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{jl(n)}catch(o){ht(i,i.return,o)}}}function bx(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{jl(n)}catch(o){ht(i,i.return,o)}}function sR(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new mx),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new mx),i;default:throw Error(r(435,n.tag))}}function af(n,i){var o=sR(n);i.forEach(function(c){if(!o.has(c)){o.add(c);var f=fR.bind(null,n,c);c.then(f,f)}})}function er(n,i){var o=i.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],p=n,v=i,I=v;e:for(;I!==null;){switch(I.tag){case 27:if($i(I.type)){Nt=I.stateNode,Zn=!1;break e}break;case 5:Nt=I.stateNode,Zn=!1;break e;case 3:case 4:Nt=I.stateNode.containerInfo,Zn=!0;break e}I=I.return}if(Nt===null)throw Error(r(160));yx(p,v,f),Nt=null,Zn=!1,p=f.alternate,p!==null&&(p.return=null),f.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)vx(i,n),i=i.sibling}var Wr=null;function vx(n,i){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:er(i,n),tr(n),c&4&&(Bi(3,n,n.return),bu(3,n),Bi(5,n,n.return));break;case 1:er(i,n),tr(n),c&512&&(an||o===null||Is(o,o.return)),c&64&&ni&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=Wr;if(er(i,n),tr(n),c&512&&(an||o===null||Is(o,o.return)),c&4){var p=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":p=f.getElementsByTagName("title")[0],(!p||p[ds]||p[Zt]||p.namespaceURI==="http://www.w3.org/2000/svg"||p.hasAttribute("itemprop"))&&(p=f.createElement(c),f.head.insertBefore(p,f.querySelector("head > title"))),An(p,c,o),p[Zt]=n,en(p),c=p;break e;case"link":var v=vw("link","href",f).get(c+(o.href||""));if(v){for(var I=0;I<v.length;I++)if(p=v[I],p.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&p.getAttribute("rel")===(o.rel==null?null:o.rel)&&p.getAttribute("title")===(o.title==null?null:o.title)&&p.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){v.splice(I,1);break t}}p=f.createElement(c),An(p,c,o),f.head.appendChild(p);break;case"meta":if(v=vw("meta","content",f).get(c+(o.content||""))){for(I=0;I<v.length;I++)if(p=v[I],p.getAttribute("content")===(o.content==null?null:""+o.content)&&p.getAttribute("name")===(o.name==null?null:o.name)&&p.getAttribute("property")===(o.property==null?null:o.property)&&p.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&p.getAttribute("charset")===(o.charSet==null?null:o.charSet)){v.splice(I,1);break t}}p=f.createElement(c),An(p,c,o),f.head.appendChild(p);break;default:throw Error(r(468,c))}p[Zt]=n,en(p),c=p}n.stateNode=c}else xw(f,n.type,n.stateNode);else n.stateNode=bw(f,c,n.memoizedProps);else p!==c?(p===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):p.count--,c===null?xw(f,n.type,n.stateNode):bw(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Eg(n,n.memoizedProps,o.memoizedProps)}break;case 27:er(i,n),tr(n),c&512&&(an||o===null||Is(o,o.return)),o!==null&&c&4&&Eg(n,n.memoizedProps,o.memoizedProps);break;case 5:if(er(i,n),tr(n),c&512&&(an||o===null||Is(o,o.return)),n.flags&32){f=n.stateNode;try{Jn(f,"")}catch(Te){ht(n,n.return,Te)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Eg(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Sg=!0);break;case 6:if(er(i,n),tr(n),c&4){if(n.stateNode===null)throw Error(r(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(Te){ht(n,n.return,Te)}}break;case 3:if(wf=null,f=Wr,Wr=vf(i.containerInfo),er(i,n),Wr=f,tr(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{jl(i.containerInfo)}catch(Te){ht(n,n.return,Te)}Sg&&(Sg=!1,xx(n));break;case 4:c=Wr,Wr=vf(n.stateNode.containerInfo),er(i,n),tr(n),Wr=c;break;case 12:er(i,n),tr(n);break;case 31:er(i,n),tr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,af(n,c)));break;case 13:er(i,n),tr(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(lf=Fe()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,af(n,c)));break;case 22:f=n.memoizedState!==null;var P=o!==null&&o.memoizedState!==null,Q=ni,re=an;if(ni=Q||f,an=re||P,er(i,n),an=re,ni=Q,tr(n),c&8192)e:for(i=n.stateNode,i._visibility=f?i._visibility&-2:i._visibility|1,f&&(o===null||P||ni||an||oo(n)),o=null,i=n;;){if(i.tag===5||i.tag===26){if(o===null){P=o=i;try{if(p=P.stateNode,f)v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{I=P.stateNode;var oe=P.memoizedProps.style,Y=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;I.style.display=Y==null||typeof Y=="boolean"?"":(""+Y).trim()}}catch(Te){ht(P,P.return,Te)}}}else if(i.tag===6){if(o===null){P=i;try{P.stateNode.nodeValue=f?"":P.memoizedProps}catch(Te){ht(P,P.return,Te)}}}else if(i.tag===18){if(o===null){P=i;try{var Z=P.stateNode;f?uw(Z,!0):uw(P.stateNode,!1)}catch(Te){ht(P,P.return,Te)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,af(n,o))));break;case 19:er(i,n),tr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,af(n,c)));break;case 30:break;case 21:break;default:er(i,n),tr(n)}}function tr(n){var i=n.flags;if(i&2){try{for(var o,c=n.return;c!==null;){if(hx(c)){o=c;break}c=c.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var f=o.stateNode,p=Tg(n);sf(n,p,f);break;case 5:var v=o.stateNode;o.flags&32&&(Jn(v,""),o.flags&=-33);var I=Tg(n);sf(n,I,v);break;case 3:case 4:var P=o.stateNode.containerInfo,Q=Tg(n);Ig(n,Q,P);break;default:throw Error(r(161))}}catch(re){ht(n,n.return,re)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function xx(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;xx(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function si(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)px(n,i.alternate,i),i=i.sibling}function oo(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:Bi(4,i,i.return),oo(i);break;case 1:Is(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&ux(i,i.return,o),oo(i);break;case 27:Ru(i.stateNode);case 26:case 5:Is(i,i.return),oo(i);break;case 22:i.memoizedState===null&&oo(i);break;case 30:oo(i);break;default:oo(i)}n=n.sibling}}function ii(n,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var c=i.alternate,f=n,p=i,v=p.flags;switch(p.tag){case 0:case 11:case 15:ii(f,p,o),bu(4,p);break;case 1:if(ii(f,p,o),c=p,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Q){ht(c,c.return,Q)}if(c=p,f=c.updateQueue,f!==null){var I=c.stateNode;try{var P=f.shared.hiddenCallbacks;if(P!==null)for(f.shared.hiddenCallbacks=null,f=0;f<P.length;f++)Jb(P[f],I)}catch(Q){ht(c,c.return,Q)}}o&&v&64&&cx(p),vu(p,p.return);break;case 27:fx(p);case 26:case 5:ii(f,p,o),o&&c===null&&v&4&&dx(p),vu(p,p.return);break;case 12:ii(f,p,o);break;case 31:ii(f,p,o),o&&v&4&&_x(f,p);break;case 13:ii(f,p,o),o&&v&4&&bx(f,p);break;case 22:p.memoizedState===null&&ii(f,p,o),vu(p,p.return);break;case 30:break;default:ii(f,p,o)}i=i.sibling}}function Ag(n,i){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&au(o))}function Ng(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&au(n))}function Xr(n,i,o,c){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)wx(n,i,o,c),i=i.sibling}function wx(n,i,o,c){var f=i.flags;switch(i.tag){case 0:case 11:case 15:Xr(n,i,o,c),f&2048&&bu(9,i);break;case 1:Xr(n,i,o,c);break;case 3:Xr(n,i,o,c),f&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&au(n)));break;case 12:if(f&2048){Xr(n,i,o,c),n=i.stateNode;try{var p=i.memoizedProps,v=p.id,I=p.onPostCommit;typeof I=="function"&&I(v,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(P){ht(i,i.return,P)}}else Xr(n,i,o,c);break;case 31:Xr(n,i,o,c);break;case 13:Xr(n,i,o,c);break;case 23:break;case 22:p=i.stateNode,v=i.alternate,i.memoizedState!==null?p._visibility&2?Xr(n,i,o,c):xu(n,i):p._visibility&2?Xr(n,i,o,c):(p._visibility|=2,wl(n,i,o,c,(i.subtreeFlags&10256)!==0||!1)),f&2048&&Ag(v,i);break;case 24:Xr(n,i,o,c),f&2048&&Ng(i.alternate,i);break;default:Xr(n,i,o,c)}}function wl(n,i,o,c,f){for(f=f&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var p=n,v=i,I=o,P=c,Q=v.flags;switch(v.tag){case 0:case 11:case 15:wl(p,v,I,P,f),bu(8,v);break;case 23:break;case 22:var re=v.stateNode;v.memoizedState!==null?re._visibility&2?wl(p,v,I,P,f):xu(p,v):(re._visibility|=2,wl(p,v,I,P,f)),f&&Q&2048&&Ag(v.alternate,v);break;case 24:wl(p,v,I,P,f),f&&Q&2048&&Ng(v.alternate,v);break;default:wl(p,v,I,P,f)}i=i.sibling}}function xu(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=n,c=i,f=c.flags;switch(c.tag){case 22:xu(o,c),f&2048&&Ag(c.alternate,c);break;case 24:xu(o,c),f&2048&&Ng(c.alternate,c);break;default:xu(o,c)}i=i.sibling}}var wu=8192;function El(n,i,o){if(n.subtreeFlags&wu)for(n=n.child;n!==null;)Ex(n,i,o),n=n.sibling}function Ex(n,i,o){switch(n.tag){case 26:El(n,i,o),n.flags&wu&&n.memoizedState!==null&&HR(o,Wr,n.memoizedState,n.memoizedProps);break;case 5:El(n,i,o);break;case 3:case 4:var c=Wr;Wr=vf(n.stateNode.containerInfo),El(n,i,o),Wr=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=wu,wu=16777216,El(n,i,o),wu=c):El(n,i,o));break;default:El(n,i,o)}}function Tx(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Eu(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var c=i[o];yn=c,Sx(c,n)}Tx(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Ix(n),n=n.sibling}function Ix(n){switch(n.tag){case 0:case 11:case 15:Eu(n),n.flags&2048&&Bi(9,n,n.return);break;case 3:Eu(n);break;case 12:Eu(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,of(n)):Eu(n);break;default:Eu(n)}}function of(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var c=i[o];yn=c,Sx(c,n)}Tx(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:Bi(8,i,i.return),of(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,of(i));break;default:of(i)}n=n.sibling}}function Sx(n,i){for(;yn!==null;){var o=yn;switch(o.tag){case 0:case 11:case 15:Bi(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:au(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,yn=c;else e:for(o=n;yn!==null;){c=yn;var f=c.sibling,p=c.return;if(gx(c),c===o){yn=null;break e}if(f!==null){f.return=p,yn=f;break e}yn=p}}}var iR={getCacheForType:function(n){var i=In(nn),o=i.data.get(n);return o===void 0&&(o=n(),i.data.set(n,o)),o},cacheSignal:function(){return In(nn).controller.signal}},aR=typeof WeakMap=="function"?WeakMap:Map,ot=0,vt=null,Qe=null,Xe=0,dt=0,pr=null,qi=!1,Tl=!1,Rg=!1,ai=0,Ut=0,Fi=0,lo=0,Cg=0,gr=0,Il=0,Tu=null,nr=null,kg=!1,lf=0,Ax=0,cf=1/0,uf=null,Hi=null,dn=0,Gi=null,Sl=null,oi=0,Dg=0,jg=null,Nx=null,Iu=0,Pg=null;function yr(){return(ot&2)!==0&&Xe!==0?Xe&-Xe:z.T!==null?zg():uh()}function Rx(){if(gr===0)if((Xe&536870912)===0||et){var n=Va;Va<<=1,(Va&3932160)===0&&(Va=262144),gr=n}else gr=536870912;return n=fr.current,n!==null&&(n.flags|=32),gr}function rr(n,i,o){(n===vt&&(dt===2||dt===9)||n.cancelPendingCommit!==null)&&(Al(n,0),Qi(n,Xe,gr,!1)),Oa(n,o),((ot&2)===0||n!==vt)&&(n===vt&&((ot&2)===0&&(lo|=o),Ut===4&&Qi(n,Xe,gr,!1)),Ss(n))}function Cx(n,i,o){if((ot&6)!==0)throw Error(r(327));var c=!o&&(i&127)===0&&(i&n.expiredLanes)===0||Br(n,i),f=c?cR(n,i):Og(n,i,!0),p=c;do{if(f===0){Tl&&!c&&Qi(n,i,0,!1);break}else{if(o=n.current.alternate,p&&!oR(o)){f=Og(n,i,!1),p=!1;continue}if(f===2){if(p=i,n.errorRecoveryDisabledLanes&p)var v=0;else v=n.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){i=v;e:{var I=n;f=Tu;var P=I.current.memoizedState.isDehydrated;if(P&&(Al(I,v).flags|=256),v=Og(I,v,!1),v!==2){if(Rg&&!P){I.errorRecoveryDisabledLanes|=p,lo|=p,f=4;break e}p=nr,nr=f,p!==null&&(nr===null?nr=p:nr.push.apply(nr,p))}f=v}if(p=!1,f!==2)continue}}if(f===1){Al(n,0),Qi(n,i,0,!0);break}e:{switch(c=n,p=f,p){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:Qi(c,i,gr,!qi);break e;case 2:nr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(f=lf+300-Fe(),10<f)){if(Qi(c,i,gr,!qi),ls(c,0,!0)!==0)break e;oi=i,c.timeoutHandle=ow(kx.bind(null,c,o,nr,uf,kg,i,gr,lo,Il,qi,p,"Throttled",-0,0),f);break e}kx(c,o,nr,uf,kg,i,gr,lo,Il,qi,p,null,-0,0)}}break}while(!0);Ss(n)}function kx(n,i,o,c,f,p,v,I,P,Q,re,oe,Y,Z){if(n.timeoutHandle=-1,oe=i.subtreeFlags,oe&8192||(oe&16785408)===16785408){oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Hr},Ex(i,p,oe);var Te=(p&62914560)===p?lf-Fe():(p&4194048)===p?Ax-Fe():0;if(Te=GR(oe,Te),Te!==null){oi=p,n.cancelPendingCommit=Te(Ux.bind(null,n,i,p,o,c,f,v,I,P,re,oe,null,Y,Z)),Qi(n,p,v,!Q);return}}Ux(n,i,p,o,c,f,v,I,P)}function oR(n){for(var i=n;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],p=f.getSnapshot;f=f.value;try{if(!dr(p(),f))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Qi(n,i,o,c){i&=~Cg,i&=~lo,n.suspendedLanes|=i,n.pingedLanes&=~i,c&&(n.warmLanes|=i),c=n.expirationTimes;for(var f=i;0<f;){var p=31-Ge(f),v=1<<p;c[p]=-1,f&=~v}o!==0&&Ma(n,o,i)}function df(){return(ot&6)===0?(Su(0),!1):!0}function Vg(){if(Qe!==null){if(dt===0)var n=Qe.return;else n=Qe,Ws=Za=null,Xp(n),yl=null,lu=0,n=Qe;for(;n!==null;)lx(n.alternate,n),n=n.return;Qe=null}}function Al(n,i){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,AR(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),oi=0,Vg(),vt=n,Qe=o=$s(n.current,null),Xe=i,dt=0,pr=null,qi=!1,Tl=Br(n,i),Rg=!1,Il=gr=Cg=lo=Fi=Ut=0,nr=Tu=null,kg=!1,(i&8)!==0&&(i|=i&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=i;0<c;){var f=31-Ge(c),p=1<<f;i|=n[f],c&=~p}return ai=i,kh(),o}function Dx(n,i){Be=null,z.H=gu,i===gl||i===Uh?(i=$b(),dt=3):i===Up?(i=$b(),dt=4):dt=i===fg?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,pr=i,Qe===null&&(Ut=1,Zh(n,Rr(i,n.current)))}function jx(){var n=fr.current;return n===null?!0:(Xe&4194048)===Xe?jr===null:(Xe&62914560)===Xe||(Xe&536870912)!==0?n===jr:!1}function Px(){var n=z.H;return z.H=gu,n===null?gu:n}function Vx(){var n=z.A;return z.A=iR,n}function hf(){Ut=4,qi||(Xe&4194048)!==Xe&&fr.current!==null||(Tl=!0),(Fi&134217727)===0&&(lo&134217727)===0||vt===null||Qi(vt,Xe,gr,!1)}function Og(n,i,o){var c=ot;ot|=2;var f=Px(),p=Vx();(vt!==n||Xe!==i)&&(uf=null,Al(n,i)),i=!1;var v=Ut;e:do try{if(dt!==0&&Qe!==null){var I=Qe,P=pr;switch(dt){case 8:Vg(),v=6;break e;case 3:case 2:case 9:case 6:fr.current===null&&(i=!0);var Q=dt;if(dt=0,pr=null,Nl(n,I,P,Q),o&&Tl){v=0;break e}break;default:Q=dt,dt=0,pr=null,Nl(n,I,P,Q)}}lR(),v=Ut;break}catch(re){Dx(n,re)}while(!0);return i&&n.shellSuspendCounter++,Ws=Za=null,ot=c,z.H=f,z.A=p,Qe===null&&(vt=null,Xe=0,kh()),v}function lR(){for(;Qe!==null;)Ox(Qe)}function cR(n,i){var o=ot;ot|=2;var c=Px(),f=Vx();vt!==n||Xe!==i?(uf=null,cf=Fe()+500,Al(n,i)):Tl=Br(n,i);e:do try{if(dt!==0&&Qe!==null){i=Qe;var p=pr;t:switch(dt){case 1:dt=0,pr=null,Nl(n,i,p,1);break;case 2:case 9:if(Qb(p)){dt=0,pr=null,Mx(i);break}i=function(){dt!==2&&dt!==9||vt!==n||(dt=7),Ss(n)},p.then(i,i);break e;case 3:dt=7;break e;case 4:dt=5;break e;case 7:Qb(p)?(dt=0,pr=null,Mx(i)):(dt=0,pr=null,Nl(n,i,p,7));break;case 5:var v=null;switch(Qe.tag){case 26:v=Qe.memoizedState;case 5:case 27:var I=Qe;if(v?ww(v):I.stateNode.complete){dt=0,pr=null;var P=I.sibling;if(P!==null)Qe=P;else{var Q=I.return;Q!==null?(Qe=Q,ff(Q)):Qe=null}break t}}dt=0,pr=null,Nl(n,i,p,5);break;case 6:dt=0,pr=null,Nl(n,i,p,6);break;case 8:Vg(),Ut=6;break e;default:throw Error(r(462))}}uR();break}catch(re){Dx(n,re)}while(!0);return Ws=Za=null,z.H=c,z.A=f,ot=o,Qe!==null?0:(vt=null,Xe=0,kh(),Ut)}function uR(){for(;Qe!==null&&!W();)Ox(Qe)}function Ox(n){var i=ax(n.alternate,n,ai);n.memoizedProps=n.pendingProps,i===null?ff(n):Qe=i}function Mx(n){var i=n,o=i.alternate;switch(i.tag){case 15:case 0:i=ex(o,i,i.pendingProps,i.type,void 0,Xe);break;case 11:i=ex(o,i,i.pendingProps,i.type.render,i.ref,Xe);break;case 5:Xp(i);default:lx(o,i),i=Qe=Vb(i,ai),i=ax(o,i,ai)}n.memoizedProps=n.pendingProps,i===null?ff(n):Qe=i}function Nl(n,i,o,c){Ws=Za=null,Xp(i),yl=null,lu=0;var f=i.return;try{if(JN(n,f,i,o,Xe)){Ut=1,Zh(n,Rr(o,n.current)),Qe=null;return}}catch(p){if(f!==null)throw Qe=f,p;Ut=1,Zh(n,Rr(o,n.current)),Qe=null;return}i.flags&32768?(et||c===1?n=!0:Tl||(Xe&536870912)!==0?n=!1:(qi=n=!0,(c===2||c===9||c===3||c===6)&&(c=fr.current,c!==null&&c.tag===13&&(c.flags|=16384))),Lx(i,n)):ff(i)}function ff(n){var i=n;do{if((i.flags&32768)!==0){Lx(i,qi);return}n=i.return;var o=tR(i.alternate,i,ai);if(o!==null){Qe=o;return}if(i=i.sibling,i!==null){Qe=i;return}Qe=i=n}while(i!==null);Ut===0&&(Ut=5)}function Lx(n,i){do{var o=nR(n.alternate,n);if(o!==null){o.flags&=32767,Qe=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(n=n.sibling,n!==null)){Qe=n;return}Qe=n=o}while(n!==null);Ut=6,Qe=null}function Ux(n,i,o,c,f,p,v,I,P){n.cancelPendingCommit=null;do mf();while(dn!==0);if((ot&6)!==0)throw Error(r(327));if(i!==null){if(i===n.current)throw Error(r(177));if(p=i.lanes|i.childLanes,p|=Tp,pp(n,o,p,v,I,P),n===vt&&(Qe=vt=null,Xe=0),Sl=i,Gi=n,oi=o,Dg=p,jg=f,Nx=c,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,mR(Xt,function(){return Hx(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||c){c=z.T,z.T=null,f=me.p,me.p=2,v=ot,ot|=4;try{rR(n,i,o)}finally{ot=v,me.p=f,z.T=c}}dn=1,zx(),Bx(),qx()}}function zx(){if(dn===1){dn=0;var n=Gi,i=Sl,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=z.T,z.T=null;var c=me.p;me.p=2;var f=ot;ot|=4;try{vx(i,n);var p=$g,v=Sb(n.containerInfo),I=p.focusedElem,P=p.selectionRange;if(v!==I&&I&&I.ownerDocument&&Ib(I.ownerDocument.documentElement,I)){if(P!==null&&bp(I)){var Q=P.start,re=P.end;if(re===void 0&&(re=Q),"selectionStart"in I)I.selectionStart=Q,I.selectionEnd=Math.min(re,I.value.length);else{var oe=I.ownerDocument||document,Y=oe&&oe.defaultView||window;if(Y.getSelection){var Z=Y.getSelection(),Te=I.textContent.length,Pe=Math.min(P.start,Te),bt=P.end===void 0?Pe:Math.min(P.end,Te);!Z.extend&&Pe>bt&&(v=bt,bt=Pe,Pe=v);var L=Tb(I,Pe),M=Tb(I,bt);if(L&&M&&(Z.rangeCount!==1||Z.anchorNode!==L.node||Z.anchorOffset!==L.offset||Z.focusNode!==M.node||Z.focusOffset!==M.offset)){var G=oe.createRange();G.setStart(L.node,L.offset),Z.removeAllRanges(),Pe>bt?(Z.addRange(G),Z.extend(M.node,M.offset)):(G.setEnd(M.node,M.offset),Z.addRange(G))}}}}for(oe=[],Z=I;Z=Z.parentNode;)Z.nodeType===1&&oe.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<oe.length;I++){var ie=oe[I];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}Sf=!!Kg,$g=Kg=null}finally{ot=f,me.p=c,z.T=o}}n.current=i,dn=2}}function Bx(){if(dn===2){dn=0;var n=Gi,i=Sl,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=z.T,z.T=null;var c=me.p;me.p=2;var f=ot;ot|=4;try{px(n,i.alternate,i)}finally{ot=f,me.p=c,z.T=o}}dn=3}}function qx(){if(dn===4||dn===3){dn=0,Se();var n=Gi,i=Sl,o=oi,c=Nx;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?dn=5:(dn=0,Sl=Gi=null,Fx(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Hi=null),Hs(o),i=i.stateNode,xe&&typeof xe.onCommitFiberRoot=="function")try{xe.onCommitFiberRoot(zn,i,void 0,(i.current.flags&128)===128)}catch{}if(c!==null){i=z.T,f=me.p,me.p=2,z.T=null;try{for(var p=n.onRecoverableError,v=0;v<c.length;v++){var I=c[v];p(I.value,{componentStack:I.stack})}}finally{z.T=i,me.p=f}}(oi&3)!==0&&mf(),Ss(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Pg?Iu++:(Iu=0,Pg=n):Iu=0,Su(0)}}function Fx(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,au(i)))}function mf(){return zx(),Bx(),qx(),Hx()}function Hx(){if(dn!==5)return!1;var n=Gi,i=Dg;Dg=0;var o=Hs(oi),c=z.T,f=me.p;try{me.p=32>o?32:o,z.T=null,o=jg,jg=null;var p=Gi,v=oi;if(dn=0,Sl=Gi=null,oi=0,(ot&6)!==0)throw Error(r(331));var I=ot;if(ot|=4,Ix(p.current),wx(p,p.current,v,o),ot=I,Su(0,!1),xe&&typeof xe.onPostCommitFiberRoot=="function")try{xe.onPostCommitFiberRoot(zn,p)}catch{}return!0}finally{me.p=f,z.T=c,Fx(n,i)}}function Gx(n,i,o){i=Rr(o,i),i=hg(n.stateNode,i,2),n=Li(n,i,2),n!==null&&(Oa(n,2),Ss(n))}function ht(n,i,o){if(n.tag===3)Gx(n,n,o);else for(;i!==null;){if(i.tag===3){Gx(i,n,o);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Hi===null||!Hi.has(c))){n=Rr(o,n),o=Qv(2),c=Li(i,o,2),c!==null&&(Kv(o,c,i,n),Oa(c,2),Ss(c));break}}i=i.return}}function Mg(n,i,o){var c=n.pingCache;if(c===null){c=n.pingCache=new aR;var f=new Set;c.set(i,f)}else f=c.get(i),f===void 0&&(f=new Set,c.set(i,f));f.has(o)||(Rg=!0,f.add(o),n=dR.bind(null,n,i,o),i.then(n,n))}function dR(n,i,o){var c=n.pingCache;c!==null&&c.delete(i),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,vt===n&&(Xe&o)===o&&(Ut===4||Ut===3&&(Xe&62914560)===Xe&&300>Fe()-lf?(ot&2)===0&&Al(n,0):Cg|=o,Il===Xe&&(Il=0)),Ss(n)}function Qx(n,i){i===0&&(i=ch()),n=Wa(n,i),n!==null&&(Oa(n,i),Ss(n))}function hR(n){var i=n.memoizedState,o=0;i!==null&&(o=i.retryLane),Qx(n,o)}function fR(n,i){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(i),Qx(n,o)}function mR(n,i){return Et(n,i)}var pf=null,Rl=null,Lg=!1,gf=!1,Ug=!1,Ki=0;function Ss(n){n!==Rl&&n.next===null&&(Rl===null?pf=Rl=n:Rl=Rl.next=n),gf=!0,Lg||(Lg=!0,gR())}function Su(n,i){if(!Ug&&gf){Ug=!0;do for(var o=!1,c=pf;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var p=0;else{var v=c.suspendedLanes,I=c.pingedLanes;p=(1<<31-Ge(42|n)+1)-1,p&=f&~(v&~I),p=p&201326741?p&201326741|1:p?p|2:0}p!==0&&(o=!0,Wx(c,p))}else p=Xe,p=ls(c,c===vt?p:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(p&3)===0||Br(c,p)||(o=!0,Wx(c,p));c=c.next}while(o);Ug=!1}}function pR(){Kx()}function Kx(){gf=Lg=!1;var n=0;Ki!==0&&SR()&&(n=Ki);for(var i=Fe(),o=null,c=pf;c!==null;){var f=c.next,p=$x(c,i);p===0?(c.next=null,o===null?pf=f:o.next=f,f===null&&(Rl=o)):(o=c,(n!==0||(p&3)!==0)&&(gf=!0)),c=f}dn!==0&&dn!==5||Su(n),Ki!==0&&(Ki=0)}function $x(n,i){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,p=n.pendingLanes&-62914561;0<p;){var v=31-Ge(p),I=1<<v,P=f[v];P===-1?((I&o)===0||(I&c)!==0)&&(f[v]=mp(I,i)):P<=i&&(n.expiredLanes|=I),p&=~I}if(i=vt,o=Xe,o=ls(n,n===i?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===i&&(dt===2||dt===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&jn(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Br(n,o)){if(i=o&-o,i===n.callbackPriority)return i;switch(c!==null&&jn(c),Hs(o)){case 2:case 8:o=wn;break;case 32:o=Xt;break;case 268435456:o=Fs;break;default:o=Xt}return c=Yx.bind(null,n),o=Et(o,c),n.callbackPriority=i,n.callbackNode=o,i}return c!==null&&c!==null&&jn(c),n.callbackPriority=2,n.callbackNode=null,2}function Yx(n,i){if(dn!==0&&dn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(mf()&&n.callbackNode!==o)return null;var c=Xe;return c=ls(n,n===vt?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(Cx(n,c,i),$x(n,Fe()),n.callbackNode!=null&&n.callbackNode===o?Yx.bind(null,n):null)}function Wx(n,i){if(mf())return null;Cx(n,i,!0)}function gR(){NR(function(){(ot&6)!==0?Et(jt,pR):Kx()})}function zg(){if(Ki===0){var n=ml;n===0&&(n=as,as<<=1,(as&261888)===0&&(as=256)),Ki=n}return Ki}function Xx(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Zo(""+n)}function Jx(n,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,n.id&&o.setAttribute("form",n.id),i.parentNode.insertBefore(o,i),n=new FormData(n),o.parentNode.removeChild(o),n}function yR(n,i,o,c,f){if(i==="submit"&&o&&o.stateNode===f){var p=Xx((f[pn]||null).action),v=c.submitter;v&&(i=(i=v[pn]||null)?Xx(i.formAction):v.getAttribute("formAction"),i!==null&&(p=i,v=null));var I=new bs("action","action",null,c,f);n.push({event:I,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ki!==0){var P=v?Jx(f,v):new FormData(f);ag(o,{pending:!0,data:P,method:f.method,action:p},null,P)}}else typeof p=="function"&&(I.preventDefault(),P=v?Jx(f,v):new FormData(f),ag(o,{pending:!0,data:P,method:f.method,action:p},p,P))},currentTarget:f}]})}}for(var Bg=0;Bg<Ep.length;Bg++){var qg=Ep[Bg],_R=qg.toLowerCase(),bR=qg[0].toUpperCase()+qg.slice(1);Yr(_R,"on"+bR)}Yr(Rb,"onAnimationEnd"),Yr(Cb,"onAnimationIteration"),Yr(kb,"onAnimationStart"),Yr("dblclick","onDoubleClick"),Yr("focusin","onFocus"),Yr("focusout","onBlur"),Yr(VN,"onTransitionRun"),Yr(ON,"onTransitionStart"),Yr(MN,"onTransitionCancel"),Yr(Db,"onTransitionEnd"),ps("onMouseEnter",["mouseout","mouseover"]),ps("onMouseLeave",["mouseout","mouseover"]),ps("onPointerEnter",["pointerout","pointerover"]),ps("onPointerLeave",["pointerout","pointerover"]),ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ms("onBeforeInput",["compositionend","keypress","textInput","paste"]),ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Au));function Zx(n,i){i=(i&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var p=void 0;if(i)for(var v=c.length-1;0<=v;v--){var I=c[v],P=I.instance,Q=I.currentTarget;if(I=I.listener,P!==p&&f.isPropagationStopped())break e;p=I,f.currentTarget=Q;try{p(f)}catch(re){Ch(re)}f.currentTarget=null,p=P}else for(v=0;v<c.length;v++){if(I=c[v],P=I.instance,Q=I.currentTarget,I=I.listener,P!==p&&f.isPropagationStopped())break e;p=I,f.currentTarget=Q;try{p(f)}catch(re){Ch(re)}f.currentTarget=null,p=P}}}}function Ke(n,i){var o=i[$o];o===void 0&&(o=i[$o]=new Set);var c=n+"__bubble";o.has(c)||(ew(i,n,2,!1),o.add(c))}function Fg(n,i,o){var c=0;i&&(c|=4),ew(o,n,c,i)}var yf="_reactListening"+Math.random().toString(36).slice(2);function Hg(n){if(!n[yf]){n[yf]=!0,Uc.forEach(function(o){o!=="selectionchange"&&(vR.has(o)||Fg(o,!1,n),Fg(o,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[yf]||(i[yf]=!0,Fg("selectionchange",!1,i))}}function ew(n,i,o,c){switch(Rw(i)){case 2:var f=$R;break;case 8:f=YR;break;default:f=i0}o=f.bind(null,i,o,n),f=void 0,!qa||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(i,o,{capture:!0,passive:f}):n.addEventListener(i,o,!0):f!==void 0?n.addEventListener(i,o,{passive:f}):n.addEventListener(i,o,!1)}function Gg(n,i,o,c,f){var p=c;if((i&1)===0&&(i&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var I=c.stateNode.containerInfo;if(I===f)break;if(v===4)for(v=c.return;v!==null;){var P=v.tag;if((P===3||P===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;I!==null;){if(v=hs(I),v===null)return;if(P=v.tag,P===5||P===6||P===26||P===27){c=p=v;continue e}I=I.parentNode}}c=c.return}Ni(function(){var Q=p,re=Ir(o),oe=[];e:{var Y=jb.get(n);if(Y!==void 0){var Z=bs,Te=n;switch(n){case"keypress":if(Ha(o)===0)break e;case"keydown":case"keyup":Z=Ah;break;case"focusin":Te="focus",Z=Qa;break;case"focusout":Te="blur",Z=Qa;break;case"beforeblur":case"afterblur":Z=Qa;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=Jc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=_h;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=b;break;case Rb:case Cb:case kb:Z=vh;break;case Db:Z=A;break;case"scroll":case"scrollend":Z=Xc;break;case"wheel":Z=J;break;case"copy":case"cut":case"paste":Z=xh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=Ks;break;case"toggle":case"beforetoggle":Z=ze}var Pe=(i&4)!==0,bt=!Pe&&(n==="scroll"||n==="scrollend"),L=Pe?Y!==null?Y+"Capture":null:Y;Pe=[];for(var M=Q,G;M!==null;){var ie=M;if(G=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||G===null||L===null||(ie=Gr(M,L),ie!=null&&Pe.push(Nu(M,ie,G))),bt)break;M=M.return}0<Pe.length&&(Y=new Z(Y,Te,null,o,re),oe.push({event:Y,listeners:Pe}))}}if((i&7)===0){e:{if(Y=n==="mouseover"||n==="pointerover",Z=n==="mouseout"||n==="pointerout",Y&&o!==$c&&(Te=o.relatedTarget||o.fromElement)&&(hs(Te)||Te[us]))break e;if((Z||Y)&&(Y=re.window===re?re:(Y=re.ownerDocument)?Y.defaultView||Y.parentWindow:window,Z?(Te=o.relatedTarget||o.toElement,Z=Q,Te=Te?hs(Te):null,Te!==null&&(bt=l(Te),Pe=Te.tag,Te!==bt||Pe!==5&&Pe!==27&&Pe!==6)&&(Te=null)):(Z=null,Te=Q),Z!==Te)){if(Pe=Jc,ie="onMouseLeave",L="onMouseEnter",M="mouse",(n==="pointerout"||n==="pointerover")&&(Pe=Ks,ie="onPointerLeave",L="onPointerEnter",M="pointer"),bt=Z==null?Y:cr(Z),G=Te==null?Y:cr(Te),Y=new Pe(ie,M+"leave",Z,o,re),Y.target=bt,Y.relatedTarget=G,ie=null,hs(re)===Q&&(Pe=new Pe(L,M+"enter",Te,o,re),Pe.target=G,Pe.relatedTarget=bt,ie=Pe),bt=ie,Z&&Te)t:{for(Pe=xR,L=Z,M=Te,G=0,ie=L;ie;ie=Pe(ie))G++;ie=0;for(var ke=M;ke;ke=Pe(ke))ie++;for(;0<G-ie;)L=Pe(L),G--;for(;0<ie-G;)M=Pe(M),ie--;for(;G--;){if(L===M||M!==null&&L===M.alternate){Pe=L;break t}L=Pe(L),M=Pe(M)}Pe=null}else Pe=null;Z!==null&&tw(oe,Y,Z,Pe,!1),Te!==null&&bt!==null&&tw(oe,bt,Te,Pe,!0)}}e:{if(Y=Q?cr(Q):window,Z=Y.nodeName&&Y.nodeName.toLowerCase(),Z==="select"||Z==="input"&&Y.type==="file")var rt=_b;else if(gb(Y))if(bb)rt=DN;else{rt=CN;var Ae=RN}else Z=Y.nodeName,!Z||Z.toLowerCase()!=="input"||Y.type!=="checkbox"&&Y.type!=="radio"?Q&&Jo(Q.elementType)&&(rt=_b):rt=kN;if(rt&&(rt=rt(n,Q))){yb(oe,rt,o,re);break e}Ae&&Ae(n,Y,Q),n==="focusout"&&Q&&Y.type==="number"&&Q.memoizedProps.value!=null&&Gc(Y,"number",Y.value)}switch(Ae=Q?cr(Q):window,n){case"focusin":(gb(Ae)||Ae.contentEditable==="true")&&(al=Ae,vp=Q,ru=null);break;case"focusout":ru=vp=al=null;break;case"mousedown":xp=!0;break;case"contextmenu":case"mouseup":case"dragend":xp=!1,Ab(oe,o,re);break;case"selectionchange":if(PN)break;case"keydown":case"keyup":Ab(oe,o,re)}var He;if(at)e:{switch(n){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else il?Ka(n,o)&&(Je="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Je="onCompositionStart");Je&&(ws&&o.locale!=="ko"&&(il||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&il&&(He=Wc()):(_s=re,Yc="value"in _s?_s.value:_s.textContent,il=!0)),Ae=_f(Q,Je),0<Ae.length&&(Je=new xs(Je,n,null,o,re),oe.push({event:Je,listeners:Ae}),He?Je.data=He:(He=sl(o),He!==null&&(Je.data=He)))),(He=Ar?IN(n,o):SN(n,o))&&(Je=_f(Q,"onBeforeInput"),0<Je.length&&(Ae=new xs("onBeforeInput","beforeinput",null,o,re),oe.push({event:Ae,listeners:Je}),Ae.data=He)),yR(oe,n,Q,o,re)}Zx(oe,i)})}function Nu(n,i,o){return{instance:n,listener:i,currentTarget:o}}function _f(n,i){for(var o=i+"Capture",c=[];n!==null;){var f=n,p=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||p===null||(f=Gr(n,o),f!=null&&c.unshift(Nu(n,f,p)),f=Gr(n,i),f!=null&&c.push(Nu(n,f,p))),n.tag===3)return c;n=n.return}return[]}function xR(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function tw(n,i,o,c,f){for(var p=i._reactName,v=[];o!==null&&o!==c;){var I=o,P=I.alternate,Q=I.stateNode;if(I=I.tag,P!==null&&P===c)break;I!==5&&I!==26&&I!==27||Q===null||(P=Q,f?(Q=Gr(o,p),Q!=null&&v.unshift(Nu(o,Q,P))):f||(Q=Gr(o,p),Q!=null&&v.push(Nu(o,Q,P)))),o=o.return}v.length!==0&&n.push({event:i,listeners:v})}var wR=/\r\n?/g,ER=/\u0000|\uFFFD/g;function nw(n){return(typeof n=="string"?n:""+n).replace(wR,`
`).replace(ER,"")}function rw(n,i){return i=nw(i),nw(n)===i}function _t(n,i,o,c,f,p){switch(o){case"children":typeof c=="string"?i==="body"||i==="textarea"&&c===""||Jn(n,c):(typeof c=="number"||typeof c=="bigint")&&i!=="body"&&Jn(n,""+c);break;case"className":ur(n,"class",c);break;case"tabIndex":ur(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ur(n,o,c);break;case"style":Kc(n,c,p);break;case"data":if(i!=="object"){ur(n,"data",c);break}case"src":case"href":if(c===""&&(i!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Zo(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof p=="function"&&(o==="formAction"?(i!=="input"&&_t(n,i,"name",f.name,f,null),_t(n,i,"formEncType",f.formEncType,f,null),_t(n,i,"formMethod",f.formMethod,f,null),_t(n,i,"formTarget",f.formTarget,f,null)):(_t(n,i,"encType",f.encType,f,null),_t(n,i,"method",f.method,f,null),_t(n,i,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Zo(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=Hr);break;case"onScroll":c!=null&&Ke("scroll",n);break;case"onScrollEnd":c!=null&&Ke("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=Zo(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Ke("beforetoggle",n),Ke("toggle",n),Wo(n,"popover",c);break;case"xlinkActuate":tn(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":tn(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":tn(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":tn(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":tn(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":tn(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":tn(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":tn(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":tn(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Wo(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=yh.get(o)||o,Wo(n,o,c))}}function Qg(n,i,o,c,f,p){switch(o){case"style":Kc(n,c,p);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Jn(n,c):(typeof c=="number"||typeof c=="bigint")&&Jn(n,""+c);break;case"onScroll":c!=null&&Ke("scroll",n);break;case"onScrollEnd":c!=null&&Ke("scrollend",n);break;case"onClick":c!=null&&(n.onclick=Hr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zc.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),i=o.slice(2,f?o.length-7:void 0),p=n[pn]||null,p=p!=null?p[o]:null,typeof p=="function"&&n.removeEventListener(i,p,f),typeof c=="function")){typeof p!="function"&&p!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(i,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):Wo(n,o,c)}}}function An(n,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ke("error",n),Ke("load",n);var c=!1,f=!1,p;for(p in o)if(o.hasOwnProperty(p)){var v=o[p];if(v!=null)switch(p){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:_t(n,i,p,v,o,null)}}f&&_t(n,i,"srcSet",o.srcSet,o,null),c&&_t(n,i,"src",o.src,o,null);return;case"input":Ke("invalid",n);var I=p=v=f=null,P=null,Q=null;for(c in o)if(o.hasOwnProperty(c)){var re=o[c];if(re!=null)switch(c){case"name":f=re;break;case"type":v=re;break;case"checked":P=re;break;case"defaultChecked":Q=re;break;case"value":p=re;break;case"defaultValue":I=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(137,i));break;default:_t(n,i,c,re,o,null)}}mh(n,p,I,P,Q,v,f,!1);return;case"select":Ke("invalid",n),c=v=p=null;for(f in o)if(o.hasOwnProperty(f)&&(I=o[f],I!=null))switch(f){case"value":p=I;break;case"defaultValue":v=I;break;case"multiple":c=I;default:_t(n,i,f,I,o,null)}i=p,o=v,n.multiple=!!c,i!=null?Ti(n,!!c,i,!1):o!=null&&Ti(n,!!c,o,!0);return;case"textarea":Ke("invalid",n),p=f=c=null;for(v in o)if(o.hasOwnProperty(v)&&(I=o[v],I!=null))switch(v){case"value":c=I;break;case"defaultValue":f=I;break;case"children":p=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(r(91));break;default:_t(n,i,v,I,o,null)}Ii(n,c,f,p);return;case"option":for(P in o)o.hasOwnProperty(P)&&(c=o[P],c!=null)&&(P==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":_t(n,i,P,c,o,null));return;case"dialog":Ke("beforetoggle",n),Ke("toggle",n),Ke("cancel",n),Ke("close",n);break;case"iframe":case"object":Ke("load",n);break;case"video":case"audio":for(c=0;c<Au.length;c++)Ke(Au[c],n);break;case"image":Ke("error",n),Ke("load",n);break;case"details":Ke("toggle",n);break;case"embed":case"source":case"link":Ke("error",n),Ke("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in o)if(o.hasOwnProperty(Q)&&(c=o[Q],c!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:_t(n,i,Q,c,o,null)}return;default:if(Jo(i)){for(re in o)o.hasOwnProperty(re)&&(c=o[re],c!==void 0&&Qg(n,i,re,c,o,void 0));return}}for(I in o)o.hasOwnProperty(I)&&(c=o[I],c!=null&&_t(n,i,I,c,o,null))}function TR(n,i,o,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,p=null,v=null,I=null,P=null,Q=null,re=null;for(Z in o){var oe=o[Z];if(o.hasOwnProperty(Z)&&oe!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":P=oe;default:c.hasOwnProperty(Z)||_t(n,i,Z,null,c,oe)}}for(var Y in c){var Z=c[Y];if(oe=o[Y],c.hasOwnProperty(Y)&&(Z!=null||oe!=null))switch(Y){case"type":p=Z;break;case"name":f=Z;break;case"checked":Q=Z;break;case"defaultChecked":re=Z;break;case"value":v=Z;break;case"defaultValue":I=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(137,i));break;default:Z!==oe&&_t(n,i,Y,Z,c,oe)}}Xo(n,v,I,P,Q,re,p,f);return;case"select":Z=v=I=Y=null;for(p in o)if(P=o[p],o.hasOwnProperty(p)&&P!=null)switch(p){case"value":break;case"multiple":Z=P;default:c.hasOwnProperty(p)||_t(n,i,p,null,c,P)}for(f in c)if(p=c[f],P=o[f],c.hasOwnProperty(f)&&(p!=null||P!=null))switch(f){case"value":Y=p;break;case"defaultValue":I=p;break;case"multiple":v=p;default:p!==P&&_t(n,i,f,p,c,P)}i=I,o=v,c=Z,Y!=null?Ti(n,!!o,Y,!1):!!c!=!!o&&(i!=null?Ti(n,!!o,i,!0):Ti(n,!!o,o?[]:"",!1));return;case"textarea":Z=Y=null;for(I in o)if(f=o[I],o.hasOwnProperty(I)&&f!=null&&!c.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:_t(n,i,I,null,c,f)}for(v in c)if(f=c[v],p=o[v],c.hasOwnProperty(v)&&(f!=null||p!=null))switch(v){case"value":Y=f;break;case"defaultValue":Z=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(r(91));break;default:f!==p&&_t(n,i,v,f,c,p)}ph(n,Y,Z);return;case"option":for(var Te in o)Y=o[Te],o.hasOwnProperty(Te)&&Y!=null&&!c.hasOwnProperty(Te)&&(Te==="selected"?n.selected=!1:_t(n,i,Te,null,c,Y));for(P in c)Y=c[P],Z=o[P],c.hasOwnProperty(P)&&Y!==Z&&(Y!=null||Z!=null)&&(P==="selected"?n.selected=Y&&typeof Y!="function"&&typeof Y!="symbol":_t(n,i,P,Y,c,Z));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pe in o)Y=o[Pe],o.hasOwnProperty(Pe)&&Y!=null&&!c.hasOwnProperty(Pe)&&_t(n,i,Pe,null,c,Y);for(Q in c)if(Y=c[Q],Z=o[Q],c.hasOwnProperty(Q)&&Y!==Z&&(Y!=null||Z!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(r(137,i));break;default:_t(n,i,Q,Y,c,Z)}return;default:if(Jo(i)){for(var bt in o)Y=o[bt],o.hasOwnProperty(bt)&&Y!==void 0&&!c.hasOwnProperty(bt)&&Qg(n,i,bt,void 0,c,Y);for(re in c)Y=c[re],Z=o[re],!c.hasOwnProperty(re)||Y===Z||Y===void 0&&Z===void 0||Qg(n,i,re,Y,c,Z);return}}for(var L in o)Y=o[L],o.hasOwnProperty(L)&&Y!=null&&!c.hasOwnProperty(L)&&_t(n,i,L,null,c,Y);for(oe in c)Y=c[oe],Z=o[oe],!c.hasOwnProperty(oe)||Y===Z||Y==null&&Z==null||_t(n,i,oe,Y,c,Z)}function sw(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function IR(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],p=f.transferSize,v=f.initiatorType,I=f.duration;if(p&&I&&sw(v)){for(v=0,I=f.responseEnd,c+=1;c<o.length;c++){var P=o[c],Q=P.startTime;if(Q>I)break;var re=P.transferSize,oe=P.initiatorType;re&&sw(oe)&&(P=P.responseEnd,v+=re*(P<I?1:(I-Q)/(P-Q)))}if(--c,i+=8*(p+v)/(f.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Kg=null,$g=null;function bf(n){return n.nodeType===9?n:n.ownerDocument}function iw(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function aw(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Yg(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Wg=null;function SR(){var n=window.event;return n&&n.type==="popstate"?n===Wg?!1:(Wg=n,!0):(Wg=null,!1)}var ow=typeof setTimeout=="function"?setTimeout:void 0,AR=typeof clearTimeout=="function"?clearTimeout:void 0,lw=typeof Promise=="function"?Promise:void 0,NR=typeof queueMicrotask=="function"?queueMicrotask:typeof lw<"u"?function(n){return lw.resolve(null).then(n).catch(RR)}:ow;function RR(n){setTimeout(function(){throw n})}function $i(n){return n==="head"}function cw(n,i){var o=i,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),jl(i);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Ru(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Ru(o);for(var p=o.firstChild;p;){var v=p.nextSibling,I=p.nodeName;p[ds]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&p.rel.toLowerCase()==="stylesheet"||o.removeChild(p),p=v}}else o==="body"&&Ru(n.ownerDocument.body);o=f}while(o);jl(i)}function uw(n,i){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function Xg(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Xg(o),Yo(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function CR(n,i,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[ds])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(p=n.getAttribute("rel"),p==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(p!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(p=n.getAttribute("src"),(p!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&p&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var p=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===p)return n}else return n;if(n=Pr(n.nextSibling),n===null)break}return null}function kR(n,i,o){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Pr(n.nextSibling),n===null))return null;return n}function dw(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=Pr(n.nextSibling),n===null))return null;return n}function Jg(n){return n.data==="$?"||n.data==="$~"}function Zg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function DR(n,i){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||o.readyState!=="loading")i();else{var c=function(){i(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Pr(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var e0=null;function hw(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(i===0)return Pr(n.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}n=n.nextSibling}return null}function fw(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return n;i--}else o!=="/$"&&o!=="/&"||i++}n=n.previousSibling}return null}function mw(n,i,o){switch(i=bf(o),n){case"html":if(n=i.documentElement,!n)throw Error(r(452));return n;case"head":if(n=i.head,!n)throw Error(r(453));return n;case"body":if(n=i.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function Ru(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Yo(n)}var Vr=new Map,pw=new Set;function vf(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var li=me.d;me.d={f:jR,r:PR,D:VR,C:OR,L:MR,m:LR,X:zR,S:UR,M:BR};function jR(){var n=li.f(),i=df();return n||i}function PR(n){var i=Tr(n);i!==null&&i.tag===5&&i.type==="form"?Dv(i):li.r(n)}var Cl=typeof document>"u"?null:document;function gw(n,i,o){var c=Cl;if(c&&typeof i=="string"&&i){var f=Xn(i);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),pw.has(f)||(pw.add(f),n={rel:n,crossOrigin:o,href:i},c.querySelector(f)===null&&(i=c.createElement("link"),An(i,"link",n),en(i),c.head.appendChild(i)))}}function VR(n){li.D(n),gw("dns-prefetch",n,null)}function OR(n,i){li.C(n,i),gw("preconnect",n,i)}function MR(n,i,o){li.L(n,i,o);var c=Cl;if(c&&n&&i){var f='link[rel="preload"][as="'+Xn(i)+'"]';i==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Xn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Xn(o.imageSizes)+'"]')):f+='[href="'+Xn(n)+'"]';var p=f;switch(i){case"style":p=kl(n);break;case"script":p=Dl(n)}Vr.has(p)||(n=x({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:n,as:i},o),Vr.set(p,n),c.querySelector(f)!==null||i==="style"&&c.querySelector(Cu(p))||i==="script"&&c.querySelector(ku(p))||(i=c.createElement("link"),An(i,"link",n),en(i),c.head.appendChild(i)))}}function LR(n,i){li.m(n,i);var o=Cl;if(o&&n){var c=i&&typeof i.as=="string"?i.as:"script",f='link[rel="modulepreload"][as="'+Xn(c)+'"][href="'+Xn(n)+'"]',p=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":p=Dl(n)}if(!Vr.has(p)&&(n=x({rel:"modulepreload",href:n},i),Vr.set(p,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(ku(p)))return}c=o.createElement("link"),An(c,"link",n),en(c),o.head.appendChild(c)}}}function UR(n,i,o){li.S(n,i,o);var c=Cl;if(c&&n){var f=fs(c).hoistableStyles,p=kl(n);i=i||"default";var v=f.get(p);if(!v){var I={loading:0,preload:null};if(v=c.querySelector(Cu(p)))I.loading=5;else{n=x({rel:"stylesheet",href:n,"data-precedence":i},o),(o=Vr.get(p))&&t0(n,o);var P=v=c.createElement("link");en(P),An(P,"link",n),P._p=new Promise(function(Q,re){P.onload=Q,P.onerror=re}),P.addEventListener("load",function(){I.loading|=1}),P.addEventListener("error",function(){I.loading|=2}),I.loading|=4,xf(v,i,c)}v={type:"stylesheet",instance:v,count:1,state:I},f.set(p,v)}}}function zR(n,i){li.X(n,i);var o=Cl;if(o&&n){var c=fs(o).hoistableScripts,f=Dl(n),p=c.get(f);p||(p=o.querySelector(ku(f)),p||(n=x({src:n,async:!0},i),(i=Vr.get(f))&&n0(n,i),p=o.createElement("script"),en(p),An(p,"link",n),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(f,p))}}function BR(n,i){li.M(n,i);var o=Cl;if(o&&n){var c=fs(o).hoistableScripts,f=Dl(n),p=c.get(f);p||(p=o.querySelector(ku(f)),p||(n=x({src:n,async:!0,type:"module"},i),(i=Vr.get(f))&&n0(n,i),p=o.createElement("script"),en(p),An(p,"link",n),o.head.appendChild(p)),p={type:"script",instance:p,count:1,state:null},c.set(f,p))}}function yw(n,i,o,c){var f=(f=de.current)?vf(f):null;if(!f)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=kl(o.href),o=fs(f).hoistableStyles,c=o.get(i),c||(c={type:"style",instance:null,count:0,state:null},o.set(i,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=kl(o.href);var p=fs(f).hoistableStyles,v=p.get(n);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},p.set(n,v),(p=f.querySelector(Cu(n)))&&!p._p&&(v.instance=p,v.state.loading=5),Vr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Vr.set(n,o),p||qR(f,n,o,v.state))),i&&c===null)throw Error(r(528,""));return v}if(i&&c!==null)throw Error(r(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Dl(o),o=fs(f).hoistableScripts,c=o.get(i),c||(c={type:"script",instance:null,count:0,state:null},o.set(i,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function kl(n){return'href="'+Xn(n)+'"'}function Cu(n){return'link[rel="stylesheet"]['+n+"]"}function _w(n){return x({},n,{"data-precedence":n.precedence,precedence:null})}function qR(n,i,o,c){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?c.loading=1:(i=n.createElement("link"),c.preload=i,i.addEventListener("load",function(){return c.loading|=1}),i.addEventListener("error",function(){return c.loading|=2}),An(i,"link",o),en(i),n.head.appendChild(i))}function Dl(n){return'[src="'+Xn(n)+'"]'}function ku(n){return"script[async]"+n}function bw(n,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var c=n.querySelector('style[data-href~="'+Xn(o.href)+'"]');if(c)return i.instance=c,en(c),c;var f=x({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),en(c),An(c,"style",f),xf(c,o.precedence,n),i.instance=c;case"stylesheet":f=kl(o.href);var p=n.querySelector(Cu(f));if(p)return i.state.loading|=4,i.instance=p,en(p),p;c=_w(o),(f=Vr.get(f))&&t0(c,f),p=(n.ownerDocument||n).createElement("link"),en(p);var v=p;return v._p=new Promise(function(I,P){v.onload=I,v.onerror=P}),An(p,"link",c),i.state.loading|=4,xf(p,o.precedence,n),i.instance=p;case"script":return p=Dl(o.src),(f=n.querySelector(ku(p)))?(i.instance=f,en(f),f):(c=o,(f=Vr.get(p))&&(c=x({},o),n0(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),en(f),An(f,"link",c),n.head.appendChild(f),i.instance=f);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(c=i.instance,i.state.loading|=4,xf(c,o.precedence,n));return i.instance}function xf(n,i,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,p=f,v=0;v<c.length;v++){var I=c[v];if(I.dataset.precedence===i)p=I;else if(p!==f)break}p?p.parentNode.insertBefore(n,p.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(n,i.firstChild))}function t0(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function n0(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var wf=null;function vw(n,i,o){if(wf===null){var c=new Map,f=wf=new Map;f.set(o,c)}else f=wf,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var p=o[f];if(!(p[ds]||p[Zt]||n==="link"&&p.getAttribute("rel")==="stylesheet")&&p.namespaceURI!=="http://www.w3.org/2000/svg"){var v=p.getAttribute(i)||"";v=n+v;var I=c.get(v);I?I.push(p):c.set(v,[p])}}return c}function xw(n,i,o){n=n.ownerDocument||n,n.head.insertBefore(o,i==="title"?n.querySelector("head > title"):null)}function FR(n,i,o){if(o===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(n=i.disabled,typeof i.precedence=="string"&&n==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function ww(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function HR(n,i,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=kl(c.href),p=i.querySelector(Cu(f));if(p){i=p._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=Ef.bind(n),i.then(n,n)),o.state.loading|=4,o.instance=p,en(p);return}p=i.ownerDocument||i,c=_w(c),(f=Vr.get(f))&&t0(c,f),p=p.createElement("link"),en(p);var v=p;v._p=new Promise(function(I,P){v.onload=I,v.onerror=P}),An(p,"link",c),o.instance=p}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=Ef.bind(n),i.addEventListener("load",o),i.addEventListener("error",o))}}var r0=0;function GR(n,i){return n.stylesheets&&n.count===0&&If(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&If(n,n.stylesheets),n.unsuspend){var p=n.unsuspend;n.unsuspend=null,p()}},6e4+i);0<n.imgBytes&&r0===0&&(r0=62500*IR());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&If(n,n.stylesheets),n.unsuspend)){var p=n.unsuspend;n.unsuspend=null,p()}},(n.imgBytes>r0?50:800)+i);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function Ef(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)If(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Tf=null;function If(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Tf=new Map,i.forEach(QR,n),Tf=null,Ef.call(n))}function QR(n,i){if(!(i.state.loading&4)){var o=Tf.get(n);if(o)var c=o.get(null);else{o=new Map,Tf.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),p=0;p<f.length;p++){var v=f[p];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(o.set(v.dataset.precedence,v),c=v)}c&&o.set(null,c)}f=i.instance,v=f.getAttribute("data-precedence"),p=o.get(v)||c,p===c&&o.set(null,f),o.set(v,f),this.count++,c=Ef.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),p?p.parentNode.insertBefore(f,p.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),i.state.loading|=4}}var Du={$$typeof:te,Provider:null,Consumer:null,_currentValue:Ee,_currentValue2:Ee,_threadCount:0};function KR(n,i,o,c,f,p,v,I,P){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cs(0),this.hiddenUpdates=cs(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=p,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function Ew(n,i,o,c,f,p,v,I,P,Q,re,oe){return n=new KR(n,i,o,v,P,Q,re,oe,I),i=1,p===!0&&(i|=24),p=hr(3,null,null,i),n.current=p,p.stateNode=n,i=Op(),i.refCount++,n.pooledCache=i,i.refCount++,p.memoizedState={element:c,isDehydrated:o,cache:i},zp(p),n}function Tw(n){return n?(n=cl,n):cl}function Iw(n,i,o,c,f,p){f=Tw(f),c.context===null?c.context=f:c.pendingContext=f,c=Mi(i),c.payload={element:o},p=p===void 0?null:p,p!==null&&(c.callback=p),o=Li(n,c,i),o!==null&&(rr(o,n,i),uu(o,n,i))}function Sw(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<i?o:i}}function s0(n,i){Sw(n,i),(n=n.alternate)&&Sw(n,i)}function Aw(n){if(n.tag===13||n.tag===31){var i=Wa(n,67108864);i!==null&&rr(i,n,67108864),s0(n,67108864)}}function Nw(n){if(n.tag===13||n.tag===31){var i=yr();i=La(i);var o=Wa(n,i);o!==null&&rr(o,n,i),s0(n,i)}}var Sf=!0;function $R(n,i,o,c){var f=z.T;z.T=null;var p=me.p;try{me.p=2,i0(n,i,o,c)}finally{me.p=p,z.T=f}}function YR(n,i,o,c){var f=z.T;z.T=null;var p=me.p;try{me.p=8,i0(n,i,o,c)}finally{me.p=p,z.T=f}}function i0(n,i,o,c){if(Sf){var f=a0(c);if(f===null)Gg(n,i,c,Af,o),Cw(n,c);else if(XR(f,n,i,o,c))c.stopPropagation();else if(Cw(n,c),i&4&&-1<WR.indexOf(n)){for(;f!==null;){var p=Tr(f);if(p!==null)switch(p.tag){case 3:if(p=p.stateNode,p.current.memoizedState.isDehydrated){var v=os(p.pendingLanes);if(v!==0){var I=p;for(I.pendingLanes|=2,I.entangledLanes|=2;v;){var P=1<<31-Ge(v);I.entanglements[1]|=P,v&=~P}Ss(p),(ot&6)===0&&(cf=Fe()+500,Su(0))}}break;case 31:case 13:I=Wa(p,2),I!==null&&rr(I,p,2),df(),s0(p,2)}if(p=a0(c),p===null&&Gg(n,i,c,Af,o),p===f)break;f=p}f!==null&&c.stopPropagation()}else Gg(n,i,c,null,o)}}function a0(n){return n=Ir(n),o0(n)}var Af=null;function o0(n){if(Af=null,n=hs(n),n!==null){var i=l(n);if(i===null)n=null;else{var o=i.tag;if(o===13){if(n=u(i),n!==null)return n;n=null}else if(o===31){if(n=m(i),n!==null)return n;n=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Af=n,null}function Rw(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ue()){case jt:return 2;case wn:return 8;case Xt:case ja:return 32;case Fs:return 268435456;default:return 32}default:return 32}}var l0=!1,Yi=null,Wi=null,Xi=null,ju=new Map,Pu=new Map,Ji=[],WR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Cw(n,i){switch(n){case"focusin":case"focusout":Yi=null;break;case"dragenter":case"dragleave":Wi=null;break;case"mouseover":case"mouseout":Xi=null;break;case"pointerover":case"pointerout":ju.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pu.delete(i.pointerId)}}function Vu(n,i,o,c,f,p){return n===null||n.nativeEvent!==p?(n={blockedOn:i,domEventName:o,eventSystemFlags:c,nativeEvent:p,targetContainers:[f]},i!==null&&(i=Tr(i),i!==null&&Aw(i)),n):(n.eventSystemFlags|=c,i=n.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),n)}function XR(n,i,o,c,f){switch(i){case"focusin":return Yi=Vu(Yi,n,i,o,c,f),!0;case"dragenter":return Wi=Vu(Wi,n,i,o,c,f),!0;case"mouseover":return Xi=Vu(Xi,n,i,o,c,f),!0;case"pointerover":var p=f.pointerId;return ju.set(p,Vu(ju.get(p)||null,n,i,o,c,f)),!0;case"gotpointercapture":return p=f.pointerId,Pu.set(p,Vu(Pu.get(p)||null,n,i,o,c,f)),!0}return!1}function kw(n){var i=hs(n.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=u(o),i!==null){n.blockedOn=i,qr(n.priority,function(){Nw(o)});return}}else if(i===31){if(i=m(o),i!==null){n.blockedOn=i,qr(n.priority,function(){Nw(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Nf(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var o=a0(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);$c=c,o.target.dispatchEvent(c),$c=null}else return i=Tr(o),i!==null&&Aw(i),n.blockedOn=o,!1;i.shift()}return!0}function Dw(n,i,o){Nf(n)&&o.delete(i)}function JR(){l0=!1,Yi!==null&&Nf(Yi)&&(Yi=null),Wi!==null&&Nf(Wi)&&(Wi=null),Xi!==null&&Nf(Xi)&&(Xi=null),ju.forEach(Dw),Pu.forEach(Dw)}function Rf(n,i){n.blockedOn===i&&(n.blockedOn=null,l0||(l0=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,JR)))}var Cf=null;function jw(n){Cf!==n&&(Cf=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Cf===n&&(Cf=null);for(var i=0;i<n.length;i+=3){var o=n[i],c=n[i+1],f=n[i+2];if(typeof c!="function"){if(o0(c||o)===null)continue;break}var p=Tr(o);p!==null&&(n.splice(i,3),i-=3,ag(p,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function jl(n){function i(P){return Rf(P,n)}Yi!==null&&Rf(Yi,n),Wi!==null&&Rf(Wi,n),Xi!==null&&Rf(Xi,n),ju.forEach(i),Pu.forEach(i);for(var o=0;o<Ji.length;o++){var c=Ji[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Ji.length&&(o=Ji[0],o.blockedOn===null);)kw(o),o.blockedOn===null&&Ji.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],p=o[c+1],v=f[pn]||null;if(typeof p=="function")v||jw(o);else if(v){var I=null;if(p&&p.hasAttribute("formAction")){if(f=p,v=p[pn]||null)I=v.formAction;else if(o0(f)!==null)continue}else I=v.action;typeof I=="function"?o[c+1]=I:(o.splice(c,3),c-=3),jw(o)}}}function Pw(){function n(p){p.canIntercept&&p.info==="react-transition"&&p.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function i(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var p=navigation.currentEntry;p&&p.url!=null&&navigation.navigate(p.url,{state:p.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),f!==null&&(f(),f=null)}}}function c0(n){this._internalRoot=n}kf.prototype.render=c0.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));var o=i.current,c=yr();Iw(o,c,n,i,null,null)},kf.prototype.unmount=c0.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Iw(n.current,2,null,n,null,null),df(),i[us]=null}};function kf(n){this._internalRoot=n}kf.prototype.unstable_scheduleHydration=function(n){if(n){var i=uh();n={blockedOn:null,target:n,priority:i};for(var o=0;o<Ji.length&&i!==0&&i<Ji[o].priority;o++);Ji.splice(o,0,n),o===0&&kw(n)}};var Vw=e.version;if(Vw!=="19.2.3")throw Error(r(527,Vw,"19.2.3"));me.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=y(i),n=n!==null?_(n):null,n=n===null?null:n.stateNode,n};var ZR={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Df.isDisabled&&Df.supportsFiber)try{zn=Df.inject(ZR),xe=Df}catch{}}return Mu.createRoot=function(n,i){if(!a(n))throw Error(r(299));var o=!1,c="",f=qv,p=Fv,v=Hv;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onUncaughtError!==void 0&&(f=i.onUncaughtError),i.onCaughtError!==void 0&&(p=i.onCaughtError),i.onRecoverableError!==void 0&&(v=i.onRecoverableError)),i=Ew(n,1,!1,null,null,o,c,null,f,p,v,Pw),n[us]=i.current,Hg(n),new c0(i)},Mu.hydrateRoot=function(n,i,o){if(!a(n))throw Error(r(299));var c=!1,f="",p=qv,v=Fv,I=Hv,P=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(p=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(I=o.onRecoverableError),o.formState!==void 0&&(P=o.formState)),i=Ew(n,1,!0,i,o??null,c,f,P,p,v,I,Pw),i.context=Tw(null),o=i.current,c=yr(),c=La(c),f=Mi(c),f.callback=null,Li(o,f,c),o=c,i.current.lanes=o,Oa(i,o),Ss(i),n[us]=i.current,Hg(n),new kf(i)},Mu.version="19.2.3",Mu}var Gw;function l2(){if(Gw)return h0.exports;Gw=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch{}}return s(),h0.exports=o2(),h0.exports}var c2=l2();const u2=Ry(c2);const d2=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),h2=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),Qw=s=>{const e=h2(s);return e.charAt(0).toUpperCase()+e.slice(1)},aI=(...s)=>s.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),f2=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var m2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const p2=lt.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:u,...m},g)=>lt.createElement("svg",{ref:g,...m2,width:e,height:e,stroke:s,strokeWidth:r?Number(t)*24/Number(e):t,className:aI("lucide",a),...!l&&!f2(m)&&{"aria-hidden":"true"},...m},[...u.map(([y,_])=>lt.createElement(y,_)),...Array.isArray(l)?l:[l]]));const pt=(s,e)=>{const t=lt.forwardRef(({className:r,...a},l)=>lt.createElement(p2,{ref:l,iconNode:e,className:aI(`lucide-${d2(Qw(s))}`,`lucide-${s}`,r),...a}));return t.displayName=Qw(s),t};const g2=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],oI=pt("archive",g2);const y2=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],ky=pt("box",y2);const _2=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],b2=pt("calculator",_2);const v2=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],x2=pt("check",v2);const w2=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],O0=pt("copy",w2);const E2=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],T2=pt("download",E2);const I2=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],M0=pt("eye",I2);const S2=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],rm=pt("file-text",S2);const A2=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Kw=pt("layers",A2);const N2=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],R2=pt("loader",N2);const C2=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],k2=pt("lock",C2);const D2=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],$w=pt("log-out",D2);const j2=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],P2=pt("menu",j2);const V2=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],O2=pt("monitor",V2);const M2=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],L2=pt("moon",M2);const U2=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],aa=pt("plus",U2);const z2=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Bf=pt("printer",z2);const B2=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],L0=pt("refresh-cw",B2);const q2=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Yw=pt("rotate-ccw",q2);const F2=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],lI=pt("save",F2);const H2=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],G2=pt("settings",H2);const Q2=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],K2=pt("shield-check",Q2);const $2=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],cI=pt("shield",$2);const Y2=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],To=pt("square-pen",Y2);const W2=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],X2=pt("sun",W2);const J2=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Os=pt("trash-2",J2);const Z2=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],eC=pt("triangle-alert",Z2);const tC=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],nC=pt("user",tC);const rC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],yd=pt("x",rC),sC=()=>{};var Ww={};const uI=function(s){const e=[];let t=0;for(let r=0;r<s.length;r++){let a=s.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<s.length&&(s.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},iC=function(s){const e=[];let t=0,r=0;for(;t<s.length;){const a=s[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const l=s[t++];e[r++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=s[t++],u=s[t++],m=s[t++],g=((a&7)<<18|(l&63)<<12|(u&63)<<6|m&63)-65536;e[r++]=String.fromCharCode(55296+(g>>10)),e[r++]=String.fromCharCode(56320+(g&1023))}else{const l=s[t++],u=s[t++];e[r++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},dI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<s.length;a+=3){const l=s[a],u=a+1<s.length,m=u?s[a+1]:0,g=a+2<s.length,y=g?s[a+2]:0,_=l>>2,x=(l&3)<<4|m>>4;let T=(m&15)<<2|y>>6,S=y&63;g||(S=64,u||(T=64)),r.push(t[_],t[x],t[T],t[S])}return r.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(uI(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):iC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<s.length;){const l=t[s.charAt(a++)],m=a<s.length?t[s.charAt(a)]:0;++a;const y=a<s.length?t[s.charAt(a)]:64;++a;const x=a<s.length?t[s.charAt(a)]:64;if(++a,l==null||m==null||y==null||x==null)throw new aC;const T=l<<2|m>>4;if(r.push(T),y!==64){const S=m<<4&240|y>>2;if(r.push(S),x!==64){const V=y<<6&192|x;r.push(V)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class aC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oC=function(s){const e=uI(s);return dI.encodeByteArray(e,!0)},sm=function(s){return oC(s).replace(/\./g,"")},Dy=function(s){try{return dI.decodeString(s,!0)}catch{}return null};function im(s,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!lC(t)||(s[t]=im(s[t],e[t]));return s}function lC(s){return s!=="__proto__"}function jy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const cC=()=>jy().__FIREBASE_DEFAULTS__,uC=()=>{if(typeof process>"u"||typeof Ww>"u")return;const s=Ww.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},dC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Dy(s[1]);return e&&JSON.parse(e)},Py=()=>{try{return sC()||cC()||uC()||dC()}catch{return}},Vy=()=>Py()?.config,hC=s=>Py()?.[`_${s}`];class fC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Ec(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hI(s){return(await fetch(s,{credentials:"include"})).ok}function mC(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",a=s.iat||0,l=s.sub||s.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...s};return[sm(JSON.stringify(t)),sm(JSON.stringify(u)),""].join(".")}const nd={};function pC(){const s={prod:[],emulator:[]};for(const e of Object.keys(nd))nd[e]?s.emulator.push(e):s.prod.push(e);return s}function gC(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let Xw=!1;function fI(s,e){if(typeof window>"u"||typeof document>"u"||!Ec(window.location.host)||nd[s]===e||nd[s]||Xw)return;nd[s]=e;function t(T){return`__firebase__banner__${T}`}const r="__firebase__banner",l=pC().prod.length>0;function u(){const T=document.getElementById(r);T&&T.remove()}function m(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function g(T,S){T.setAttribute("width","24"),T.setAttribute("id",S),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function y(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{Xw=!0,u()},T}function _(T,S){T.setAttribute("id",S),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function x(){const T=gC(r),S=t("text"),V=document.getElementById(S)||document.createElement("span"),U=t("learnmore"),$=document.getElementById(U)||document.createElement("a"),H=t("preprendIcon"),se=document.getElementById(H)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const te=T.element;m(te),_($,U);const be=y();g(se,H),te.append(se,V,$,be),document.body.appendChild(te)}l?(V.innerText="Preview backend disconnected.",se.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(se.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,V.innerText="Preview backend running in this workspace."),V.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}function Ot(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ot())}function Cm(){const s=Py()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _C(){return typeof window<"u"||mI()}function mI(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function bC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function pI(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function Oy(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gI(){const s=Ot();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function yI(){return!Cm()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _I(){return!Cm()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function _d(){try{return typeof indexedDB=="object"}catch{return!1}}function vC(){return new Promise((s,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),s(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(t){e(t)}})}const xC="FirebaseError";class Gn extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=xC,Object.setPrototypeOf(this,Gn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qo.prototype.create)}}class qo{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?wC(l,r):"Error",m=`${this.serviceName}: ${u} (${a}).`;return new Gn(a,m,r)}}function wC(s,e){return s.replace(EC,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const EC=/\{\$([^}]+)}/g;function Jw(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function TC(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function pa(s,e){if(s===e)return!0;const t=Object.keys(s),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const l=s[a],u=e[a];if(Zw(l)&&Zw(u)){if(!pa(l,u))return!1}else if(l!==u)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function Zw(s){return s!==null&&typeof s=="object"}function Tc(s){const e=[];for(const[t,r]of Object.entries(s))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ql(s){const e={};return s.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,l]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function $u(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function bI(s,e){const t=new IC(s,e);return t.subscribe.bind(t)}class IC{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");SC(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=g0),a.error===void 0&&(a.error=g0),a.complete===void 0&&(a.complete=g0);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch{}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function SC(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function g0(){}function je(s){return s&&s._delegate?s._delegate:s}class Us{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const uo="[DEFAULT]";class AC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new fC;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(r)return null;throw a}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(RC(e))try{this.getOrInitializeService({instanceIdentifier:uo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});r.resolve(l)}catch{}}}}clearInstance(e=uo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=uo){return this.instances.has(e)}getOptions(e=uo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[l,u]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(l);r===m&&u.resolve(a)}return a}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(r)??new Set;a.add(e),this.onInitCallbacks.set(r,a);const l=this.instances.get(r);return l&&e(l,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:NC(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=uo){return this.component?this.component.multipleInstances?e:uo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function NC(s){return s===uo?void 0:s}function RC(s){return s.instantiationMode==="EAGER"}class vI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new AC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const My=[];var $e;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})($e||($e={}));const xI={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},CC=$e.INFO,kC={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},DC=(s,e,...t)=>{if(e<s.logLevel)return;const r=new Date().toISOString(),a=kC[e];if(!a)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class km{constructor(e){this.name=e,this._logLevel=CC,this._logHandler=DC,this._userLogHandler=null,My.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}}function jC(s){My.forEach(e=>{e.setLogLevel(s)})}function PC(s,e){for(const t of My){let r=null;e&&e.level&&(r=xI[e.level]),s===null?t.userLogHandler=null:t.userLogHandler=(a,l,...u)=>{const m=u.map(g=>{if(g==null)return null;if(typeof g=="string")return g;if(typeof g=="number"||typeof g=="boolean")return g.toString();if(g instanceof Error)return g.message;try{return JSON.stringify(g)}catch{return null}}).filter(g=>g).join(" ");l>=(r??a.logLevel)&&s({level:$e[l].toLowerCase(),message:m,args:u,type:a.name})}}}const VC=(s,e)=>e.some(t=>s instanceof t);let eE,tE;function OC(){return eE||(eE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function MC(){return tE||(tE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wI=new WeakMap,U0=new WeakMap,EI=new WeakMap,y0=new WeakMap,Ly=new WeakMap;function LC(s){const e=new Promise((t,r)=>{const a=()=>{s.removeEventListener("success",l),s.removeEventListener("error",u)},l=()=>{t(ua(s.result)),a()},u=()=>{r(s.error),a()};s.addEventListener("success",l),s.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&wI.set(t,s)}).catch(()=>{}),Ly.set(e,s),e}function UC(s){if(U0.has(s))return;const e=new Promise((t,r)=>{const a=()=>{s.removeEventListener("complete",l),s.removeEventListener("error",u),s.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{r(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",l),s.addEventListener("error",u),s.addEventListener("abort",u)});U0.set(s,e)}let z0={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return U0.get(s);if(e==="objectStoreNames")return s.objectStoreNames||EI.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ua(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function zC(s){z0=s(z0)}function BC(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=s.call(_0(this),e,...t);return EI.set(r,e.sort?e.sort():[e]),ua(r)}:MC().includes(s)?function(...e){return s.apply(_0(this),e),ua(wI.get(this))}:function(...e){return ua(s.apply(_0(this),e))}}function qC(s){return typeof s=="function"?BC(s):(s instanceof IDBTransaction&&UC(s),VC(s,OC())?new Proxy(s,z0):s)}function ua(s){if(s instanceof IDBRequest)return LC(s);if(y0.has(s))return y0.get(s);const e=qC(s);return e!==s&&(y0.set(s,e),Ly.set(e,s)),e}const _0=s=>Ly.get(s);function FC(s,e,{blocked:t,upgrade:r,blocking:a,terminated:l}={}){const u=indexedDB.open(s,e),m=ua(u);return r&&u.addEventListener("upgradeneeded",g=>{r(ua(u.result),g.oldVersion,g.newVersion,ua(u.transaction),g)}),t&&u.addEventListener("blocked",g=>t(g.oldVersion,g.newVersion,g)),m.then(g=>{l&&g.addEventListener("close",()=>l()),a&&g.addEventListener("versionchange",y=>a(y.oldVersion,y.newVersion,y))}).catch(()=>{}),m}const HC=["get","getKey","getAll","getAllKeys","count"],GC=["put","add","delete","clear"],b0=new Map;function nE(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(b0.get(e))return b0.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=GC.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||HC.includes(t)))return;const l=async function(u,...m){const g=this.transaction(u,a?"readwrite":"readonly");let y=g.store;return r&&(y=y.index(m.shift())),(await Promise.all([y[t](...m),a&&g.done]))[0]};return b0.set(e,l),l}zC(s=>({...s,get:(e,t,r)=>nE(e,t)||s.get(e,t,r),has:(e,t)=>!!nE(e,t)||s.has(e,t)}));class QC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(KC(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function KC(s){return s.getComponent()?.type==="VERSION"}const am="@firebase/app",B0="0.14.7";const hi=new km("@firebase/app"),$C="@firebase/app-compat",YC="@firebase/analytics-compat",WC="@firebase/analytics",XC="@firebase/app-check-compat",JC="@firebase/app-check",ZC="@firebase/auth",ek="@firebase/auth-compat",tk="@firebase/database",nk="@firebase/data-connect",rk="@firebase/database-compat",sk="@firebase/functions",ik="@firebase/functions-compat",ak="@firebase/installations",ok="@firebase/installations-compat",lk="@firebase/messaging",ck="@firebase/messaging-compat",uk="@firebase/performance",dk="@firebase/performance-compat",hk="@firebase/remote-config",fk="@firebase/remote-config-compat",mk="@firebase/storage",pk="@firebase/storage-compat",gk="@firebase/firestore",yk="@firebase/ai",_k="@firebase/firestore-compat",bk="firebase",vk="12.8.0";const ga="[DEFAULT]",xk={[am]:"fire-core",[$C]:"fire-core-compat",[WC]:"fire-analytics",[YC]:"fire-analytics-compat",[JC]:"fire-app-check",[XC]:"fire-app-check-compat",[ZC]:"fire-auth",[ek]:"fire-auth-compat",[tk]:"fire-rtdb",[nk]:"fire-data-connect",[rk]:"fire-rtdb-compat",[sk]:"fire-fn",[ik]:"fire-fn-compat",[ak]:"fire-iid",[ok]:"fire-iid-compat",[lk]:"fire-fcm",[ck]:"fire-fcm-compat",[uk]:"fire-perf",[dk]:"fire-perf-compat",[hk]:"fire-rc",[fk]:"fire-rc-compat",[mk]:"fire-gcs",[pk]:"fire-gcs-compat",[gk]:"fire-fst",[_k]:"fire-fst-compat",[yk]:"fire-vertex","fire-js":"fire-js",[bk]:"fire-js-all"};const ya=new Map,ec=new Map,tc=new Map;function bd(s,e){try{s.container.addComponent(e)}catch(t){hi.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function TI(s,e){s.container.addOrOverwriteComponent(e)}function _a(s){const e=s.name;if(tc.has(e))return hi.debug(`There were multiple attempts to register component ${e}.`),!1;tc.set(e,s);for(const t of ya.values())bd(t,s);for(const t of ec.values())bd(t,s);return!0}function II(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function wk(s,e,t=ga){II(s,e).clearInstance(t)}function Uy(s){return s.options!==void 0}function SI(s){return Uy(s)?!1:"authIdToken"in s||"appCheckToken"in s||"releaseOnDeref"in s||"automaticDataCollectionEnabled"in s}function Ct(s){return s==null?!1:s.settings!==void 0}function Ek(){tc.clear()}const Tk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xr=new qo("app","Firebase",Tk);let AI=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Us("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xr.create("app-deleted",{appName:this._name})}};function rE(s,e){const t=Dy(s.split(".")[1]);if(t===null||JSON.parse(t).exp===void 0)return;const a=JSON.parse(t).exp*1e3,l=new Date().getTime();a-l<=0}class Ik extends AI{constructor(e,t,r,a){const l=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,u={name:r,automaticDataCollectionEnabled:l};if(e.apiKey!==void 0)super(e,u,a);else{const m=e;super(m.options,u,a)}this._serverConfig={automaticDataCollectionEnabled:l,...t},this._serverConfig.authIdToken&&rE(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&rE(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,es(am,B0,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){By(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw xr.create("server-app-deleted")}}const Sa=vk;function zy(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const r={name:ga,automaticDataCollectionEnabled:!0,...e},a=r.name;if(typeof a!="string"||!a)throw xr.create("bad-app-name",{appName:String(a)});if(t||(t=Vy()),!t)throw xr.create("no-options");const l=ya.get(a);if(l){if(pa(t,l.options)&&pa(r,l.config))return l;throw xr.create("duplicate-app",{appName:a})}const u=new vI(a);for(const g of tc.values())u.addComponent(g);const m=new AI(t,r,u);return ya.set(a,m),m}function Sk(s,e={}){if(_C()&&!mI())throw xr.create("invalid-server-app-environment");let t,r=e||{};if(s&&(Uy(s)?t=s.options:SI(s)?r=s:t=s),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=Vy()),!t)throw xr.create("no-options");const a={...r,...t};a.releaseOnDeref!==void 0&&delete a.releaseOnDeref;const l=_=>[..._].reduce((x,T)=>Math.imul(31,x)+T.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw xr.create("finalization-registry-not-supported",{});const u=""+l(JSON.stringify(a)),m=ec.get(u);if(m)return m.incRefCount(r.releaseOnDeref),m;const g=new vI(u);for(const _ of tc.values())g.addComponent(_);const y=new Ik(t,r,u,g);return ec.set(u,y),y}function Ak(s=ga){const e=ya.get(s);if(!e&&s===ga&&Vy())return zy();if(!e)throw xr.create("no-app",{appName:s});return e}function Nk(){return Array.from(ya.values())}async function By(s){let e=!1;const t=s.name;ya.has(t)?(e=!0,ya.delete(t)):ec.has(t)&&s.decRefCount()<=0&&(ec.delete(t),e=!0),e&&(await Promise.all(s.container.getProviders().map(r=>r.delete())),s.isDeleted=!0)}function es(s,e,t){let r=xk[s]??s;t&&(r+=`-${t}`);const a=r.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${r}" with version "${e}":`];a&&u.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hi.warn(u.join(" "));return}_a(new Us(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function NI(s,e){if(s!==null&&typeof s!="function")throw xr.create("invalid-log-argument");PC(s,e)}function RI(s){jC(s)}const Rk="firebase-heartbeat-database",Ck=1,vd="firebase-heartbeat-store";let v0=null;function CI(){return v0||(v0=FC(Rk,Ck,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(vd)}catch{}}}}).catch(s=>{throw xr.create("idb-open",{originalErrorMessage:s.message})})),v0}async function kk(s){try{const t=(await CI()).transaction(vd),r=await t.objectStore(vd).get(kI(s));return await t.done,r}catch(e){if(e instanceof Gn)hi.warn(e.message);else{const t=xr.create("idb-get",{originalErrorMessage:e?.message});hi.warn(t.message)}}}async function sE(s,e){try{const r=(await CI()).transaction(vd,"readwrite");await r.objectStore(vd).put(e,kI(s)),await r.done}catch(t){if(t instanceof Gn)hi.warn(t.message);else{const r=xr.create("idb-set",{originalErrorMessage:t?.message});hi.warn(r.message)}}}function kI(s){return`${s.name}!${s.options.appId}`}const Dk=1024,jk=30;class Pk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ok(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=iE();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>jk){const a=Mk(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){hi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=iE(),{heartbeatsToSend:t,unsentEntries:r}=Vk(this._heartbeatsCache.heartbeats),a=sm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return hi.warn(e),""}}}function iE(){return new Date().toISOString().substring(0,10)}function Vk(s,e=Dk){const t=[];let r=s.slice();for(const a of s){const l=t.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),aE(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),aE(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Ok{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _d()?vC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await kk(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return sE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return sE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function aE(s){return sm(JSON.stringify({version:2,heartbeats:s})).length}function Mk(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let r=1;r<s.length;r++)s[r].date<t&&(t=s[r].date,e=r);return e}function Lk(s){_a(new Us("platform-logger",e=>new QC(e),"PRIVATE")),_a(new Us("heartbeat",e=>new Pk(e),"PRIVATE")),es(am,B0,s),es(am,B0,"esm2020"),es("fire-js","")}Lk("");const Uk=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Gn,SDK_VERSION:Sa,_DEFAULT_ENTRY_NAME:ga,_addComponent:bd,_addOrOverwriteComponent:TI,_apps:ya,_clearComponents:Ek,_components:tc,_getProvider:II,_isFirebaseApp:Uy,_isFirebaseServerApp:Ct,_isFirebaseServerAppSettings:SI,_registerComponent:_a,_removeServiceInstance:wk,_serverApps:ec,deleteApp:By,getApp:Ak,getApps:Nk,initializeApp:zy,initializeServerApp:Sk,onLog:NI,registerVersion:es,setLogLevel:RI},Symbol.toStringTag,{value:"Module"}));class zk{constructor(e,t){this._delegate=e,this.firebase=t,bd(e,new Us("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),By(this._delegate)))}_getService(e,t=ga){this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&r.getComponent()?.instantiationMode==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=ga){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){bd(this._delegate,e)}_addOrOverwriteComponent(e){TI(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Bk={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},oE=new qo("app-compat","Firebase",Bk);function qk(s){const e={},t={__esModule:!0,initializeApp:l,app:a,registerVersion:es,setLogLevel:RI,onLog:NI,apps:null,SDK_VERSION:Sa,INTERNAL:{registerComponent:m,removeApp:r,useAsService:g,modularAPIs:Uk}};t.default=t,Object.defineProperty(t,"apps",{get:u});function r(y){delete e[y]}function a(y){if(y=y||ga,!Jw(e,y))throw oE.create("no-app",{appName:y});return e[y]}a.App=s;function l(y,_={}){const x=zy(y,_);if(Jw(e,x.name))return e[x.name];const T=new s(x,t);return e[x.name]=T,T}function u(){return Object.keys(e).map(y=>e[y])}function m(y){const _=y.name,x=_.replace("-compat","");if(_a(y)&&y.type==="PUBLIC"){const T=(S=a())=>{if(typeof S[x]!="function")throw oE.create("invalid-app-argument",{appName:_});return S[x]()};y.serviceProps!==void 0&&im(T,y.serviceProps),t[x]=T,s.prototype[x]=function(...S){return this._getService.bind(this,_).apply(this,y.multipleInstances?S:[])}}return y.type==="PUBLIC"?t[x]:null}function g(y,_){return _==="serverAuth"?null:_}return t}function DI(){const s=qk(zk);s.INTERNAL={...s.INTERNAL,createFirebaseNamespace:DI,extendNamespace:e,createSubscribe:bI,ErrorFactory:qo,deepExtend:im};function e(t){im(s,t)}return s}const Fk=DI();const lE=new km("@firebase/app-compat"),Hk="@firebase/app-compat",Gk="0.5.7";function Qk(s){es(Hk,Gk,s)}try{const s=jy();if(s.firebase!==void 0){lE.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=s.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&lE.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const ts=Fk;Qk();var Kk="firebase",$k="12.8.0";ts.registerVersion(Kk,$k,"app-compat");const Lu={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},Pl={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function Yk(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function jI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Wk=Yk,Xk=jI,PI=new qo("auth","Firebase",jI());const om=new km("@firebase/auth");function Jk(s,...e){om.logLevel<=$e.WARN&&om.warn(`Auth (${Sa}): ${s}`,...e)}function qf(s,...e){om.logLevel<=$e.ERROR&&om.error(`Auth (${Sa}): ${s}`,...e)}function kn(s,...e){throw Fy(s,...e)}function fn(s,...e){return Fy(s,...e)}function qy(s,e,t){const r={...Xk(),[e]:t};return new qo("auth","Firebase",r).create(e,{appName:s.name})}function vn(s){return qy(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ic(s,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&kn(s,"argument-error"),qy(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Fy(s,...e){if(typeof s!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=s.name),s._errorFactory.create(t,...r)}return PI.create(s,...e)}function fe(s,e,...t){if(!s)throw Fy(e,...t)}function js(s){const e="INTERNAL ASSERTION FAILED: "+s;throw qf(e),new Error(e)}function is(s,e){s||js(e)}function xd(){return typeof self<"u"&&self.location?.href||""}function Hy(){return cE()==="http:"||cE()==="https:"}function cE(){return typeof self<"u"&&self.location?.protocol||null}function Zk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Hy()||pI()||"connection"in navigator)?navigator.onLine:!0}function eD(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class Bd{constructor(e,t){this.shortDelay=e,this.longDelay=t,is(t>e,"Short delay should be less than long delay!"),this.isMobile=yC()||Oy()}get(){return Zk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Gy(s,e){is(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class VI{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;js("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;js("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;js("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const tD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const nD=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rD=new Bd(3e4,6e4);function qt(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function Ft(s,e,t,r,a={}){return OI(s,a,async()=>{let l={},u={};r&&(e==="GET"?u=r:l={body:JSON.stringify(r)});const m=Tc({key:s.config.apiKey,...u}).slice(1),g=await s._getAdditionalHeaders();g["Content-Type"]="application/json",s.languageCode&&(g["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:g,...l};return bC()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&Ec(s.emulatorConfig.host)&&(y.credentials="include"),VI.fetch()(await MI(s,s.config.apiHost,t,m),y)})}async function OI(s,e,t){s._canInitEmulator=!1;const r={...tD,...e};try{const a=new iD(s),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw Yu(s,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const m=l.ok?u.errorMessage:u.error.message,[g,y]=m.split(" : ");if(g==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yu(s,"credential-already-in-use",u);if(g==="EMAIL_EXISTS")throw Yu(s,"email-already-in-use",u);if(g==="USER_DISABLED")throw Yu(s,"user-disabled",u);const _=r[g]||g.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw qy(s,_,y);kn(s,_)}}catch(a){if(a instanceof Gn)throw a;kn(s,"network-request-failed",{message:String(a)})}}async function gi(s,e,t,r,a={}){const l=await Ft(s,e,t,r,a);return"mfaPendingCredential"in l&&kn(s,"multi-factor-auth-required",{_serverResponse:l}),l}async function MI(s,e,t,r){const a=`${e}${t}?${r}`,l=s,u=l.config.emulator?Gy(s.config,a):`${s.config.apiScheme}://${a}`;return nD.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function sD(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class iD{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(fn(this.auth,"network-request-failed")),rD.get())})}}function Yu(s,e,t){const r={appName:s.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=fn(s,e,r);return a.customData._tokenResponse=t,a}function uE(s){return s!==void 0&&s.getResponse!==void 0}function dE(s){return s!==void 0&&s.enterprise!==void 0}class LI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return sD(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function aD(s){return(await Ft(s,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function UI(s,e){return Ft(s,"GET","/v2/recaptchaConfig",qt(s,e))}async function oD(s,e){return Ft(s,"POST","/v1/accounts:delete",e)}async function lD(s,e){return Ft(s,"POST","/v1/accounts:update",e)}async function lm(s,e){return Ft(s,"POST","/v1/accounts:lookup",e)}function rd(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cD(s,e=!1){const t=je(s),r=await t.getIdToken(e),a=Dm(r);fe(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:r,authTime:rd(x0(a.auth_time)),issuedAtTime:rd(x0(a.iat)),expirationTime:rd(x0(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function x0(s){return Number(s)*1e3}function Dm(s){const[e,t,r]=s.split(".");if(e===void 0||t===void 0||r===void 0)return qf("JWT malformed, contained fewer than 3 sections"),null;try{const a=Dy(t);return a?JSON.parse(a):(qf("Failed to decode base64 JWT payload"),null)}catch(a){return qf("Caught error parsing JWT payload as JSON",a?.toString()),null}}function hE(s){const e=Dm(s);return fe(e,"internal-error"),fe(typeof e.exp<"u","internal-error"),fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function fi(s,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Gn&&uD(r)&&s.auth.currentUser===s&&await s.auth.signOut(),r}}function uD({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class dD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class q0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=rd(this.lastLoginAt),this.creationTime=rd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function wd(s){const e=s.auth,t=await s.getIdToken(),r=await fi(s,lm(e,{idToken:t}));fe(r?.users.length,e,"internal-error");const a=r.users[0];s._notifyReloadListener(a);const l=a.providerUserInfo?.length?zI(a.providerUserInfo):[],u=fD(s.providerData,l),m=s.isAnonymous,g=!(s.email&&a.passwordHash)&&!u?.length,y=m?g:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new q0(a.createdAt,a.lastLoginAt),isAnonymous:y};Object.assign(s,_)}async function hD(s){const e=je(s);await wd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function fD(s,e){return[...s.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function zI(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function mD(s,e){const t=await OI(s,{},async()=>{const r=Tc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=s.config,u=await MI(s,a,"/v1/token",`key=${l}`),m=await s._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const g={method:"POST",headers:m,body:r};return s.emulatorConfig&&Ec(s.emulatorConfig.host)&&(g.credentials="include"),VI.fetch()(u,g)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function pD(s,e){return Ft(s,"POST","/v2/accounts:revokeToken",qt(s,e))}class Kl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fe(e.idToken,"internal-error"),fe(typeof e.idToken<"u","internal-error"),fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){fe(e.length!==0,"internal-error");const t=hE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:l}=await mD(e,t);this.updateTokensAndExpiration(r,a,Number(l))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:l}=t,u=new Kl;return r&&(fe(typeof r=="string","internal-error",{appName:e}),u.refreshToken=r),a&&(fe(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(fe(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Kl,this.toJSON())}_performRefresh(){return js("not implemented")}}function ea(s,e){fe(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Zr{constructor({uid:e,auth:t,stsTokenManager:r,...a}){this.providerId="firebase",this.proactiveRefresh=new dD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new q0(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await fi(this,this.stsTokenManager.getToken(this.auth,e));return fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return cD(this,e)}reload(){return hD(this)}_assign(e){this!==e&&(fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Zr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await wd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ct(this.auth.app))return Promise.reject(vn(this.auth));const e=await this.getIdToken();return await fi(this,oD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,m=t.tenantId??void 0,g=t._redirectEventId??void 0,y=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:x,emailVerified:T,isAnonymous:S,providerData:V,stsTokenManager:U}=t;fe(x&&U,e,"internal-error");const $=Kl.fromJSON(this.name,U);fe(typeof x=="string",e,"internal-error"),ea(r,e.name),ea(a,e.name),fe(typeof T=="boolean",e,"internal-error"),fe(typeof S=="boolean",e,"internal-error"),ea(l,e.name),ea(u,e.name),ea(m,e.name),ea(g,e.name),ea(y,e.name),ea(_,e.name);const H=new Zr({uid:x,auth:e,email:a,emailVerified:T,displayName:r,isAnonymous:S,photoURL:u,phoneNumber:l,tenantId:m,stsTokenManager:$,createdAt:y,lastLoginAt:_});return V&&Array.isArray(V)&&(H.providerData=V.map(se=>({...se}))),g&&(H._redirectEventId=g),H}static async _fromIdTokenResponse(e,t,r=!1){const a=new Kl;a.updateFromServerResponse(t);const l=new Zr({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await wd(l),l}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];fe(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?zI(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,m=new Kl;m.updateFromIdToken(r);const g=new Zr({uid:a.localId,auth:e,stsTokenManager:m,isAnonymous:u}),y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new q0(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(g,y),g}}const fE=new Map;function vr(s){is(s instanceof Function,"Expected a class definition");let e=fE.get(s);return e?(is(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,fE.set(s,e),e)}class BI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}BI.type="NONE";const nc=BI;function Io(s,e,t){return`firebase:${s}:${e}:${t}`}class $l{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:l}=this.auth;this.fullUserKey=Io(this.userKey,a.apiKey,l),this.fullPersistenceKey=Io("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await lm(this.auth,{idToken:e}).catch(()=>{});return t?Zr._fromGetAccountInfoResponse(this.auth,t,e):null}return Zr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new $l(vr(nc),e,r);const a=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=a[0]||vr(nc);const u=Io(r,e.config.apiKey,e.name);let m=null;for(const y of t)try{const _=await y._get(u);if(_){let x;if(typeof _=="string"){const T=await lm(e,{idToken:_}).catch(()=>{});if(!T)break;x=await Zr._fromGetAccountInfoResponse(e,T,_)}else x=Zr._fromJSON(e,_);y!==l&&(m=x),l=y;break}}catch{}const g=a.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!g.length?new $l(l,e,r):(l=g[0],m&&await l._set(u,m.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(u)}catch{}})),new $l(l,e,r))}}function mE(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(GI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(qI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(QI(e))return"Blackberry";if(KI(e))return"Webos";if(FI(e))return"Safari";if((e.includes("chrome/")||HI(e))&&!e.includes("edge/"))return"Chrome";if(qd(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=s.match(t);if(r?.length===2)return r[1]}return"Other"}function qI(s=Ot()){return/firefox\//i.test(s)}function FI(s=Ot()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function HI(s=Ot()){return/crios\//i.test(s)}function GI(s=Ot()){return/iemobile/i.test(s)}function qd(s=Ot()){return/android/i.test(s)}function QI(s=Ot()){return/blackberry/i.test(s)}function KI(s=Ot()){return/webos/i.test(s)}function Fd(s=Ot()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function gD(s=Ot()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(s)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(s)}function yD(s=Ot()){return Fd(s)&&!!window.navigator?.standalone}function _D(){return gI()&&document.documentMode===10}function $I(s=Ot()){return Fd(s)||qd(s)||KI(s)||QI(s)||/windows phone/i.test(s)||GI(s)}function YI(s,e=[]){let t;switch(s){case"Browser":t=mE(Ot());break;case"Worker":t=`${mE(Ot())}-${s}`;break;default:t=s}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Sa}/${r}`}class bD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=l=>new Promise((u,m)=>{try{const g=e(l);u(g)}catch(g){m(g)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function vD(s,e={}){return Ft(s,"GET","/v2/passwordPolicy",qt(s,e))}const xD=6;class wD{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??xD,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class ED{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pE(this),this.idTokenSubscription=new pE(this),this.beforeStateQueue=new bD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=PI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=vr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await $l.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await lm(this,{idToken:e}),r=await Zr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch{await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ct(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=r?._redirectEventId,m=await this.tryRedirectSignIn(e);(!l||l===u)&&m?.user&&(r=m.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(l){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await wd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ct(this.app))return Promise.reject(vn(this));const t=e?je(e):null;return t&&fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ct(this.app)?Promise.reject(vn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ct(this.app)?Promise.reject(vn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(vr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await vD(this),t=new wD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qo("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await pD(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&vr(e)||this._popupRedirectResolver;fe(t,this,"argument-error"),this.redirectPersistenceManager=await $l.create(this,[vr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(m,this,"internal-error"),m.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const g=e.addObserver(t,r,a);return()=>{u=!0,g()}}else{const g=e.addObserver(t);return()=>{u=!0,g()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=YI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ct(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Jk(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Mt(s){return je(s)}class pE{constructor(e){this.auth=e,this.observer=null,this.addObserver=bI(t=>this.observer=t)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Hd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function TD(s){Hd=s}function Qy(s){return Hd.loadJS(s)}function ID(){return Hd.recaptchaV2Script}function SD(){return Hd.recaptchaEnterpriseScript}function AD(){return Hd.gapiScript}function WI(s){return`__${s}${Math.floor(Math.random()*1e6)}`}const ND=500,RD=6e4,jf=1e12;class CD{constructor(e){this.auth=e,this.counter=jf,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new jD(e,this.auth.name,t||{})),this.counter++,r}reset(e){const t=e||jf;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||jf;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||jf;return this._widgets.get(t)?.execute(),""}}class kD{constructor(){this.enterprise=new DD}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class DD{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class jD{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const a=typeof e=="string"?document.getElementById(e):e;fe(a,"argument-error",{appName:t}),this.container=a,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=PD(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},RD)},ND))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function PD(s){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<s;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const VD="recaptcha-enterprise",sd="NO_RECAPTCHA";class XI{constructor(e){this.type=VD,this.auth=Mt(e)}async verify(e="verify",t=!1){async function r(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,m)=>{UI(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(g=>{if(g.recaptchaKey===void 0)m(new Error("recaptcha Enterprise site key undefined"));else{const y=new LI(g);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,u(y.siteKey)}}).catch(g=>{m(g)})})}function a(l,u,m){const g=window.grecaptcha;dE(g)?g.enterprise.ready(()=>{g.enterprise.execute(l,{action:e}).then(y=>{u(y)}).catch(()=>{u(sd)})}):m(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new kD().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{r(this.auth).then(m=>{if(!t&&dE(window.grecaptcha))a(m,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let g=SD();g.length!==0&&(g+=m),Qy(g).then(()=>{a(m,l,u)}).catch(y=>{u(y)})}}).catch(m=>{u(m)})})}}async function Uu(s,e,t,r=!1,a=!1){const l=new XI(s);let u;if(a)u=sd;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const m={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in m){const g=m.phoneEnrollmentInfo.phoneNumber,y=m.phoneEnrollmentInfo.recaptchaToken;Object.assign(m,{phoneEnrollmentInfo:{phoneNumber:g,recaptchaToken:y,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in m){const g=m.phoneSignInInfo.recaptchaToken;Object.assign(m,{phoneSignInInfo:{recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return m}return r?Object.assign(m,{captchaResp:u}):Object.assign(m,{captchaResponse:u}),Object.assign(m,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(m,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),m}async function da(s,e,t,r,a){if(a==="EMAIL_PASSWORD_PROVIDER")if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await Uu(s,e,t,t==="getOobCode");return r(s,l)}else return r(s,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){const u=await Uu(s,e,t,t==="getOobCode");return r(s,u)}else return Promise.reject(l)});else if(a==="PHONE_PROVIDER")if(s._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const l=await Uu(s,e,t);return r(s,l).catch(async u=>{if(s._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(u.code==="auth/missing-recaptcha-token"||u.code==="auth/invalid-app-credential")){const m=await Uu(s,e,t,!1,!0);return r(s,m)}return Promise.reject(u)})}else{const l=await Uu(s,e,t,!1,!0);return r(s,l)}else return Promise.reject(a+" provider is not supported.")}async function OD(s){const e=Mt(s),t=await UI(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new LI(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new XI(e).verify()}function MD(s,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(vr);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(r,e?.popupRedirectResolver)}function LD(s,e,t){const r=Mt(s);fe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!!t?.disableWarnings,l=JI(e),{host:u,port:m}=UD(e),g=m===null?"":`:${m}`,y={url:`${l}//${u}${g}/`},_=Object.freeze({host:u,port:m,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){fe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),fe(pa(y,r.config.emulator)&&pa(_,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=y,r.emulatorConfig=_,r.settings.appVerificationDisabledForTesting=!0,Ec(u)?(hI(`${l}//${u}${g}`),fI("Auth",!0)):a||zD()}function JI(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function UD(s){const e=JI(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const l=a[1];return{host:l,port:gE(r.substr(l.length+1))}}else{const[l,u]=r.split(":");return{host:l,port:gE(u)}}}function gE(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function zD(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class Sc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return js("not implemented")}_getIdTokenResponse(e){return js("not implemented")}_linkToIdToken(e,t){return js("not implemented")}_getReauthenticationResolver(e){return js("not implemented")}}async function ZI(s,e){return Ft(s,"POST","/v1/accounts:resetPassword",qt(s,e))}async function BD(s,e){return Ft(s,"POST","/v1/accounts:update",e)}async function qD(s,e){return Ft(s,"POST","/v1/accounts:signUp",e)}async function FD(s,e){return Ft(s,"POST","/v1/accounts:update",qt(s,e))}async function HD(s,e){return gi(s,"POST","/v1/accounts:signInWithPassword",qt(s,e))}async function jm(s,e){return Ft(s,"POST","/v1/accounts:sendOobCode",qt(s,e))}async function GD(s,e){return jm(s,e)}async function QD(s,e){return jm(s,e)}async function KD(s,e){return jm(s,e)}async function $D(s,e){return jm(s,e)}async function YD(s,e){return gi(s,"POST","/v1/accounts:signInWithEmailLink",qt(s,e))}async function WD(s,e){return gi(s,"POST","/v1/accounts:signInWithEmailLink",qt(s,e))}class Ed extends Sc{constructor(e,t,r,a=null){super("password",r),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Ed(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Ed(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return da(e,t,"signInWithPassword",HD,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return YD(e,{email:this._email,oobCode:this._password});default:kn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return da(e,r,"signUpPassword",qD,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return WD(e,{idToken:t,email:this._email,oobCode:this._password});default:kn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function di(s,e){return gi(s,"POST","/v1/accounts:signInWithIdp",qt(s,e))}const XD="http://localhost";class zs extends Sc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new zs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):kn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,...l}=t;if(!r||!a)return null;const u=new zs(r,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return di(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,di(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,di(e,t)}buildRequest(){const e={requestUri:XD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Tc(t)}return e}}async function yE(s,e){return Ft(s,"POST","/v1/accounts:sendVerificationCode",qt(s,e))}async function JD(s,e){return gi(s,"POST","/v1/accounts:signInWithPhoneNumber",qt(s,e))}async function ZD(s,e){const t=await gi(s,"POST","/v1/accounts:signInWithPhoneNumber",qt(s,e));if(t.temporaryProof)throw Yu(s,"account-exists-with-different-credential",t);return t}const ej={USER_NOT_FOUND:"user-not-found"};async function tj(s,e){const t={...e,operation:"REAUTH"};return gi(s,"POST","/v1/accounts:signInWithPhoneNumber",qt(s,t),ej)}class So extends Sc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new So({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new So({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return JD(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return ZD(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return tj(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:a}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:a}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:a,temporaryProof:l}=e;return!r&&!t&&!a&&!l?null:new So({verificationId:t,verificationCode:r,phoneNumber:a,temporaryProof:l})}}function nj(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function rj(s){const e=Ql($u(s)).link,t=e?Ql($u(e)).deep_link_id:null,r=Ql($u(s)).deep_link_id;return(r?Ql($u(r)).link:null)||r||t||e||s}class Pm{constructor(e){const t=Ql($u(e)),r=t.apiKey??null,a=t.oobCode??null,l=nj(t.mode??null);fe(r&&a&&l,"argument-error"),this.apiKey=r,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=rj(e);try{return new Pm(t)}catch{return null}}}class Aa{constructor(){this.providerId=Aa.PROVIDER_ID}static credential(e,t){return Ed._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Pm.parseLink(t);return fe(r,"argument-error"),Ed._fromEmailAndCode(e,r.code,r.tenantId)}}Aa.PROVIDER_ID="password";Aa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Aa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class yi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ac extends yi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Yl extends Ac{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return fe("providerId"in t&&"signInMethod"in t,"argument-error"),zs._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return fe(e.idToken||e.accessToken,"argument-error"),zs._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Yl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Yl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:a,pendingToken:l,nonce:u,providerId:m}=e;if(!r&&!a&&!t&&!l||!m)return null;try{return new Yl(m)._credential({idToken:t,accessToken:r,nonce:u,pendingToken:l})}catch{return null}}}class Rs extends Ac{constructor(){super("facebook.com")}static credential(e){return zs._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rs.credential(e.oauthAccessToken)}catch{return null}}}Rs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Rs.PROVIDER_ID="facebook.com";class Cs extends Ac{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return zs._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Cs.credential(t,r)}catch{return null}}}Cs.GOOGLE_SIGN_IN_METHOD="google.com";Cs.PROVIDER_ID="google.com";class ks extends Ac{constructor(){super("github.com")}static credential(e){return zs._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ks.credential(e.oauthAccessToken)}catch{return null}}}ks.GITHUB_SIGN_IN_METHOD="github.com";ks.PROVIDER_ID="github.com";const sj="http://localhost";class rc extends Sc{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return di(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,di(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,di(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,pendingToken:l}=t;return!r||!a||!l||r!==a?null:new rc(r,l)}static _create(e,t){return new rc(e,t)}buildRequest(){return{requestUri:sj,returnSecureToken:!0,pendingToken:this.pendingToken}}}const ij="saml.";class cm extends yi{constructor(e){fe(e.startsWith(ij),"argument-error"),super(e)}static credentialFromResult(e){return cm.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return cm.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=rc.fromJSON(e);return fe(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return rc._create(r,t)}catch{return null}}}class Ds extends Ac{constructor(){super("twitter.com")}static credential(e,t){return zs._fromParams({providerId:Ds.PROVIDER_ID,signInMethod:Ds.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ds.credentialFromTaggedObject(e)}static credentialFromError(e){return Ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ds.credential(t,r)}catch{return null}}}Ds.TWITTER_SIGN_IN_METHOD="twitter.com";Ds.PROVIDER_ID="twitter.com";async function eS(s,e){return gi(s,"POST","/v1/accounts:signUp",qt(s,e))}class Lr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const l=await Zr._fromIdTokenResponse(e,r,a),u=_E(r);return new Lr({user:l,providerId:u,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=_E(r);return new Lr({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function _E(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}async function aj(s){if(Ct(s.app))return Promise.reject(vn(s));const e=Mt(s);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Lr({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await eS(e,{returnSecureToken:!0}),r=await Lr._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class um extends Gn{constructor(e,t,r,a){super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,um.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new um(e,t,r,a)}}function tS(s,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?um._fromErrorAndOperation(s,l,e,r):l})}function nS(s){return new Set(s.map(({providerId:e})=>e).filter(e=>!!e))}async function oj(s,e){const t=je(s);await Vm(!0,t,e);const{providerUserInfo:r}=await lD(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=nS(r||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Ky(s,e,t=!1){const r=await fi(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Lr._forOperation(s,"link",r)}async function Vm(s,e,t){await wd(e);const r=nS(e.providerData),a=s===!1?"provider-already-linked":"no-such-provider";fe(r.has(t)===s,e.auth,a)}async function rS(s,e,t=!1){const{auth:r}=s;if(Ct(r.app))return Promise.reject(vn(r));const a="reauthenticate";try{const l=await fi(s,tS(r,a,e,s),t);fe(l.idToken,r,"internal-error");const u=Dm(l.idToken);fe(u,r,"internal-error");const{sub:m}=u;return fe(s.uid===m,r,"user-mismatch"),Lr._forOperation(s,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&kn(r,"user-mismatch"),l}}async function sS(s,e,t=!1){if(Ct(s.app))return Promise.reject(vn(s));const r="signIn",a=await tS(s,r,e),l=await Lr._fromIdTokenResponse(s,r,a);return t||await s._updateCurrentUser(l.user),l}async function Om(s,e){return sS(Mt(s),e)}async function iS(s,e){const t=je(s);return await Vm(!1,t,e.providerId),Ky(t,e)}async function aS(s,e){return rS(je(s),e)}async function lj(s,e){return gi(s,"POST","/v1/accounts:signInWithCustomToken",qt(s,e))}async function cj(s,e){if(Ct(s.app))return Promise.reject(vn(s));const t=Mt(s),r=await lj(t,{token:e,returnSecureToken:!0}),a=await Lr._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(a.user),a}class Gd{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?$y._fromServerResponse(e,t):"totpInfo"in t?Yy._fromServerResponse(e,t):kn(e,"internal-error")}}class $y extends Gd{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new $y(t)}}class Yy extends Gd{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Yy(t)}}function Mm(s,e,t){fe(t.url?.length>0,s,"invalid-continue-uri"),fe(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,s,"invalid-dynamic-link-domain"),fe(typeof t.linkDomain>"u"||t.linkDomain.length>0,s,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(fe(t.iOS.bundleId.length>0,s,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(fe(t.android.packageName.length>0,s,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function Wy(s){const e=Mt(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function uj(s,e,t){const r=Mt(s),a={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Mm(r,a,t),await da(r,a,"getOobCode",QD,"EMAIL_PASSWORD_PROVIDER")}async function dj(s,e,t){await ZI(je(s),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Wy(s),r})}async function hj(s,e){await FD(je(s),{oobCode:e})}async function oS(s,e){const t=je(s),r=await ZI(t,{oobCode:e}),a=r.requestType;switch(fe(a,t,"internal-error"),a){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":fe(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":fe(r.mfaInfo,t,"internal-error");default:fe(r.email,t,"internal-error")}let l=null;return r.mfaInfo&&(l=Gd._fromServerResponse(Mt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:l},operation:a}}async function fj(s,e){const{data:t}=await oS(je(s),e);return t.email}async function mj(s,e,t){if(Ct(s.app))return Promise.reject(vn(s));const r=Mt(s),u=await da(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",eS,"EMAIL_PASSWORD_PROVIDER").catch(g=>{throw g.code==="auth/password-does-not-meet-requirements"&&Wy(s),g}),m=await Lr._fromIdTokenResponse(r,"signIn",u);return await r._updateCurrentUser(m.user),m}function pj(s,e,t){return Ct(s.app)?Promise.reject(vn(s)):Om(je(s),Aa.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Wy(s),r})}async function gj(s,e,t){const r=Mt(s),a={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function l(u,m){fe(m.handleCodeInApp,r,"argument-error"),m&&Mm(r,u,m)}l(a,t),await da(r,a,"getOobCode",KD,"EMAIL_PASSWORD_PROVIDER")}function yj(s,e){return Pm.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function _j(s,e,t){if(Ct(s.app))return Promise.reject(vn(s));const r=je(s),a=Aa.credentialWithLink(e,t||xd());return fe(a._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Om(r,a)}async function bj(s,e){return Ft(s,"POST","/v1/accounts:createAuthUri",qt(s,e))}async function vj(s,e){const t=Hy()?xd():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:a}=await bj(je(s),r);return a||[]}async function xj(s,e){const t=je(s),a={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()};e&&Mm(t.auth,a,e);const{email:l}=await GD(t.auth,a);l!==s.email&&await s.reload()}async function wj(s,e,t){const r=je(s),l={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await s.getIdToken(),newEmail:e};t&&Mm(r.auth,l,t);const{email:u}=await $D(r.auth,l);u!==s.email&&await s.reload()}async function Ej(s,e){return Ft(s,"POST","/v1/accounts:update",e)}async function Tj(s,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=je(s),l={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await fi(r,Ej(r.auth,l));r.displayName=u.displayName||null,r.photoURL=u.photoUrl||null;const m=r.providerData.find(({providerId:g})=>g==="password");m&&(m.displayName=r.displayName,m.photoURL=r.photoURL),await r._updateTokensIfNecessary(u)}function Ij(s,e){const t=je(s);return Ct(t.auth.app)?Promise.reject(vn(t.auth)):lS(t,e,null)}function Sj(s,e){return lS(je(s),null,e)}async function lS(s,e,t){const{auth:r}=s,l={idToken:await s.getIdToken(),returnSecureToken:!0};e&&(l.email=e),t&&(l.password=t);const u=await fi(s,BD(r,l));await s._updateTokensIfNecessary(u,!0)}function Aj(s){if(!s)return null;const{providerId:e}=s,t=s.rawUserInfo?JSON.parse(s.rawUserInfo):{},r=s.isNewUser||s.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&s?.idToken){const a=Dm(s.idToken)?.firebase?.sign_in_provider;if(a){const l=a!=="anonymous"&&a!=="custom"?a:null;return new Wl(r,l)}}if(!e)return null;switch(e){case"facebook.com":return new Nj(r,t);case"github.com":return new Rj(r,t);case"google.com":return new Cj(r,t);case"twitter.com":return new kj(r,t,s.screenName||null);case"custom":case"anonymous":return new Wl(r,null);default:return new Wl(r,e,t)}}class Wl{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class cS extends Wl{constructor(e,t,r,a){super(e,t,r),this.username=a}}class Nj extends Wl{constructor(e,t){super(e,"facebook.com",t)}}class Rj extends cS{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}}class Cj extends Wl{constructor(e,t){super(e,"google.com",t)}}class kj extends cS{constructor(e,t,r){super(e,"twitter.com",t,r)}}function Dj(s){const{user:e,_tokenResponse:t}=s;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:Aj(t)}class bo{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new bo("enroll",e,t)}static _fromMfaPendingCredential(e){return new bo("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return bo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return bo._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Xy{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Mt(e),a=t.customData._serverResponse,l=(a.mfaInfo||[]).map(m=>Gd._fromServerResponse(r,m));fe(a.mfaPendingCredential,r,"internal-error");const u=bo._fromMfaPendingCredential(a.mfaPendingCredential);return new Xy(u,l,async m=>{const g=await m._process(r,u);delete a.mfaInfo,delete a.mfaPendingCredential;const y={...a,idToken:g.idToken,refreshToken:g.refreshToken};switch(t.operationType){case"signIn":const _=await Lr._fromIdTokenResponse(r,t.operationType,y);return await r._updateCurrentUser(_.user),_;case"reauthenticate":return fe(t.user,r,"internal-error"),Lr._forOperation(t.user,t.operationType,y);default:kn(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function jj(s,e){const t=je(s),r=e;return fe(e.customData.operationType,t,"argument-error"),fe(r.customData._serverResponse?.mfaPendingCredential,t,"argument-error"),Xy._fromError(t,r)}function bE(s,e){return Ft(s,"POST","/v2/accounts/mfaEnrollment:start",qt(s,e))}function Pj(s,e){return Ft(s,"POST","/v2/accounts/mfaEnrollment:finalize",qt(s,e))}function Vj(s,e){return Ft(s,"POST","/v2/accounts/mfaEnrollment:withdraw",qt(s,e))}class Jy{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Gd._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new Jy(e)}async getSession(){return bo._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,a=await this.getSession(),l=await fi(this.user,r._process(this.user.auth,a,t));return await this.user._updateTokensIfNecessary(l),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const a=await fi(this.user,Vj(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:l})=>l!==t),await this.user._updateTokensIfNecessary(a),await this.user.reload()}catch(a){throw a}}}const w0=new WeakMap;function Oj(s){const e=je(s);return w0.has(e)||w0.set(e,Jy._fromUser(e)),w0.get(e)}const dm="__sak";class uS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(dm,"1"),this.storage.removeItem(dm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Mj=1e3,Lj=10;class dS extends uS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=$I(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,m,g)=>{this.notifyListeners(u,g)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(r);!t&&this.localCache[r]===u||this.notifyListeners(r,u)},l=this.storage.getItem(r);_D()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Lj):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Mj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}dS.type="LOCAL";const Zy=dS;class hS extends uS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}hS.type="SESSION";const No=hS;function Uj(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Lm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new Lm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:l}=t.data,u=this.handlersMap[a];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const m=Array.from(u).map(async y=>y(t.origin,l)),g=await Uj(m);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:g})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Lm.receivers=[];function Qd(s="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return s+t}class zj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((m,g)=>{const y=Qd("",20);a.port1.start();const _=setTimeout(()=>{g(new Error("unsupported_event"))},r);u={messageChannel:a,onMessage(x){const T=x;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{g(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),m(T.data.response);break;default:clearTimeout(_),clearTimeout(l),g(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function ln(){return window}function Bj(s){ln().location.href=s}function e_(){return typeof ln().WorkerGlobalScope<"u"&&typeof ln().importScripts=="function"}async function qj(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Fj(){return navigator?.serviceWorker?.controller||null}function Hj(){return e_()?self:null}const fS="firebaseLocalStorageDb",Gj=1,hm="firebaseLocalStorage",mS="fbase_key";class Kd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Um(s,e){return s.transaction([hm],e?"readwrite":"readonly").objectStore(hm)}function Qj(){const s=indexedDB.deleteDatabase(fS);return new Kd(s).toPromise()}function F0(){const s=indexedDB.open(fS,Gj);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const r=s.result;try{r.createObjectStore(hm,{keyPath:mS})}catch(a){t(a)}}),s.addEventListener("success",async()=>{const r=s.result;r.objectStoreNames.contains(hm)?e(r):(r.close(),await Qj(),e(await F0()))})})}async function vE(s,e,t){const r=Um(s,!0).put({[mS]:e,value:t});return new Kd(r).toPromise()}async function Kj(s,e){const t=Um(s,!1).get(e),r=await new Kd(t).toPromise();return r===void 0?null:r.value}function xE(s,e){const t=Um(s,!0).delete(e);return new Kd(t).toPromise()}const $j=800,Yj=3;class pS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await F0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>Yj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return e_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Lm._getInstance(Hj()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await qj(),!this.activeServiceWorker)return;this.sender=new zj(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Fj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await F0();return await vE(e,dm,"1"),await xE(e,dm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>vE(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Kj(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>xE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Um(a,!1).getAll();return new Kd(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$j)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}pS.type="LOCAL";const Td=pS;function wE(s,e){return Ft(s,"POST","/v2/accounts/mfaSignIn:start",qt(s,e))}function Wj(s,e){return Ft(s,"POST","/v2/accounts/mfaSignIn:finalize",qt(s,e))}const E0=WI("rcb"),Xj=new Bd(3e4,6e4);class Jj{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!ln().grecaptcha?.render}load(e,t=""){return fe(Zj(t),e,"argument-error"),this.shouldResolveImmediately(t)&&uE(ln().grecaptcha)?Promise.resolve(ln().grecaptcha):new Promise((r,a)=>{const l=ln().setTimeout(()=>{a(fn(e,"network-request-failed"))},Xj.get());ln()[E0]=()=>{ln().clearTimeout(l),delete ln()[E0];const m=ln().grecaptcha;if(!m||!uE(m)){a(fn(e,"internal-error"));return}const g=m.render;m.render=(y,_)=>{const x=g(y,_);return this.counter++,x},this.hostLanguage=t,r(m)};const u=`${ID()}?${Tc({onload:E0,render:"explicit",hl:t})}`;Qy(u).catch(()=>{clearTimeout(l),a(fn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!ln().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function Zj(s){return s.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(s)}class eP{async load(e){return new CD(e)}clearedOneInstance(){}}const id="recaptcha",tP={theme:"light",type:"image"};let nP=class{constructor(e,t,r={...tP}){this.parameters=r,this.type=id,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Mt(e),this.isInvisible=this.parameters.size==="invisible",fe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const a=typeof t=="string"?document.getElementById(t):t;fe(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new eP:new Jj,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(a=>{const l=u=>{u&&(this.tokenChangeListeners.delete(l),a(u))};this.tokenChangeListeners.add(l),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){fe(!this.parameters.sitekey,this.auth,"argument-error"),fe(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),fe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=ln()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){fe(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){fe(Hy()&&!e_(),this.auth,"internal-error"),await rP(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await aD(this.auth);fe(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return fe(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function rP(){let s=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}s=()=>e(),window.addEventListener("load",s)}).catch(e=>{throw s&&window.removeEventListener("load",s),e})}class t_{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=So._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function sP(s,e,t){if(Ct(s.app))return Promise.reject(vn(s));const r=Mt(s),a=await zm(r,e,je(t));return new t_(a,l=>Om(r,l))}async function iP(s,e,t){const r=je(s);await Vm(!1,r,"phone");const a=await zm(r.auth,e,je(t));return new t_(a,l=>iS(r,l))}async function aP(s,e,t){const r=je(s);if(Ct(r.auth.app))return Promise.reject(vn(r.auth));const a=await zm(r.auth,e,je(t));return new t_(a,l=>aS(r,l))}async function zm(s,e,t){if(!s._getRecaptchaConfig())try{await OD(s)}catch{}try{let r;if(typeof e=="string"?r={phoneNumber:e}:r=e,"session"in r){const a=r.session;if("phoneNumber"in r){fe(a.type==="enroll",s,"internal-error");const l={idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await da(s,l,"mfaSmsEnrollment",async(y,_)=>{if(_.phoneEnrollmentInfo.captchaResponse===sd){fe(t?.type===id,y,"argument-error");const x=await T0(y,_,t);return bE(y,x)}return bE(y,_)},"PHONE_PROVIDER").catch(y=>Promise.reject(y))).phoneSessionInfo.sessionInfo}else{fe(a.type==="signin",s,"internal-error");const l=r.multiFactorHint?.uid||r.multiFactorUid;fe(l,s,"missing-multi-factor-info");const u={mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await da(s,u,"mfaSmsSignIn",async(_,x)=>{if(x.phoneSignInInfo.captchaResponse===sd){fe(t?.type===id,_,"argument-error");const T=await T0(_,x,t);return wE(_,T)}return wE(_,x)},"PHONE_PROVIDER").catch(_=>Promise.reject(_))).phoneResponseInfo.sessionInfo}}else{const a={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await da(s,a,"sendVerificationCode",async(g,y)=>{if(y.captchaResponse===sd){fe(t?.type===id,g,"argument-error");const _=await T0(g,y,t);return yE(g,_)}return yE(g,y)},"PHONE_PROVIDER").catch(g=>Promise.reject(g))).sessionInfo}}finally{t?._reset()}}async function oP(s,e){const t=je(s);if(Ct(t.auth.app))return Promise.reject(vn(t.auth));await Ky(t,e)}async function T0(s,e,t){fe(t.type===id,s,"argument-error");const r=await t.verify();fe(typeof r=="string",s,"argument-error");const a={...e};if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.captchaResponse,m=a.phoneEnrollmentInfo.clientType,g=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:r,captchaResponse:u,clientType:m,recaptchaVersion:g}}),a}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.captchaResponse,u=a.phoneSignInInfo.clientType,m=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:l,clientType:u,recaptchaVersion:m}}),a}else return Object.assign(a,{recaptchaToken:r}),a}let Ro=class Ff{constructor(e){this.providerId=Ff.PROVIDER_ID,this.auth=Mt(e)}verifyPhoneNumber(e,t){return zm(this.auth,e,je(t))}static credential(e,t){return So._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Ff.credentialFromTaggedObject(t)}static credentialFromError(e){return Ff.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?So._fromTokenResponse(t,r):null}};Ro.PROVIDER_ID="phone";Ro.PHONE_SIGN_IN_METHOD="phone";function Fo(s,e){return e?vr(e):(fe(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class n_ extends Sc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return di(e,this._buildIdpRequest())}_linkToIdToken(e,t){return di(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return di(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function lP(s){return sS(s.auth,new n_(s),s.bypassAuthState)}function cP(s){const{auth:e,user:t}=s;return fe(t,e,"internal-error"),rS(t,new n_(s),s.bypassAuthState)}async function uP(s){const{auth:e,user:t}=s;return fe(t,e,"internal-error"),Ky(t,new n_(s),s.bypassAuthState)}class gS{constructor(e,t,r,a,l=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:l,error:u,type:m}=e;if(u){this.reject(u);return}const g={auth:this.auth,requestUri:t,sessionId:r,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(g))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lP;case"linkViaPopup":case"linkViaRedirect":return uP;case"reauthViaPopup":case"reauthViaRedirect":return cP;default:kn(this.auth,"internal-error")}}resolve(e){is(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){is(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const dP=new Bd(2e3,1e4);async function hP(s,e,t){if(Ct(s.app))return Promise.reject(fn(s,"operation-not-supported-in-this-environment"));const r=Mt(s);Ic(s,e,yi);const a=Fo(r,t);return new ci(r,"signInViaPopup",e,a).executeNotNull()}async function fP(s,e,t){const r=je(s);if(Ct(r.auth.app))return Promise.reject(fn(r.auth,"operation-not-supported-in-this-environment"));Ic(r.auth,e,yi);const a=Fo(r.auth,t);return new ci(r.auth,"reauthViaPopup",e,a,r).executeNotNull()}async function mP(s,e,t){const r=je(s);Ic(r.auth,e,yi);const a=Fo(r.auth,t);return new ci(r.auth,"linkViaPopup",e,a,r).executeNotNull()}class ci extends gS{constructor(e,t,r,a,l){super(e,t,a,l),this.provider=r,this.authWindow=null,this.pollId=null,ci.currentPopupAction&&ci.currentPopupAction.cancel(),ci.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fe(e,this.auth,"internal-error"),e}async onExecution(){is(this.filter.length===1,"Popup operations only handle one event");const e=Qd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(fn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(fn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ci.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,dP.get())};e()}}ci.currentPopupAction=null;const pP="pendingRedirect",ad=new Map;class gP extends gS{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=ad.get(this.auth._key());if(!e){try{const r=await yP(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ad.set(this.auth._key(),e)}return this.bypassAuthState||ad.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function yP(s,e){const t=_S(e),r=yS(s);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}async function r_(s,e){return yS(s)._set(_S(e),"true")}function _P(){ad.clear()}function s_(s,e){ad.set(s._key(),e)}function yS(s){return vr(s._redirectPersistence)}function _S(s){return Io(pP,s.config.apiKey,s.name)}function bP(s,e,t){return vP(s,e,t)}async function vP(s,e,t){if(Ct(s.app))return Promise.reject(vn(s));const r=Mt(s);Ic(s,e,yi),await r._initializationPromise;const a=Fo(r,t);return await r_(a,r),a._openRedirect(r,e,"signInViaRedirect")}function xP(s,e,t){return wP(s,e,t)}async function wP(s,e,t){const r=je(s);if(Ic(r.auth,e,yi),Ct(r.auth.app))return Promise.reject(vn(r.auth));await r.auth._initializationPromise;const a=Fo(r.auth,t);await r_(a,r.auth);const l=await bS(r);return a._openRedirect(r.auth,e,"reauthViaRedirect",l)}function EP(s,e,t){return TP(s,e,t)}async function TP(s,e,t){const r=je(s);Ic(r.auth,e,yi),await r.auth._initializationPromise;const a=Fo(r.auth,t);await Vm(!1,r,e.providerId),await r_(a,r.auth);const l=await bS(r);return a._openRedirect(r.auth,e,"linkViaRedirect",l)}async function IP(s,e){return await Mt(s)._initializationPromise,Bm(s,e,!1)}async function Bm(s,e,t=!1){if(Ct(s.app))return Promise.reject(vn(s));const r=Mt(s),a=Fo(r,e),u=await new gP(r,a,t).execute();return u&&!t&&(delete u.user._redirectEventId,await r._persistUserIfCurrent(u.user),await r._setRedirectUser(null,e)),u}async function bS(s){const e=Qd(`${s.uid}:::`);return s._redirectEventId=e,await s.auth._setRedirectUser(s),await s.auth._persistUserIfCurrent(s),e}const SP=600*1e3;class vS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!AP(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!xS(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(fn(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=SP&&this.cachedEventUids.clear(),this.cachedEventUids.has(EE(e))}saveEventToCache(e){this.cachedEventUids.add(EE(e)),this.lastProcessedEventTime=Date.now()}}function EE(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function xS({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function AP(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xS(s);default:return!1}}async function wS(s,e={}){return Ft(s,"GET","/v1/projects",e)}const NP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,RP=/^https?/;async function CP(s){if(s.config.emulator)return;const{authorizedDomains:e}=await wS(s);for(const t of e)try{if(kP(t))return}catch{}kn(s,"unauthorized-domain")}function kP(s){const e=xd(),{protocol:t,hostname:r}=new URL(e);if(s.startsWith("chrome-extension://")){const u=new URL(s);return u.hostname===""&&r===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===r}if(!RP.test(t))return!1;if(NP.test(s))return r===s;const a=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const DP=new Bd(3e4,6e4);function TE(){const s=ln().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function jP(s){return new Promise((e,t)=>{function r(){TE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{TE(),t(fn(s,"network-request-failed"))},timeout:DP.get()})}if(ln().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ln().gapi?.load)r();else{const a=WI("iframefcb");return ln()[a]=()=>{gapi.load?r():t(fn(s,"network-request-failed"))},Qy(`${AD()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Hf=null,e})}let Hf=null;function PP(s){return Hf=Hf||jP(s),Hf}const VP=new Bd(5e3,15e3),OP="__/auth/iframe",MP="emulator/auth/iframe",LP={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},UP=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function zP(s){const e=s.config;fe(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?Gy(e,MP):`https://${s.config.authDomain}/${OP}`,r={apiKey:e.apiKey,appName:s.name,v:Sa},a=UP.get(s.config.apiHost);a&&(r.eid=a);const l=s._getFrameworks();return l.length&&(r.fw=l.join(",")),`${t}?${Tc(r).slice(1)}`}async function BP(s){const e=await PP(s),t=ln().gapi;return fe(t,s,"internal-error"),e.open({where:document.body,url:zP(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:LP,dontclear:!0},r=>new Promise(async(a,l)=>{await r.restyle({setHideOnLeave:!1});const u=fn(s,"network-request-failed"),m=ln().setTimeout(()=>{l(u)},VP.get());function g(){ln().clearTimeout(m),a(r)}r.ping(g).then(g,()=>{l(u)})}))}const qP={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},FP=500,HP=600,GP="_blank",QP="http://localhost";class IE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function KP(s,e,t,r=FP,a=HP){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-r)/2,0).toString();let m="";const g={...qP,width:r.toString(),height:a.toString(),top:l,left:u},y=Ot().toLowerCase();t&&(m=HI(y)?GP:t),qI(y)&&(e=e||QP,g.scrollbars="yes");const _=Object.entries(g).reduce((T,[S,V])=>`${T}${S}=${V},`,"");if(yD(y)&&m!=="_self")return $P(e||"",m),new IE(null);const x=window.open(e||"",m,_);fe(x,s,"popup-blocked");try{x.focus()}catch{}return new IE(x)}function $P(s,e){const t=document.createElement("a");t.href=s,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const YP="__/auth/handler",WP="emulator/auth/handler",XP=encodeURIComponent("fac");async function H0(s,e,t,r,a,l){fe(s.config.authDomain,s,"auth-domain-config-required"),fe(s.config.apiKey,s,"invalid-api-key");const u={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:r,v:Sa,eventId:a};if(e instanceof yi){e.setDefaultLanguage(s.languageCode),u.providerId=e.providerId||"",TC(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,x]of Object.entries(l||{}))u[_]=x}if(e instanceof Ac){const _=e.getScopes().filter(x=>x!=="");_.length>0&&(u.scopes=_.join(","))}s.tenantId&&(u.tid=s.tenantId);const m=u;for(const _ of Object.keys(m))m[_]===void 0&&delete m[_];const g=await s._getAppCheckToken(),y=g?`#${XP}=${encodeURIComponent(g)}`:"";return`${JP(s)}?${Tc(m).slice(1)}${y}`}function JP({config:s}){return s.emulator?Gy(s,WP):`https://${s.authDomain}/${YP}`}const I0="webStorageSupport";class ZP{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=No,this._completeRedirectFn=Bm,this._overrideRedirectResult=s_}async _openPopup(e,t,r,a){is(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await H0(e,t,r,xd(),a);return KP(e,l,Qd())}async _openRedirect(e,t,r,a){await this._originValidation(e);const l=await H0(e,t,r,xd(),a);return Bj(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(is(l,"If manager is not set, promise should be"),l)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await BP(e),r=new vS(e);return t.register("authEvent",a=>(fe(a?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(I0,{type:I0},a=>{const l=a?.[0]?.[I0];l!==void 0&&t(!!l),kn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=CP(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return $I()||FI()||Fd()}}const eV=ZP;class tV{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return js("unexpected MultiFactorSessionType")}}}class i_ extends tV{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new i_(e)}_finalizeEnroll(e,t,r){return Pj(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return Wj(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class ES{constructor(){}static assertion(e){return i_._fromCredential(e)}}ES.FACTOR_ID="phone";var SE="@firebase/auth",AE="1.12.0";class nV{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function rV(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function sV(s){_a(new Us("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:m}=r.options;fe(u&&!u.includes(":"),"invalid-api-key",{appName:r.name});const g={apiKey:u,authDomain:m,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:YI(s)},y=new ED(r,a,l,g);return MD(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),_a(new Us("auth-internal",e=>{const t=Mt(e.getProvider("auth").getImmediate());return(r=>new nV(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),es(SE,AE,rV(s)),es(SE,AE,"esm2020")}const iV=300;hC("authIdTokenMaxAge");function aV(){return document.getElementsByTagName("head")?.[0]??document}TD({loadJS(s){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",s),r.onload=e,r.onerror=a=>{const l=fn("internal-error");l.customData=a,t(l)},r.type="text/javascript",r.charset="UTF-8",aV().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});sV("Browser");function Co(){return window}const oV=2e3;async function lV(s,e,t){const{BuildInfo:r}=Co();is(e.sessionId,"AuthEvent did not contain a session ID");const a=await fV(e.sessionId),l={};return Fd()?l.ibi=r.packageName:qd()?l.apn=r.packageName:kn(s,"operation-not-supported-in-this-environment"),r.displayName&&(l.appDisplayName=r.displayName),l.sessionId=a,H0(s,t,e.type,void 0,e.eventId??void 0,l)}async function cV(s){const{BuildInfo:e}=Co(),t={};Fd()?t.iosBundleId=e.packageName:qd()?t.androidPackageName=e.packageName:kn(s,"operation-not-supported-in-this-environment"),await wS(s,t)}function uV(s){const{cordova:e}=Co();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let a=null;r?e.plugins.browsertab.openUrl(s):a=e.InAppBrowser.open(s,gD()?"_blank":"_system","location=yes"),t(a)})})}async function dV(s,e,t){const{cordova:r}=Co();let a=()=>{};try{await new Promise((l,u)=>{let m=null;function g(){l();const x=r.plugins.browsertab?.close;typeof x=="function"&&x(),typeof t?.close=="function"&&t.close()}function y(){m||(m=window.setTimeout(()=>{u(fn(s,"redirect-cancelled-by-user"))},oV))}function _(){document?.visibilityState==="visible"&&y()}e.addPassiveListener(g),document.addEventListener("resume",y,!1),qd()&&document.addEventListener("visibilitychange",_,!1),a=()=>{e.removePassiveListener(g),document.removeEventListener("resume",y,!1),document.removeEventListener("visibilitychange",_,!1),m&&window.clearTimeout(m)}})}finally{a()}}function hV(s){const e=Co();fe(typeof e?.universalLinks?.subscribe=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),fe(typeof e?.BuildInfo?.packageName<"u",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),fe(typeof e?.cordova?.plugins?.browsertab?.openUrl=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),fe(typeof e?.cordova?.plugins?.browsertab?.isAvailable=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),fe(typeof e?.cordova?.InAppBrowser?.open=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function fV(s){const e=mV(s),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(a=>a.toString(16).padStart(2,"0")).join("")}function mV(s){if(is(/[0-9a-zA-Z]+/.test(s),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(s);const e=new ArrayBuffer(s.length),t=new Uint8Array(e);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t}const pV=20;class gV extends vS{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function yV(s,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:vV(),postBody:null,tenantId:s.tenantId,error:fn(s,"no-auth-event")}}function _V(s,e){return G0()._set(Q0(s),e)}async function NE(s){const e=await G0()._get(Q0(s));return e&&await G0()._remove(Q0(s)),e}function bV(s,e){const t=wV(e);if(t.includes("/__/auth/callback")){const r=Gf(t),l=(r.firebaseError?xV(decodeURIComponent(r.firebaseError)):null)?.code?.split("auth/")?.[1],u=l?fn(l):null;return u?{type:s.type,eventId:s.eventId,tenantId:s.tenantId,error:u,urlResponse:null,sessionId:null,postBody:null}:{type:s.type,eventId:s.eventId,tenantId:s.tenantId,sessionId:s.sessionId,urlResponse:t,postBody:null}}return null}function vV(){const s=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<pV;t++){const r=Math.floor(Math.random()*e.length);s.push(e.charAt(r))}return s.join("")}function G0(){return vr(Zy)}function Q0(s){return Io("authEvent",s.config.apiKey,s.name)}function xV(s){try{return JSON.parse(s)}catch{return null}}function wV(s){const e=Gf(s),t=e.link?decodeURIComponent(e.link):void 0,r=Gf(t).link,a=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Gf(a).link||a||r||t||s}function Gf(s){if(!s?.includes("?"))return{};const[e,...t]=s.split("?");return Ql(t.join("?"))}const EV=500;class TV{constructor(){this._redirectPersistence=No,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Bm,this._overrideRedirectResult=s_}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new gV(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){kn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,a){hV(e);const l=await this._initialize(e);await l.initialized(),l.resetRedirect(),_P(),await this._originValidation(e);const u=yV(e,r,a);await _V(e,u);const m=await lV(e,u,t),g=await uV(m);return dV(e,l,g)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=cV(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:a,BuildInfo:l}=Co(),u=setTimeout(async()=>{await NE(e),t.onEvent(RE())},EV),m=async _=>{clearTimeout(u);const x=await NE(e);let T=null;x&&_?.url&&(T=bV(x,_.url)),t.onEvent(T||RE())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,m);const g=a,y=`${l.packageName.toLowerCase()}://`;Co().handleOpenURL=async _=>{if(_.toLowerCase().startsWith(y)&&m({url:_}),typeof g=="function")try{g(_)}catch{}}}}const IV=TV;function RE(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:fn("no-auth-event")}}function SV(s,e){Mt(s)._logFramework(e)}var AV="@firebase/auth-compat",NV="0.6.2";const RV=1e3;function od(){return self?.location?.protocol||null}function CV(){return od()==="http:"||od()==="https:"}function TS(s=Ot()){return!!((od()==="file:"||od()==="ionic:"||od()==="capacitor:")&&s.toLowerCase().match(/iphone|ipad|ipod|android/))}function kV(){return Oy()||Cm()}function DV(){return gI()&&document?.documentMode===11}function jV(s=Ot()){return/Edge\/\d+/.test(s)}function PV(s=Ot()){return DV()||jV(s)}function IS(){try{const s=self.localStorage,e=Qd();if(s)return s.setItem(e,"1"),s.removeItem(e),PV()?_d():!0}catch{return a_()&&_d()}return!1}function a_(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function S0(){return(CV()||pI()||TS())&&!kV()&&IS()&&!a_()}function SS(){return TS()&&typeof document<"u"}async function VV(){return SS()?new Promise(s=>{const e=setTimeout(()=>{s(!1)},RV);document.addEventListener("deviceready",()=>{clearTimeout(e),s(!0)})}):!1}function OV(){return typeof window<"u"?window:null}const br={LOCAL:"local",NONE:"none",SESSION:"session"},zu=fe,AS="persistence";function MV(s,e){if(zu(Object.values(br).includes(e),s,"invalid-persistence-type"),Oy()){zu(e!==br.SESSION,s,"unsupported-persistence-type");return}if(Cm()){zu(e===br.NONE,s,"unsupported-persistence-type");return}if(a_()){zu(e===br.NONE||e===br.LOCAL&&_d(),s,"unsupported-persistence-type");return}zu(e===br.NONE||IS(),s,"unsupported-persistence-type")}async function K0(s){await s._initializationPromise;const e=NS(),t=Io(AS,s.config.apiKey,s.name);e&&e.setItem(t,s._getPersistenceType())}function LV(s,e){const t=NS();if(!t)return[];const r=Io(AS,s,e);switch(t.getItem(r)){case br.NONE:return[nc];case br.LOCAL:return[Td,No];case br.SESSION:return[No];default:return[]}}function NS(){try{return OV()?.sessionStorage||null}catch{return null}}const UV=fe;class oa{constructor(){this.browserResolver=vr(eV),this.cordovaResolver=vr(IV),this.underlyingResolver=null,this._redirectPersistence=No,this._completeRedirectFn=Bm,this._overrideRedirectResult=s_}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,a)}async _openRedirect(e,t,r,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,a)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return SS()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return UV(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await VV();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function RS(s){return s.unwrap()}function zV(s){return s.wrapped()}function BV(s){return CS(s)}function qV(s,e){const t=e.customData?._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){const r=e;r.resolver=new FV(s,jj(s,e))}else if(t){const r=CS(e),a=e;r&&(a.credential=r,a.tenantId=t.tenantId||void 0,a.email=t.email||void 0,a.phoneNumber=t.phoneNumber||void 0)}}function CS(s){const{_tokenResponse:e}=s instanceof Gn?s.customData:s;if(!e)return null;if(!(s instanceof Gn)&&"temporaryProof"in e&&"phoneNumber"in e)return Ro.credentialFromResult(s);const t=e.providerId;if(!t||t===Lu.PASSWORD)return null;let r;switch(t){case Lu.GOOGLE:r=Cs;break;case Lu.FACEBOOK:r=Rs;break;case Lu.GITHUB:r=ks;break;case Lu.TWITTER:r=Ds;break;default:const{oauthIdToken:a,oauthAccessToken:l,oauthTokenSecret:u,pendingToken:m,nonce:g}=e;return!l&&!u&&!a&&!m?null:m?t.startsWith("saml.")?rc._create(t,m):zs._fromParams({providerId:t,signInMethod:t,pendingToken:m,idToken:a,accessToken:l}):new Yl(t).credential({idToken:a,accessToken:l,rawNonce:g})}return s instanceof Gn?r.credentialFromError(s):r.credentialFromResult(s)}function sr(s,e){return e.catch(t=>{throw t instanceof Gn&&qV(s,t),t}).then(t=>{const r=t.operationType,a=t.user;return{operationType:r,credential:BV(t),additionalUserInfo:Dj(t),user:qm.getOrCreate(a)}})}async function $0(s,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>sr(s,t.confirm(r))}}class FV{constructor(e,t){this.resolver=t,this.auth=zV(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return sr(RS(this.auth),this.resolver.resolveSignIn(e))}}let qm=class Wu{constructor(e){this._delegate=e,this.multiFactor=Oj(e)}static getOrCreate(e){return Wu.USER_MAP.has(e)||Wu.USER_MAP.set(e,new Wu(e)),Wu.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return sr(this.auth,iS(this._delegate,e))}async linkWithPhoneNumber(e,t){return $0(this.auth,iP(this._delegate,e,t))}async linkWithPopup(e){return sr(this.auth,mP(this._delegate,e,oa))}async linkWithRedirect(e){return await K0(Mt(this.auth)),EP(this._delegate,e,oa)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return sr(this.auth,aS(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return $0(this.auth,aP(this._delegate,e,t))}reauthenticateWithPopup(e){return sr(this.auth,fP(this._delegate,e,oa))}async reauthenticateWithRedirect(e){return await K0(Mt(this.auth)),xP(this._delegate,e,oa)}sendEmailVerification(e){return xj(this._delegate,e)}async unlink(e){return await oj(this._delegate,e),this}updateEmail(e){return Ij(this._delegate,e)}updatePassword(e){return Sj(this._delegate,e)}updatePhoneNumber(e){return oP(this._delegate,e)}updateProfile(e){return Tj(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return wj(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};qm.USER_MAP=new WeakMap;const Bu=fe;class Y0{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Bu(r,"invalid-api-key",{appName:e.name}),Bu(r,"invalid-api-key",{appName:e.name});const a=typeof window<"u"?oa:void 0;this._delegate=t.initialize({options:{persistence:HV(r,e.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(Wk),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?qm.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){LD(this._delegate,e,t)}applyActionCode(e){return hj(this._delegate,e)}checkActionCode(e){return oS(this._delegate,e)}confirmPasswordReset(e,t){return dj(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return sr(this._delegate,mj(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return vj(this._delegate,e)}isSignInWithEmailLink(e){return yj(this._delegate,e)}async getRedirectResult(){Bu(S0(),this._delegate,"operation-not-supported-in-this-environment");const e=await IP(this._delegate,oa);return e?sr(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){SV(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:a,error:l,complete:u}=CE(e,t,r);return this._delegate.onAuthStateChanged(a,l,u)}onIdTokenChanged(e,t,r){const{next:a,error:l,complete:u}=CE(e,t,r);return this._delegate.onIdTokenChanged(a,l,u)}sendSignInLinkToEmail(e,t){return gj(this._delegate,e,t)}sendPasswordResetEmail(e,t){return uj(this._delegate,e,t||void 0)}async setPersistence(e){MV(this._delegate,e);let t;switch(e){case br.SESSION:t=No;break;case br.LOCAL:t=await vr(Td)._isAvailable()?Td:Zy;break;case br.NONE:t=nc;break;default:return kn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return sr(this._delegate,aj(this._delegate))}signInWithCredential(e){return sr(this._delegate,Om(this._delegate,e))}signInWithCustomToken(e){return sr(this._delegate,cj(this._delegate,e))}signInWithEmailAndPassword(e,t){return sr(this._delegate,pj(this._delegate,e,t))}signInWithEmailLink(e,t){return sr(this._delegate,_j(this._delegate,e,t))}signInWithPhoneNumber(e,t){return $0(this._delegate,sP(this._delegate,e,t))}async signInWithPopup(e){return Bu(S0(),this._delegate,"operation-not-supported-in-this-environment"),sr(this._delegate,hP(this._delegate,e,oa))}async signInWithRedirect(e){return Bu(S0(),this._delegate,"operation-not-supported-in-this-environment"),await K0(this._delegate),bP(this._delegate,e,oa)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return fj(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Y0.Persistence=br;function CE(s,e,t){let r=s;typeof s!="function"&&({next:r,error:e,complete:t}=s);const a=r;return{next:u=>a(u&&qm.getOrCreate(u)),error:e,complete:t}}function HV(s,e){const t=LV(s,e);if(typeof self<"u"&&!t.includes(Td)&&t.push(Td),typeof window<"u")for(const r of[Zy,No])t.includes(r)||t.push(r);return t.includes(nc)||t.push(nc),t}class o_{static credential(e,t){return Ro.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new Ro(RS(ts.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}o_.PHONE_SIGN_IN_METHOD=Ro.PHONE_SIGN_IN_METHOD;o_.PROVIDER_ID=Ro.PROVIDER_ID;const GV=fe;class QV{constructor(e,t,r=ts.app()){GV(r.options?.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new nP(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const KV="auth-compat";function $V(s){s.INTERNAL.registerComponent(new Us(KV,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Y0(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Pl.EMAIL_SIGNIN,PASSWORD_RESET:Pl.PASSWORD_RESET,RECOVER_EMAIL:Pl.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Pl.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Pl.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Pl.VERIFY_EMAIL}},EmailAuthProvider:Aa,FacebookAuthProvider:Rs,GithubAuthProvider:ks,GoogleAuthProvider:Cs,OAuthProvider:Yl,SAMLAuthProvider:cm,PhoneAuthProvider:o_,PhoneMultiFactorGenerator:ES,RecaptchaVerifier:QV,TwitterAuthProvider:Ds,Auth:Y0,AuthCredential:Sc,Error:Gn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),s.registerVersion(AV,NV)}$V(ts);var kE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ha,kS;(function(){var s;function e(C,N){function E(){}E.prototype=N.prototype,C.F=N.prototype,C.prototype=new E,C.prototype.constructor=C,C.D=function(D,k,j){for(var R=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)R[_e-2]=arguments[_e];return N.prototype[k].apply(D,R)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(C,N,E){E||(E=0);const D=Array(16);if(typeof N=="string")for(var k=0;k<16;++k)D[k]=N.charCodeAt(E++)|N.charCodeAt(E++)<<8|N.charCodeAt(E++)<<16|N.charCodeAt(E++)<<24;else for(k=0;k<16;++k)D[k]=N[E++]|N[E++]<<8|N[E++]<<16|N[E++]<<24;N=C.g[0],E=C.g[1],k=C.g[2];let j=C.g[3],R;R=N+(j^E&(k^j))+D[0]+3614090360&4294967295,N=E+(R<<7&4294967295|R>>>25),R=j+(k^N&(E^k))+D[1]+3905402710&4294967295,j=N+(R<<12&4294967295|R>>>20),R=k+(E^j&(N^E))+D[2]+606105819&4294967295,k=j+(R<<17&4294967295|R>>>15),R=E+(N^k&(j^N))+D[3]+3250441966&4294967295,E=k+(R<<22&4294967295|R>>>10),R=N+(j^E&(k^j))+D[4]+4118548399&4294967295,N=E+(R<<7&4294967295|R>>>25),R=j+(k^N&(E^k))+D[5]+1200080426&4294967295,j=N+(R<<12&4294967295|R>>>20),R=k+(E^j&(N^E))+D[6]+2821735955&4294967295,k=j+(R<<17&4294967295|R>>>15),R=E+(N^k&(j^N))+D[7]+4249261313&4294967295,E=k+(R<<22&4294967295|R>>>10),R=N+(j^E&(k^j))+D[8]+1770035416&4294967295,N=E+(R<<7&4294967295|R>>>25),R=j+(k^N&(E^k))+D[9]+2336552879&4294967295,j=N+(R<<12&4294967295|R>>>20),R=k+(E^j&(N^E))+D[10]+4294925233&4294967295,k=j+(R<<17&4294967295|R>>>15),R=E+(N^k&(j^N))+D[11]+2304563134&4294967295,E=k+(R<<22&4294967295|R>>>10),R=N+(j^E&(k^j))+D[12]+1804603682&4294967295,N=E+(R<<7&4294967295|R>>>25),R=j+(k^N&(E^k))+D[13]+4254626195&4294967295,j=N+(R<<12&4294967295|R>>>20),R=k+(E^j&(N^E))+D[14]+2792965006&4294967295,k=j+(R<<17&4294967295|R>>>15),R=E+(N^k&(j^N))+D[15]+1236535329&4294967295,E=k+(R<<22&4294967295|R>>>10),R=N+(k^j&(E^k))+D[1]+4129170786&4294967295,N=E+(R<<5&4294967295|R>>>27),R=j+(E^k&(N^E))+D[6]+3225465664&4294967295,j=N+(R<<9&4294967295|R>>>23),R=k+(N^E&(j^N))+D[11]+643717713&4294967295,k=j+(R<<14&4294967295|R>>>18),R=E+(j^N&(k^j))+D[0]+3921069994&4294967295,E=k+(R<<20&4294967295|R>>>12),R=N+(k^j&(E^k))+D[5]+3593408605&4294967295,N=E+(R<<5&4294967295|R>>>27),R=j+(E^k&(N^E))+D[10]+38016083&4294967295,j=N+(R<<9&4294967295|R>>>23),R=k+(N^E&(j^N))+D[15]+3634488961&4294967295,k=j+(R<<14&4294967295|R>>>18),R=E+(j^N&(k^j))+D[4]+3889429448&4294967295,E=k+(R<<20&4294967295|R>>>12),R=N+(k^j&(E^k))+D[9]+568446438&4294967295,N=E+(R<<5&4294967295|R>>>27),R=j+(E^k&(N^E))+D[14]+3275163606&4294967295,j=N+(R<<9&4294967295|R>>>23),R=k+(N^E&(j^N))+D[3]+4107603335&4294967295,k=j+(R<<14&4294967295|R>>>18),R=E+(j^N&(k^j))+D[8]+1163531501&4294967295,E=k+(R<<20&4294967295|R>>>12),R=N+(k^j&(E^k))+D[13]+2850285829&4294967295,N=E+(R<<5&4294967295|R>>>27),R=j+(E^k&(N^E))+D[2]+4243563512&4294967295,j=N+(R<<9&4294967295|R>>>23),R=k+(N^E&(j^N))+D[7]+1735328473&4294967295,k=j+(R<<14&4294967295|R>>>18),R=E+(j^N&(k^j))+D[12]+2368359562&4294967295,E=k+(R<<20&4294967295|R>>>12),R=N+(E^k^j)+D[5]+4294588738&4294967295,N=E+(R<<4&4294967295|R>>>28),R=j+(N^E^k)+D[8]+2272392833&4294967295,j=N+(R<<11&4294967295|R>>>21),R=k+(j^N^E)+D[11]+1839030562&4294967295,k=j+(R<<16&4294967295|R>>>16),R=E+(k^j^N)+D[14]+4259657740&4294967295,E=k+(R<<23&4294967295|R>>>9),R=N+(E^k^j)+D[1]+2763975236&4294967295,N=E+(R<<4&4294967295|R>>>28),R=j+(N^E^k)+D[4]+1272893353&4294967295,j=N+(R<<11&4294967295|R>>>21),R=k+(j^N^E)+D[7]+4139469664&4294967295,k=j+(R<<16&4294967295|R>>>16),R=E+(k^j^N)+D[10]+3200236656&4294967295,E=k+(R<<23&4294967295|R>>>9),R=N+(E^k^j)+D[13]+681279174&4294967295,N=E+(R<<4&4294967295|R>>>28),R=j+(N^E^k)+D[0]+3936430074&4294967295,j=N+(R<<11&4294967295|R>>>21),R=k+(j^N^E)+D[3]+3572445317&4294967295,k=j+(R<<16&4294967295|R>>>16),R=E+(k^j^N)+D[6]+76029189&4294967295,E=k+(R<<23&4294967295|R>>>9),R=N+(E^k^j)+D[9]+3654602809&4294967295,N=E+(R<<4&4294967295|R>>>28),R=j+(N^E^k)+D[12]+3873151461&4294967295,j=N+(R<<11&4294967295|R>>>21),R=k+(j^N^E)+D[15]+530742520&4294967295,k=j+(R<<16&4294967295|R>>>16),R=E+(k^j^N)+D[2]+3299628645&4294967295,E=k+(R<<23&4294967295|R>>>9),R=N+(k^(E|~j))+D[0]+4096336452&4294967295,N=E+(R<<6&4294967295|R>>>26),R=j+(E^(N|~k))+D[7]+1126891415&4294967295,j=N+(R<<10&4294967295|R>>>22),R=k+(N^(j|~E))+D[14]+2878612391&4294967295,k=j+(R<<15&4294967295|R>>>17),R=E+(j^(k|~N))+D[5]+4237533241&4294967295,E=k+(R<<21&4294967295|R>>>11),R=N+(k^(E|~j))+D[12]+1700485571&4294967295,N=E+(R<<6&4294967295|R>>>26),R=j+(E^(N|~k))+D[3]+2399980690&4294967295,j=N+(R<<10&4294967295|R>>>22),R=k+(N^(j|~E))+D[10]+4293915773&4294967295,k=j+(R<<15&4294967295|R>>>17),R=E+(j^(k|~N))+D[1]+2240044497&4294967295,E=k+(R<<21&4294967295|R>>>11),R=N+(k^(E|~j))+D[8]+1873313359&4294967295,N=E+(R<<6&4294967295|R>>>26),R=j+(E^(N|~k))+D[15]+4264355552&4294967295,j=N+(R<<10&4294967295|R>>>22),R=k+(N^(j|~E))+D[6]+2734768916&4294967295,k=j+(R<<15&4294967295|R>>>17),R=E+(j^(k|~N))+D[13]+1309151649&4294967295,E=k+(R<<21&4294967295|R>>>11),R=N+(k^(E|~j))+D[4]+4149444226&4294967295,N=E+(R<<6&4294967295|R>>>26),R=j+(E^(N|~k))+D[11]+3174756917&4294967295,j=N+(R<<10&4294967295|R>>>22),R=k+(N^(j|~E))+D[2]+718787259&4294967295,k=j+(R<<15&4294967295|R>>>17),R=E+(j^(k|~N))+D[9]+3951481745&4294967295,C.g[0]=C.g[0]+N&4294967295,C.g[1]=C.g[1]+(k+(R<<21&4294967295|R>>>11))&4294967295,C.g[2]=C.g[2]+k&4294967295,C.g[3]=C.g[3]+j&4294967295}r.prototype.v=function(C,N){N===void 0&&(N=C.length);const E=N-this.blockSize,D=this.C;let k=this.h,j=0;for(;j<N;){if(k==0)for(;j<=E;)a(this,C,j),j+=this.blockSize;if(typeof C=="string"){for(;j<N;)if(D[k++]=C.charCodeAt(j++),k==this.blockSize){a(this,D),k=0;break}}else for(;j<N;)if(D[k++]=C[j++],k==this.blockSize){a(this,D),k=0;break}}this.h=k,this.o+=N},r.prototype.A=function(){var C=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);C[0]=128;for(var N=1;N<C.length-8;++N)C[N]=0;N=this.o*8;for(var E=C.length-8;E<C.length;++E)C[E]=N&255,N/=256;for(this.v(C),C=Array(16),N=0,E=0;E<4;++E)for(let D=0;D<32;D+=8)C[N++]=this.g[E]>>>D&255;return C};function l(C,N){var E=m;return Object.prototype.hasOwnProperty.call(E,C)?E[C]:E[C]=N(C)}function u(C,N){this.h=N;const E=[];let D=!0;for(let k=C.length-1;k>=0;k--){const j=C[k]|0;D&&j==N||(E[k]=j,D=!1)}this.g=E}var m={};function g(C){return-128<=C&&C<128?l(C,function(N){return new u([N|0],N<0?-1:0)}):new u([C|0],C<0?-1:0)}function y(C){if(isNaN(C)||!isFinite(C))return x;if(C<0)return $(y(-C));const N=[];let E=1;for(let D=0;C>=E;D++)N[D]=C/E|0,E*=4294967296;return new u(N,0)}function _(C,N){if(C.length==0)throw Error("number format error: empty string");if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(C.charAt(0)=="-")return $(_(C.substring(1),N));if(C.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=y(Math.pow(N,8));let D=x;for(let j=0;j<C.length;j+=8){var k=Math.min(8,C.length-j);const R=parseInt(C.substring(j,j+k),N);k<8?(k=y(Math.pow(N,k)),D=D.j(k).add(y(R))):(D=D.j(E),D=D.add(y(R)))}return D}var x=g(0),T=g(1),S=g(16777216);s=u.prototype,s.m=function(){if(U(this))return-$(this).m();let C=0,N=1;for(let E=0;E<this.g.length;E++){const D=this.i(E);C+=(D>=0?D:4294967296+D)*N,N*=4294967296}return C},s.toString=function(C){if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(V(this))return"0";if(U(this))return"-"+$(this).toString(C);const N=y(Math.pow(C,6));var E=this;let D="";for(;;){const k=be(E,N).g;E=H(E,k.j(N));let j=((E.g.length>0?E.g[0]:E.h)>>>0).toString(C);if(E=k,V(E))return j+D;for(;j.length<6;)j="0"+j;D=j+D}},s.i=function(C){return C<0?0:C<this.g.length?this.g[C]:this.h};function V(C){if(C.h!=0)return!1;for(let N=0;N<C.g.length;N++)if(C.g[N]!=0)return!1;return!0}function U(C){return C.h==-1}s.l=function(C){return C=H(this,C),U(C)?-1:V(C)?0:1};function $(C){const N=C.g.length,E=[];for(let D=0;D<N;D++)E[D]=~C.g[D];return new u(E,~C.h).add(T)}s.abs=function(){return U(this)?$(this):this},s.add=function(C){const N=Math.max(this.g.length,C.g.length),E=[];let D=0;for(let k=0;k<=N;k++){let j=D+(this.i(k)&65535)+(C.i(k)&65535),R=(j>>>16)+(this.i(k)>>>16)+(C.i(k)>>>16);D=R>>>16,j&=65535,R&=65535,E[k]=R<<16|j}return new u(E,E[E.length-1]&-2147483648?-1:0)};function H(C,N){return C.add($(N))}s.j=function(C){if(V(this)||V(C))return x;if(U(this))return U(C)?$(this).j($(C)):$($(this).j(C));if(U(C))return $(this.j($(C)));if(this.l(S)<0&&C.l(S)<0)return y(this.m()*C.m());const N=this.g.length+C.g.length,E=[];for(var D=0;D<2*N;D++)E[D]=0;for(D=0;D<this.g.length;D++)for(let k=0;k<C.g.length;k++){const j=this.i(D)>>>16,R=this.i(D)&65535,_e=C.i(k)>>>16,Ne=C.i(k)&65535;E[2*D+2*k]+=R*Ne,se(E,2*D+2*k),E[2*D+2*k+1]+=j*Ne,se(E,2*D+2*k+1),E[2*D+2*k+1]+=R*_e,se(E,2*D+2*k+1),E[2*D+2*k+2]+=j*_e,se(E,2*D+2*k+2)}for(C=0;C<N;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=N;C<2*N;C++)E[C]=0;return new u(E,0)};function se(C,N){for(;(C[N]&65535)!=C[N];)C[N+1]+=C[N]>>>16,C[N]&=65535,N++}function te(C,N){this.g=C,this.h=N}function be(C,N){if(V(N))throw Error("division by zero");if(V(C))return new te(x,x);if(U(C))return N=be($(C),N),new te($(N.g),$(N.h));if(U(N))return N=be(C,$(N)),new te($(N.g),N.h);if(C.g.length>30){if(U(C)||U(N))throw Error("slowDivide_ only works with positive integers.");for(var E=T,D=N;D.l(C)<=0;)E=ae(E),D=ae(D);var k=ee(E,1),j=ee(D,1);for(D=ee(D,2),E=ee(E,2);!V(D);){var R=j.add(D);R.l(C)<=0&&(k=k.add(E),j=R),D=ee(D,1),E=ee(E,1)}return N=H(C,k.j(N)),new te(k,N)}for(k=x;C.l(N)>=0;){for(E=Math.max(1,Math.floor(C.m()/N.m())),D=Math.ceil(Math.log(E)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),j=y(E),R=j.j(N);U(R)||R.l(C)>0;)E-=D,j=y(E),R=j.j(N);V(j)&&(j=T),k=k.add(j),C=H(C,R)}return new te(k,C)}s.B=function(C){return be(this,C).h},s.and=function(C){const N=Math.max(this.g.length,C.g.length),E=[];for(let D=0;D<N;D++)E[D]=this.i(D)&C.i(D);return new u(E,this.h&C.h)},s.or=function(C){const N=Math.max(this.g.length,C.g.length),E=[];for(let D=0;D<N;D++)E[D]=this.i(D)|C.i(D);return new u(E,this.h|C.h)},s.xor=function(C){const N=Math.max(this.g.length,C.g.length),E=[];for(let D=0;D<N;D++)E[D]=this.i(D)^C.i(D);return new u(E,this.h^C.h)};function ae(C){const N=C.g.length+1,E=[];for(let D=0;D<N;D++)E[D]=C.i(D)<<1|C.i(D-1)>>>31;return new u(E,C.h)}function ee(C,N){const E=N>>5;N%=32;const D=C.g.length-E,k=[];for(let j=0;j<D;j++)k[j]=N>0?C.i(j+E)>>>N|C.i(j+E+1)<<32-N:C.i(j+E);return new u(k,C.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,kS=r,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=y,u.fromString=_,ha=u}).apply(typeof kE<"u"?kE:typeof self<"u"?self:typeof window<"u"?window:{});var Pf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var DS,Xu,jS,Qf,W0,PS,VS,OS;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pf=="object"&&Pf];for(var b=0;b<h.length;++b){var w=h[b];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=t(this);function a(h,b){if(b)e:{var w=r;h=h.split(".");for(var A=0;A<h.length-1;A++){var F=h[A];if(!(F in w))break e;w=w[F]}h=h[h.length-1],A=w[h],b=b(A),b!=A&&b!=null&&e(w,h,{configurable:!0,writable:!0,value:b})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(b){var w=[],A;for(A in b)Object.prototype.hasOwnProperty.call(b,A)&&w.push([A,b[A]]);return w}});var l=l||{},u=this||self;function m(h){var b=typeof h;return b=="object"&&h!=null||b=="function"}function g(h,b,w){return h.call.apply(h.bind,arguments)}function y(h,b,w){return y=g,y.apply(null,arguments)}function _(h,b){var w=Array.prototype.slice.call(arguments,1);return function(){var A=w.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function x(h,b){function w(){}w.prototype=b.prototype,h.Z=b.prototype,h.prototype=new w,h.prototype.constructor=h,h.Ob=function(A,F,J){for(var ge=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)ge[ze-2]=arguments[ze];return b.prototype[F].apply(A,ge)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function S(h){const b=h.length;if(b>0){const w=Array(b);for(let A=0;A<b;A++)w[A]=h[A];return w}return[]}function V(h,b){for(let A=1;A<arguments.length;A++){const F=arguments[A];var w=typeof F;if(w=w!="object"?w:F?Array.isArray(F)?"array":w:"null",w=="array"||w=="object"&&typeof F.length=="number"){w=h.length||0;const J=F.length||0;h.length=w+J;for(let ge=0;ge<J;ge++)h[w+ge]=F[ge]}else h.push(F)}}class U{constructor(b,w){this.i=b,this.j=w,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function $(h){u.setTimeout(()=>{throw h},0)}function H(){var h=C;let b=null;return h.g&&(b=h.g,h.g=h.g.next,h.g||(h.h=null),b.next=null),b}class se{constructor(){this.h=this.g=null}add(b,w){const A=te.get();A.set(b,w),this.h?this.h.next=A:this.g=A,this.h=A}}var te=new U(()=>new be,h=>h.reset());class be{constructor(){this.next=this.g=this.h=null}set(b,w){this.h=b,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,ee=!1,C=new se,N=()=>{const h=Promise.resolve(void 0);ae=()=>{h.then(E)}};function E(){for(var h;h=H();){try{h.h.call(h.g)}catch(w){$(w)}var b=te;b.j(h),b.h<100&&(b.h++,h.next=b.g,b.g=h)}ee=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(h,b){this.type=h,this.g=this.target=b,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,b=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};u.addEventListener("test",w,b),u.removeEventListener("test",w,b)}catch{}return h})();function R(h){return/^[\s\xa0]*$/.test(h)}function _e(h,b){k.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,b)}x(_e,k),_e.prototype.init=function(h,b){const w=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=b,b=h.relatedTarget,b||(w=="mouseover"?b=h.fromElement:w=="mouseout"&&(b=h.toElement)),this.relatedTarget=b,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&_e.Z.h.call(this)},_e.prototype.h=function(){_e.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Ne="closure_listenable_"+(Math.random()*1e6|0),z=0;function me(h,b,w,A,F){this.listener=h,this.proxy=null,this.src=b,this.type=w,this.capture=!!A,this.ha=F,this.key=++z,this.da=this.fa=!1}function Ee(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ue(h,b,w){for(const A in h)b.call(w,h[A],A,h)}function De(h,b){for(const w in h)b.call(void 0,h[w],w,h)}function O(h){const b={};for(const w in h)b[w]=h[w];return b}const ne="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(h,b){let w,A;for(let F=1;F<arguments.length;F++){A=arguments[F];for(w in A)h[w]=A[w];for(let J=0;J<ne.length;J++)w=ne[J],Object.prototype.hasOwnProperty.call(A,w)&&(h[w]=A[w])}}function K(h){this.src=h,this.g={},this.h=0}K.prototype.add=function(h,b,w,A,F){const J=h.toString();h=this.g[J],h||(h=this.g[J]=[],this.h++);const ge=de(h,b,A,F);return ge>-1?(b=h[ge],w||(b.fa=!1)):(b=new me(b,this.src,J,!!A,F),b.fa=w,h.push(b)),b};function le(h,b){const w=b.type;if(w in h.g){var A=h.g[w],F=Array.prototype.indexOf.call(A,b,void 0),J;(J=F>=0)&&Array.prototype.splice.call(A,F,1),J&&(Ee(b),h.g[w].length==0&&(delete h.g[w],h.h--))}}function de(h,b,w,A){for(let F=0;F<h.length;++F){const J=h[F];if(!J.da&&J.listener==b&&J.capture==!!w&&J.ha==A)return F}return-1}var pe="closure_lm_"+(Math.random()*1e6|0),Ce={};function nt(h,b,w,A,F){if(Array.isArray(b)){for(let J=0;J<b.length;J++)nt(h,b[J],w,A,F);return null}return w=Wn(w),h&&h[Ne]?h.J(b,w,m(A)?!!A.capture:!1,F):lr(h,b,w,!1,A,F)}function lr(h,b,w,A,F,J){if(!b)throw Error("Invalid event type");const ge=m(F)?!!F.capture:!!F;let ze=Dn(h);if(ze||(h[pe]=ze=new K(h)),w=ze.add(b,w,A,ge,J),w.proxy)return w;if(A=Ht(),w.proxy=A,A.src=h,A.listener=w,h.addEventListener)j||(F=ge),F===void 0&&(F=!1),h.addEventListener(b.toString(),A,F);else if(h.attachEvent)h.attachEvent(un(b.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Ht(){function h(w){return b.call(h.src,h.listener,w)}const b=$n;return h}function xn(h,b,w,A,F){if(Array.isArray(b))for(var J=0;J<b.length;J++)xn(h,b[J],w,A,F);else A=m(A)?!!A.capture:!!A,w=Wn(w),h&&h[Ne]?(h=h.i,J=String(b).toString(),J in h.g&&(b=h.g[J],w=de(b,w,A,F),w>-1&&(Ee(b[w]),Array.prototype.splice.call(b,w,1),b.length==0&&(delete h.g[J],h.h--)))):h&&(h=Dn(h))&&(b=h.g[b.toString()],h=-1,b&&(h=de(b,w,A,F)),(w=h>-1?b[h]:null)&&Er(w))}function Er(h){if(typeof h!="number"&&h&&!h.da){var b=h.src;if(b&&b[Ne])le(b.i,h);else{var w=h.type,A=h.proxy;b.removeEventListener?b.removeEventListener(w,A,h.capture):b.detachEvent?b.detachEvent(un(w),A):b.addListener&&b.removeListener&&b.removeListener(A),(w=Dn(b))?(le(w,h),w.h==0&&(w.src=null,b[pe]=null)):Ee(h)}}}function un(h){return h in Ce?Ce[h]:Ce[h]="on"+h}function $n(h,b){if(h.da)h=!0;else{b=new _e(b,this);const w=h.listener,A=h.ha||h.src;h.fa&&Er(h),h=w.call(A,b)}return h}function Dn(h){return h=h[pe],h instanceof K?h:null}var Yn="__closure_events_fn_"+(Math.random()*1e9>>>0);function Wn(h){return typeof h=="function"?h:(h[Yn]||(h[Yn]=function(b){return h.handleEvent(b)}),h[Yn])}function We(){D.call(this),this.i=new K(this),this.M=this,this.G=null}x(We,D),We.prototype[Ne]=!0,We.prototype.removeEventListener=function(h,b,w,A){xn(this,h,b,w,A)};function Et(h,b){var w,A=h.G;if(A)for(w=[];A;A=A.G)w.push(A);if(h=h.M,A=b.type||b,typeof b=="string")b=new k(b,h);else if(b instanceof k)b.target=b.target||h;else{var F=b;b=new k(A,h),q(b,F)}F=!0;let J,ge;if(w)for(ge=w.length-1;ge>=0;ge--)J=b.g=w[ge],F=jn(J,A,!0,b)&&F;if(J=b.g=h,F=jn(J,A,!0,b)&&F,F=jn(J,A,!1,b)&&F,w)for(ge=0;ge<w.length;ge++)J=b.g=w[ge],F=jn(J,A,!1,b)&&F}We.prototype.N=function(){if(We.Z.N.call(this),this.i){var h=this.i;for(const b in h.g){const w=h.g[b];for(let A=0;A<w.length;A++)Ee(w[A]);delete h.g[b],h.h--}}this.G=null},We.prototype.J=function(h,b,w,A){return this.i.add(String(h),b,!1,w,A)},We.prototype.K=function(h,b,w,A){return this.i.add(String(h),b,!0,w,A)};function jn(h,b,w,A){if(b=h.i.g[String(b)],!b)return!0;b=b.concat();let F=!0;for(let J=0;J<b.length;++J){const ge=b[J];if(ge&&!ge.da&&ge.capture==w){const ze=ge.listener,Gt=ge.ha||ge.src;ge.fa&&le(h.i,ge),F=ze.call(Gt,A)!==!1&&F}}return F&&!A.defaultPrevented}function W(h,b){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=y(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:u.setTimeout(h,b||0)}function Se(h){h.g=W(()=>{h.g=null,h.i&&(h.i=!1,Se(h))},h.l);const b=h.h;h.h=null,h.m.apply(null,b)}class Fe extends D{constructor(b,w){super(),this.m=b,this.l=w,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Se(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ue(h){D.call(this),this.h=h,this.g={}}x(ue,D);var jt=[];function wn(h){Ue(h.g,function(b,w){this.g.hasOwnProperty(w)&&Er(b)},h),h.g={}}ue.prototype.N=function(){ue.Z.N.call(this),wn(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xt=u.JSON.stringify,ja=u.JSON.parse,Fs=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function Oc(){}function Ur(){}var zn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function xe(){k.call(this,"d")}x(xe,k);function Ve(){k.call(this,"c")}x(Ve,k);var Ge={},zr=null;function wi(){return zr=zr||new We}Ge.Ia="serverreachability";function Pa(h){k.call(this,Ge.Ia,h)}x(Pa,k);function as(h){const b=wi();Et(b,new Pa(b))}Ge.STAT_EVENT="statevent";function Va(h,b){k.call(this,Ge.STAT_EVENT,h),this.stat=b}x(Va,k);function Jt(h){const b=wi();Et(b,new Va(b,h))}Ge.Ja="timingevent";function os(h,b){k.call(this,Ge.Ja,h),this.size=b}x(os,k);function ls(h,b){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},b)}function Br(){this.g=!0}Br.prototype.ua=function(){this.g=!1};function mp(h,b,w,A,F,J){h.info(function(){if(h.g)if(J){var ge="",ze=J.split("&");for(let at=0;at<ze.length;at++){var Gt=ze[at].split("=");if(Gt.length>1){const At=Gt[0];Gt=Gt[1];const Ar=At.split("_");ge=Ar.length>=2&&Ar[1]=="type"?ge+(At+"="+Gt+"&"):ge+(At+"=redacted&")}}}else ge=null;else ge=J;return"XMLHTTP REQ ("+A+") [attempt "+F+"]: "+b+`
`+w+`
`+ge})}function ch(h,b,w,A,F,J,ge){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+F+"]: "+b+`
`+w+`
`+J+" "+ge})}function cs(h,b,w,A){h.info(function(){return"XMLHTTP TEXT ("+b+"): "+pp(h,w)+(A?" "+A:"")})}function Oa(h,b){h.info(function(){return"TIMEOUT: "+b})}Br.prototype.info=function(){};function pp(h,b){if(!h.g)return b;if(!b)return null;try{const J=JSON.parse(b);if(J){for(h=0;h<J.length;h++)if(Array.isArray(J[h])){var w=J[h];if(!(w.length<2)){var A=w[1];if(Array.isArray(A)&&!(A.length<1)){var F=A[0];if(F!="noop"&&F!="stop"&&F!="close")for(let ge=1;ge<A.length;ge++)A[ge]=""}}}}return Xt(J)}catch{return b}}var Ma={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Mc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Lc;function La(){}x(La,Oc),La.prototype.g=function(){return new XMLHttpRequest},Lc=new La;function Hs(h){return encodeURIComponent(String(h))}function uh(h){var b=1;h=h.split(":");const w=[];for(;b>0&&h.length;)w.push(h.shift()),b--;return h.length&&w.push(h.join(":")),w}function qr(h,b,w,A){this.j=h,this.i=b,this.l=w,this.S=A||1,this.V=new ue(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Fr}function Fr(){this.i=null,this.g="",this.h=!1}var Zt={},pn={};function us(h,b,w){h.M=1,h.A=Ua(tn(b)),h.u=w,h.R=!0,$o(h,null)}function $o(h,b){h.F=Date.now(),ds(h),h.B=tn(h.A);var w=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),Jo(w.i,"t",A),h.C=0,w=h.j.L,h.h=new Fr,h.g=Ih(h.j,w?b:null,!h.u),h.P>0&&(h.O=new Fe(y(h.Y,h,h.g),h.P)),b=h.V,w=h.g,A=h.ba;var F="readystatechange";Array.isArray(F)||(F&&(jt[0]=F.toString()),F=jt);for(let J=0;J<F.length;J++){const ge=nt(w,F[J],A||b.handleEvent,!1,b.h||b);if(!ge)break;b.g[ge.key]=ge}b=h.J?O(h.J):{},h.u?(h.v||(h.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,b)):(h.v="GET",h.g.ea(h.B,h.v,null,b)),as(),mp(h.i,h.v,h.B,h.l,h.S,h.u)}qr.prototype.ba=function(h){h=h.target;const b=this.O;b&&Qr(h)==3?b.j():this.Y(h)},qr.prototype.Y=function(h){try{if(h==this.g)e:{const ze=Qr(this.g),Gt=this.g.ya(),at=this.g.ca();if(!(ze<3)&&(ze!=3||this.g&&(this.h.h||this.g.la()||En(this.g)))){this.K||ze!=4||Gt==7||(Gt==8||at<=0?as(3):as(2)),hs(this);var b=this.g.ca();this.X=b;var w=gp(this);if(this.o=b==200,ch(this.i,this.v,this.B,this.l,this.S,ze,b),this.o){if(this.U&&!this.L){t:{if(this.g){var A,F=this.g;if((A=F.g?F.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(A)){var J=A;break t}}J=null}if(h=J)cs(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,fs(this,h);else{this.o=!1,this.m=3,Jt(12),cr(this),Tr(this);break e}}if(this.R){h=!0;let At;for(;!this.K&&this.C<w.length;)if(At=hh(this,w),At==pn){ze==4&&(this.m=4,Jt(14),h=!1),cs(this.i,this.l,null,"[Incomplete Response]");break}else if(At==Zt){this.m=4,Jt(15),cs(this.i,this.l,w,"[Invalid Chunk]"),h=!1;break}else cs(this.i,this.l,At,null),fs(this,At);if(dh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ze!=4||w.length!=0||this.h.h||(this.m=1,Jt(16),h=!1),this.o=this.o&&h,!h)cs(this.i,this.l,w,"[Invalid Chunked Response]"),cr(this),Tr(this);else if(w.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Zc(ge),ge.P=!0,Jt(11))}}else cs(this.i,this.l,w,null),fs(this,w);ze==4&&cr(this),this.o&&!this.K&&(ze==4?xh(this.j,this):(this.o=!1,ds(this)))}else Qs(this.g),b==400&&w.indexOf("Unknown SID")>0?(this.m=3,Jt(12)):(this.m=0,Jt(13)),cr(this),Tr(this)}}}catch{}};function gp(h){if(!dh(h))return h.g.la();const b=En(h.g);if(b==="")return"";let w="";const A=b.length,F=Qr(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return cr(h),Tr(h),"";h.h.i=new u.TextDecoder}for(let J=0;J<A;J++)h.h.h=!0,w+=h.h.i.decode(b[J],{stream:!(F&&J==A-1)});return b.length=0,h.h.g+=w,h.C=0,h.h.g}function dh(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function hh(h,b){var w=h.C,A=b.indexOf(`
`,w);return A==-1?pn:(w=Number(b.substring(w,A)),isNaN(w)?Zt:(A+=1,A+w>b.length?pn:(b=b.slice(A,A+w),h.C=A+w,b)))}qr.prototype.cancel=function(){this.K=!0,cr(this)};function ds(h){h.T=Date.now()+h.H,Yo(h,h.H)}function Yo(h,b){if(h.D!=null)throw Error("WatchDog timer not null");h.D=ls(y(h.aa,h),b)}function hs(h){h.D&&(u.clearTimeout(h.D),h.D=null)}qr.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Oa(this.i,this.B),this.M!=2&&(as(),Jt(17)),cr(this),this.m=2,Tr(this)):Yo(this,this.T-h)};function Tr(h){h.j.I==0||h.K||xh(h.j,h)}function cr(h){hs(h);var b=h.O;b&&typeof b.dispose=="function"&&b.dispose(),h.O=null,wn(h.V),h.g&&(b=h.g,h.g=null,b.abort(),b.dispose())}function fs(h,b){try{var w=h.j;if(w.I!=0&&(w.g==h||ps(w.h,h))){if(!h.L&&ps(w.h,h)&&w.I==3){try{var A=w.Ba.g.parse(b)}catch{A=null}if(Array.isArray(A)&&A.length==3){var F=A;if(F[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<h.F)rl(w),Ci(w);else break e;Qa(w),Jt(18)}}else w.xa=F[1],0<w.xa-w.K&&F[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=ls(y(w.Va,w),6e3));ms(w.h)<=1&&w.ta&&(w.ta=void 0)}else xs(w,11)}else if((h.L||w.g==h)&&rl(w),!R(b))for(F=w.Ba.g.parse(b),b=0;b<F.length;b++){let at=F[b];const At=at[0];if(!(At<=w.K))if(w.K=At,at=at[1],w.I==2)if(at[0]=="c"){w.M=at[1],w.ba=at[2];const Ar=at[3];Ar!=null&&(w.ka=Ar,w.j.info("VER="+w.ka));const ws=at[4];ws!=null&&(w.za=ws,w.j.info("SVER="+w.za));const Kr=at[5];Kr!=null&&typeof Kr=="number"&&Kr>0&&(A=1.5*Kr,w.O=A,w.j.info("backChannelRequestTimeoutMs_="+A)),A=w;const $r=h.g;if($r){const Ka=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ka){var J=A.h;J.g||Ka.indexOf("spdy")==-1&&Ka.indexOf("quic")==-1&&Ka.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Bc(J,J.h),J.h=null))}if(A.G){const sl=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;sl&&(A.wa=sl,ut(A.J,A.G,sl))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-h.F,w.j.info("Handshake RTT: "+w.T+"ms")),A=w;var ge=h;if(A.na=Th(A,A.L?A.ba:null,A.W),ge.L){qc(A.h,ge);var ze=ge,Gt=A.O;Gt&&(ze.H=Gt),ze.D&&(hs(ze),ds(ze)),A.g=ge}else bh(A);w.i.length>0&&vs(w)}else at[0]!="stop"&&at[0]!="close"||xs(w,7);else w.I==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?xs(w,7):Xc(w):at[0]!="noop"&&w.l&&w.l.qa(at),w.A=0)}}as(4)}catch{}}var en=class{constructor(h,b){this.g=h,this.map=b}};function Uc(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function zc(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ms(h){return h.h?1:h.g?h.g.size:0}function ps(h,b){return h.h?h.h==b:h.g?h.g.has(b):!1}function Bc(h,b){h.g?h.g.add(b):h.h=b}function qc(h,b){h.h&&h.h==b?h.h=null:h.g&&h.g.has(b)&&h.g.delete(b)}Uc.prototype.cancel=function(){if(this.i=Fc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Fc(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let b=h.i;for(const w of h.g.values())b=b.concat(w.G);return b}return S(h.i)}var fh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wo(h,b){if(h){h=h.split("&");for(let w=0;w<h.length;w++){const A=h[w].indexOf("=");let F,J=null;A>=0?(F=h[w].substring(0,A),J=h[w].substring(A+1)):F=h[w],b(F,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function ur(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;h instanceof ur?(this.l=h.l,gn(this,h.j),this.o=h.o,this.g=h.g,Ei(this,h.u),this.h=h.h,Hc(this,yh(h.i)),this.m=h.m):h&&(b=String(h).match(fh))?(this.l=!1,gn(this,b[1]||"",!0),this.o=gs(b[2]||""),this.g=gs(b[3]||"",!0),Ei(this,b[4]),this.h=gs(b[5]||"",!0),Hc(this,b[6]||"",!0),this.m=gs(b[7]||"")):(this.l=!1,this.i=new Ii(null,this.l))}ur.prototype.toString=function(){const h=[];var b=this.j;b&&h.push(za(b,Xo,!0),":");var w=this.g;return(w||b=="file")&&(h.push("//"),(b=this.o)&&h.push(za(b,Xo,!0),"@"),h.push(Hs(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&h.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(za(w,w.charAt(0)=="/"?Gc:mh,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",za(w,ph)),h.join("")},ur.prototype.resolve=function(h){const b=tn(this);let w=!!h.j;w?gn(b,h.j):w=!!h.o,w?b.o=h.o:w=!!h.g,w?b.g=h.g:w=h.u!=null;var A=h.h;if(w)Ei(b,h.u);else if(w=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var F=b.h.lastIndexOf("/");F!=-1&&(A=b.h.slice(0,F+1)+A)}if(F=A,F==".."||F==".")A="";else if(F.indexOf("./")!=-1||F.indexOf("/.")!=-1){A=F.lastIndexOf("/",0)==0,F=F.split("/");const J=[];for(let ge=0;ge<F.length;){const ze=F[ge++];ze=="."?A&&ge==F.length&&J.push(""):ze==".."?((J.length>1||J.length==1&&J[0]!="")&&J.pop(),A&&ge==F.length&&J.push("")):(J.push(ze),A=!0)}A=J.join("/")}else A=F}return w?b.h=A:w=h.i.toString()!=="",w?Hc(b,yh(h.i)):w=!!h.m,w&&(b.m=h.m),b};function tn(h){return new ur(h)}function gn(h,b,w){h.j=w?gs(b,!0):b,h.j&&(h.j=h.j.replace(/:$/,""))}function Ei(h,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);h.u=b}else h.u=null}function Hc(h,b,w){b instanceof Ii?(h.i=b,Zo(h.i,h.l)):(w||(b=za(b,Ti)),h.i=new Ii(b,h.l))}function ut(h,b,w){h.i.set(b,w)}function Ua(h){return ut(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function gs(h,b){return h?b?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function za(h,b,w){return typeof h=="string"?(h=encodeURI(h).replace(b,Xn),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Xn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Xo=/[#\/\?@]/g,mh=/[#\?:]/g,Gc=/[#\?]/g,Ti=/[#\?@]/g,ph=/#/g;function Ii(h,b){this.h=this.g=null,this.i=h||null,this.j=!!b}function Jn(h){h.g||(h.g=new Map,h.h=0,h.i&&Wo(h.i,function(b,w){h.add(decodeURIComponent(b.replace(/\+/g," ")),w)}))}s=Ii.prototype,s.add=function(h,b){Jn(this),this.i=null,h=Si(this,h);let w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(b),this.h+=1,this};function gh(h,b){Jn(h),b=Si(h,b),h.g.has(b)&&(h.i=null,h.h-=h.g.get(b).length,h.g.delete(b))}function Qc(h,b){return Jn(h),b=Si(h,b),h.g.has(b)}s.forEach=function(h,b){Jn(this),this.g.forEach(function(w,A){w.forEach(function(F){h.call(b,F,A,this)},this)},this)};function Kc(h,b){Jn(h);let w=[];if(typeof b=="string")Qc(h,b)&&(w=w.concat(h.g.get(Si(h,b))));else for(h=Array.from(h.g.values()),b=0;b<h.length;b++)w=w.concat(h[b]);return w}s.set=function(h,b){return Jn(this),this.i=null,h=Si(this,h),Qc(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[b]),this.h+=1,this},s.get=function(h,b){return h?(h=Kc(this,h),h.length>0?String(h[0]):b):b};function Jo(h,b,w){gh(h,b),w.length>0&&(h.i=null,h.g.set(Si(h,b),S(w)),h.h+=w.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],b=Array.from(this.g.keys());for(let A=0;A<b.length;A++){var w=b[A];const F=Hs(w);w=Kc(this,w);for(let J=0;J<w.length;J++){let ge=F;w[J]!==""&&(ge+="="+Hs(w[J])),h.push(ge)}}return this.i=h.join("&")};function yh(h){const b=new Ii;return b.i=h.i,h.g&&(b.g=new Map(h.g),b.h=h.h),b}function Si(h,b){return b=String(b),h.j&&(b=b.toLowerCase()),b}function Zo(h,b){b&&!h.j&&(Jn(h),h.i=null,h.g.forEach(function(w,A){const F=A.toLowerCase();A!=F&&(gh(this,A),Jo(this,F,w))},h)),h.j=b}function Hr(h,b){const w=new Br;if(u.Image){const A=new Image;A.onload=_(Ir,w,"TestLoadImage: loaded",!0,b,A),A.onerror=_(Ir,w,"TestLoadImage: error",!1,b,A),A.onabort=_(Ir,w,"TestLoadImage: abort",!1,b,A),A.ontimeout=_(Ir,w,"TestLoadImage: timeout",!1,b,A),u.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else b(!1)}function $c(h,b){const w=new Br,A=new AbortController,F=setTimeout(()=>{A.abort(),Ir(w,"TestPingServer: timeout",!1,b)},1e4);fetch(h,{signal:A.signal}).then(J=>{clearTimeout(F),J.ok?Ir(w,"TestPingServer: ok",!0,b):Ir(w,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(F),Ir(w,"TestPingServer: error",!1,b)})}function Ir(h,b,w,A,F){try{F&&(F.onload=null,F.onerror=null,F.onabort=null,F.ontimeout=null),A(w)}catch{}}function Ai(){this.g=new Fs}function ys(h){this.i=h.Sb||null,this.h=h.ab||!1}x(ys,Oc),ys.prototype.g=function(){return new Ba(this.i,this.h)};function Ba(h,b){We.call(this),this.H=h,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(Ba,We),s=Ba.prototype,s.open=function(h,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=b,this.readyState=1,Gr(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(b.body=h),(this.H||u).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ni(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Gr(this)),this.g&&(this.readyState=3,Gr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;el(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function el(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var b=h.value?h.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!h.done}))&&(this.response=this.responseText+=b)}h.done?Ni(this):Gr(this),this.readyState==3&&el(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,Ni(this))},s.Na=function(h){this.g&&(this.response=h,Ni(this))},s.ga=function(){this.g&&Ni(this)};function Ni(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Gr(h)}s.setRequestHeader=function(h,b){this.A.append(h,b)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],b=this.h.entries();for(var w=b.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=b.next();return h.join(`\r
`)};function Gr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ba.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Sr(h){let b="";return Ue(h,function(w,A){b+=A,b+=":",b+=w,b+=`\r
`}),b}function qa(h,b,w){e:{for(A in w){var A=!1;break e}A=!0}A||(w=Sr(w),typeof h=="string"?w!=null&&Hs(w):ut(h,b,w))}function gt(h){We.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(gt,We);var _s=/^https?$/i,Yc=["POST","PUT"];s=gt.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,b,w,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);b=b?b.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Lc.g(),this.g.onreadystatechange=T(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(h),!0),this.B=!1}catch(J){Fa(this,J);return}if(h=w||"",w=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var F in A)w.set(F,A[F]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const J of A.keys())w.set(J,A.get(J));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(w.keys()).find(J=>J.toLowerCase()=="content-type"),F=u.FormData&&h instanceof u.FormData,!(Array.prototype.indexOf.call(Yc,b,void 0)>=0)||A||F||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,ge]of w)this.g.setRequestHeader(J,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(J){Fa(this,J)}};function Fa(h,b){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=b,h.o=5,Wc(h),Gs(h)}function Wc(h){h.A||(h.A=!0,Et(h,"complete"),Et(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,Et(this,"complete"),Et(this,"abort"),Gs(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gs(this,!0)),gt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Ha(this):this.Xa())},s.Xa=function(){Ha(this)};function Ha(h){if(h.h&&typeof l<"u"){if(h.v&&Qr(h)==4)setTimeout(h.Ca.bind(h),0);else if(Et(h,"readystatechange"),Qr(h)==4){h.h=!1;try{const J=h.ca();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var w;if(!(w=b)){var A;if(A=J===0){let ge=String(h.D).match(fh)[1]||null;!ge&&u.self&&u.self.location&&(ge=u.self.location.protocol.slice(0,-1)),A=!_s.test(ge?ge.toLowerCase():"")}w=A}if(w)Et(h,"complete"),Et(h,"success");else{h.o=6;try{var F=Qr(h)>2?h.g.statusText:""}catch{F=""}h.l=F+" ["+h.ca()+"]",Wc(h)}}finally{Gs(h)}}}}function Gs(h,b){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const w=h.g;h.g=null,b||Et(h,"ready");try{w.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Qr(h){return h.g?h.g.readyState:0}s.ca=function(){try{return Qr(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var b=this.g.responseText;return h&&b.indexOf(h)==0&&(b=b.substring(h.length)),ja(b)}};function En(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Qs(h){const b={};h=(h.g&&Qr(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(R(h[A]))continue;var w=uh(h[A]);const F=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const J=b[F]||[];b[F]=J,J.push(w)}De(b,function(A){return A.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function bs(h,b,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||b}function Ri(h){this.za=0,this.i=[],this.j=new Br,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=bs("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=bs("baseRetryDelayMs",5e3,h),this.Za=bs("retryDelaySeedMs",1e4,h),this.Ta=bs("forwardChannelMaxRetries",2,h),this.va=bs("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Uc(h&&h.concurrentRequestLimit),this.Ba=new Ai,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=Ri.prototype,s.ka=8,s.I=1,s.connect=function(h,b,w,A){Jt(0),this.W=h,this.H=b||{},w&&A!==void 0&&(this.H.OSID=w,this.H.OAID=A),this.F=this.X,this.J=Th(this,null,this.W),vs(this)};function Xc(h){if(tl(h),h.I==3){var b=h.V++,w=tn(h.J);if(ut(w,"SID",h.M),ut(w,"RID",b),ut(w,"TYPE","terminate"),Ga(h,w),b=new qr(h,h.j,b),b.M=2,b.A=Ua(tn(w)),w=!1,u.navigator&&u.navigator.sendBeacon)try{w=u.navigator.sendBeacon(b.A.toString(),"")}catch{}!w&&u.Image&&(new Image().src=b.A,w=!0),w||(b.g=Ih(b.j,null),b.g.ea(b.A)),b.F=Date.now(),ds(b)}Eh(h)}function Ci(h){h.g&&(Zc(h),h.g.cancel(),h.g=null)}function tl(h){Ci(h),h.v&&(u.clearTimeout(h.v),h.v=null),rl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&u.clearTimeout(h.m),h.m=null)}function vs(h){if(!zc(h.h)&&!h.m){h.m=!0;var b=h.Ea;ae||N(),ee||(ae(),ee=!0),C.add(b,h),h.D=0}}function nl(h,b){return ms(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=b.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=ls(y(h.Ea,h,b),wh(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const F=new qr(this,this.j,h);let J=this.o;if(this.U&&(J?(J=O(J),q(J,this.U)):J=this.U),this.u!==null||this.R||(F.J=J,J=null),this.S)e:{for(var b=0,w=0;w<this.i.length;w++){t:{var A=this.i[w];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(b+=A,b>4096){b=w;break e}if(b===4096||w===this.i.length-1){b=w+1;break e}}b=1e3}else b=1e3;b=_h(this,F,b),w=tn(this.J),ut(w,"RID",h),ut(w,"CVER",22),this.G&&ut(w,"X-HTTP-Session-Id",this.G),Ga(this,w),J&&(this.R?b="headers="+Hs(Sr(J))+"&"+b:this.u&&qa(w,this.u,J)),Bc(this.h,F),this.Ra&&ut(w,"TYPE","init"),this.S?(ut(w,"$req",b),ut(w,"SID","null"),F.U=!0,us(F,w,null)):us(F,w,b),this.I=2}}else this.I==3&&(h?Jc(this,h):this.i.length==0||zc(this.h)||Jc(this))};function Jc(h,b){var w;b?w=b.l:w=h.V++;const A=tn(h.J);ut(A,"SID",h.M),ut(A,"RID",w),ut(A,"AID",h.K),Ga(h,A),h.u&&h.o&&qa(A,h.u,h.o),w=new qr(h,h.j,w,h.D+1),h.u===null&&(w.J=h.o),b&&(h.i=b.G.concat(h.i)),b=_h(h,w,1e3),w.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Bc(h.h,w),us(w,A,b)}function Ga(h,b){h.H&&Ue(h.H,function(w,A){ut(b,A,w)}),h.l&&Ue({},function(w,A){ut(b,A,w)})}function _h(h,b,w){w=Math.min(h.i.length,w);const A=h.l?y(h.l.Ka,h.l,h):null;e:{var F=h.i;let ze=-1;for(;;){const Gt=["count="+w];ze==-1?w>0?(ze=F[0].g,Gt.push("ofs="+ze)):ze=0:Gt.push("ofs="+ze);let at=!0;for(let At=0;At<w;At++){var J=F[At].g;const Ar=F[At].map;if(J-=ze,J<0)ze=Math.max(0,F[At].g-100),at=!1;else try{J="req"+J+"_"||"";try{var ge=Ar instanceof Map?Ar:Object.entries(Ar);for(const[ws,Kr]of ge){let $r=Kr;m(Kr)&&($r=Xt(Kr)),Gt.push(J+ws+"="+encodeURIComponent($r))}}catch(ws){throw Gt.push(J+"type="+encodeURIComponent("_badmap")),ws}}catch{A&&A(Ar)}}if(at){ge=Gt.join("&");break e}}ge=void 0}return h=h.i.splice(0,w),b.G=h,ge}function bh(h){if(!h.g&&!h.v){h.Y=1;var b=h.Da;ae||N(),ee||(ae(),ee=!0),C.add(b,h),h.A=0}}function Qa(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=ls(y(h.Da,h),wh(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,vh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=ls(y(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Jt(10),Ci(this),vh(this))};function Zc(h){h.B!=null&&(u.clearTimeout(h.B),h.B=null)}function vh(h){h.g=new qr(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var b=tn(h.na);ut(b,"RID","rpc"),ut(b,"SID",h.M),ut(b,"AID",h.K),ut(b,"CI",h.F?"0":"1"),!h.F&&h.ia&&ut(b,"TO",h.ia),ut(b,"TYPE","xmlhttp"),Ga(h,b),h.u&&h.o&&qa(b,h.u,h.o),h.O&&(h.g.H=h.O);var w=h.g;h=h.ba,w.M=1,w.A=Ua(tn(b)),w.u=null,w.R=!0,$o(w,h)}s.Va=function(){this.C!=null&&(this.C=null,Ci(this),Qa(this),Jt(19))};function rl(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function xh(h,b){var w=null;if(h.g==b){rl(h),Zc(h),h.g=null;var A=2}else if(ps(h.h,b))w=b.G,qc(h.h,b),A=1;else return;if(h.I!=0){if(b.o)if(A==1){w=b.u?b.u.length:0,b=Date.now()-b.F;var F=h.D;A=wi(),Et(A,new os(A,w)),vs(h)}else bh(h);else if(F=b.m,F==3||F==0&&b.X>0||!(A==1&&nl(h,b)||A==2&&Qa(h)))switch(w&&w.length>0&&(b=h.h,b.i=b.i.concat(w)),F){case 1:xs(h,5);break;case 4:xs(h,10);break;case 3:xs(h,6);break;default:xs(h,2)}}}function wh(h,b){let w=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(w*=2),w*b}function xs(h,b){if(h.j.info("Error code "+b),b==2){var w=y(h.bb,h),A=h.Ua;const F=!A;A=new ur(A||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||gn(A,"https"),Ua(A),F?Hr(A.toString(),w):$c(A.toString(),w)}else Jt(2);h.I=0,h.l&&h.l.pa(b),Eh(h),tl(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Jt(2)):(this.j.info("Failed to ping google.com"),Jt(1))};function Eh(h){if(h.I=0,h.ja=[],h.l){const b=Fc(h.h);(b.length!=0||h.i.length!=0)&&(V(h.ja,b),V(h.ja,h.i),h.h.i.length=0,S(h.i),h.i.length=0),h.l.oa()}}function Th(h,b,w){var A=w instanceof ur?tn(w):new ur(w);if(A.g!="")b&&(A.g=b+"."+A.g),Ei(A,A.u);else{var F=u.location;A=F.protocol,b=b?b+"."+F.hostname:F.hostname,F=+F.port;const J=new ur(null);A&&gn(J,A),b&&(J.g=b),F&&Ei(J,F),w&&(J.h=w),A=J}return w=h.G,b=h.wa,w&&b&&ut(A,w,b),ut(A,"VER",h.ka),Ga(h,A),A}function Ih(h,b,w){if(b&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=h.Aa&&!h.ma?new gt(new ys({ab:w})):new gt(h.ma),b.Fa(h.L),b}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sh(){}s=Sh.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function ki(){}ki.prototype.g=function(h,b){return new Bn(h,b)};function Bn(h,b){We.call(this),this.g=new Ri(b),this.l=h,this.h=b&&b.messageUrlParams||null,h=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(h?h["X-WebChannel-Content-Type"]=b.messageContentType:h={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(h?h["X-WebChannel-Client-Profile"]=b.sa:h={"X-WebChannel-Client-Profile":b.sa}),this.g.U=h,(h=b&&b.Qb)&&!R(h)&&(this.g.u=h),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!R(b)&&(this.g.G=b,h=this.h,h!==null&&b in h&&(h=this.h,b in h&&delete h[b])),this.j=new Ks(this)}x(Bn,We),Bn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Bn.prototype.close=function(){Xc(this.g)},Bn.prototype.o=function(h){var b=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.v&&(w={},w.__data__=Xt(h),h=w);b.i.push(new en(b.Ya++,h)),b.I==3&&vs(b)},Bn.prototype.N=function(){this.g.l=null,delete this.j,Xc(this.g),delete this.g,Bn.Z.N.call(this)};function Ah(h){xe.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var b=h.__sm__;if(b){e:{for(const w in b){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,b=b!==null&&h in b?b[h]:void 0),this.data=b}else this.data=h}x(Ah,xe);function Nh(){Ve.call(this),this.status=1}x(Nh,Ve);function Ks(h){this.g=h}x(Ks,Sh),Ks.prototype.ra=function(){Et(this.g,"a")},Ks.prototype.qa=function(h){Et(this.g,new Ah(h))},Ks.prototype.pa=function(h){Et(this.g,new Nh)},Ks.prototype.oa=function(){Et(this.g,"b")},ki.prototype.createWebChannel=ki.prototype.g,Bn.prototype.send=Bn.prototype.o,Bn.prototype.open=Bn.prototype.m,Bn.prototype.close=Bn.prototype.close,OS=function(){return new ki},VS=function(){return wi()},PS=Ge,W0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ma.NO_ERROR=0,Ma.TIMEOUT=8,Ma.HTTP_ERROR=6,Qf=Ma,Mc.COMPLETE="complete",jS=Mc,Ur.EventType=zn,zn.OPEN="a",zn.CLOSE="b",zn.ERROR="c",zn.MESSAGE="d",We.prototype.listen=We.prototype.J,Xu=Ur,gt.prototype.listenOnce=gt.prototype.K,gt.prototype.getLastError=gt.prototype.Ha,gt.prototype.getLastErrorCode=gt.prototype.ya,gt.prototype.getStatus=gt.prototype.ca,gt.prototype.getResponseJson=gt.prototype.La,gt.prototype.getResponseText=gt.prototype.la,gt.prototype.send=gt.prototype.ea,gt.prototype.setWithCredentials=gt.prototype.Fa,DS=gt}).apply(typeof Pf<"u"?Pf:typeof self<"u"?self:typeof window<"u"?window:{});class bn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}bn.UNAUTHENTICATED=new bn(null),bn.GOOGLE_CREDENTIALS=new bn("google-credentials-uid"),bn.FIRST_PARTY=new bn("first-party-uid"),bn.MOCK_USER=new bn("mock-user");let Nc="12.8.0";function YV(s){Nc=s}const ba=new km("@firebase/firestore");function Bl(){return ba.logLevel}function WV(s){ba.setLogLevel(s)}function he(s,...e){if(ba.logLevel<=$e.DEBUG){const t=e.map(l_);ba.debug(`Firestore (${Nc}): ${s}`,...t)}}function $t(s,...e){if(ba.logLevel<=$e.ERROR){const t=e.map(l_);ba.error(`Firestore (${Nc}): ${s}`,...t)}}function Bs(s,...e){if(ba.logLevel<=$e.WARN){const t=e.map(l_);ba.warn(`Firestore (${Nc}): ${s}`,...t)}}function l_(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function we(s,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,MS(s,r,t)}function MS(s,e,t){let r=`FIRESTORE (${Nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw $t(r),new Error(r)}function Ie(s,e,t,r){let a="Unexpected state";typeof t=="string"?a=t:r=t,s||MS(e,a,r)}function XV(s,e){s||we(57014,e)}function ve(s,e){return s}const X={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ce extends Gn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Cn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class LS{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class JV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(bn.UNAUTHENTICATED)))}shutdown(){}}class ZV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class eO{constructor(e){this.t=e,this.currentUser=bn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ie(this.o===void 0,42304);let r=this.i;const a=g=>this.i!==r?(r=this.i,t(g)):Promise.resolve();let l=new Cn;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Cn,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const g=l;e.enqueueRetryable((async()=>{await g.promise,await a(this.currentUser)}))},m=g=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=g,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((g=>m(g))),setTimeout((()=>{if(!this.auth){const g=this.t.getImmediate({optional:!0});g?m(g):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Cn)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ie(typeof r.accessToken=="string",31837,{l:r}),new LS(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ie(e===null||typeof e=="string",2055,{h:e}),new bn(e)}}class tO{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=bn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class nO{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new tO(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(bn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class DE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rO{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ct(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ie(this.o===void 0,3512);const r=l=>{l.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,he("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>r(l)))};const a=l=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new DE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ie(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new DE(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function sO(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<s;r++)t[r]=Math.floor(256*Math.random());return t}class c_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=sO(40);for(let l=0;l<a.length;++l)r.length<20&&a[l]<t&&(r+=e.charAt(a[l]%62))}return r}}function Oe(s,e){return s<e?-1:s>e?1:0}function X0(s,e){const t=Math.min(s.length,e.length);for(let r=0;r<t;r++){const a=s.charAt(r),l=e.charAt(r);if(a!==l)return A0(a)===A0(l)?Oe(a,l):A0(a)?1:-1}return Oe(s.length,e.length)}const iO=55296,aO=57343;function A0(s){const e=s.charCodeAt(0);return e>=iO&&e<=aO}function sc(s,e,t){return s.length===e.length&&s.every(((r,a)=>t(r,e[a])))}function US(s){return s+"\0"}const jE="__name__";class As{constructor(e,t,r){t===void 0?t=0:t>e.length&&we(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&we(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return As.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof As?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const l=As.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return Oe(e.length,t.length)}static compareSegments(e,t){const r=As.isNumericId(e),a=As.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?As.extractNumericId(e).compare(As.extractNumericId(t)):X0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ha.fromString(e.substring(4,e.length-2))}}class Ye extends As{construct(e,t,r){return new Ye(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ce(X.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((a=>a.length>0)))}return new Ye(t)}static emptyPath(){return new Ye([])}}const oO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kt extends As{construct(e,t,r){return new kt(e,t,r)}static isValidIdentifier(e){return oO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===jE}static keyField(){return new kt([jE])}static fromServerFormat(e){const t=[];let r="",a=0;const l=()=>{if(r.length===0)throw new ce(X.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let u=!1;for(;a<e.length;){const m=e[a];if(m==="\\"){if(a+1===e.length)throw new ce(X.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const g=e[a+1];if(g!=="\\"&&g!=="."&&g!=="`")throw new ce(X.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=g,a+=2}else m==="`"?(u=!u,a++):m!=="."||u?(r+=m,a++):(l(),a++)}if(l(),u)throw new ce(X.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kt(t)}static emptyPath(){return new kt([])}}class ye{constructor(e){this.path=e}static fromPath(e){return new ye(Ye.fromString(e))}static fromName(e){return new ye(Ye.fromString(e).popFirst(5))}static empty(){return new ye(Ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ye.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ye(new Ye(e.slice()))}}function u_(s,e,t){if(!t)throw new ce(X.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function zS(s,e,t,r){if(e===!0&&r===!0)throw new ce(X.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function PE(s){if(!ye.isDocumentKey(s))throw new ce(X.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function VE(s){if(ye.isDocumentKey(s))throw new ce(X.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function BS(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function Fm(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":we(12329,{type:typeof s})}function it(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new ce(X.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Fm(s);throw new ce(X.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function qS(s,e){if(e<=0)throw new ce(X.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function cn(s,e){const t={typeString:s};return e&&(t.value=e),t}function $d(s,e){if(!BS(s))throw new ce(X.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const a=e[r].typeString,l="value"in e[r]?{value:e[r].value}:void 0;if(!(r in s)){t=`JSON missing required field: '${r}'`;break}const u=s[r];if(a&&typeof u!==a){t=`JSON field '${r}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${r}' field to equal '${l.value}'`;break}}if(t)throw new ce(X.INVALID_ARGUMENT,t);return!0}const OE=-62135596800,ME=1e6;class ct{static now(){return ct.fromMillis(Date.now())}static fromDate(e){return ct.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*ME);return new ct(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ce(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ce(X.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<OE)throw new ce(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ce(X.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ME}_compareTo(e){return this.seconds===e.seconds?Oe(this.nanoseconds,e.nanoseconds):Oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ct._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($d(e,ct._jsonSchema))return new ct(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-OE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ct._jsonSchemaVersion="firestore/timestamp/1.0",ct._jsonSchema={type:cn("string",ct._jsonSchemaVersion),seconds:cn("number"),nanoseconds:cn("number")};class Re{static fromTimestamp(e){return new Re(e)}static min(){return new Re(new ct(0,0))}static max(){return new Re(new ct(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ic=-1;class fm{constructor(e,t,r,a){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=a}}function J0(s){return s.fields.find((e=>e.kind===2))}function ho(s){return s.fields.filter((e=>e.kind!==2))}fm.UNKNOWN_ID=-1;class Kf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Id{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Id(0,wr.min())}}function FS(s,e){const t=s.toTimestamp().seconds,r=s.toTimestamp().nanoseconds+1,a=Re.fromTimestamp(r===1e9?new ct(t+1,0):new ct(t,r));return new wr(a,ye.empty(),e)}function HS(s){return new wr(s.readTime,s.key,ic)}class wr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new wr(Re.min(),ye.empty(),ic)}static max(){return new wr(Re.max(),ye.empty(),ic)}}function d_(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ye.comparator(s.documentKey,e.documentKey),t!==0?t:Oe(s.largestBatchId,e.largestBatchId))}const GS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class QS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Na(s){if(s.code!==X.FAILED_PRECONDITION||s.message!==GS)throw s;he("LocalStore","Unexpectedly lost primary lease")}class B{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&we(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new B(((r,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(r,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(r,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof B?t:B.resolve(t)}catch(t){return B.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):B.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):B.reject(t)}static resolve(e){return new B(((t,r)=>{t(e)}))}static reject(e){return new B(((t,r)=>{r(e)}))}static waitFor(e){return new B(((t,r)=>{let a=0,l=0,u=!1;e.forEach((m=>{++a,m.next((()=>{++l,u&&l===a&&t()}),(g=>r(g)))})),u=!0,l===a&&t()}))}static or(e){let t=B.resolve(!1);for(const r of e)t=t.next((a=>a?B.resolve(a):r()));return t}static forEach(e,t){const r=[];return e.forEach(((a,l)=>{r.push(t.call(this,a,l))})),this.waitFor(r)}static mapArray(e,t){return new B(((r,a)=>{const l=e.length,u=new Array(l);let m=0;for(let g=0;g<l;g++){const y=g;t(e[y]).next((_=>{u[y]=_,++m,m===l&&r(u)}),(_=>a(_)))}}))}static doWhile(e,t){return new B(((r,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):r()};l()}))}}const _r="SimpleDb";class Hm{static open(e,t,r,a){try{return new Hm(t,e.transaction(a,r))}catch(l){throw new ld(t,l)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Cn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ld(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const a=h_(r.target.error);this.S.reject(new ld(e,a))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(he(_r,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new cO(t)}}class Ms{static delete(e){return he(_r,"Removing database:",e),mo(jy().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!_d())return!1;if(Ms.F())return!0;const e=Ot(),t=Ms.M(e),r=0<t&&t<10,a=KS(e),l=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||l)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Ms.M(Ot())===12.2&&$t("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(he(_r,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=l=>{const u=l.target.result;t(u)},a.onblocked=()=>{r(new ld(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const u=l.target.error;u.name==="VersionError"?r(new ce(X.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?r(new ce(X.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):r(new ld(e,u))},a.onupgradeneeded=l=>{he(_r,'Database "'+this.name+'" requires upgrade from version:',l.oldVersion);const u=l.target.result;this.N.k(u,a.transaction,l.oldVersion,this.version).next((()=>{he(_r,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,a){const l=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const m=Hm.open(this.db,e,l?"readonly":"readwrite",r),g=a(m).next((y=>(m.C(),y))).catch((y=>(m.abort(y),B.reject(y)))).toPromise();return g.catch((()=>{})),await m.D,g}catch(m){const g=m,y=g.name!=="FirebaseError"&&u<3;if(he(_r,"Transaction failed with error:",g.message,"Retrying:",y),this.close(),!y)return Promise.reject(g)}}}close(){this.db&&this.db.close(),this.db=void 0}}function KS(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class lO{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return mo(this.U.delete())}}class ld extends ce{constructor(e,t){super(X.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ra(s){return s.name==="IndexedDbTransactionError"}class cO{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(he(_r,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(he(_r,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),mo(r)}add(e){return he(_r,"ADD",this.store.name,e,e),mo(this.store.add(e))}get(e){return mo(this.store.get(e)).next((t=>(t===void 0&&(t=null),he(_r,"GET",this.store.name,e,t),t)))}delete(e){return he(_r,"DELETE",this.store.name,e),mo(this.store.delete(e))}count(){return he(_r,"COUNT",this.store.name),mo(this.store.count())}H(e,t){const r=this.options(e,t),a=r.index?this.store.index(r.index):this.store;if(typeof a.getAll=="function"){const l=a.getAll(r.range);return new B(((u,m)=>{l.onerror=g=>{m(g.target.error)},l.onsuccess=g=>{u(g.target.result)}}))}{const l=this.cursor(r),u=[];return this.J(l,((m,g)=>{u.push(g)})).next((()=>u))}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new B(((a,l)=>{r.onerror=u=>{l(u.target.error)},r.onsuccess=u=>{a(u.target.result)}}))}X(e,t){he(_r,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const a=this.cursor(r);return this.J(a,((l,u,m)=>m.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const a=this.cursor(r);return this.J(a,t)}te(e){const t=this.cursor({});return new B(((r,a)=>{t.onerror=l=>{const u=h_(l.target.error);a(u)},t.onsuccess=l=>{const u=l.target.result;u?e(u.primaryKey,u.value).next((m=>{m?u.continue():r()})):r()}}))}J(e,t){const r=[];return new B(((a,l)=>{e.onerror=u=>{l(u.target.error)},e.onsuccess=u=>{const m=u.target.result;if(!m)return void a();const g=new lO(m),y=t(m.primaryKey,m.value,g);if(y instanceof B){const _=y.catch((x=>(g.done(),B.reject(x))));r.push(_)}g.isDone?a():g.G===null?m.continue():m.continue(g.G)}})).next((()=>B.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function mo(s){return new B(((e,t)=>{s.onsuccess=r=>{const a=r.target.result;e(a)},s.onerror=r=>{const a=h_(r.target.error);t(a)}}))}let LE=!1;function h_(s){const e=Ms.M(Ot());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(t)>=0){const r=new ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return LE||(LE=!0,setTimeout((()=>{throw r}),0)),r}}return s}const cd="IndexBackfiller";class uO{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){he(cd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();he(cd,`Documents written: ${t}`)}catch(t){Ra(t)?he(cd,"Ignoring IndexedDB error during index backfill: ",t):await Na(t)}await this.re(6e4)}))}}class dO{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let a=t,l=!0;return B.doWhile((()=>l===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!r.has(u))return he(cd,`Processing collection: ${u}`),this.oe(e,u,a).next((m=>{a-=m,r.add(u)}));l=!1})))).next((()=>t-a))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,r).next((l=>{const u=l.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(a,l))).next((m=>(he(cd,`Updating offset: ${m}`),this.localStore.indexManager.updateCollectionGroup(e,t,m)))).next((()=>u.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((a,l)=>{const u=HS(l);d_(u,r)>0&&(r=u)})),new wr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ir{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ir.ce=-1;const fa=-1;function Yd(s){return s==null}function Sd(s){return s===0&&1/s==-1/0}function $S(s){return typeof s=="number"&&Number.isInteger(s)&&!Sd(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const mm="";function Ln(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=UE(e)),e=hO(s.get(t),e);return UE(e)}function hO(s,e){let t=e;const r=s.length;for(let a=0;a<r;a++){const l=s.charAt(a);switch(l){case"\0":t+="";break;case mm:t+="";break;default:t+=l}}return t}function UE(s){return s+mm+""}function Ps(s){const e=s.length;if(Ie(e>=2,64408,{path:s}),e===2)return Ie(s.charAt(0)===mm&&s.charAt(1)==="",56145,{path:s}),Ye.emptyPath();const t=e-2,r=[];let a="";for(let l=0;l<e;){const u=s.indexOf(mm,l);switch((u<0||u>t)&&we(50515,{path:s}),s.charAt(u+1)){case"":const m=s.substring(l,u);let g;a.length===0?g=m:(a+=m,g=a,a=""),r.push(g);break;case"":a+=s.substring(l,u),a+="\0";break;case"":a+=s.substring(l,u+1);break;default:we(61167,{path:s})}l=u+2}return new Ye(r)}const fo="remoteDocuments",Wd="owner",Vl="owner",Ad="mutationQueues",fO="userId",Jr="mutations",zE="batchId",vo="userMutationsIndex",BE=["userId","batchId"];function $f(s,e){return[s,Ln(e)]}function YS(s,e,t){return[s,Ln(e),t]}const mO={},ac="documentMutations",pm="remoteDocumentsV14",pO=["prefixPath","collectionGroup","readTime","documentId"],Yf="documentKeyIndex",gO=["prefixPath","collectionGroup","documentId"],WS="collectionGroupIndex",yO=["collectionGroup","readTime","prefixPath","documentId"],Nd="remoteDocumentGlobal",Z0="remoteDocumentGlobalKey",oc="targets",XS="queryTargetsIndex",_O=["canonicalId","targetId"],lc="targetDocuments",bO=["targetId","path"],f_="documentTargetsIndex",vO=["path","targetId"],gm="targetGlobalKey",Ao="targetGlobal",Rd="collectionParents",xO=["collectionId","parent"],cc="clientMetadata",wO="clientId",Gm="bundles",EO="bundleId",Qm="namedQueries",TO="name",m_="indexConfiguration",IO="indexId",ey="collectionGroupIndex",SO="collectionGroup",ud="indexState",AO=["indexId","uid"],JS="sequenceNumberIndex",NO=["uid","sequenceNumber"],dd="indexEntries",RO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ZS="documentKeyIndex",CO=["indexId","uid","orderedDocumentKey"],Km="documentOverlays",kO=["userId","collectionPath","documentId"],ty="collectionPathOverlayIndex",DO=["userId","collectionPath","largestBatchId"],e1="collectionGroupOverlayIndex",jO=["userId","collectionGroup","largestBatchId"],p_="globals",PO="name",t1=[Ad,Jr,ac,fo,oc,Wd,Ao,lc,cc,Nd,Rd,Gm,Qm],VO=[...t1,Km],n1=[Ad,Jr,ac,pm,oc,Wd,Ao,lc,cc,Nd,Rd,Gm,Qm,Km],r1=n1,g_=[...r1,m_,ud,dd],OO=g_,s1=[...g_,p_],MO=s1;class ny extends QS{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function mn(s,e){const t=ve(s);return Ms.O(t.le,e)}function qE(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Ca(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function i1(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class wt{constructor(e,t){this.comparator=e,this.root=t||Nn.EMPTY}insert(e,t){return new wt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Nn.BLACK,null,null))}remove(e){return new wt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vf(this.root,e,this.comparator,!0)}}class Vf{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nn{constructor(e,t,r,a,l){this.key=e,this.value=t,this.color=r??Nn.RED,this.left=a??Nn.EMPTY,this.right=l??Nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,l){return new Nn(e??this.key,t??this.value,r??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const l=r(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,r),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Nn.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw we(43730,{key:this.key,value:this.value});if(this.right.isRed())throw we(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw we(27949);return e+(this.isRed()?0:1)}}Nn.EMPTY=null,Nn.RED=!0,Nn.BLACK=!1;Nn.EMPTY=new class{constructor(){this.size=0}get key(){throw we(57766)}get value(){throw we(16141)}get color(){throw we(16727)}get left(){throw we(29726)}get right(){throw we(36894)}copy(e,t,r,a,l){return this}insert(e,t,r){return new Nn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mt{constructor(e){this.comparator=e,this.data=new wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new FE(this.data.getIterator())}getIteratorFrom(e){return new FE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mt(this.comparator);return t.data=e,t}}class FE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ol(s){return s.hasNext()?s.getNext():void 0}class ar{constructor(e){this.fields=e,e.sort(kt.comparator)}static empty(){return new ar([])}unionWith(e){let t=new mt(kt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ar(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sc(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class a1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function LO(){return typeof atob<"u"}class Bt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new a1("Invalid base64 string: "+l):l}})(e);return new Bt(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new Bt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bt.EMPTY_BYTE_STRING=new Bt("");const UO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mi(s){if(Ie(!!s,39018),typeof s=="string"){let e=0;const t=UO.exec(s);if(Ie(!!t,46558,{timestamp:s}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(s);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Rt(s.seconds),nanos:Rt(s.nanos)}}function Rt(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function pi(s){return typeof s=="string"?Bt.fromBase64String(s):Bt.fromUint8Array(s)}const o1="server_timestamp",l1="__type__",c1="__previous_value__",u1="__local_write_time__";function $m(s){return(s?.mapValue?.fields||{})[l1]?.stringValue===o1}function Ym(s){const e=s.mapValue.fields[c1];return $m(e)?Ym(e):e}function Cd(s){const e=mi(s.mapValue.fields[u1].timestampValue);return new ct(e.seconds,e.nanos)}class zO{constructor(e,t,r,a,l,u,m,g,y,_,x){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=m,this.longPollingOptions=g,this.useFetchStreams=y,this.isUsingEmulator=_,this.apiKey=x}}const ry="(default)";class va{constructor(e,t){this.projectId=e,this.database=t||ry}static empty(){return new va("","")}get isDefaultDatabase(){return this.database===ry}isEqual(e){return e instanceof va&&e.projectId===this.projectId&&e.database===this.database}}function BO(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new ce(X.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new va(s.options.projectId,e)}const y_="__type__",d1="__max__",la={mapValue:{fields:{__type__:{stringValue:d1}}}},__="__vector__",uc="value",Wf={nullValue:"NULL_VALUE"};function xa(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?$m(s)?4:h1(s)?9007199254740991:Wm(s)?10:11:we(28295,{value:s})}function qs(s,e){if(s===e)return!0;const t=xa(s);if(t!==xa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Cd(s).isEqual(Cd(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=mi(a.timestampValue),m=mi(l.timestampValue);return u.seconds===m.seconds&&u.nanos===m.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(a,l){return pi(a.bytesValue).isEqual(pi(l.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(a,l){return Rt(a.geoPointValue.latitude)===Rt(l.geoPointValue.latitude)&&Rt(a.geoPointValue.longitude)===Rt(l.geoPointValue.longitude)})(s,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Rt(a.integerValue)===Rt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Rt(a.doubleValue),m=Rt(l.doubleValue);return u===m?Sd(u)===Sd(m):isNaN(u)&&isNaN(m)}return!1})(s,e);case 9:return sc(s.arrayValue.values||[],e.arrayValue.values||[],qs);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},m=l.mapValue.fields||{};if(qE(u)!==qE(m))return!1;for(const g in u)if(u.hasOwnProperty(g)&&(m[g]===void 0||!qs(u[g],m[g])))return!1;return!0})(s,e);default:return we(52216,{left:s})}}function kd(s,e){return(s.values||[]).find((t=>qs(t,e)))!==void 0}function wa(s,e){if(s===e)return 0;const t=xa(s),r=xa(e);if(t!==r)return Oe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Oe(s.booleanValue,e.booleanValue);case 2:return(function(l,u){const m=Rt(l.integerValue||l.doubleValue),g=Rt(u.integerValue||u.doubleValue);return m<g?-1:m>g?1:m===g?0:isNaN(m)?isNaN(g)?0:-1:1})(s,e);case 3:return HE(s.timestampValue,e.timestampValue);case 4:return HE(Cd(s),Cd(e));case 5:return X0(s.stringValue,e.stringValue);case 6:return(function(l,u){const m=pi(l),g=pi(u);return m.compareTo(g)})(s.bytesValue,e.bytesValue);case 7:return(function(l,u){const m=l.split("/"),g=u.split("/");for(let y=0;y<m.length&&y<g.length;y++){const _=Oe(m[y],g[y]);if(_!==0)return _}return Oe(m.length,g.length)})(s.referenceValue,e.referenceValue);case 8:return(function(l,u){const m=Oe(Rt(l.latitude),Rt(u.latitude));return m!==0?m:Oe(Rt(l.longitude),Rt(u.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return GE(s.arrayValue,e.arrayValue);case 10:return(function(l,u){const m=l.fields||{},g=u.fields||{},y=m[uc]?.arrayValue,_=g[uc]?.arrayValue,x=Oe(y?.values?.length||0,_?.values?.length||0);return x!==0?x:GE(y,_)})(s.mapValue,e.mapValue);case 11:return(function(l,u){if(l===la.mapValue&&u===la.mapValue)return 0;if(l===la.mapValue)return 1;if(u===la.mapValue)return-1;const m=l.fields||{},g=Object.keys(m),y=u.fields||{},_=Object.keys(y);g.sort(),_.sort();for(let x=0;x<g.length&&x<_.length;++x){const T=X0(g[x],_[x]);if(T!==0)return T;const S=wa(m[g[x]],y[_[x]]);if(S!==0)return S}return Oe(g.length,_.length)})(s.mapValue,e.mapValue);default:throw we(23264,{he:t})}}function HE(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Oe(s,e);const t=mi(s),r=mi(e),a=Oe(t.seconds,r.seconds);return a!==0?a:Oe(t.nanos,r.nanos)}function GE(s,e){const t=s.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const l=wa(t[a],r[a]);if(l)return l}return Oe(t.length,r.length)}function dc(s){return sy(s)}function sy(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const r=mi(t);return`time(${r.seconds},${r.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return pi(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ye.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let r="[",a=!0;for(const l of t.values||[])a?a=!1:r+=",",r+=sy(l);return r+"]"})(s.arrayValue):"mapValue"in s?(function(t){const r=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const u of r)l?l=!1:a+=",",a+=`${u}:${sy(t.fields[u])}`;return a+"}"})(s.mapValue):we(61005,{value:s})}function Xf(s){switch(xa(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ym(s);return e?16+Xf(e):16;case 5:return 2*s.stringValue.length;case 6:return pi(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((a,l)=>a+Xf(l)),0)})(s.arrayValue);case 10:case 11:return(function(r){let a=0;return Ca(r.fields,((l,u)=>{a+=l.length+Xf(u)})),a})(s.mapValue);default:throw we(13486,{value:s})}}function ko(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function iy(s){return!!s&&"integerValue"in s}function Dd(s){return!!s&&"arrayValue"in s}function QE(s){return!!s&&"nullValue"in s}function KE(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Jf(s){return!!s&&"mapValue"in s}function Wm(s){return(s?.mapValue?.fields||{})[y_]?.stringValue===__}function hd(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Ca(s.mapValue.fields,((t,r)=>e.mapValue.fields[t]=hd(r))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hd(s.arrayValue.values[t]);return e}return{...s}}function h1(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===d1}const f1={mapValue:{fields:{[y_]:{stringValue:__},[uc]:{arrayValue:{}}}}};function qO(s){return"nullValue"in s?Wf:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?ko(va.empty(),ye.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?Wm(s)?f1:{mapValue:{}}:we(35942,{value:s})}function FO(s){return"nullValue"in s?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?ko(va.empty(),ye.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?f1:"mapValue"in s?Wm(s)?{mapValue:{}}:la:we(61959,{value:s})}function $E(s,e){const t=wa(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?-1:!s.inclusive&&e.inclusive?1:0}function YE(s,e){const t=wa(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?1:!s.inclusive&&e.inclusive?-1:0}class Rn{constructor(e){this.value=e}static empty(){return new Rn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Jf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hd(t)}setAll(e){let t=kt.emptyPath(),r={},a=[];e.forEach(((u,m)=>{if(!t.isImmediateParentOf(m)){const g=this.getFieldsMap(t);this.applyChanges(g,r,a),r={},a=[],t=m.popLast()}u?r[m.lastSegment()]=hd(u):a.push(m.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,r,a)}delete(e){const t=this.field(e.popLast());Jf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];Jf(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){Ca(t,((a,l)=>e[a]=l));for(const a of r)delete e[a]}clone(){return new Rn(hd(this.value))}}function m1(s){const e=[];return Ca(s.fields,((t,r)=>{const a=new kt([t]);if(Jf(r)){const l=m1(r.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new ar(e)}class St{constructor(e,t,r,a,l,u,m){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=l,this.data=u,this.documentState=m}static newInvalidDocument(e){return new St(e,0,Re.min(),Re.min(),Re.min(),Rn.empty(),0)}static newFoundDocument(e,t,r,a){return new St(e,1,t,Re.min(),r,a,0)}static newNoDocument(e,t){return new St(e,2,t,Re.min(),Re.min(),Rn.empty(),0)}static newUnknownDocument(e,t){return new St(e,3,t,Re.min(),Re.min(),Rn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof St&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new St(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ea{constructor(e,t){this.position=e,this.inclusive=t}}function WE(s,e,t){let r=0;for(let a=0;a<s.position.length;a++){const l=e[a],u=s.position[a];if(l.field.isKeyField()?r=ye.comparator(ye.fromName(u.referenceValue),t.key):r=wa(u,t.data.field(l.field)),l.dir==="desc"&&(r*=-1),r!==0)break}return r}function XE(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!qs(s.position[t],e.position[t]))return!1;return!0}class jd{constructor(e,t="asc"){this.field=e,this.dir=t}}function HO(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class p1{}class Ze extends p1{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new GO(e,t,r):t==="array-contains"?new $O(e,r):t==="in"?new x1(e,r):t==="not-in"?new YO(e,r):t==="array-contains-any"?new WO(e,r):new Ze(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new QO(e,r):new KO(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(wa(t,this.value)):t!==null&&xa(this.value)===xa(t)&&this.matchesComparison(wa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return we(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ft extends p1{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ft(e,t)}matches(e){return hc(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function hc(s){return s.op==="and"}function ay(s){return s.op==="or"}function b_(s){return g1(s)&&hc(s)}function g1(s){for(const e of s.filters)if(e instanceof ft)return!1;return!0}function oy(s){if(s instanceof Ze)return s.field.canonicalString()+s.op.toString()+dc(s.value);if(b_(s))return s.filters.map((e=>oy(e))).join(",");{const e=s.filters.map((t=>oy(t))).join(",");return`${s.op}(${e})`}}function y1(s,e){return s instanceof Ze?(function(r,a){return a instanceof Ze&&r.op===a.op&&r.field.isEqual(a.field)&&qs(r.value,a.value)})(s,e):s instanceof ft?(function(r,a){return a instanceof ft&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((l,u,m)=>l&&y1(u,a.filters[m])),!0):!1})(s,e):void we(19439)}function _1(s,e){const t=s.filters.concat(e);return ft.create(t,s.op)}function b1(s){return s instanceof Ze?(function(t){return`${t.field.canonicalString()} ${t.op} ${dc(t.value)}`})(s):s instanceof ft?(function(t){return t.op.toString()+" {"+t.getFilters().map(b1).join(" ,")+"}"})(s):"Filter"}class GO extends Ze{constructor(e,t,r){super(e,t,r),this.key=ye.fromName(r.referenceValue)}matches(e){const t=ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class QO extends Ze{constructor(e,t){super(e,"in",t),this.keys=v1("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class KO extends Ze{constructor(e,t){super(e,"not-in",t),this.keys=v1("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function v1(s,e){return(e.arrayValue?.values||[]).map((t=>ye.fromName(t.referenceValue)))}class $O extends Ze{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Dd(t)&&kd(t.arrayValue,this.value)}}class x1 extends Ze{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&kd(this.value.arrayValue,t)}}class YO extends Ze{constructor(e,t){super(e,"not-in",t)}matches(e){if(kd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!kd(this.value.arrayValue,t)}}class WO extends Ze{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Dd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>kd(this.value.arrayValue,r)))}}class XO{constructor(e,t=null,r=[],a=[],l=null,u=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=l,this.startAt=u,this.endAt=m,this.Te=null}}function ly(s,e=null,t=[],r=[],a=null,l=null,u=null){return new XO(s,e,t,r,a,l,u)}function Do(s){const e=ve(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>oy(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(l){return l.field.canonicalString()+l.dir})(r))).join(","),Yd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>dc(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>dc(r))).join(",")),e.Te=t}return e.Te}function Xd(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!HO(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!y1(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!XE(s.startAt,e.startAt)&&XE(s.endAt,e.endAt)}function ym(s){return ye.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function _m(s,e){return s.filters.filter((t=>t instanceof Ze&&t.field.isEqual(e)))}function JE(s,e,t){let r=Wf,a=!0;for(const l of _m(s,e)){let u=Wf,m=!0;switch(l.op){case"<":case"<=":u=qO(l.value);break;case"==":case"in":case">=":u=l.value;break;case">":u=l.value,m=!1;break;case"!=":case"not-in":u=Wf}$E({value:r,inclusive:a},{value:u,inclusive:m})<0&&(r=u,a=m)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const u=t.position[l];$E({value:r,inclusive:a},{value:u,inclusive:t.inclusive})<0&&(r=u,a=t.inclusive);break}}return{value:r,inclusive:a}}function ZE(s,e,t){let r=la,a=!0;for(const l of _m(s,e)){let u=la,m=!0;switch(l.op){case">=":case">":u=FO(l.value),m=!1;break;case"==":case"in":case"<=":u=l.value;break;case"<":u=l.value,m=!1;break;case"!=":case"not-in":u=la}YE({value:r,inclusive:a},{value:u,inclusive:m})>0&&(r=u,a=m)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const u=t.position[l];YE({value:r,inclusive:a},{value:u,inclusive:t.inclusive})>0&&(r=u,a=t.inclusive);break}}return{value:r,inclusive:a}}class _i{constructor(e,t=null,r=[],a=[],l=null,u="F",m=null,g=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=l,this.limitType=u,this.startAt=m,this.endAt=g,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function w1(s,e,t,r,a,l,u,m){return new _i(s,e,t,r,a,l,u,m)}function Rc(s){return new _i(s)}function eT(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function JO(s){return ye.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function v_(s){return s.collectionGroup!==null}function Xl(s){const e=ve(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let m=new mt(kt.comparator);return u.filters.forEach((g=>{g.getFlattenedFilters().forEach((y=>{y.isInequality()&&(m=m.add(y.field))}))})),m})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new jd(l,r))})),t.has(kt.keyField().canonicalString())||e.Ie.push(new jd(kt.keyField(),r))}return e.Ie}function Qn(s){const e=ve(s);return e.Ee||(e.Ee=ZO(e,Xl(s))),e.Ee}function ZO(s,e){if(s.limitType==="F")return ly(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new jd(a.field,l)}));const t=s.endAt?new Ea(s.endAt.position,s.endAt.inclusive):null,r=s.startAt?new Ea(s.startAt.position,s.startAt.inclusive):null;return ly(s.path,s.collectionGroup,e,s.filters,s.limit,t,r)}}function cy(s,e){const t=s.filters.concat([e]);return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function eM(s,e){const t=s.explicitOrderBy.concat([e]);return new _i(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function bm(s,e,t){return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function tM(s,e){return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,e,s.endAt)}function nM(s,e){return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,e)}function Jd(s,e){return Xd(Qn(s),Qn(e))&&s.limitType===e.limitType}function E1(s){return`${Do(Qn(s))}|lt:${s.limitType}`}function ql(s){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((a=>b1(a))).join(", ")}]`),Yd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((a=>dc(a))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((a=>dc(a))).join(",")),`Target(${r})`})(Qn(s))}; limitType=${s.limitType})`}function Zd(s,e){return e.isFoundDocument()&&(function(r,a){const l=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(l):ye.isDocumentKey(r.path)?r.path.isEqual(l):r.path.isImmediateParentOf(l)})(s,e)&&(function(r,a){for(const l of Xl(r))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(s,e)&&(function(r,a){for(const l of r.filters)if(!l.matches(a))return!1;return!0})(s,e)&&(function(r,a){return!(r.startAt&&!(function(u,m,g){const y=WE(u,m,g);return u.inclusive?y<=0:y<0})(r.startAt,Xl(r),a)||r.endAt&&!(function(u,m,g){const y=WE(u,m,g);return u.inclusive?y>=0:y>0})(r.endAt,Xl(r),a))})(s,e)}function T1(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function I1(s){return(e,t)=>{let r=!1;for(const a of Xl(s)){const l=rM(a,e,t);if(l!==0)return l;r=r||a.field.isKeyField()}return 0}}function rM(s,e,t){const r=s.field.isKeyField()?ye.comparator(e.key,t.key):(function(l,u,m){const g=u.data.field(l),y=m.data.field(l);return g!==null&&y!==null?wa(g,y):we(42886)})(s.field,e,t);switch(s.dir){case"asc":return r;case"desc":return-1*r;default:return we(19790,{direction:s.dir})}}class bi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,l]of r)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ca(this.inner,((t,r)=>{for(const[a,l]of r)e(a,l)}))}isEmpty(){return i1(this.inner)}size(){return this.innerSize}}const sM=new wt(ye.comparator);function or(){return sM}const S1=new wt(ye.comparator);function Ju(...s){let e=S1;for(const t of s)e=e.insert(t.key,t);return e}function A1(s){let e=S1;return s.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Vs(){return fd()}function N1(){return fd()}function fd(){return new bi((s=>s.toString()),((s,e)=>s.isEqual(e)))}const iM=new wt(ye.comparator),aM=new mt(ye.comparator);function qe(...s){let e=aM;for(const t of s)e=e.add(t);return e}const oM=new mt(Oe);function x_(){return oM}function w_(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Sd(e)?"-0":e}}function R1(s){return{integerValue:""+s}}function C1(s,e){return $S(e)?R1(e):w_(s,e)}class Xm{constructor(){this._=void 0}}function lM(s,e,t){return s instanceof fc?(function(a,l){const u={fields:{[l1]:{stringValue:o1},[u1]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&$m(l)&&(l=Ym(l)),l&&(u.fields[c1]=l),{mapValue:u}})(t,e):s instanceof jo?D1(s,e):s instanceof Po?j1(s,e):(function(a,l){const u=k1(a,l),m=tT(u)+tT(a.Ae);return iy(u)&&iy(a.Ae)?R1(m):w_(a.serializer,m)})(s,e)}function cM(s,e,t){return s instanceof jo?D1(s,e):s instanceof Po?j1(s,e):t}function k1(s,e){return s instanceof mc?(function(r){return iy(r)||(function(l){return!!l&&"doubleValue"in l})(r)})(e)?e:{integerValue:0}:null}class fc extends Xm{}class jo extends Xm{constructor(e){super(),this.elements=e}}function D1(s,e){const t=P1(e);for(const r of s.elements)t.some((a=>qs(a,r)))||t.push(r);return{arrayValue:{values:t}}}class Po extends Xm{constructor(e){super(),this.elements=e}}function j1(s,e){let t=P1(e);for(const r of s.elements)t=t.filter((a=>!qs(a,r)));return{arrayValue:{values:t}}}class mc extends Xm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function tT(s){return Rt(s.integerValue||s.doubleValue)}function P1(s){return Dd(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class eh{constructor(e,t){this.field=e,this.transform=t}}function uM(s,e){return s.field.isEqual(e.field)&&(function(r,a){return r instanceof jo&&a instanceof jo||r instanceof Po&&a instanceof Po?sc(r.elements,a.elements,qs):r instanceof mc&&a instanceof mc?qs(r.Ae,a.Ae):r instanceof fc&&a instanceof fc})(s.transform,e.transform)}class dM{constructor(e,t){this.version=e,this.transformResults=t}}class Dt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Dt}static exists(e){return new Dt(void 0,e)}static updateTime(e){return new Dt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zf(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Jm{}function V1(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new kc(s.key,Dt.none()):new Cc(s.key,s.data,Dt.none());{const t=s.data,r=Rn.empty();let a=new mt(kt.comparator);for(let l of e.fields)if(!a.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?r.delete(l):r.set(l,u),a=a.add(l)}return new vi(s.key,r,new ar(a.toArray()),Dt.none())}}function hM(s,e,t){s instanceof Cc?(function(a,l,u){const m=a.value.clone(),g=rT(a.fieldTransforms,l,u.transformResults);m.setAll(g),l.convertToFoundDocument(u.version,m).setHasCommittedMutations()})(s,e,t):s instanceof vi?(function(a,l,u){if(!Zf(a.precondition,l))return void l.convertToUnknownDocument(u.version);const m=rT(a.fieldTransforms,l,u.transformResults),g=l.data;g.setAll(O1(a)),g.setAll(m),l.convertToFoundDocument(u.version,g).setHasCommittedMutations()})(s,e,t):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function md(s,e,t,r){return s instanceof Cc?(function(l,u,m,g){if(!Zf(l.precondition,u))return m;const y=l.value.clone(),_=sT(l.fieldTransforms,g,u);return y.setAll(_),u.convertToFoundDocument(u.version,y).setHasLocalMutations(),null})(s,e,t,r):s instanceof vi?(function(l,u,m,g){if(!Zf(l.precondition,u))return m;const y=sT(l.fieldTransforms,g,u),_=u.data;return _.setAll(O1(l)),_.setAll(y),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),m===null?null:m.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((x=>x.field)))})(s,e,t,r):(function(l,u,m){return Zf(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):m})(s,e,t)}function fM(s,e){let t=null;for(const r of s.fieldTransforms){const a=e.data.field(r.field),l=k1(r.transform,a||null);l!=null&&(t===null&&(t=Rn.empty()),t.set(r.field,l))}return t||null}function nT(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&sc(r,a,((l,u)=>uM(l,u)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Cc extends Jm{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class vi extends Jm{constructor(e,t,r,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function O1(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=s.data.field(t);e.set(t,r)}})),e}function rT(s,e,t){const r=new Map;Ie(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let a=0;a<t.length;a++){const l=s[a],u=l.transform,m=e.data.field(l.field);r.set(l.field,cM(u,m,t[a]))}return r}function sT(s,e,t){const r=new Map;for(const a of s){const l=a.transform,u=t.data.field(a.field);r.set(a.field,lM(l,u,e))}return r}class kc extends Jm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class E_ extends Jm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class T_{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&hM(l,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=md(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=md(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=N1();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let m=this.applyToLocalView(u,l.mutatedFields);m=t.has(a.key)?null:m;const g=V1(u,m);g!==null&&r.set(a.key,g),u.isValidDocument()||u.convertToNoDocument(Re.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),qe())}isEqual(e){return this.batchId===e.batchId&&sc(this.mutations,e.mutations,((t,r)=>nT(t,r)))&&sc(this.baseMutations,e.baseMutations,((t,r)=>nT(t,r)))}}class I_{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){Ie(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let a=(function(){return iM})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,r[u].version);return new I_(e,t,r,a)}}class S_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class mM{constructor(e,t){this.count=e,this.unchangedNames=t}}var on,tt;function M1(s){switch(s){case X.OK:return we(64938);case X.CANCELLED:case X.UNKNOWN:case X.DEADLINE_EXCEEDED:case X.RESOURCE_EXHAUSTED:case X.INTERNAL:case X.UNAVAILABLE:case X.UNAUTHENTICATED:return!1;case X.INVALID_ARGUMENT:case X.NOT_FOUND:case X.ALREADY_EXISTS:case X.PERMISSION_DENIED:case X.FAILED_PRECONDITION:case X.ABORTED:case X.OUT_OF_RANGE:case X.UNIMPLEMENTED:case X.DATA_LOSS:return!0;default:return we(15467,{code:s})}}function L1(s){if(s===void 0)return $t("GRPC error has no .code"),X.UNKNOWN;switch(s){case on.OK:return X.OK;case on.CANCELLED:return X.CANCELLED;case on.UNKNOWN:return X.UNKNOWN;case on.DEADLINE_EXCEEDED:return X.DEADLINE_EXCEEDED;case on.RESOURCE_EXHAUSTED:return X.RESOURCE_EXHAUSTED;case on.INTERNAL:return X.INTERNAL;case on.UNAVAILABLE:return X.UNAVAILABLE;case on.UNAUTHENTICATED:return X.UNAUTHENTICATED;case on.INVALID_ARGUMENT:return X.INVALID_ARGUMENT;case on.NOT_FOUND:return X.NOT_FOUND;case on.ALREADY_EXISTS:return X.ALREADY_EXISTS;case on.PERMISSION_DENIED:return X.PERMISSION_DENIED;case on.FAILED_PRECONDITION:return X.FAILED_PRECONDITION;case on.ABORTED:return X.ABORTED;case on.OUT_OF_RANGE:return X.OUT_OF_RANGE;case on.UNIMPLEMENTED:return X.UNIMPLEMENTED;case on.DATA_LOSS:return X.DATA_LOSS;default:return we(39323,{code:s})}}(tt=on||(on={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";function U1(){return new TextEncoder}const pM=new ha([4294967295,4294967295],0);function iT(s){const e=U1().encode(s),t=new kS;return t.update(e),new Uint8Array(t.digest())}function aT(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ha([t,r],0),new ha([a,l],0)]}class A_{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Zu(`Invalid padding: ${t}`);if(r<0)throw new Zu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Zu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Zu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ha.fromNumber(this.ge)}ye(e,t,r){let a=e.add(t.multiply(ha.fromNumber(r)));return a.compare(pM)===1&&(a=new ha([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=iT(e),[r,a]=aT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(r,a,l);if(!this.we(u))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new A_(l,a,t);return r.forEach((m=>u.insert(m))),u}insert(e){if(this.ge===0)return;const t=iT(e),[r,a]=aT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(r,a,l);this.be(u)}}be(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Zu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class th{constructor(e,t,r,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,nh.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new th(Re.min(),a,new wt(Oe),or(),qe())}}class nh{constructor(e,t,r,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new nh(r,t,qe(),qe(),qe())}}class em{constructor(e,t,r,a){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=a}}class z1{constructor(e,t){this.targetId=e,this.Ce=t}}class B1{constructor(e,t,r=Bt.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class oT{constructor(){this.ve=0,this.Fe=lT(),this.Me=Bt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=qe(),t=qe(),r=qe();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:we(38017,{changeType:l})}})),new nh(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=lT()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ie(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class gM{constructor(e){this.Ge=e,this.ze=new Map,this.je=or(),this.He=Of(),this.Je=Of(),this.Ze=new wt(Oe)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:we(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,r=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(ym(l))if(r===0){const u=new ye(l.path);this.et(t,u,St.newNoDocument(u,Re.min()))}else Ie(r===1,20013,{expectedCount:r});else{const u=this._t(t);if(u!==r){const m=this.ut(e),g=m?this.ct(m,e,u):1;if(g!==0){this.it(t);const y=g===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:l=0}=t;let u,m;try{u=pi(r).toUint8Array()}catch(g){if(g instanceof a1)return Bs("Decoding the base64 bloom filter in existence filter failed ("+g.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw g}try{m=new A_(u,a,l)}catch(g){return Bs(g instanceof Zu?"BloomFilter error: ":"Applying bloom filter failed: ",g),null}return m.ge===0?null:m}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let a=0;return r.forEach((l=>{const u=this.Ge.ht(),m=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(m)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const m=this.ot(u);if(m){if(l.current&&ym(m.target)){const g=new ye(m.target.path);this.It(g).has(u)||this.Et(u,g)||this.et(u,g,St.newNoDocument(g,e))}l.Be&&(t.set(u,l.ke()),l.Ke())}}));let r=qe();this.Je.forEach(((l,u)=>{let m=!0;u.forEachWhile((g=>{const y=this.ot(g);return!y||y.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(r=r.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new th(e,t,this.Ze,this.je,r);return this.je=or(),this.He=Of(),this.Je=Of(),this.Ze=new wt(Oe),a}Ye(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.qe(t,1):a.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new oT,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new mt(Oe),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new mt(Oe),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||he("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new oT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Of(){return new wt(ye.comparator)}function lT(){return new wt(ye.comparator)}const yM={asc:"ASCENDING",desc:"DESCENDING"},_M={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bM={and:"AND",or:"OR"};class vM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function uy(s,e){return s.useProto3Json||Yd(e)?e:{value:e}}function pc(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function q1(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function xM(s,e){return pc(s,e.toTimestamp())}function Yt(s){return Ie(!!s,49232),Re.fromTimestamp((function(t){const r=mi(t);return new ct(r.seconds,r.nanos)})(s))}function N_(s,e){return dy(s,e).canonicalString()}function dy(s,e){const t=(function(a){return new Ye(["projects",a.projectId,"databases",a.database])})(s).child("documents");return e===void 0?t:t.child(e)}function F1(s){const e=Ye.fromString(s);return Ie(Z1(e),10190,{key:e.toString()}),e}function Pd(s,e){return N_(s.databaseId,e.path)}function Ls(s,e){const t=F1(e);if(t.get(1)!==s.databaseId.projectId)throw new ce(X.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new ce(X.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ye(Q1(t))}function H1(s,e){return N_(s.databaseId,e)}function G1(s){const e=F1(s);return e.length===4?Ye.emptyPath():Q1(e)}function hy(s){return new Ye(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function Q1(s){return Ie(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function cT(s,e,t){return{name:Pd(s,e),fields:t.value.mapValue.fields}}function K1(s,e,t){const r=Ls(s,e.name),a=Yt(e.updateTime),l=e.createTime?Yt(e.createTime):Re.min(),u=new Rn({mapValue:{fields:e.fields}}),m=St.newFoundDocument(r,a,l,u);return t&&m.setHasCommittedMutations(),t?m.setHasCommittedMutations():m}function wM(s,e){return"found"in e?(function(r,a){Ie(!!a.found,43571),a.found.name,a.found.updateTime;const l=Ls(r,a.found.name),u=Yt(a.found.updateTime),m=a.found.createTime?Yt(a.found.createTime):Re.min(),g=new Rn({mapValue:{fields:a.found.fields}});return St.newFoundDocument(l,u,m,g)})(s,e):"missing"in e?(function(r,a){Ie(!!a.missing,3894),Ie(!!a.readTime,22933);const l=Ls(r,a.missing),u=Yt(a.readTime);return St.newNoDocument(l,u)})(s,e):we(7234,{result:e})}function EM(s,e){let t;if("targetChange"in e){e.targetChange;const r=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:we(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(y,_){return y.useProto3Json?(Ie(_===void 0||typeof _=="string",58123),Bt.fromBase64String(_||"")):(Ie(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Bt.fromUint8Array(_||new Uint8Array))})(s,e.targetChange.resumeToken),u=e.targetChange.cause,m=u&&(function(y){const _=y.code===void 0?X.UNKNOWN:L1(y.code);return new ce(_,y.message||"")})(u);t=new B1(r,a,l,m||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=Ls(s,r.document.name),l=Yt(r.document.updateTime),u=r.document.createTime?Yt(r.document.createTime):Re.min(),m=new Rn({mapValue:{fields:r.document.fields}}),g=St.newFoundDocument(a,l,u,m),y=r.targetIds||[],_=r.removedTargetIds||[];t=new em(y,_,g.key,g)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=Ls(s,r.document),l=r.readTime?Yt(r.readTime):Re.min(),u=St.newNoDocument(a,l),m=r.removedTargetIds||[];t=new em([],m,u.key,u)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=Ls(s,r.document),l=r.removedTargetIds||[];t=new em([],l,a,null)}else{if(!("filter"in e))return we(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:l}=r,u=new mM(a,l),m=r.targetId;t=new z1(m,u)}}return t}function Vd(s,e){let t;if(e instanceof Cc)t={update:cT(s,e.key,e.value)};else if(e instanceof kc)t={delete:Pd(s,e.key)};else if(e instanceof vi)t={update:cT(s,e.key,e.data),updateMask:RM(e.fieldMask)};else{if(!(e instanceof E_))return we(16599,{dt:e.type});t={verify:Pd(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(l,u){const m=u.transform;if(m instanceof fc)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof jo)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Po)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof mc)return{fieldPath:u.field.canonicalString(),increment:m.Ae};throw we(20930,{transform:u.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:xM(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:we(27497)})(s,e.precondition)),t}function fy(s,e){const t=e.currentDocument?(function(l){return l.updateTime!==void 0?Dt.updateTime(Yt(l.updateTime)):l.exists!==void 0?Dt.exists(l.exists):Dt.none()})(e.currentDocument):Dt.none(),r=e.updateTransforms?e.updateTransforms.map((a=>(function(u,m){let g=null;if("setToServerValue"in m)Ie(m.setToServerValue==="REQUEST_TIME",16630,{proto:m}),g=new fc;else if("appendMissingElements"in m){const _=m.appendMissingElements.values||[];g=new jo(_)}else if("removeAllFromArray"in m){const _=m.removeAllFromArray.values||[];g=new Po(_)}else"increment"in m?g=new mc(u,m.increment):we(16584,{proto:m});const y=kt.fromServerFormat(m.fieldPath);return new eh(y,g)})(s,a))):[];if(e.update){e.update.name;const a=Ls(s,e.update.name),l=new Rn({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(g){const y=g.fieldPaths||[];return new ar(y.map((_=>kt.fromServerFormat(_))))})(e.updateMask);return new vi(a,l,u,t,r)}return new Cc(a,l,t,r)}if(e.delete){const a=Ls(s,e.delete);return new kc(a,t)}if(e.verify){const a=Ls(s,e.verify);return new E_(a,t)}return we(1463,{proto:e})}function TM(s,e){return s&&s.length>0?(Ie(e!==void 0,14353),s.map((t=>(function(a,l){let u=a.updateTime?Yt(a.updateTime):Yt(l);return u.isEqual(Re.min())&&(u=Yt(l)),new dM(u,a.transformResults||[])})(t,e)))):[]}function $1(s,e){return{documents:[H1(s,e.path)]}}function Y1(s,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=H1(s,a);const l=(function(y){if(y.length!==0)return J1(ft.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(y){if(y.length!==0)return y.map((_=>(function(T){return{field:Fl(T.field),direction:SM(T.dir)}})(_)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const m=uy(s,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:a}}function W1(s){let e=G1(s.parent);const t=s.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){Ie(r===1,65062);const _=t.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];t.where&&(l=(function(x){const T=X1(x);return T instanceof ft&&b_(T)?T.getFilters():[T]})(t.where));let u=[];t.orderBy&&(u=(function(x){return x.map((T=>(function(V){return new jd(Hl(V.field),(function($){switch($){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(V.direction))})(T)))})(t.orderBy));let m=null;t.limit&&(m=(function(x){let T;return T=typeof x=="object"?x.value:x,Yd(T)?null:T})(t.limit));let g=null;t.startAt&&(g=(function(x){const T=!!x.before,S=x.values||[];return new Ea(S,T)})(t.startAt));let y=null;return t.endAt&&(y=(function(x){const T=!x.before,S=x.values||[];return new Ea(S,T)})(t.endAt)),w1(e,a,u,l,m,"F",g,y)}function IM(s,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return we(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function X1(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Hl(t.unaryFilter.field);return Ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=Hl(t.unaryFilter.field);return Ze.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Hl(t.unaryFilter.field);return Ze.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Hl(t.unaryFilter.field);return Ze.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return we(61313);default:return we(60726)}})(s):s.fieldFilter!==void 0?(function(t){return Ze.create(Hl(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return we(58110);default:return we(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return ft.create(t.compositeFilter.filters.map((r=>X1(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return we(1026)}})(t.compositeFilter.op))})(s):we(30097,{filter:s})}function SM(s){return yM[s]}function AM(s){return _M[s]}function NM(s){return bM[s]}function Fl(s){return{fieldPath:s.canonicalString()}}function Hl(s){return kt.fromServerFormat(s.fieldPath)}function J1(s){return s instanceof Ze?(function(t){if(t.op==="=="){if(KE(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NAN"}};if(QE(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(KE(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NOT_NAN"}};if(QE(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fl(t.field),op:AM(t.op),value:t.value}}})(s):s instanceof ft?(function(t){const r=t.getFilters().map((a=>J1(a)));return r.length===1?r[0]:{compositeFilter:{op:NM(t.op),filters:r}}})(s):we(54877,{filter:s})}function RM(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Z1(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function eA(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class ui{constructor(e,t,r,a,l=Re.min(),u=Re.min(),m=Bt.EMPTY_BYTE_STRING,g=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=m,this.expectedCount=g}withSequenceNumber(e){return new ui(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ui(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ui(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ui(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class tA{constructor(e){this.yt=e}}function CM(s,e){let t;if(e.document)t=K1(s.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ye.fromSegments(e.noDocument.path),a=Oo(e.noDocument.readTime);t=St.newNoDocument(r,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return we(56709);{const r=ye.fromSegments(e.unknownDocument.path),a=Oo(e.unknownDocument.version);t=St.newUnknownDocument(r,a)}}return e.readTime&&t.setReadTime((function(a){const l=new ct(a[0],a[1]);return Re.fromTimestamp(l)})(e.readTime)),t}function uT(s,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:vm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(l,u){return{name:Pd(l,u.key),fields:u.data.value.mapValue.fields,updateTime:pc(l,u.version.toTimestamp()),createTime:pc(l,u.createTime.toTimestamp())}})(s.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Vo(e.version)};else{if(!e.isUnknownDocument())return we(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Vo(e.version)}}return r}function vm(s){const e=s.toTimestamp();return[e.seconds,e.nanoseconds]}function Vo(s){const e=s.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Oo(s){const e=new ct(s.seconds,s.nanoseconds);return Re.fromTimestamp(e)}function po(s,e){const t=(e.baseMutations||[]).map((l=>fy(s.yt,l)));for(let l=0;l<e.mutations.length-1;++l){const u=e.mutations[l];if(l+1<e.mutations.length&&e.mutations[l+1].transform!==void 0){const m=e.mutations[l+1];u.updateTransforms=m.transform.fieldTransforms,e.mutations.splice(l+1,1),++l}}const r=e.mutations.map((l=>fy(s.yt,l))),a=ct.fromMillis(e.localWriteTimeMs);return new T_(e.batchId,a,t,r)}function ed(s){const e=Oo(s.readTime),t=s.lastLimboFreeSnapshotVersion!==void 0?Oo(s.lastLimboFreeSnapshotVersion):Re.min();let r;return r=(function(l){return l.documents!==void 0})(s.query)?(function(l){const u=l.documents.length;return Ie(u===1,1966,{count:u}),Qn(Rc(G1(l.documents[0])))})(s.query):(function(l){return Qn(W1(l))})(s.query),new ui(r,s.targetId,"TargetPurposeListen",s.lastListenSequenceNumber,e,t,Bt.fromBase64String(s.resumeToken))}function nA(s,e){const t=Vo(e.snapshotVersion),r=Vo(e.lastLimboFreeSnapshotVersion);let a;a=ym(e.target)?$1(s.yt,e.target):Y1(s.yt,e.target).ft;const l=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Do(e.target),readTime:t,resumeToken:l,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:a}}function R_(s){const e=W1({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?bm(e,e.limit,"L"):e}function N0(s,e){return new S_(e.largestBatchId,fy(s.yt,e.overlayMutation))}function dT(s,e){const t=e.path.lastSegment();return[s,Ln(e.path.popLast()),t]}function hT(s,e,t,r){return{indexId:s,uid:e,sequenceNumber:t,readTime:Vo(r.readTime),documentKey:Ln(r.documentKey.path),largestBatchId:r.largestBatchId}}class kM{getBundleMetadata(e,t){return fT(e).get(t).next((r=>{if(r)return(function(l){return{id:l.bundleId,createTime:Oo(l.createTime),version:l.version}})(r)}))}saveBundleMetadata(e,t){return fT(e).put((function(a){return{bundleId:a.id,createTime:Vo(Yt(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return mT(e).get(t).next((r=>{if(r)return(function(l){return{name:l.name,query:R_(l.bundledQuery),readTime:Oo(l.readTime)}})(r)}))}saveNamedQuery(e,t){return mT(e).put((function(a){return{name:a.name,readTime:Vo(Yt(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function fT(s){return mn(s,Gm)}function mT(s){return mn(s,Qm)}class Zm{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Zm(e,r)}getOverlay(e,t){return qu(e).get(dT(this.userId,t)).next((r=>r?N0(this.serializer,r):null))}getOverlays(e,t){const r=Vs();return B.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&r.set(a,l)})))).next((()=>r))}saveOverlays(e,t,r){const a=[];return r.forEach(((l,u)=>{const m=new S_(t,u);a.push(this.bt(e,m))})),B.waitFor(a)}removeOverlaysForBatchId(e,t,r){const a=new Set;t.forEach((u=>a.add(Ln(u.getCollectionPath()))));const l=[];return a.forEach((u=>{const m=IDBKeyRange.bound([this.userId,u,r],[this.userId,u,r+1],!1,!0);l.push(qu(e).X(ty,m))})),B.waitFor(l)}getOverlaysForCollection(e,t,r){const a=Vs(),l=Ln(t),u=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,Number.POSITIVE_INFINITY],!0);return qu(e).H(ty,u).next((m=>{for(const g of m){const y=N0(this.serializer,g);a.set(y.getKey(),y)}return a}))}getOverlaysForCollectionGroup(e,t,r,a){const l=Vs();let u;const m=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return qu(e).ee({index:e1,range:m},((g,y,_)=>{const x=N0(this.serializer,y);l.size()<a||x.largestBatchId===u?(l.set(x.getKey(),x),u=x.largestBatchId):_.done()})).next((()=>l))}bt(e,t){return qu(e).put((function(a,l,u){const[m,g,y]=dT(l,u.mutation.key);return{userId:l,collectionPath:g,documentId:y,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:Vd(a.yt,u.mutation)}})(this.serializer,this.userId,t))}}function qu(s){return mn(s,Km)}class DM{St(e){return mn(e,p_)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const r=t?.value;return r?Bt.fromUint8Array(r):Bt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class go{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Rt(e.integerValue));else if("doubleValue"in e){const r=Rt(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Sd(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=mi(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(pi(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?h1(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Wm(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):we(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const r=e.fields||{};this.Ft(t,55);for(const a of Object.keys(r))this.Ot(a,t),this.Ct(r[a],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const a=uc,l=r[a].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Rt(l)),this.Ot(a,t),this.Ct(r[a],t)}qt(e,t){const r=e.values||[];this.Ft(t,50);for(const a of r)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),ye.fromName(e).path.forEach((r=>{this.Ft(t,60),this.$t(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}go.Wt=new go;const Ml=255;function jM(s){if(s===0)return 8;let e=0;return s>>4||(e+=4,s<<=4),s>>6||(e+=2,s<<=2),s>>7||(e+=1),e}function pT(s){const e=64-(function(r){let a=0;for(let l=0;l<8;++l){const u=jM(255&r[l]);if(a+=u,u!==8)break}return a})(s);return Math.ceil(e/8)}class PM{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const a=t.codePointAt(0);this.Gt(240|a>>>18),this.Gt(128|63&a>>>12),this.Gt(128|63&a>>>6),this.Gt(128|63&a)}}this.zt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const a=t.codePointAt(0);this.Ht(240|a>>>18),this.Ht(128|63&a>>>12),this.Ht(128|63&a>>>6),this.Ht(128|63&a)}}this.Jt()}Yt(e){const t=this.en(e),r=pT(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),r=pT(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(Ml),this.sn(255)}_n(){this.an(Ml),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(l){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,l,!1),new Uint8Array(u.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let a=1;a<t.length;++a)t[a]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ml?(this.sn(Ml),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ml?(this.an(Ml),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const a=new Uint8Array(r);a.set(this.buffer),this.buffer=a}}class VM{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class OM{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Fu{constructor(){this.cn=new PM,this.ascending=new VM(this.cn),this.descending=new OM(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class yo{constructor(e,t,r,a){this.hn=e,this.Pn=t,this.Tn=r,this.In=a}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new yo(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:tm(this.Tn),directionalValue:tm(this.In),orderedDocumentKey:tm(t),documentKey:r.path.toArray()}}An(e,t,r){const a=this.Rn(e,t,r);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function ta(s,e){let t=s.hn-e.hn;return t!==0?t:(t=gT(s.Tn,e.Tn),t!==0?t:(t=gT(s.In,e.In),t!==0?t:ye.comparator(s.Pn,e.Pn)))}function gT(s,e){for(let t=0;t<s.length&&t<e.length;++t){const r=s[t]-e[t];if(r!==0)return r}return s.length-e.length}function tm(s){return _I()?(function(t){let r="";for(let a=0;a<t.length;a++)r+=String.fromCharCode(t[a]);return r})(s):s}function yT(s){return typeof s!="string"?s:(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(s)}class _T{constructor(e){this.Vn=new mt(((t,r)=>kt.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(Ie(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=J0(e);if(t!==void 0&&!this.pn(t))return!1;const r=ho(e);let a=new Set,l=0,u=0;for(;l<r.length&&this.pn(r[l]);++l)a=a.add(r[l].fieldPath.canonicalString());if(l===r.length)return!0;if(this.Vn.size>0){const m=this.Vn.getIterator().getNext();if(!a.has(m.field.canonicalString())){const g=r[l];if(!this.yn(m,g)||!this.wn(this.dn[u++],g))return!1}++l}for(;l<r.length;++l){const m=r[l];if(u>=this.dn.length||!this.wn(this.dn[u++],m))return!1}return!0}bn(){if(this.fn)return null;let e=new mt(kt.comparator);const t=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Kf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Kf(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Kf(r.field,r.dir==="asc"?0:1)));return new fm(fm.UNKNOWN_ID,this.collectionId,t,Id.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function rA(s){if(Ie(s instanceof Ze||s instanceof ft,20012),s instanceof Ze){if(s instanceof x1){const t=s.value.arrayValue?.values?.map((r=>Ze.create(s.field,"==",r)))||[];return ft.create(t,"or")}return s}const e=s.filters.map((t=>rA(t)));return ft.create(e,s.op)}function MM(s){if(s.getFilters().length===0)return[];const e=gy(rA(s));return Ie(sA(e),7391),my(e)||py(e)?[e]:e.getFilters()}function my(s){return s instanceof Ze}function py(s){return s instanceof ft&&b_(s)}function sA(s){return my(s)||py(s)||(function(t){if(t instanceof ft&&ay(t)){for(const r of t.getFilters())if(!my(r)&&!py(r))return!1;return!0}return!1})(s)}function gy(s){if(Ie(s instanceof Ze||s instanceof ft,34018),s instanceof Ze)return s;if(s.filters.length===1)return gy(s.filters[0]);const e=s.filters.map((r=>gy(r)));let t=ft.create(e,s.op);return t=xm(t),sA(t)?t:(Ie(t instanceof ft,64498),Ie(hc(t),40251),Ie(t.filters.length>1,57927),t.filters.reduce(((r,a)=>C_(r,a))))}function C_(s,e){let t;return Ie(s instanceof Ze||s instanceof ft,38388),Ie(e instanceof Ze||e instanceof ft,25473),t=s instanceof Ze?e instanceof Ze?(function(a,l){return ft.create([a,l],"and")})(s,e):bT(s,e):e instanceof Ze?bT(e,s):(function(a,l){if(Ie(a.filters.length>0&&l.filters.length>0,48005),hc(a)&&hc(l))return _1(a,l.getFilters());const u=ay(a)?a:l,m=ay(a)?l:a,g=u.filters.map((y=>C_(y,m)));return ft.create(g,"or")})(s,e),xm(t)}function bT(s,e){if(hc(e))return _1(e,s.getFilters());{const t=e.filters.map((r=>C_(s,r)));return ft.create(t,"or")}}function xm(s){if(Ie(s instanceof Ze||s instanceof ft,11850),s instanceof Ze)return s;const e=s.getFilters();if(e.length===1)return xm(e[0]);if(g1(s))return s;const t=e.map((a=>xm(a))),r=[];return t.forEach((a=>{a instanceof Ze?r.push(a):a instanceof ft&&(a.op===s.op?r.push(...a.filters):r.push(a))})),r.length===1?r[0]:ft.create(r,s.op)}class LM{constructor(){this.Sn=new k_}addToCollectionParentIndex(e,t){return this.Sn.add(t),B.resolve()}getCollectionParents(e,t){return B.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return B.resolve()}deleteFieldIndex(e,t){return B.resolve()}deleteAllFieldIndexes(e){return B.resolve()}createTargetIndexes(e,t){return B.resolve()}getDocumentsMatchingTarget(e,t){return B.resolve(null)}getIndexType(e,t){return B.resolve(0)}getFieldIndexes(e,t){return B.resolve([])}getNextCollectionGroupToUpdate(e){return B.resolve(null)}getMinOffset(e,t){return B.resolve(wr.min())}getMinOffsetFromCollectionGroup(e,t){return B.resolve(wr.min())}updateCollectionGroup(e,t,r){return B.resolve()}updateIndexEntries(e,t){return B.resolve()}}class k_{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new mt(Ye.comparator),l=!a.has(r);return this.index[t]=a.add(r),l}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new mt(Ye.comparator)).toArray()}}const vT="IndexedDbIndexManager",Mf=new Uint8Array(0);class UM{constructor(e,t){this.databaseId=t,this.Dn=new k_,this.Cn=new bi((r=>Do(r)),((r,a)=>Xd(r,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const r=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const l={collectionId:r,parent:Ln(a)};return xT(e).put(l)}return B.resolve()}getCollectionParents(e,t){const r=[],a=IDBKeyRange.bound([t,""],[US(t),""],!1,!0);return xT(e).H(a).next((l=>{for(const u of l){if(u.collectionId!==t)break;r.push(Ps(u.parent))}return r}))}addFieldIndex(e,t){const r=Hu(e),a=(function(m){return{indexId:m.indexId,collectionGroup:m.collectionGroup,fields:m.fields.map((g=>[g.fieldPath.canonicalString(),g.kind]))}})(t);delete a.indexId;const l=r.add(a);if(t.indexState){const u=Ul(e);return l.next((m=>{u.put(hT(m,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return l.next()}deleteFieldIndex(e,t){const r=Hu(e),a=Ul(e),l=Ll(e);return r.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>l.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Hu(e),r=Ll(e),a=Ul(e);return t.X().next((()=>r.X())).next((()=>a.X()))}createTargetIndexes(e,t){return B.forEach(this.vn(t),(r=>this.getIndexType(e,r).next((a=>{if(a===0||a===1){const l=new _T(r).bn();if(l!=null)return this.addFieldIndex(e,l)}}))))}getDocumentsMatchingTarget(e,t){const r=Ll(e);let a=!0;const l=new Map;return B.forEach(this.vn(t),(u=>this.Fn(e,u).next((m=>{a&&(a=!!m),l.set(u,m)})))).next((()=>{if(a){let u=qe();const m=[];return B.forEach(l,((g,y)=>{he(vT,`Using index ${(function(te){return`id=${te.indexId}|cg=${te.collectionGroup}|f=${te.fields.map((be=>`${be.fieldPath}:${be.kind}`)).join(",")}`})(g)} to execute ${Do(t)}`);const _=(function(te,be){const ae=J0(be);if(ae===void 0)return null;for(const ee of _m(te,ae.fieldPath))switch(ee.op){case"array-contains-any":return ee.value.arrayValue.values||[];case"array-contains":return[ee.value]}return null})(y,g),x=(function(te,be){const ae=new Map;for(const ee of ho(be))for(const C of _m(te,ee.fieldPath))switch(C.op){case"==":case"in":ae.set(ee.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return ae.set(ee.fieldPath.canonicalString(),C.value),Array.from(ae.values())}return null})(y,g),T=(function(te,be){const ae=[];let ee=!0;for(const C of ho(be)){const N=C.kind===0?JE(te,C.fieldPath,te.startAt):ZE(te,C.fieldPath,te.startAt);ae.push(N.value),ee&&(ee=N.inclusive)}return new Ea(ae,ee)})(y,g),S=(function(te,be){const ae=[];let ee=!0;for(const C of ho(be)){const N=C.kind===0?ZE(te,C.fieldPath,te.endAt):JE(te,C.fieldPath,te.endAt);ae.push(N.value),ee&&(ee=N.inclusive)}return new Ea(ae,ee)})(y,g),V=this.Mn(g,y,T),U=this.Mn(g,y,S),$=this.xn(g,y,x),H=this.On(g.indexId,_,V,T.inclusive,U,S.inclusive,$);return B.forEach(H,(se=>r.Z(se,t.limit).next((te=>{te.forEach((be=>{const ae=ye.fromSegments(be.documentKey);u.has(ae)||(u=u.add(ae),m.push(ae))}))}))))})).next((()=>m))}return B.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=MM(ft.create(e.filters,"and")).map((r=>ly(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,r,a,l,u,m){const g=(t!=null?t.length:1)*Math.max(r.length,l.length),y=g/(t!=null?t.length:1),_=[];for(let x=0;x<g;++x){const T=t?this.Nn(t[x/y]):Mf,S=this.Bn(e,T,r[x%y],a),V=this.Ln(e,T,l[x%y],u),U=m.map(($=>this.Bn(e,T,$,!0)));_.push(...this.createRange(S,V,U))}return _}Bn(e,t,r,a){const l=new yo(e,ye.empty(),t,r);return a?l:l.En()}Ln(e,t,r,a){const l=new yo(e,ye.empty(),t,r);return a?l.En():l}Fn(e,t){const r=new _T(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((l=>{let u=null;for(const m of l)r.gn(m)&&(!u||m.fields.length>u.fields.length)&&(u=m);return u}))}getIndexType(e,t){let r=2;const a=this.vn(t);return B.forEach(a,(l=>this.Fn(e,l).next((u=>{u?r!==0&&u.fields.length<(function(g){let y=new mt(kt.comparator),_=!1;for(const x of g.filters)for(const T of x.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?_=!0:y=y.add(T.field));for(const x of g.orderBy)x.field.isKeyField()||(y=y.add(x.field));return y.size+(_?1:0)})(l)&&(r=1):r=0})))).next((()=>(function(u){return u.limit!==null})(t)&&a.length>1&&r===2?1:r))}kn(e,t){const r=new Fu;for(const a of ho(e)){const l=t.data.field(a.fieldPath);if(l==null)return null;const u=r.ln(a.kind);go.Wt.Dt(l,u)}return r.un()}Nn(e){const t=new Fu;return go.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const r=new Fu;return go.Wt.Dt(ko(this.databaseId,t),r.ln((function(l){const u=ho(l);return u.length===0?0:u[u.length-1].kind})(e))),r.un()}xn(e,t,r){if(r===null)return[];let a=[];a.push(new Fu);let l=0;for(const u of ho(e)){const m=r[l++];for(const g of a)if(this.qn(t,u.fieldPath)&&Dd(m))a=this.Un(a,u,m);else{const y=g.ln(u.kind);go.Wt.Dt(m,y)}}return this.$n(a)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){const a=[...e],l=[];for(const u of r.arrayValue.values||[])for(const m of a){const g=new Fu;g.seed(m.un()),go.Wt.Dt(u,g.ln(t.kind)),l.push(g)}return l}qn(e,t){return!!e.filters.find((r=>r instanceof Ze&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Hu(e),a=Ul(e);return(t?r.H(ey,IDBKeyRange.bound(t,t)):r.H()).next((l=>{const u=[];return B.forEach(l,(m=>a.get([m.indexId,this.uid]).next((g=>{u.push((function(_,x){const T=x?new Id(x.sequenceNumber,new wr(Oo(x.readTime),new ye(Ps(x.documentKey)),x.largestBatchId)):Id.empty(),S=_.fields.map((([V,U])=>new Kf(kt.fromServerFormat(V),U)));return new fm(_.indexId,_.collectionGroup,S,T)})(m,g))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,a)=>{const l=r.indexState.sequenceNumber-a.indexState.sequenceNumber;return l!==0?l:Oe(r.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const a=Hu(e),l=Ul(e);return this.Wn(e).next((u=>a.H(ey,IDBKeyRange.bound(t,t)).next((m=>B.forEach(m,(g=>l.put(hT(g.indexId,this.uid,u,r))))))))}updateIndexEntries(e,t){const r=new Map;return B.forEach(t,((a,l)=>{const u=r.get(a.collectionGroup);return(u?B.resolve(u):this.getFieldIndexes(e,a.collectionGroup)).next((m=>(r.set(a.collectionGroup,m),B.forEach(m,(g=>this.Qn(e,a,g).next((y=>{const _=this.Gn(l,g);return y.isEqual(_)?B.resolve():this.zn(e,l,g,y,_)})))))))}))}jn(e,t,r,a){return Ll(e).put(a.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,a){return Ll(e).delete(a.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){const a=Ll(e);let l=new mt(ta);return a.ee({index:ZS,range:IDBKeyRange.only([r.indexId,this.uid,tm(this.Kn(r,t))])},((u,m)=>{l=l.add(new yo(r.indexId,t,yT(m.arrayValue),yT(m.directionalValue)))})).next((()=>l))}Gn(e,t){let r=new mt(ta);const a=this.kn(t,e);if(a==null)return r;const l=J0(t);if(l!=null){const u=e.data.field(l.fieldPath);if(Dd(u))for(const m of u.arrayValue.values||[])r=r.add(new yo(t.indexId,e.key,this.Nn(m),a))}else r=r.add(new yo(t.indexId,e.key,Mf,a));return r}zn(e,t,r,a,l){he(vT,"Updating index entries for document '%s'",t.key);const u=[];return(function(g,y,_,x,T){const S=g.getIterator(),V=y.getIterator();let U=Ol(S),$=Ol(V);for(;U||$;){let H=!1,se=!1;if(U&&$){const te=_(U,$);te<0?se=!0:te>0&&(H=!0)}else U!=null?se=!0:H=!0;H?(x($),$=Ol(V)):se?(T(U),U=Ol(S)):(U=Ol(S),$=Ol(V))}})(a,l,ta,(m=>{u.push(this.jn(e,t,r,m))}),(m=>{u.push(this.Hn(e,t,r,m))})),B.waitFor(u)}Wn(e){let t=1;return Ul(e).ee({index:JS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,a,l)=>{l.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((u,m)=>ta(u,m))).filter(((u,m,g)=>!m||ta(u,g[m-1])!==0));const a=[];a.push(e);for(const u of r){const m=ta(u,e),g=ta(u,t);if(m===0)a[0]=e.En();else if(m>0&&g<0)a.push(u),a.push(u.En());else if(g>0)break}a.push(t);const l=[];for(let u=0;u<a.length;u+=2){if(this.Jn(a[u],a[u+1]))return[];const m=a[u].An(this.uid,Mf,ye.empty()),g=a[u+1].An(this.uid,Mf,ye.empty());l.push(IDBKeyRange.bound(m,g))}return l}Jn(e,t){return ta(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(wT)}getMinOffset(e,t){return B.mapArray(this.vn(t),(r=>this.Fn(e,r).next((a=>a||we(44426))))).next(wT)}}function xT(s){return mn(s,Rd)}function Ll(s){return mn(s,dd)}function Hu(s){return mn(s,m_)}function Ul(s){return mn(s,ud)}function wT(s){Ie(s.length!==0,28825);let e=s[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<s.length;r++){const a=s[r].indexState.offset;d_(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new wr(e.readTime,e.documentKey,t)}const ET={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},iA=41943040;class On{static withCacheSize(e){return new On(e,On.DEFAULT_COLLECTION_PERCENTILE,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function aA(s,e,t){const r=s.store(Jr),a=s.store(ac),l=[],u=IDBKeyRange.only(t.batchId);let m=0;const g=r.ee({range:u},((_,x,T)=>(m++,T.delete())));l.push(g.next((()=>{Ie(m===1,47070,{batchId:t.batchId})})));const y=[];for(const _ of t.mutations){const x=YS(e,_.key.path,t.batchId);l.push(a.delete(x)),y.push(_.key)}return B.waitFor(l).next((()=>y))}function wm(s){if(!s)return 0;let e;if(s.document)e=s.document;else if(s.unknownDocument)e=s.unknownDocument;else{if(!s.noDocument)throw we(14731);e=s.noDocument}return JSON.stringify(e).length}On.DEFAULT_COLLECTION_PERCENTILE=10,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,On.DEFAULT=new On(iA,On.DEFAULT_COLLECTION_PERCENTILE,On.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),On.DISABLED=new On(-1,0,0);class ep{constructor(e,t,r,a){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=a,this.Zn={}}static wt(e,t,r,a){Ie(e.uid!=="",64387);const l=e.isAuthenticated()?e.uid:"";return new ep(l,t,r,a)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return na(e).ee({index:vo,range:r},((a,l,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,r,a){const l=Gl(e),u=na(e);return u.add({}).next((m=>{Ie(typeof m=="number",49019);const g=new T_(m,t,r,a),y=(function(S,V,U){const $=U.baseMutations.map((se=>Vd(S.yt,se))),H=U.mutations.map((se=>Vd(S.yt,se)));return{userId:V,batchId:U.batchId,localWriteTimeMs:U.localWriteTime.toMillis(),baseMutations:$,mutations:H}})(this.serializer,this.userId,g),_=[];let x=new mt(((T,S)=>Oe(T.canonicalString(),S.canonicalString())));for(const T of a){const S=YS(this.userId,T.key.path,m);x=x.add(T.key.path.popLast()),_.push(u.put(y)),_.push(l.put(S,mO))}return x.forEach((T=>{_.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Zn[m]=g.keys()})),B.waitFor(_).next((()=>g))}))}lookupMutationBatch(e,t){return na(e).get(t).next((r=>r?(Ie(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),po(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?B.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const a=r.keys();return this.Zn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=IDBKeyRange.lowerBound([this.userId,r]);let l=null;return na(e).ee({index:vo,range:a},((u,m,g)=>{m.userId===this.userId&&(Ie(m.batchId>=r,47524,{Yn:r}),l=po(this.serializer,m)),g.done()})).next((()=>l))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=fa;return na(e).ee({index:vo,range:t,reverse:!0},((a,l,u)=>{r=l.batchId,u.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,fa],[this.userId,Number.POSITIVE_INFINITY]);return na(e).H(vo,t).next((r=>r.map((a=>po(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=$f(this.userId,t.path),a=IDBKeyRange.lowerBound(r),l=[];return Gl(e).ee({range:a},((u,m,g)=>{const[y,_,x]=u,T=Ps(_);if(y===this.userId&&t.path.isEqual(T))return na(e).get(x).next((S=>{if(!S)throw we(61480,{er:u,batchId:x});Ie(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:x}),l.push(po(this.serializer,S))}));g.done()})).next((()=>l))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new mt(Oe);const a=[];return t.forEach((l=>{const u=$f(this.userId,l.path),m=IDBKeyRange.lowerBound(u),g=Gl(e).ee({range:m},((y,_,x)=>{const[T,S,V]=y,U=Ps(S);T===this.userId&&l.path.isEqual(U)?r=r.add(V):x.done()}));a.push(g)})),B.waitFor(a).next((()=>this.tr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1,l=$f(this.userId,r),u=IDBKeyRange.lowerBound(l);let m=new mt(Oe);return Gl(e).ee({range:u},((g,y,_)=>{const[x,T,S]=g,V=Ps(T);x===this.userId&&r.isPrefixOf(V)?V.length===a&&(m=m.add(S)):_.done()})).next((()=>this.tr(e,m)))}tr(e,t){const r=[],a=[];return t.forEach((l=>{a.push(na(e).get(l).next((u=>{if(u===null)throw we(35274,{batchId:l});Ie(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:l}),r.push(po(this.serializer,u))})))})),B.waitFor(a).next((()=>r))}removeMutationBatch(e,t){return aA(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),B.forEach(r,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return B.resolve();const r=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),a=[];return Gl(e).ee({range:r},((l,u,m)=>{if(l[0]===this.userId){const g=Ps(l[1]);a.push(g)}else m.done()})).next((()=>{Ie(a.length===0,56720,{rr:a.map((l=>l.canonicalString()))})}))}))}containsKey(e,t){return oA(e,this.userId,t)}ir(e){return lA(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:fa,lastStreamToken:""}))}}function oA(s,e,t){const r=$f(e,t.path),a=r[1],l=IDBKeyRange.lowerBound(r);let u=!1;return Gl(s).ee({range:l,Y:!0},((m,g,y)=>{const[_,x,T]=m;_===e&&x===a&&(u=!0),y.done()})).next((()=>u))}function na(s){return mn(s,Jr)}function Gl(s){return mn(s,ac)}function lA(s){return mn(s,Ad)}class Mo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Mo(0)}static ar(){return new Mo(-1)}}class zM{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const r=new Mo(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Re.fromTimestamp(new ct(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.ur(e).next((a=>(a.highestListenSequenceNumber=t,r&&(a.lastRemoteSnapshotVersion=r.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.cr(e,a))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>zl(e).delete(t.targetId))).next((()=>this.ur(e))).next((r=>(Ie(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r))))}removeTargets(e,t,r){let a=0;const l=[];return zl(e).ee(((u,m)=>{const g=ed(m);g.sequenceNumber<=t&&r.get(g.targetId)===null&&(a++,l.push(this.removeTargetData(e,g)))})).next((()=>B.waitFor(l))).next((()=>a))}forEachTarget(e,t){return zl(e).ee(((r,a)=>{const l=ed(a);t(l)}))}ur(e){return TT(e).get(gm).next((t=>(Ie(t!==null,2888),t)))}cr(e,t){return TT(e).put(gm,t)}lr(e,t){return zl(e).put(nA(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Do(t),a=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let l=null;return zl(e).ee({range:a,index:XS},((u,m,g)=>{const y=ed(m);Xd(t,y.target)&&(l=y,g.done())})).next((()=>l))}addMatchingKeys(e,t,r){const a=[],l=ia(e);return t.forEach((u=>{const m=Ln(u.path);a.push(l.put({targetId:r,path:m})),a.push(this.referenceDelegate.addReference(e,r,u))})),B.waitFor(a)}removeMatchingKeys(e,t,r){const a=ia(e);return B.forEach(t,(l=>{const u=Ln(l.path);return B.waitFor([a.delete([r,u]),this.referenceDelegate.removeReference(e,r,l)])}))}removeMatchingKeysForTargetId(e,t){const r=ia(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(a)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),a=ia(e);let l=qe();return a.ee({range:r,Y:!0},((u,m,g)=>{const y=Ps(u[1]),_=new ye(y);l=l.add(_)})).next((()=>l))}containsKey(e,t){const r=Ln(t.path),a=IDBKeyRange.bound([r],[US(r)],!1,!0);let l=0;return ia(e).ee({index:f_,Y:!0,range:a},(([u,m],g,y)=>{u!==0&&(l++,y.done())})).next((()=>l>0))}At(e,t){return zl(e).get(t).next((r=>r?ed(r):null))}}function zl(s){return mn(s,oc)}function TT(s){return mn(s,Ao)}function ia(s){return mn(s,lc)}const IT="LruGarbageCollector",BM=1048576;function ST([s,e],[t,r]){const a=Oe(s,t);return a===0?Oe(e,r):a}class qM{constructor(e){this.Pr=e,this.buffer=new mt(ST),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();ST(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class cA{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){he(IT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ra(t)?he(IT,"Ignoring IndexedDB error during garbage collection: ",t):await Na(t)}await this.Ar(3e5)}))}}class FM{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return B.resolve(ir.ce);const r=new qM(t);return this.Vr.forEachTarget(e,(a=>r.Er(a.sequenceNumber))).next((()=>this.Vr.mr(e,(a=>r.Er(a))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(he("LruGarbageCollector","Garbage collection skipped; disabled"),B.resolve(ET)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(he("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ET):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,a,l,u,m,g,y;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(he("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),a=this.params.maximumSequenceNumbersToCollect):a=x,u=Date.now(),this.nthSequenceNumber(e,a)))).next((x=>(r=x,m=Date.now(),this.removeTargets(e,r,t)))).next((x=>(l=x,g=Date.now(),this.removeOrphanedDocuments(e,r)))).next((x=>(y=Date.now(),Bl()<=$e.DEBUG&&he("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${a} in `+(m-u)+`ms
	Removed ${l} targets in `+(g-m)+`ms
	Removed ${x} documents in `+(y-g)+`ms
Total Duration: ${y-_}ms`),B.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:x}))))}}function uA(s,e){return new FM(s,e)}class HM{constructor(e,t){this.db=e,this.garbageCollector=uA(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((r,a)=>t(a)))}addReference(e,t,r){return Lf(e,r)}removeReference(e,t,r){return Lf(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Lf(e,t)}wr(e,t){return(function(a,l){let u=!1;return lA(a).te((m=>oA(a,m,l).next((g=>(g&&(u=!0),B.resolve(!g)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let l=0;return this.yr(e,((u,m)=>{if(m<=t){const g=this.wr(e,u).next((y=>{if(!y)return l++,r.getEntry(e,u).next((()=>(r.removeEntry(u,Re.min()),ia(e).delete((function(x){return[0,Ln(x.path)]})(u)))))}));a.push(g)}})).next((()=>B.waitFor(a))).next((()=>r.apply(e))).next((()=>l))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Lf(e,t)}yr(e,t){const r=ia(e);let a,l=ir.ce;return r.ee({index:f_},(([u,m],{path:g,sequenceNumber:y})=>{u===0?(l!==ir.ce&&t(new ye(Ps(a)),l),l=y,a=g):l=ir.ce})).next((()=>{l!==ir.ce&&t(new ye(Ps(a)),l)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Lf(s,e){return ia(s).put((function(r,a){return{targetId:0,path:Ln(r.path),sequenceNumber:a}})(e,s.currentSequenceNumber))}class dA{constructor(){this.changes=new bi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,St.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?B.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class GM{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return co(e).put(r)}removeEntry(e,t,r){return co(e).delete((function(l,u){const m=l.path.toArray();return[m.slice(0,m.length-2),m[m.length-2],vm(u),m[m.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=St.newInvalidDocument(t);return co(e).ee({index:Yf,range:IDBKeyRange.only(Gu(t))},((a,l)=>{r=this.Sr(t,l)})).next((()=>r))}Dr(e,t){let r={size:0,document:St.newInvalidDocument(t)};return co(e).ee({index:Yf,range:IDBKeyRange.only(Gu(t))},((a,l)=>{r={document:this.Sr(t,l),size:wm(l)}})).next((()=>r))}getEntries(e,t){let r=or();return this.Cr(e,t,((a,l)=>{const u=this.Sr(a,l);r=r.insert(a,u)})).next((()=>r))}vr(e,t){let r=or(),a=new wt(ye.comparator);return this.Cr(e,t,((l,u)=>{const m=this.Sr(l,u);r=r.insert(l,m),a=a.insert(l,wm(u))})).next((()=>({documents:r,Fr:a})))}Cr(e,t,r){if(t.isEmpty())return B.resolve();let a=new mt(RT);t.forEach((g=>a=a.add(g)));const l=IDBKeyRange.bound(Gu(a.first()),Gu(a.last())),u=a.getIterator();let m=u.getNext();return co(e).ee({index:Yf,range:l},((g,y,_)=>{const x=ye.fromSegments([...y.prefixPath,y.collectionGroup,y.documentId]);for(;m&&RT(m,x)<0;)r(m,null),m=u.getNext();m&&m.isEqual(x)&&(r(m,y),m=u.hasNext()?u.getNext():null),m?_.j(Gu(m)):_.done()})).next((()=>{for(;m;)r(m,null),m=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,r,a,l){const u=t.path,m=[u.popLast().toArray(),u.lastSegment(),vm(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],g=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return co(e).H(IDBKeyRange.bound(m,g,!0)).next((y=>{l?.incrementDocumentReadCount(y.length);let _=or();for(const x of y){const T=this.Sr(ye.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);T.isFoundDocument()&&(Zd(t,T)||a.has(T.key))&&(_=_.insert(T.key,T))}return _}))}getAllFromCollectionGroup(e,t,r,a){let l=or();const u=NT(t,r),m=NT(t,wr.max());return co(e).ee({index:WS,range:IDBKeyRange.bound(u,m,!0)},((g,y,_)=>{const x=this.Sr(ye.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);l=l.insert(x.key,x),l.size===a&&_.done()})).next((()=>l))}newChangeBuffer(e){return new QM(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return AT(e).get(Z0).next((t=>(Ie(!!t,20021),t)))}br(e,t){return AT(e).put(Z0,t)}Sr(e,t){if(t){const r=CM(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Re.min())))return r}return St.newInvalidDocument(e)}}function hA(s){return new GM(s)}class QM extends dA{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new bi((r=>r.toString()),((r,a)=>r.isEqual(a)))}applyChanges(e){const t=[];let r=0,a=new mt(((l,u)=>Oe(l.canonicalString(),u.canonicalString())));return this.changes.forEach(((l,u)=>{const m=this.Or.get(l);if(t.push(this.Mr.removeEntry(e,l,m.readTime)),u.isValidDocument()){const g=uT(this.Mr.serializer,u);a=a.add(l.path.popLast());const y=wm(g);r+=y-m.size,t.push(this.Mr.addEntry(e,l,g))}else if(r-=m.size,this.trackRemovals){const g=uT(this.Mr.serializer,u.convertToNoDocument(Re.min()));t.push(this.Mr.addEntry(e,l,g))}})),a.forEach((l=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,l))})),t.push(this.Mr.updateMetadata(e,r)),B.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((r=>(this.Or.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:r,Fr:a})=>(a.forEach(((l,u)=>{this.Or.set(l,{size:u,readTime:r.get(l).readTime})})),r)))}}function AT(s){return mn(s,Nd)}function co(s){return mn(s,pm)}function Gu(s){const e=s.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function NT(s,e){const t=e.documentKey.path.toArray();return[s,vm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function RT(s,e){const t=s.path.toArray(),r=e.path.toArray();let a=0;for(let l=0;l<t.length-2&&l<r.length-2;++l)if(a=Oe(t[l],r[l]),a)return a;return a=Oe(t.length,r.length),a||(a=Oe(t[t.length-2],r[r.length-2]),a||Oe(t[t.length-1],r[r.length-1]))}class KM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class fA{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(r!==null&&md(r.mutation,a,ar.empty(),ct.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,qe()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=qe()){const a=Vs();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,r).next((l=>{let u=Ju();return l.forEach(((m,g)=>{u=u.insert(m,g.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const r=Vs();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,qe())))}populateOverlays(e,t,r){const a=[];return r.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,m)=>{t.set(u,m)}))}))}computeViews(e,t,r,a){let l=or();const u=fd(),m=(function(){return fd()})();return t.forEach(((g,y)=>{const _=r.get(y.key);a.has(y.key)&&(_===void 0||_.mutation instanceof vi)?l=l.insert(y.key,y):_!==void 0?(u.set(y.key,_.mutation.getFieldMask()),md(_.mutation,y,_.mutation.getFieldMask(),ct.now())):u.set(y.key,ar.empty())})),this.recalculateAndSaveOverlays(e,l).next((g=>(g.forEach(((y,_)=>u.set(y,_))),t.forEach(((y,_)=>m.set(y,new KM(_,u.get(y)??null)))),m)))}recalculateAndSaveOverlays(e,t){const r=fd();let a=new wt(((u,m)=>u-m)),l=qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const m of u)m.keys().forEach((g=>{const y=t.get(g);if(y===null)return;let _=r.get(g)||ar.empty();_=m.applyToLocalView(y,_),r.set(g,_);const x=(a.get(m.batchId)||qe()).add(g);a=a.insert(m.batchId,x)}))})).next((()=>{const u=[],m=a.getReverseIterator();for(;m.hasNext();){const g=m.getNext(),y=g.key,_=g.value,x=N1();_.forEach((T=>{if(!l.has(T)){const S=V1(t.get(T),r.get(T));S!==null&&x.set(T,S),l=l.add(T)}})),u.push(this.documentOverlayCache.saveOverlays(e,y,x))}return B.waitFor(u)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,a){return JO(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):v_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-l.size):B.resolve(Vs());let m=ic,g=l;return u.next((y=>B.forEach(y,((_,x)=>(m<x.largestBatchId&&(m=x.largestBatchId),l.get(_)?B.resolve():this.remoteDocumentCache.getEntry(e,_).next((T=>{g=g.insert(_,T)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,g,y,qe()))).next((_=>({batchId:m,changes:A1(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ye(t)).next((r=>{let a=Ju();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const l=t.collectionGroup;let u=Ju();return this.indexManager.getCollectionParents(e,l).next((m=>B.forEach(m,(g=>{const y=(function(x,T){return new _i(T,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(t,g.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,r,a).next((_=>{_.forEach(((x,T)=>{u=u.insert(x,T)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,r,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,l,a)))).next((u=>{l.forEach(((g,y)=>{const _=y.getKey();u.get(_)===null&&(u=u.insert(_,St.newInvalidDocument(_)))}));let m=Ju();return u.forEach(((g,y)=>{const _=l.get(g);_!==void 0&&md(_.mutation,y,ar.empty(),ct.now()),Zd(t,y)&&(m=m.insert(g,y))})),m}))}}class $M{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return B.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Yt(a.createTime)}})(t)),B.resolve()}getNamedQuery(e,t){return B.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(a){return{name:a.name,query:R_(a.bundledQuery),readTime:Yt(a.readTime)}})(t)),B.resolve()}}class YM{constructor(){this.overlays=new wt(ye.comparator),this.Lr=new Map}getOverlay(e,t){return B.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Vs();return B.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&r.set(a,l)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((a,l)=>{this.bt(e,t,l)})),B.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.Lr.get(r);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(r)),B.resolve()}getOverlaysForCollection(e,t,r){const a=Vs(),l=t.length+1,u=new ye(t.child("")),m=this.overlays.getIteratorFrom(u);for(;m.hasNext();){const g=m.getNext().value,y=g.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&g.largestBatchId>r&&a.set(g.getKey(),g)}return B.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let l=new wt(((y,_)=>y-_));const u=this.overlays.getIterator();for(;u.hasNext();){const y=u.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>r){let _=l.get(y.largestBatchId);_===null&&(_=Vs(),l=l.insert(y.largestBatchId,_)),_.set(y.getKey(),y)}}const m=Vs(),g=l.getIterator();for(;g.hasNext()&&(g.getNext().value.forEach(((y,_)=>m.set(y,_))),!(m.size()>=a)););return B.resolve(m)}bt(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const u=this.Lr.get(a.largestBatchId).delete(r.key);this.Lr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new S_(t,r));let l=this.Lr.get(t);l===void 0&&(l=qe(),this.Lr.set(t,l)),this.Lr.set(t,l.add(r.key))}}class WM{constructor(){this.sessionToken=Bt.EMPTY_BYTE_STRING}getSessionToken(e){return B.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,B.resolve()}}class D_{constructor(){this.kr=new mt(_n.Kr),this.qr=new mt(_n.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const r=new _n(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new _n(e,t))}Qr(e,t){e.forEach((r=>this.removeReference(r,t)))}Gr(e){const t=new ye(new Ye([])),r=new _n(t,e),a=new _n(t,e+1),l=[];return this.qr.forEachInRange([r,a],(u=>{this.Wr(u),l.push(u.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ye(new Ye([])),r=new _n(t,e),a=new _n(t,e+1);let l=qe();return this.qr.forEachInRange([r,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new _n(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class _n{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ye.comparator(e.key,t.key)||Oe(e.Hr,t.Hr)}static Ur(e,t){return Oe(e.Hr,t.Hr)||ye.comparator(e.key,t.key)}}class XM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new mt(_n.Kr)}checkEmpty(e){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new T_(l,t,r,a);this.mutationQueue.push(u);for(const m of a)this.Jr=this.Jr.add(new _n(m.key,l)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return B.resolve(u)}lookupMutationBatch(e,t){return B.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.Xr(r),l=a<0?0:a;return B.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?fa:this.Yn-1)}getAllMutationBatches(e){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new _n(t,0),a=new _n(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([r,a],(u=>{const m=this.Zr(u.Hr);l.push(m)})),B.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new mt(Oe);return t.forEach((a=>{const l=new _n(a,0),u=new _n(a,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,u],(m=>{r=r.add(m.Hr)}))})),B.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let l=r;ye.isDocumentKey(l)||(l=l.child(""));const u=new _n(new ye(l),0);let m=new mt(Oe);return this.Jr.forEachWhile((g=>{const y=g.key.path;return!!r.isPrefixOf(y)&&(y.length===a&&(m=m.add(g.Hr)),!0)}),u),B.resolve(this.Yr(m))}Yr(e){const t=[];return e.forEach((r=>{const a=this.Zr(r);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Ie(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return B.forEach(t.mutations,(a=>{const l=new _n(a.key,t.batchId);return r=r.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,t){const r=new _n(t,0),a=this.Jr.firstAfterOrEqual(r);return B.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,B.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class JM{constructor(e){this.ti=e,this.docs=(function(){return new wt(ye.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),l=a?a.size:0,u=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return B.resolve(r?r.document.mutableCopy():St.newInvalidDocument(t))}getEntries(e,t){let r=or();return t.forEach((a=>{const l=this.docs.get(a);r=r.insert(a,l?l.document.mutableCopy():St.newInvalidDocument(a))})),B.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let l=or();const u=t.path,m=new ye(u.child("__id-9223372036854775808__")),g=this.docs.getIteratorFrom(m);for(;g.hasNext();){const{key:y,value:{document:_}}=g.getNext();if(!u.isPrefixOf(y.path))break;y.path.length>u.length+1||d_(HS(_),r)<=0||(a.has(_.key)||Zd(t,_))&&(l=l.insert(_.key,_.mutableCopy()))}return B.resolve(l)}getAllFromCollectionGroup(e,t,r,a){we(9500)}ni(e,t){return B.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new ZM(this)}getSize(e){return B.resolve(this.size)}}class ZM extends dA{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?t.push(this.Mr.addEntry(e,a)):this.Mr.removeEntry(r)})),B.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class e4{constructor(e){this.persistence=e,this.ri=new bi((t=>Do(t)),Xd),this.lastRemoteSnapshotVersion=Re.min(),this.highestTargetId=0,this.ii=0,this.si=new D_,this.targetCount=0,this.oi=Mo._r()}forEachTarget(e,t){return this.ri.forEach(((r,a)=>t(a))),B.resolve()}getLastRemoteSnapshotVersion(e){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return B.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),B.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Mo(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,B.resolve()}updateTargetData(e,t){return this.lr(t),B.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,B.resolve()}removeTargets(e,t,r){let a=0;const l=[];return this.ri.forEach(((u,m)=>{m.sequenceNumber<=t&&r.get(m.targetId)===null&&(this.ri.delete(u),l.push(this.removeMatchingKeysForTargetId(e,m.targetId)),a++)})),B.waitFor(l).next((()=>a))}getTargetCount(e){return B.resolve(this.targetCount)}getTargetData(e,t){const r=this.ri.get(t)||null;return B.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),B.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),B.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),B.resolve()}getMatchingKeysForTargetId(e,t){const r=this.si.jr(t);return B.resolve(r)}containsKey(e,t){return B.resolve(this.si.containsKey(t))}}class j_{constructor(e,t){this._i={},this.overlays={},this.ai=new ir(0),this.ui=!1,this.ui=!0,this.ci=new WM,this.referenceDelegate=e(this),this.li=new e4(this),this.indexManager=new LM,this.remoteDocumentCache=(function(a){return new JM(a)})((r=>this.referenceDelegate.hi(r))),this.serializer=new tA(t),this.Pi=new $M(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new YM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new XM(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){he("MemoryPersistence","Starting transaction:",e);const a=new t4(this.ai.next());return this.referenceDelegate.Ti(),r(a).next((l=>this.referenceDelegate.Ii(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return B.or(Object.values(this._i).map((r=>()=>r.containsKey(e,t))))}}class t4 extends QS{constructor(e){super(),this.currentSequenceNumber=e}}class tp{constructor(e){this.persistence=e,this.Ri=new D_,this.Ai=null}static Vi(e){return new tp(e)}get di(){if(this.Ai)return this.Ai;throw we(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),B.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),B.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),B.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((a=>this.di.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.di.add(l.toString())))})).next((()=>r.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.di,(r=>{const a=ye.fromPath(r);return this.mi(e,a).next((l=>{l||t.removeEntry(a,Re.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return B.or([()=>B.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Em{constructor(e,t){this.persistence=e,this.fi=new bi((r=>Ln(r.path)),((r,a)=>r.isEqual(a))),this.garbageCollector=uA(this,t)}static Vi(e,t){return new Em(e,t)}Ti(){}Ii(e){return B.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}mr(e,t){return B.forEach(this.fi,((r,a)=>this.wr(e,r,a).next((l=>l?B.resolve():t(a)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ni(e,(u=>this.wr(e,u,t).next((m=>{m||(r++,l.removeEntry(u,Re.min()))})))).next((()=>l.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),B.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),B.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),B.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),B.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Xf(e.data.value)),t}wr(e,t,r){return B.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.fi.get(t);return B.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class n4{constructor(e){this.serializer=e}k(e,t,r,a){const l=new Hm("createOrUpgrade",t);r<1&&a>=1&&((function(g){g.createObjectStore(Wd)})(e),(function(g){g.createObjectStore(Ad,{keyPath:fO}),g.createObjectStore(Jr,{keyPath:zE,autoIncrement:!0}).createIndex(vo,BE,{unique:!0}),g.createObjectStore(ac)})(e),CT(e),(function(g){g.createObjectStore(fo)})(e));let u=B.resolve();return r<3&&a>=3&&(r!==0&&((function(g){g.deleteObjectStore(lc),g.deleteObjectStore(oc),g.deleteObjectStore(Ao)})(e),CT(e)),u=u.next((()=>(function(g){const y=g.store(Ao),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Re.min().toTimestamp(),targetCount:0};return y.put(gm,_)})(l)))),r<4&&a>=4&&(r!==0&&(u=u.next((()=>(function(g,y){return y.store(Jr).H().next((x=>{g.deleteObjectStore(Jr),g.createObjectStore(Jr,{keyPath:zE,autoIncrement:!0}).createIndex(vo,BE,{unique:!0});const T=y.store(Jr),S=x.map((V=>T.put(V)));return B.waitFor(S)}))})(e,l)))),u=u.next((()=>{(function(g){g.createObjectStore(cc,{keyPath:wO})})(e)}))),r<5&&a>=5&&(u=u.next((()=>this.gi(l)))),r<6&&a>=6&&(u=u.next((()=>((function(g){g.createObjectStore(Nd)})(e),this.pi(l))))),r<7&&a>=7&&(u=u.next((()=>this.yi(l)))),r<8&&a>=8&&(u=u.next((()=>this.wi(e,l)))),r<9&&a>=9&&(u=u.next((()=>{(function(g){g.objectStoreNames.contains("remoteDocumentChanges")&&g.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&a>=10&&(u=u.next((()=>this.bi(l)))),r<11&&a>=11&&(u=u.next((()=>{(function(g){g.createObjectStore(Gm,{keyPath:EO})})(e),(function(g){g.createObjectStore(Qm,{keyPath:TO})})(e)}))),r<12&&a>=12&&(u=u.next((()=>{(function(g){const y=g.createObjectStore(Km,{keyPath:kO});y.createIndex(ty,DO,{unique:!1}),y.createIndex(e1,jO,{unique:!1})})(e)}))),r<13&&a>=13&&(u=u.next((()=>(function(g){const y=g.createObjectStore(pm,{keyPath:pO});y.createIndex(Yf,gO),y.createIndex(WS,yO)})(e))).next((()=>this.Si(e,l))).next((()=>e.deleteObjectStore(fo)))),r<14&&a>=14&&(u=u.next((()=>this.Di(e,l)))),r<15&&a>=15&&(u=u.next((()=>(function(g){g.createObjectStore(m_,{keyPath:IO,autoIncrement:!0}).createIndex(ey,SO,{unique:!1}),g.createObjectStore(ud,{keyPath:AO}).createIndex(JS,NO,{unique:!1}),g.createObjectStore(dd,{keyPath:RO}).createIndex(ZS,CO,{unique:!1})})(e)))),r<16&&a>=16&&(u=u.next((()=>{t.objectStore(ud).clear()})).next((()=>{t.objectStore(dd).clear()}))),r<17&&a>=17&&(u=u.next((()=>{(function(g){g.createObjectStore(p_,{keyPath:PO})})(e)}))),r<18&&a>=18&&_I()&&(u=u.next((()=>{t.objectStore(ud).clear()})).next((()=>{t.objectStore(dd).clear()}))),u}pi(e){let t=0;return e.store(fo).ee(((r,a)=>{t+=wm(a)})).next((()=>{const r={byteSize:t};return e.store(Nd).put(Z0,r)}))}gi(e){const t=e.store(Ad),r=e.store(Jr);return t.H().next((a=>B.forEach(a,(l=>{const u=IDBKeyRange.bound([l.userId,fa],[l.userId,l.lastAcknowledgedBatchId]);return r.H(vo,u).next((m=>B.forEach(m,(g=>{Ie(g.userId===l.userId,18650,"Cannot process batch from unexpected user",{batchId:g.batchId});const y=po(this.serializer,g);return aA(e,l.userId,y).next((()=>{}))}))))}))))}yi(e){const t=e.store(lc),r=e.store(fo);return e.store(Ao).get(gm).next((a=>{const l=[];return r.ee(((u,m)=>{const g=new Ye(u),y=(function(x){return[0,Ln(x)]})(g);l.push(t.get(y).next((_=>_?B.resolve():(x=>t.put({targetId:0,path:Ln(x),sequenceNumber:a.highestListenSequenceNumber}))(g))))})).next((()=>B.waitFor(l)))}))}wi(e,t){e.createObjectStore(Rd,{keyPath:xO});const r=t.store(Rd),a=new k_,l=u=>{if(a.add(u)){const m=u.lastSegment(),g=u.popLast();return r.put({collectionId:m,parent:Ln(g)})}};return t.store(fo).ee({Y:!0},((u,m)=>{const g=new Ye(u);return l(g.popLast())})).next((()=>t.store(ac).ee({Y:!0},(([u,m,g],y)=>{const _=Ps(m);return l(_.popLast())}))))}bi(e){const t=e.store(oc);return t.ee(((r,a)=>{const l=ed(a),u=nA(this.serializer,l);return t.put(u)}))}Si(e,t){const r=t.store(fo),a=[];return r.ee(((l,u)=>{const m=t.store(pm),g=(function(x){return x.document?new ye(Ye.fromString(x.document.name).popFirst(5)):x.noDocument?ye.fromSegments(x.noDocument.path):x.unknownDocument?ye.fromSegments(x.unknownDocument.path):we(36783)})(u).path.toArray(),y={prefixPath:g.slice(0,g.length-2),collectionGroup:g[g.length-2],documentId:g[g.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};a.push(m.put(y))})).next((()=>B.waitFor(a)))}Di(e,t){const r=t.store(Jr),a=hA(this.serializer),l=new j_(tp.Vi,this.serializer.yt);return r.H().next((u=>{const m=new Map;return u.forEach((g=>{let y=m.get(g.userId)??qe();po(this.serializer,g).keys().forEach((_=>y=y.add(_))),m.set(g.userId,y)})),B.forEach(m,((g,y)=>{const _=new bn(y),x=Zm.wt(this.serializer,_),T=l.getIndexManager(_),S=ep.wt(_,this.serializer,T,l.referenceDelegate);return new fA(a,S,x,T).recalculateAndSaveOverlaysForDocumentKeys(new ny(t,ir.ce),g).next()}))}))}}function CT(s){s.createObjectStore(lc,{keyPath:bO}).createIndex(f_,vO,{unique:!0}),s.createObjectStore(oc,{keyPath:"targetId"}).createIndex(XS,_O,{unique:!0}),s.createObjectStore(Ao)}const ra="IndexedDbPersistence",R0=18e5,C0=5e3,k0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",mA="main";class P_{constructor(e,t,r,a,l,u,m,g,y,_,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=l,this.window=u,this.document=m,this.Fi=y,this.Mi=_,this.xi=x,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=T=>Promise.resolve(),!P_.v())throw new ce(X.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new HM(this,a),this.Ki=t+mA,this.serializer=new tA(g),this.qi=new Ms(this.Ki,this.xi,new n4(this.serializer)),this.ci=new DM,this.li=new zM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=hA(this.serializer),this.Pi=new kM,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,_===!1&&$t(ra,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ce(X.FAILED_PRECONDITION,k0);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new ir(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Uf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(Ra(e))return he(ra,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return he(ra,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Qu(e).get(Vl).next((t=>B.resolve(this.Xi(t))))}Yi(e){return Uf(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,R0)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=mn(t,cc);return r.H().next((a=>{const l=this.ns(a,R0),u=a.filter((m=>l.indexOf(m)===-1));return B.forEach(u,(m=>r.delete(m.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?B.resolve(!0):Qu(e).get(Vl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,C0)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new ce(X.FAILED_PRECONDITION,k0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Uf(e).H().next((r=>this.ns(r,C0).find((a=>{if(this.clientId!==a.clientId){const l=!this.networkEnabled&&a.networkEnabled,u=!this.inForeground&&a.inForeground,m=this.networkEnabled===a.networkEnabled;if(l||u&&m)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&he(ra,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Wd,cc],(e=>{const t=new ny(e,ir.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((r=>this.ts(r.updateTimeMs,t)&&!this.ss(r.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Uf(e).H().next((t=>this.ns(t,R0).map((r=>r.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return ep.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new UM(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Zm.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){he(ra,"Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",l=(function(g){return g===18?MO:g===17?s1:g===16?OO:g===15?g_:g===14?r1:g===13?n1:g===12?VO:g===11?t1:void we(60245)})(this.xi);let u;return this.qi.runTransaction(e,a,l,(m=>(u=new ny(m,this.ai?this.ai.next():ir.ce),t==="readwrite-primary"?this.ji(u).next((g=>!!g||this.Hi(u))).next((g=>{if(!g)throw $t(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new ce(X.FAILED_PRECONDITION,GS);return r(u)})).next((g=>this.Zi(u).next((()=>g)))):this.Ps(u).next((()=>r(u)))))).then((m=>(u.raiseOnCommittedEvent(),m)))}Ps(e){return Qu(e).get(Vl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,C0)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ce(X.FAILED_PRECONDITION,k0)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Qu(e).put(Vl,t)}static v(){return Ms.v()}Ji(e){const t=Qu(e);return t.get(Vl).next((r=>this.Xi(r)?(he(ra,"Releasing primary lease."),t.delete(Vl)):B.resolve()))}ts(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||($t(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;yI()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const t=this.Ui?.getItem(this.rs(e))!==null;return he(ra,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return $t(ra,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){$t("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Qu(s){return mn(s,Wd)}function Uf(s){return mn(s,cc)}function V_(s,e){let t=s.projectId;return s.isDefaultDatabase||(t+="."+s.database),"firestore/"+e+"/"+t+"/"}class O_{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=a}static Es(e,t){let r=qe(),a=qe();for(const l of t.docChanges)switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new O_(e,t.fromCache,r,a)}}class r4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class pA{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return yI()?8:KS(Ot())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,a){const l={result:null};return this.gs(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ps(e,t,a,r).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new r4;return this.ys(e,t,u).next((m=>{if(l.result=m,this.As)return this.ws(e,t,u,m.size)}))})).next((()=>l.result))}ws(e,t,r,a){return r.documentReadCount<this.Vs?(Bl()<=$e.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",ql(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),B.resolve()):(Bl()<=$e.DEBUG&&he("QueryEngine","Query:",ql(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.ds*a?(Bl()<=$e.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",ql(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qn(t))):B.resolve())}gs(e,t){if(eT(t))return B.resolve(null);let r=Qn(t);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=bm(t,null,"F"),r=Qn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((l=>{const u=qe(...l);return this.fs.getDocuments(e,u).next((m=>this.indexManager.getMinOffset(e,r).next((g=>{const y=this.bs(t,m);return this.Ss(t,y,u,g.readTime)?this.gs(e,bm(t,null,"F")):this.Ds(e,y,t,g)}))))})))))}ps(e,t,r,a){return eT(t)||a.isEqual(Re.min())?B.resolve(null):this.fs.getDocuments(e,r).next((l=>{const u=this.bs(t,l);return this.Ss(t,u,r,a)?B.resolve(null):(Bl()<=$e.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),ql(t)),this.Ds(e,u,t,FS(a,ic)).next((m=>m)))}))}bs(e,t){let r=new mt(I1(e));return t.forEach(((a,l)=>{Zd(e,l)&&(r=r.add(l))})),r}Ss(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ys(e,t,r){return Bl()<=$e.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",ql(t)),this.fs.getDocumentsMatchingQuery(e,t,wr.min(),r)}Ds(e,t,r,a){return this.fs.getDocumentsMatchingQuery(e,r,a).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}const M_="LocalStore",s4=3e8;class i4{constructor(e,t,r,a){this.persistence=e,this.Cs=t,this.serializer=a,this.vs=new wt(Oe),this.Fs=new bi((l=>Do(l)),Xd),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fA(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function gA(s,e,t,r){return new i4(s,e,t,r)}async function yA(s,e){const t=ve(s);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next((l=>(a=l,t.Os(e),t.mutationQueue.getAllMutationBatches(r)))).next((l=>{const u=[],m=[];let g=qe();for(const y of a){u.push(y.batchId);for(const _ of y.mutations)g=g.add(_.key)}for(const y of l){m.push(y.batchId);for(const _ of y.mutations)g=g.add(_.key)}return t.localDocuments.getDocuments(r,g).next((y=>({Ns:y,removedBatchIds:u,addedBatchIds:m})))}))}))}function a4(s,e){const t=ve(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(m,g,y,_){const x=y.batch,T=x.keys();let S=B.resolve();return T.forEach((V=>{S=S.next((()=>_.getEntry(g,V))).next((U=>{const $=y.docVersions.get(V);Ie($!==null,48541),U.version.compareTo($)<0&&(x.applyToRemoteDocument(U,y),U.isValidDocument()&&(U.setReadTime(y.commitVersion),_.addEntry(U)))}))})),S.next((()=>m.mutationQueue.removeMutationBatch(g,x)))})(t,r,e,l).next((()=>l.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(m){let g=qe();for(let y=0;y<m.mutationResults.length;++y)m.mutationResults[y].transformResults.length>0&&(g=g.add(m.batch.mutations[y].key));return g})(e)))).next((()=>t.localDocuments.getDocuments(r,a)))}))}function _A(s){const e=ve(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function o4(s,e){const t=ve(s),r=e.snapshotVersion;let a=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.xs.newChangeBuffer({trackRemovals:!0});a=t.vs;const m=[];e.targetChanges.forEach(((_,x)=>{const T=a.get(x);if(!T)return;m.push(t.li.removeMatchingKeys(l,_.removedDocuments,x).next((()=>t.li.addMatchingKeys(l,_.addedDocuments,x))));let S=T.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(x)!==null?S=S.withResumeToken(Bt.EMPTY_BYTE_STRING,Re.min()).withLastLimboFreeSnapshotVersion(Re.min()):_.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(_.resumeToken,r)),a=a.insert(x,S),(function(U,$,H){return U.resumeToken.approximateByteSize()===0||$.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=s4?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0})(T,S,_)&&m.push(t.li.updateTargetData(l,S))}));let g=or(),y=qe();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(l,_))})),m.push(bA(l,u,e.documentUpdates).next((_=>{g=_.Bs,y=_.Ls}))),!r.isEqual(Re.min())){const _=t.li.getLastRemoteSnapshotVersion(l).next((x=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,r)));m.push(_)}return B.waitFor(m).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,g,y))).next((()=>g))})).then((l=>(t.vs=a,l)))}function bA(s,e,t){let r=qe(),a=qe();return t.forEach((l=>r=r.add(l))),e.getEntries(s,r).next((l=>{let u=or();return t.forEach(((m,g)=>{const y=l.get(m);g.isFoundDocument()!==y.isFoundDocument()&&(a=a.add(m)),g.isNoDocument()&&g.version.isEqual(Re.min())?(e.removeEntry(m,g.readTime),u=u.insert(m,g)):!y.isValidDocument()||g.version.compareTo(y.version)>0||g.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(g),u=u.insert(m,g)):he(M_,"Ignoring outdated watch update for ",m,". Current version:",y.version," Watch version:",g.version)})),{Bs:u,Ls:a}}))}function l4(s,e){const t=ve(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=fa),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function gc(s,e){const t=ve(s);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return t.li.getTargetData(r,e).next((l=>l?(a=l,B.resolve(a)):t.li.allocateTargetId(r).next((u=>(a=new ui(e,u,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=t.vs.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r}))}async function yc(s,e,t){const r=ve(s),a=r.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",l,(u=>r.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!Ra(u))throw u;he(M_,`Failed to update sequence numbers for target ${e}: ${u}`)}r.vs=r.vs.remove(e),r.Fs.delete(a.target)}function Tm(s,e,t){const r=ve(s);let a=Re.min(),l=qe();return r.persistence.runTransaction("Execute query","readwrite",(u=>(function(g,y,_){const x=ve(g),T=x.Fs.get(_);return T!==void 0?B.resolve(x.vs.get(T)):x.li.getTargetData(y,_)})(r,u,Qn(e)).next((m=>{if(m)return a=m.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(u,m.targetId).next((g=>{l=g}))})).next((()=>r.Cs.getDocumentsMatchingQuery(u,e,t?a:Re.min(),t?l:qe()))).next((m=>(wA(r,T1(e),m),{documents:m,ks:l})))))}function vA(s,e){const t=ve(s),r=ve(t.li),a=t.vs.get(e);return a?Promise.resolve(a.target):t.persistence.runTransaction("Get target data","readonly",(l=>r.At(l,e).next((u=>u?u.target:null))))}function xA(s,e){const t=ve(s),r=t.Ms.get(e)||Re.min();return t.persistence.runTransaction("Get new document changes","readonly",(a=>t.xs.getAllFromCollectionGroup(a,e,FS(r,ic),Number.MAX_SAFE_INTEGER))).then((a=>(wA(t,e,a),a)))}function wA(s,e,t){let r=s.Ms.get(e)||Re.min();t.forEach(((a,l)=>{l.readTime.compareTo(r)>0&&(r=l.readTime)})),s.Ms.set(e,r)}async function c4(s,e,t,r){const a=ve(s);let l=qe(),u=or();for(const y of t){const _=e.Ks(y.metadata.name);y.document&&(l=l.add(_));const x=e.qs(y);x.setReadTime(e.Us(y.metadata.readTime)),u=u.insert(_,x)}const m=a.xs.newChangeBuffer({trackRemovals:!0}),g=await gc(a,(function(_){return Qn(Rc(Ye.fromString(`__bundle__/docs/${_}`)))})(r));return a.persistence.runTransaction("Apply bundle documents","readwrite",(y=>bA(y,m,u).next((_=>(m.apply(y),_))).next((_=>a.li.removeMatchingKeysForTargetId(y,g.targetId).next((()=>a.li.addMatchingKeys(y,l,g.targetId))).next((()=>a.localDocuments.getLocalViewOfDocuments(y,_.Bs,_.Ls))).next((()=>_.Bs))))))}async function u4(s,e,t=qe()){const r=await gc(s,Qn(R_(e.bundledQuery))),a=ve(s);return a.persistence.runTransaction("Save named query","readwrite",(l=>{const u=Yt(e.readTime);if(r.snapshotVersion.compareTo(u)>=0)return a.Pi.saveNamedQuery(l,e);const m=r.withResumeToken(Bt.EMPTY_BYTE_STRING,u);return a.vs=a.vs.insert(m.targetId,m),a.li.updateTargetData(l,m).next((()=>a.li.removeMatchingKeysForTargetId(l,r.targetId))).next((()=>a.li.addMatchingKeys(l,t,r.targetId))).next((()=>a.Pi.saveNamedQuery(l,e)))}))}const EA="firestore_clients";function kT(s,e){return`${EA}_${s}_${e}`}const TA="firestore_mutations";function DT(s,e,t){let r=`${TA}_${s}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const IA="firestore_targets";function D0(s,e){return`${IA}_${s}_${e}`}const Ns="SharedClientState";class Im{constructor(e,t,r,a){this.user=e,this.batchId=t,this.state=r,this.error=a}static $s(e,t,r){const a=JSON.parse(r);let l,u=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return u&&a.error&&(u=typeof a.error.message=="string"&&typeof a.error.code=="string",u&&(l=new ce(a.error.code,a.error.message))),u?new Im(e,t,a.state,l):($t(Ns,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pd{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){const r=JSON.parse(t);let a,l=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return l&&r.error&&(l=typeof r.error.message=="string"&&typeof r.error.code=="string",l&&(a=new ce(r.error.code,r.error.message))),l?new pd(e,r.state,a):($t(Ns,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Sm{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const r=JSON.parse(t);let a=typeof r=="object"&&r.activeTargetIds instanceof Array,l=x_();for(let u=0;a&&u<r.activeTargetIds.length;++u)a=$S(r.activeTargetIds[u]),l=l.add(r.activeTargetIds[u]);return a?new Sm(e,l):($t(Ns,`Failed to parse client data for instance '${e}': ${t}`),null)}}class L_{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new L_(t.clientId,t.onlineState):($t(Ns,`Failed to parse online state: ${e}`),null)}}class yy{constructor(){this.activeTargetIds=x_()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class j0{constructor(e,t,r,a,l){this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new wt(Oe),this.started=!1,this.Zs=[];const u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=l,this.Xs=kT(this.persistenceKey,this.zs),this.Ys=(function(g){return`firestore_sequence_number_${g}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new yy),this.eo=new RegExp(`^${EA}_${u}_([^_]*)$`),this.no=new RegExp(`^${TA}_${u}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${IA}_${u}_(\\d+)$`),this.io=(function(g){return`firestore_online_state_${g}`})(this.persistenceKey),this.so=(function(g){return`firestore_bundle_loaded_v2_${g}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const a=this.getItem(kT(this.persistenceKey,r));if(a){const l=Sm.$s(r,a);l&&(this.Js=this.Js.insert(l.clientId,l))}}this.oo();const t=this.storage.getItem(this.io);if(t){const r=this._o(t);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((r,a)=>{a.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const a=this.storage.getItem(D0(this.persistenceKey,e));if(a){const l=pd.$s(e,a);l&&(r=l.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(D0(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach((a=>{this.lo(a)})),this.currentUser=e,r.forEach((a=>{this.addPendingMutation(a)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return he(Ns,"READ",e,t),t}setItem(e,t){he(Ns,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){he(Ns,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(he(Ns,"EVENT",t.key,t.newValue),t.key===this.Xs)return void $t("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const r=this.Eo(t.key);return this.Ro(r,null)}{const r=this.Ao(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(t.key)){if(t.newValue!==null){const r=this.Vo(t.key,t.newValue);if(r)return this.mo(r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(t.key===this.io){if(t.newValue!==null){const r=this._o(t.newValue);if(r)return this.ao(r)}}else if(t.key===this.Ys){const r=(function(l){let u=ir.ce;if(l!=null)try{const m=JSON.parse(l);Ie(typeof m=="number",30636,{yo:l}),u=m}catch(m){$t(Ns,"Failed to read sequence number from WebStorage",m)}return u})(t.newValue);r!==ir.ce&&this.sequenceNumberHandler(r)}else if(t.key===this.so){const r=this.wo(t.newValue);await Promise.all(r.map((a=>this.syncEngine.bo(a))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){const a=new Im(this.currentUser,e,t,r),l=DT(this.persistenceKey,this.currentUser,e);this.setItem(l,a.Ws())}lo(e){const t=DT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){const a=D0(this.persistenceKey,e),l=new pd(e,t,r);this.setItem(a,l.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const r=this.Eo(e);return Sm.$s(r,t)}Vo(e,t){const r=this.no.exec(e),a=Number(r[1]),l=r[2]!==void 0?r[2]:null;return Im.$s(new bn(l),a,t)}fo(e,t){const r=this.ro.exec(e),a=Number(r[1]);return pd.$s(a,t)}_o(e){return L_.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);he(Ns,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const r=t?this.Js.insert(e,t):this.Js.remove(e),a=this.uo(this.Js),l=this.uo(r),u=[],m=[];return l.forEach((g=>{a.has(g)||u.push(g)})),a.forEach((g=>{l.has(g)||m.push(g)})),this.syncEngine.Co(u,m).then((()=>{this.Js=r}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=x_();return e.forEach(((r,a)=>{t=t.unionWith(a.activeTargetIds)})),t}}class SA{constructor(){this.vo=new yy,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new yy,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class d4{Mo(e){}shutdown(){}}const jT="ConnectivityMonitor";class PT{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){he(jT,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){he(jT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let zf=null;function _y(){return zf===null?zf=(function(){return 268435456+Math.round(2147483648*Math.random())})():zf++,"0x"+zf.toString(16)}const P0="RestConnection",h4={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class f4{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${a}`,this.$o=this.databaseId.database===ry?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Wo(e,t,r,a,l){const u=_y(),m=this.Qo(e,t.toUriEncodedString());he(P0,`Sending RPC '${e}' ${u}:`,m,r);const g={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(g,a,l);const{host:y}=new URL(m),_=Ec(y);return this.zo(e,m,g,r,_).then((x=>(he(P0,`Received RPC '${e}' ${u}: `,x),x)),(x=>{throw Bs(P0,`RPC '${e}' ${u} failed with error: `,x,"url: ",m,"request:",r),x}))}jo(e,t,r,a,l,u){return this.Wo(e,t,r,a,l)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Nc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),r&&r.headers.forEach(((a,l)=>e[l]=a))}Qo(e,t){const r=h4[e];let a=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(a=`${a}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),a}terminate(){}}class m4{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Vn="WebChannelConnection",Ku=(s,e,t)=>{s.listen(e,(r=>{try{t(r)}catch(a){setTimeout((()=>{throw a}),0)}}))};class Jl extends f4{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Jl.c_){const e=VS();Ku(e,PS.STAT_EVENT,(t=>{t.stat===W0.PROXY?he(Vn,"STAT_EVENT: detected buffering proxy"):t.stat===W0.NOPROXY&&he(Vn,"STAT_EVENT: detected no buffering proxy")})),Jl.c_=!0}}zo(e,t,r,a,l){const u=_y();return new Promise(((m,g)=>{const y=new DS;y.setWithCredentials(!0),y.listenOnce(jS.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Qf.NO_ERROR:const x=y.getResponseJson();he(Vn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(x)),m(x);break;case Qf.TIMEOUT:he(Vn,`RPC '${e}' ${u} timed out`),g(new ce(X.DEADLINE_EXCEEDED,"Request time out"));break;case Qf.HTTP_ERROR:const T=y.getStatus();if(he(Vn,`RPC '${e}' ${u} failed with status:`,T,"response text:",y.getResponseText()),T>0){let S=y.getResponseJson();Array.isArray(S)&&(S=S[0]);const V=S?.error;if(V&&V.status&&V.message){const U=(function(H){const se=H.toLowerCase().replace(/_/g,"-");return Object.values(X).indexOf(se)>=0?se:X.UNKNOWN})(V.status);g(new ce(U,V.message))}else g(new ce(X.UNKNOWN,"Server responded with status "+y.getStatus()))}else g(new ce(X.UNAVAILABLE,"Connection failed."));break;default:we(9055,{l_:e,streamId:u,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{he(Vn,`RPC '${e}' ${u} completed.`)}}));const _=JSON.stringify(a);he(Vn,`RPC '${e}' ${u} sending request:`,a),y.send(t,"POST",_,r,15)}))}T_(e,t,r){const a=_y(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=this.createWebChannelTransport(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(m.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(m.useFetchStreams=!0),this.Go(m.initMessageHeaders,t,r),m.encodeInitMessageHeaders=!0;const y=l.join("");he(Vn,`Creating RPC '${e}' stream ${a}: ${y}`,m);const _=u.createWebChannel(y,m);this.I_(_);let x=!1,T=!1;const S=new m4({Ho:V=>{T?he(Vn,`Not sending because RPC '${e}' stream ${a} is closed:`,V):(x||(he(Vn,`Opening RPC '${e}' stream ${a} transport.`),_.open(),x=!0),he(Vn,`RPC '${e}' stream ${a} sending:`,V),_.send(V))},Jo:()=>_.close()});return Ku(_,Xu.EventType.OPEN,(()=>{T||(he(Vn,`RPC '${e}' stream ${a} transport opened.`),S.i_())})),Ku(_,Xu.EventType.CLOSE,(()=>{T||(T=!0,he(Vn,`RPC '${e}' stream ${a} transport closed`),S.o_(),this.E_(_))})),Ku(_,Xu.EventType.ERROR,(V=>{T||(T=!0,Bs(Vn,`RPC '${e}' stream ${a} transport errored. Name:`,V.name,"Message:",V.message),S.o_(new ce(X.UNAVAILABLE,"The operation could not be completed")))})),Ku(_,Xu.EventType.MESSAGE,(V=>{if(!T){const U=V.data[0];Ie(!!U,16349);const $=U,H=$?.error||$[0]?.error;if(H){he(Vn,`RPC '${e}' stream ${a} received error:`,H);const se=H.status;let te=(function(ee){const C=on[ee];if(C!==void 0)return L1(C)})(se),be=H.message;te===void 0&&(te=X.INTERNAL,be="Unknown error status: "+se+" with message "+H.message),T=!0,S.o_(new ce(te,be)),_.close()}else he(Vn,`RPC '${e}' stream ${a} received:`,U),S.__(U)}})),Jl.u_(),setTimeout((()=>{S.s_()}),0),S}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return OS()}}function p4(s){return new Jl(s)}function AA(){return typeof window<"u"?window:null}function nm(){return typeof document<"u"?document:null}function rh(s){return new vM(s,!0)}Jl.c_=!1;class U_{constructor(e,t,r=1e3,a=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=a,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-r);a>0&&he("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const VT="PersistentStream";class NA{constructor(e,t,r,a,l,u,m,g){this.Ci=e,this.b_=r,this.S_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=m,this.listener=g,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new U_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===X.RESOURCE_EXHAUSTED?($t(t.toString()),$t("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===X.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.D_===t&&this.G_(r,a)}),(r=>{e((()=>{const a=new ce(X.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(a)}))}))}G_(e,t){const r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((a=>{r((()=>this.z_(a)))})),this.stream.onMessage((a=>{r((()=>++this.F_==1?this.H_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return he(VT,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(he(VT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class g4 extends NA{constructor(e,t,r,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=EM(this.serializer,e),r=(function(l){if(!("targetChange"in l))return Re.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Re.min():u.readTime?Yt(u.readTime):Re.min()})(e);return this.listener.J_(t,r)}Z_(e){const t={};t.database=hy(this.serializer),t.addTarget=(function(l,u){let m;const g=u.target;if(m=ym(g)?{documents:$1(l,g)}:{query:Y1(l,g).ft},m.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){m.resumeToken=q1(l,u.resumeToken);const y=uy(l,u.expectedCount);y!==null&&(m.expectedCount=y)}else if(u.snapshotVersion.compareTo(Re.min())>0){m.readTime=pc(l,u.snapshotVersion.toTimestamp());const y=uy(l,u.expectedCount);y!==null&&(m.expectedCount=y)}return m})(this.serializer,e);const r=IM(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){const t={};t.database=hy(this.serializer),t.removeTarget=e,this.K_(t)}}class y4 extends NA{constructor(e,t,r,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,u),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Ie(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ie(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ie(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=TM(e.writeResults,e.commitTime),r=Yt(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=hy(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Vd(this.serializer,r)))};this.K_(t)}}class _4{}class b4 extends _4{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new ce(X.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Wo(e,dy(t,r),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ce(X.UNKNOWN,l.toString())}))}jo(e,t,r,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,m])=>this.connection.jo(e,dy(t,r),a,u,m,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===X.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ce(X.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function v4(s,e,t,r){return new b4(s,e,t,r)}class x4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?($t(t),this.aa=!1):he("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Lo="RemoteStore";class w4{constructor(e,t,r,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((u=>{r.enqueueAndForget((async()=>{ka(this)&&(he(Lo,"Restarting streams for network reachability change."),await(async function(g){const y=ve(g);y.Ea.add(4),await Dc(y),y.Va.set("Unknown"),y.Ea.delete(4),await sh(y)})(this))}))})),this.Va=new x4(r,a)}}async function sh(s){if(ka(s))for(const e of s.Ra)await e(!0)}async function Dc(s){for(const e of s.Ra)await e(!1)}function np(s,e){const t=ve(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),q_(t)?B_(t):Pc(t).O_()&&z_(t,e))}function _c(s,e){const t=ve(s),r=Pc(t);t.Ia.delete(e),r.O_()&&RA(t,e),t.Ia.size===0&&(r.O_()?r.L_():ka(t)&&t.Va.set("Unknown"))}function z_(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Re.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Pc(s).Z_(e)}function RA(s,e){s.da.$e(e),Pc(s).X_(e)}function B_(s){s.da=new gM({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),Pc(s).start(),s.Va.ua()}function q_(s){return ka(s)&&!Pc(s).x_()&&s.Ia.size>0}function ka(s){return ve(s).Ea.size===0}function CA(s){s.da=void 0}async function E4(s){s.Va.set("Online")}async function T4(s){s.Ia.forEach(((e,t)=>{z_(s,e)}))}async function I4(s,e){CA(s),q_(s)?(s.Va.ha(e),B_(s)):s.Va.set("Unknown")}async function S4(s,e,t){if(s.Va.set("Online"),e instanceof B1&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const m of l.targetIds)a.Ia.has(m)&&(await a.remoteSyncer.rejectListen(m,u),a.Ia.delete(m),a.da.removeTarget(m))})(s,e)}catch(r){he(Lo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Am(s,r)}else if(e instanceof em?s.da.Xe(e):e instanceof z1?s.da.st(e):s.da.tt(e),!t.isEqual(Re.min()))try{const r=await _A(s.localStore);t.compareTo(r)>=0&&await(function(l,u){const m=l.da.Tt(u);return m.targetChanges.forEach(((g,y)=>{if(g.resumeToken.approximateByteSize()>0){const _=l.Ia.get(y);_&&l.Ia.set(y,_.withResumeToken(g.resumeToken,u))}})),m.targetMismatches.forEach(((g,y)=>{const _=l.Ia.get(g);if(!_)return;l.Ia.set(g,_.withResumeToken(Bt.EMPTY_BYTE_STRING,_.snapshotVersion)),RA(l,g);const x=new ui(_.target,g,y,_.sequenceNumber);z_(l,x)})),l.remoteSyncer.applyRemoteEvent(m)})(s,t)}catch(r){he(Lo,"Failed to raise snapshot:",r),await Am(s,r)}}async function Am(s,e,t){if(!Ra(e))throw e;s.Ea.add(1),await Dc(s),s.Va.set("Offline"),t||(t=()=>_A(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{he(Lo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await sh(s)}))}function kA(s,e){return e().catch((t=>Am(s,t,e)))}async function jc(s){const e=ve(s),t=Ta(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:fa;for(;A4(e);)try{const a=await l4(e.localStore,r);if(a===null){e.Ta.length===0&&t.L_();break}r=a.batchId,N4(e,a)}catch(a){await Am(e,a)}DA(e)&&jA(e)}function A4(s){return ka(s)&&s.Ta.length<10}function N4(s,e){s.Ta.push(e);const t=Ta(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function DA(s){return ka(s)&&!Ta(s).x_()&&s.Ta.length>0}function jA(s){Ta(s).start()}async function R4(s){Ta(s).ra()}async function C4(s){const e=Ta(s);for(const t of s.Ta)e.ea(t.mutations)}async function k4(s,e,t){const r=s.Ta.shift(),a=I_.from(r,e,t);await kA(s,(()=>s.remoteSyncer.applySuccessfulWrite(a))),await jc(s)}async function D4(s,e){e&&Ta(s).Y_&&await(async function(r,a){if((function(u){return M1(u)&&u!==X.ABORTED})(a.code)){const l=r.Ta.shift();Ta(r).B_(),await kA(r,(()=>r.remoteSyncer.rejectFailedWrite(l.batchId,a))),await jc(r)}})(s,e),DA(s)&&jA(s)}async function OT(s,e){const t=ve(s);t.asyncQueue.verifyOperationInProgress(),he(Lo,"RemoteStore received new credentials");const r=ka(t);t.Ea.add(3),await Dc(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await sh(t)}async function by(s,e){const t=ve(s);e?(t.Ea.delete(2),await sh(t)):e||(t.Ea.add(2),await Dc(t),t.Va.set("Unknown"))}function Pc(s){return s.ma||(s.ma=(function(t,r,a){const l=ve(t);return l.sa(),new g4(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:E4.bind(null,s),Yo:T4.bind(null,s),t_:I4.bind(null,s),J_:S4.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),q_(s)?B_(s):s.Va.set("Unknown")):(await s.ma.stop(),CA(s))}))),s.ma}function Ta(s){return s.fa||(s.fa=(function(t,r,a){const l=ve(t);return l.sa(),new y4(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:R4.bind(null,s),t_:D4.bind(null,s),ta:C4.bind(null,s),na:k4.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await jc(s)):(await s.fa.stop(),s.Ta.length>0&&(he(Lo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class F_{constructor(e,t,r,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=l,this.deferred=new Cn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,l){const u=Date.now()+r,m=new F_(e,t,u,a,l);return m.start(r),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ce(X.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vc(s,e){if($t("AsyncQueue",`${e}: ${s}`),Ra(s))return new ce(X.UNAVAILABLE,`${e}: ${s}`);throw s}class Zl{static emptySet(e){return new Zl(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ye.comparator(t.key,r.key):(t,r)=>ye.comparator(t.key,r.key),this.keyedMap=Ju(),this.sortedSet=new wt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Zl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Zl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class MT{constructor(){this.ga=new wt(ye.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):we(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class bc{constructor(e,t,r,a,l,u,m,g,y){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=m,this.excludesMetadataChanges=g,this.hasCachedResults=y}static fromInitialDocuments(e,t,r,a,l){const u=[];return t.forEach((m=>{u.push({type:0,doc:m})})),new bc(e,t,Zl.emptySet(t),u,r,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}class j4{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class P4{constructor(){this.queries=LT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const a=ve(t),l=a.queries;a.queries=LT(),l.forEach(((u,m)=>{for(const g of m.ba)g.onError(r)}))})(this,new ce(X.ABORTED,"Firestore shutting down"))}}function LT(){return new bi((s=>E1(s)),Jd)}async function H_(s,e){const t=ve(s);let r=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.Da()&&(r=2):(l=new j4,r=e.Da()?0:1);try{switch(r){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(u){const m=Vc(u,`Initialization of query '${ql(e.query)}' failed`);return void e.onError(m)}t.queries.set(a,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&Q_(t)}async function G_(s,e){const t=ve(s),r=e.query;let a=3;const l=t.queries.get(r);if(l){const u=l.ba.indexOf(e);u>=0&&(l.ba.splice(u,1),l.ba.length===0?a=e.Da()?0:1:!l.Sa()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function V4(s,e){const t=ve(s);let r=!1;for(const a of e){const l=a.query,u=t.queries.get(l);if(u){for(const m of u.ba)m.Fa(a)&&(r=!0);u.wa=a}}r&&Q_(t)}function O4(s,e,t){const r=ve(s),a=r.queries.get(e);if(a)for(const l of a.ba)l.onError(t);r.queries.delete(e)}function Q_(s){s.Ca.forEach((e=>{e.next()}))}var vy,UT;(UT=vy||(vy={})).Ma="default",UT.Cache="cache";class K_{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new bc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=bc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vy.Cache}}class M4{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class zT{constructor(e){this.serializer=e}Ks(e){return Ls(this.serializer,e)}qs(e){return e.metadata.exists?K1(this.serializer,e.document,!1):St.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return Yt(e)}}class L4{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=PA(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const r=Ye.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new zT(this.serializer);for(const a of e)if(a.metadata.queries){const l=r.Ks(a.metadata.name);for(const u of a.metadata.queries){const m=(t.get(u)||qe()).add(l);t.set(u,m)}}return t}async ja(e){const t=await c4(e,new zT(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(const a of this.Wa)await u4(e,a,r.get(a.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function PA(s){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:s.totalDocuments,totalBytes:s.totalBytes}}class VA{constructor(e){this.key=e}}class OA{constructor(e){this.key=e}}class MA{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=qe(),this.mutatedKeys=qe(),this.eu=I1(e),this.tu=new Zl(this.eu)}get nu(){return this.Za}ru(e,t){const r=t?t.iu:new MT,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=a,m=!1;const g=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,y=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,x)=>{const T=a.get(_),S=Zd(this.query,x)?x:null,V=!!T&&this.mutatedKeys.has(T.key),U=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let $=!1;T&&S?T.data.isEqual(S.data)?V!==U&&(r.track({type:3,doc:S}),$=!0):this.su(T,S)||(r.track({type:2,doc:S}),$=!0,(g&&this.eu(S,g)>0||y&&this.eu(S,y)<0)&&(m=!0)):!T&&S?(r.track({type:0,doc:S}),$=!0):T&&!S&&(r.track({type:1,doc:T}),$=!0,(g||y)&&(m=!0)),$&&(S?(u=u.add(S),l=U?l.add(_):l.delete(_)):(u=u.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),l=l.delete(_.key),r.track({type:1,doc:_})}return{tu:u,iu:r,Ss:m,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((_,x)=>(function(S,V){const U=$=>{switch($){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we(20277,{Vt:$})}};return U(S)-U(V)})(_.type,x.type)||this.eu(_.doc,x.doc))),this.ou(r),a=a??!1;const m=t&&!a?this._u():[],g=this.Ya.size===0&&this.current&&!a?1:0,y=g!==this.Xa;return this.Xa=g,u.length!==0||y?{snapshot:new bc(this.query,e.tu,l,u,e.mutatedKeys,g===0,y,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new MT,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=qe(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const t=[];return e.forEach((r=>{this.Ya.has(r)||t.push(new OA(r))})),this.Ya.forEach((r=>{e.has(r)||t.push(new VA(r))})),t}cu(e){this.Za=e.ks,this.Ya=qe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return bc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Da="SyncEngine";class U4{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class z4{constructor(e){this.key=e,this.hu=!1}}class B4{constructor(e,t,r,a,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new bi((m=>E1(m)),Jd),this.Iu=new Map,this.Eu=new Set,this.Ru=new wt(ye.comparator),this.Au=new Map,this.Vu=new D_,this.du={},this.mu=new Map,this.fu=Mo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function q4(s,e,t=!0){const r=rp(s);let a;const l=r.Tu.get(e);return l?(r.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await LA(r,e,t,!0),a}async function F4(s,e){const t=rp(s);await LA(t,e,!0,!1)}async function LA(s,e,t,r){const a=await gc(s.localStore,Qn(e)),l=a.targetId,u=s.sharedClientState.addLocalQueryTarget(l,t);let m;return r&&(m=await $_(s,e,l,u==="current",a.resumeToken)),s.isPrimaryClient&&t&&np(s.remoteStore,a),m}async function $_(s,e,t,r,a){s.pu=(x,T,S)=>(async function(U,$,H,se){let te=$.view.ru(H);te.Ss&&(te=await Tm(U.localStore,$.query,!1).then((({documents:C})=>$.view.ru(C,te))));const be=se&&se.targetChanges.get($.targetId),ae=se&&se.targetMismatches.get($.targetId)!=null,ee=$.view.applyChanges(te,U.isPrimaryClient,be,ae);return xy(U,$.targetId,ee.au),ee.snapshot})(s,x,T,S);const l=await Tm(s.localStore,e,!0),u=new MA(e,l.ks),m=u.ru(l.documents),g=nh.createSynthesizedTargetChangeForCurrentChange(t,r&&s.onlineState!=="Offline",a),y=u.applyChanges(m,s.isPrimaryClient,g);xy(s,t,y.au);const _=new U4(e,t,u);return s.Tu.set(e,_),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function H4(s,e,t){const r=ve(s),a=r.Tu.get(e),l=r.Iu.get(a.targetId);if(l.length>1)return r.Iu.set(a.targetId,l.filter((u=>!Jd(u,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await yc(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),t&&_c(r.remoteStore,a.targetId),vc(r,a.targetId)})).catch(Na)):(vc(r,a.targetId),await yc(r.localStore,a.targetId,!0))}async function G4(s,e){const t=ve(s),r=t.Tu.get(e),a=t.Iu.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),_c(t.remoteStore,r.targetId))}async function Q4(s,e,t){const r=J_(s);try{const a=await(function(u,m){const g=ve(u),y=ct.now(),_=m.reduce(((S,V)=>S.add(V.key)),qe());let x,T;return g.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let V=or(),U=qe();return g.xs.getEntries(S,_).next(($=>{V=$,V.forEach(((H,se)=>{se.isValidDocument()||(U=U.add(H))}))})).next((()=>g.localDocuments.getOverlayedDocuments(S,V))).next(($=>{x=$;const H=[];for(const se of m){const te=fM(se,x.get(se.key).overlayedDocument);te!=null&&H.push(new vi(se.key,te,m1(te.value.mapValue),Dt.exists(!0)))}return g.mutationQueue.addMutationBatch(S,y,H,m)})).next(($=>{T=$;const H=$.applyToLocalDocumentSet(x,U);return g.documentOverlayCache.saveOverlays(S,$.batchId,H)}))})).then((()=>({batchId:T.batchId,changes:A1(x)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(u,m,g){let y=u.du[u.currentUser.toKey()];y||(y=new wt(Oe)),y=y.insert(m,g),u.du[u.currentUser.toKey()]=y})(r,a.batchId,t),await xi(r,a.changes),await jc(r.remoteStore)}catch(a){const l=Vc(a,"Failed to persist write");t.reject(l)}}async function UA(s,e){const t=ve(s);try{const r=await o4(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=t.Au.get(l);u&&(Ie(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?Ie(u.hu,14607):a.removedDocuments.size>0&&(Ie(u.hu,42227),u.hu=!1))})),await xi(t,r,e)}catch(r){await Na(r)}}function BT(s,e,t){const r=ve(s);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Tu.forEach(((l,u)=>{const m=u.view.va(e);m.snapshot&&a.push(m.snapshot)})),(function(u,m){const g=ve(u);g.onlineState=m;let y=!1;g.queries.forEach(((_,x)=>{for(const T of x.ba)T.va(m)&&(y=!0)})),y&&Q_(g)})(r.eventManager,e),a.length&&r.Pu.J_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function K4(s,e,t){const r=ve(s);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Au.get(e),l=a&&a.key;if(l){let u=new wt(ye.comparator);u=u.insert(l,St.newNoDocument(l,Re.min()));const m=qe().add(l),g=new th(Re.min(),new Map,new wt(Oe),u,m);await UA(r,g),r.Ru=r.Ru.remove(l),r.Au.delete(e),X_(r)}else await yc(r.localStore,e,!1).then((()=>vc(r,e,t))).catch(Na)}async function $4(s,e){const t=ve(s),r=e.batch.batchId;try{const a=await a4(t.localStore,e);W_(t,r,null),Y_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await xi(t,a)}catch(a){await Na(a)}}async function Y4(s,e,t){const r=ve(s);try{const a=await(function(u,m){const g=ve(u);return g.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let _;return g.mutationQueue.lookupMutationBatch(y,m).next((x=>(Ie(x!==null,37113),_=x.keys(),g.mutationQueue.removeMutationBatch(y,x)))).next((()=>g.mutationQueue.performConsistencyCheck(y))).next((()=>g.documentOverlayCache.removeOverlaysForBatchId(y,_,m))).next((()=>g.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,_))).next((()=>g.localDocuments.getDocuments(y,_)))}))})(r.localStore,e);W_(r,e,t),Y_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await xi(r,a)}catch(a){await Na(a)}}async function W4(s,e){const t=ve(s);ka(t.remoteStore)||he(Da,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(u){const m=ve(u);return m.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(g=>m.mutationQueue.getHighestUnacknowledgedBatchId(g)))})(t.localStore);if(r===fa)return void e.resolve();const a=t.mu.get(r)||[];a.push(e),t.mu.set(r,a)}catch(r){const a=Vc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(a)}}function Y_(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function W_(s,e,t){const r=ve(s);let a=r.du[r.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),r.du[r.currentUser.toKey()]=a}}function vc(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const r of s.Iu.get(e))s.Tu.delete(r),t&&s.Pu.yu(r,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((r=>{s.Vu.containsKey(r)||zA(s,r)}))}function zA(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(_c(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),X_(s))}function xy(s,e,t){for(const r of t)r instanceof VA?(s.Vu.addReference(r.key,e),X4(s,r)):r instanceof OA?(he(Da,"Document no longer in limbo: "+r.key),s.Vu.removeReference(r.key,e),s.Vu.containsKey(r.key)||zA(s,r.key)):we(19791,{wu:r})}function X4(s,e){const t=e.key,r=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(r)||(he(Da,"New document in limbo: "+t),s.Eu.add(r),X_(s))}function X_(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ye(Ye.fromString(e)),r=s.fu.next();s.Au.set(r,new z4(t)),s.Ru=s.Ru.insert(t,r),np(s.remoteStore,new ui(Qn(Rc(t.path)),r,"TargetPurposeLimboResolution",ir.ce))}}async function xi(s,e,t){const r=ve(s),a=[],l=[],u=[];r.Tu.isEmpty()||(r.Tu.forEach(((m,g)=>{u.push(r.pu(g,e,t).then((y=>{if((y||t)&&r.isPrimaryClient){const _=y?!y.fromCache:t?.targetChanges.get(g.targetId)?.current;r.sharedClientState.updateQueryState(g.targetId,_?"current":"not-current")}if(y){a.push(y);const _=O_.Es(g.targetId,y);l.push(_)}})))})),await Promise.all(u),r.Pu.J_(a),await(async function(g,y){const _=ve(g);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>B.forEach(y,(T=>B.forEach(T.Ts,(S=>_.persistence.referenceDelegate.addReference(x,T.targetId,S))).next((()=>B.forEach(T.Is,(S=>_.persistence.referenceDelegate.removeReference(x,T.targetId,S)))))))))}catch(x){if(!Ra(x))throw x;he(M_,"Failed to update sequence numbers: "+x)}for(const x of y){const T=x.targetId;if(!x.fromCache){const S=_.vs.get(T),V=S.snapshotVersion,U=S.withLastLimboFreeSnapshotVersion(V);_.vs=_.vs.insert(T,U)}}})(r.localStore,l))}async function J4(s,e){const t=ve(s);if(!t.currentUser.isEqual(e)){he(Da,"User change. New user:",e.toKey());const r=await yA(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((m=>{m.forEach((g=>{g.reject(new ce(X.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await xi(t,r.Ns)}}function Z4(s,e){const t=ve(s),r=t.Au.get(e);if(r&&r.hu)return qe().add(r.key);{let a=qe();const l=t.Iu.get(e);if(!l)return a;for(const u of l){const m=t.Tu.get(u);a=a.unionWith(m.view.nu)}return a}}async function e6(s,e){const t=ve(s),r=await Tm(t.localStore,e.query,!0),a=e.view.cu(r);return t.isPrimaryClient&&xy(t,e.targetId,a.au),a}async function t6(s,e){const t=ve(s);return xA(t.localStore,e).then((r=>xi(t,r)))}async function n6(s,e,t,r){const a=ve(s),l=await(function(m,g){const y=ve(m),_=ve(y.mutationQueue);return y.persistence.runTransaction("Lookup mutation documents","readonly",(x=>_.Xn(x,g).next((T=>T?y.localDocuments.getDocuments(x,T):B.resolve(null)))))})(a.localStore,e);l!==null?(t==="pending"?await jc(a.remoteStore):t==="acknowledged"||t==="rejected"?(W_(a,e,r||null),Y_(a,e),(function(m,g){ve(ve(m).mutationQueue).nr(g)})(a.localStore,e)):we(6720,"Unknown batchState",{bu:t}),await xi(a,l)):he(Da,"Cannot apply mutation batch with id: "+e)}async function r6(s,e){const t=ve(s);if(rp(t),J_(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),a=await qT(t,r.toArray());t.gu=!0,await by(t.remoteStore,!0);for(const l of a)np(t.remoteStore,l)}else if(e===!1&&t.gu!==!1){const r=[];let a=Promise.resolve();t.Iu.forEach(((l,u)=>{t.sharedClientState.isLocalQueryTarget(u)?r.push(u):a=a.then((()=>(vc(t,u),yc(t.localStore,u,!0)))),_c(t.remoteStore,u)})),await a,await qT(t,r),(function(u){const m=ve(u);m.Au.forEach(((g,y)=>{_c(m.remoteStore,y)})),m.Vu.zr(),m.Au=new Map,m.Ru=new wt(ye.comparator)})(t),t.gu=!1,await by(t.remoteStore,!1)}}async function qT(s,e,t){const r=ve(s),a=[],l=[];for(const u of e){let m;const g=r.Iu.get(u);if(g&&g.length!==0){m=await gc(r.localStore,Qn(g[0]));for(const y of g){const _=r.Tu.get(y),x=await e6(r,_);x.snapshot&&l.push(x.snapshot)}}else{const y=await vA(r.localStore,u);m=await gc(r.localStore,y),await $_(r,BA(y),u,!1,m.resumeToken)}a.push(m)}return r.Pu.J_(l),a}function BA(s){return w1(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function s6(s){return(function(t){return ve(ve(t).persistence).hs()})(ve(s).localStore)}async function i6(s,e,t,r){const a=ve(s);if(a.gu)return void he(Da,"Ignoring unexpected query state notification.");const l=a.Iu.get(e);if(l&&l.length>0)switch(t){case"current":case"not-current":{const u=await xA(a.localStore,T1(l[0])),m=th.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Bt.EMPTY_BYTE_STRING);await xi(a,u,m);break}case"rejected":await yc(a.localStore,e,!0),vc(a,e,r);break;default:we(64155,t)}}async function a6(s,e,t){const r=rp(s);if(r.gu){for(const a of e){if(r.Iu.has(a)&&r.sharedClientState.isActiveQueryTarget(a)){he(Da,"Adding an already active target "+a);continue}const l=await vA(r.localStore,a),u=await gc(r.localStore,l);await $_(r,BA(l),u.targetId,!1,u.resumeToken),np(r.remoteStore,u)}for(const a of t)r.Iu.has(a)&&await yc(r.localStore,a,!1).then((()=>{_c(r.remoteStore,a),vc(r,a)})).catch(Na)}}function rp(s){const e=ve(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=UA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Z4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=K4.bind(null,e),e.Pu.J_=V4.bind(null,e.eventManager),e.Pu.yu=O4.bind(null,e.eventManager),e}function J_(s){const e=ve(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Y4.bind(null,e),e}function o6(s,e,t){const r=ve(s);(async function(l,u,m){try{const g=await u.getMetadata();if(await(function(S,V){const U=ve(S),$=Yt(V.createTime);return U.persistence.runTransaction("hasNewerBundle","readonly",(H=>U.Pi.getBundleMetadata(H,V.id))).then((H=>!!H&&H.createTime.compareTo($)>=0))})(l.localStore,g))return await u.close(),m._completeWith((function(S){return{taskState:"Success",documentsLoaded:S.totalDocuments,bytesLoaded:S.totalBytes,totalDocuments:S.totalDocuments,totalBytes:S.totalBytes}})(g)),Promise.resolve(new Set);m._updateProgress(PA(g));const y=new L4(g,u.serializer);let _=await u.Su();for(;_;){const T=await y.Ga(_);T&&m._updateProgress(T),_=await u.Su()}const x=await y.ja(l.localStore);return await xi(l,x.Ja,void 0),await(function(S,V){const U=ve(S);return U.persistence.runTransaction("Save bundle","readwrite",($=>U.Pi.saveBundleMetadata($,V)))})(l.localStore,g),m._completeWith(x.progress),Promise.resolve(x.Ha)}catch(g){return Bs(Da,`Loading bundle failed with ${g}`),m._failWith(g),Promise.resolve(new Set)}})(r,e,t).then((a=>{r.sharedClientState.notifyBundleLoaded(a)}))}class Od{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return gA(this.persistence,new pA,e.initialUser,this.serializer)}Cu(e){return new j_(tp.Vi,this.serializer)}Du(e){return new SA}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Od.provider={build:()=>new Od};class l6 extends Od{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ie(this.persistence.referenceDelegate instanceof Em,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new cA(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?On.withCacheSize(this.cacheSizeBytes):On.DEFAULT;return new j_((r=>Em.Vi(r,t)),this.serializer)}}class qA extends Od{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await J_(this.xu.syncEngine),await jc(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return gA(this.persistence,new pA,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new cA(r,e.asyncQueue,t)}Mu(e,t){const r=new dO(t,this.persistence);return new uO(e.asyncQueue,r)}Cu(e){const t=V_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?On.withCacheSize(this.cacheSizeBytes):On.DEFAULT;return new P_(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,AA(),nm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new SA}}class c6 extends qA{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof j0&&(this.sharedClientState.syncEngine={So:n6.bind(null,t),Do:i6.bind(null,t),Co:a6.bind(null,t),hs:s6.bind(null,t),bo:t6.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async r=>{await r6(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=AA();if(!j0.v(t))throw new ce(X.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=V_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new j0(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Md{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>BT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=J4.bind(null,this.syncEngine),await by(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new P4})()}createDatastore(e){const t=rh(e.databaseInfo.databaseId),r=p4(e.databaseInfo);return v4(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,a,l,u,m){return new w4(r,a,l,u,m)})(this.localStore,this.datastore,e.asyncQueue,(t=>BT(this.syncEngine,t,0)),(function(){return PT.v()?new PT:new d4})())}createSyncEngine(e,t){return(function(a,l,u,m,g,y,_){const x=new B4(a,l,u,m,g,y);return _&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=ve(t);he(Lo,"RemoteStore shutting down."),r.Ea.add(5),await Dc(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Md.provider={build:()=>new Md};function FT(s,e=10240){let t=0;return{async read(){if(t<s.byteLength){const r={value:s.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class sp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):$t("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class u6{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Cn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.Ua()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);const a=await this.Uu(r);return new M4(JSON.parse(a),e.length+r)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}let d6=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ce(X.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(a,l){const u=ve(a),m={documents:l.map((x=>Pd(u.serializer,x)))},g=await u.jo("BatchGetDocuments",u.serializer.databaseId,Ye.emptyPath(),m,l.length),y=new Map;g.forEach((x=>{const T=wM(u.serializer,x);y.set(T.key.toString(),T)}));const _=[];return l.forEach((x=>{const T=y.get(x.toString());Ie(!!T,55234,{key:x}),_.push(T)})),_})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new kc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const a=ye.fromPath(r);this.mutations.push(new E_(a,this.precondition(a)))})),await(async function(r,a){const l=ve(r),u={writes:a.map((m=>Vd(l.serializer,m)))};await l.Wo("Commit",l.serializer.databaseId,Ye.emptyPath(),u)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw we(50498,{Gu:e.constructor.name});t=Re.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ce(X.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Re.min())?Dt.exists(!1):Dt.updateTime(t):Dt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Re.min()))throw new ce(X.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Dt.updateTime(t)}return Dt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};class h6{constructor(e,t,r,a,l){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=a,this.deferred=l,this.zu=r.maxAttempts,this.M_=new U_(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new d6(this.datastore),t=this.Ju(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((a=>{this.Zu(a)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(e){try{const t=this.updateFunction(e);return!Yd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!M1(t)}return!1}}const Ia="FirestoreClient";class f6{constructor(e,t,r,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=a,this.user=bn.UNAUTHENTICATED,this.clientId=c_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(r,(async u=>{he(Ia,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(r,(u=>(he(Ia,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Cn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Vc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function V0(s,e){s.asyncQueue.verifyOperationInProgress(),he(Ia,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let r=t.initialUser;s.setCredentialChangeListener((async a=>{r.isEqual(a)||(await yA(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function HT(s,e){s.asyncQueue.verifyOperationInProgress();const t=await Z_(s);he(Ia,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((r=>OT(e.remoteStore,r))),s.setAppCheckTokenChangeListener(((r,a)=>OT(e.remoteStore,a))),s._onlineComponents=e}async function Z_(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){he(Ia,"Using user provided OfflineComponentProvider");try{await V0(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===X.FAILED_PRECONDITION||a.code===X.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Bs("Error using user provided cache. Falling back to memory cache: "+t),await V0(s,new Od)}}else he(Ia,"Using default OfflineComponentProvider"),await V0(s,new l6(void 0));return s._offlineComponents}async function ip(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(he(Ia,"Using user provided OnlineComponentProvider"),await HT(s,s._uninitializedComponentsProvider._online)):(he(Ia,"Using default OnlineComponentProvider"),await HT(s,new Md))),s._onlineComponents}function FA(s){return Z_(s).then((e=>e.persistence))}function eb(s){return Z_(s).then((e=>e.localStore))}function HA(s){return ip(s).then((e=>e.remoteStore))}function tb(s){return ip(s).then((e=>e.syncEngine))}function m6(s){return ip(s).then((e=>e.datastore))}async function xc(s){const e=await ip(s),t=e.eventManager;return t.onListen=q4.bind(null,e.syncEngine),t.onUnlisten=H4.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=F4.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=G4.bind(null,e.syncEngine),t}function p6(s){return s.asyncQueue.enqueue((async()=>{const e=await FA(s),t=await HA(s);return e.setNetworkEnabled(!0),(function(a){const l=ve(a);return l.Ea.delete(0),sh(l)})(t)}))}function g6(s){return s.asyncQueue.enqueue((async()=>{const e=await FA(s),t=await HA(s);return e.setNetworkEnabled(!1),(async function(a){const l=ve(a);l.Ea.add(0),await Dc(l),l.Va.set("Offline")})(t)}))}function y6(s,e,t,r){const a=new sp(r),l=new K_(e,a,t);return s.asyncQueue.enqueueAndForget((async()=>H_(await xc(s),l))),()=>{a.Nu(),s.asyncQueue.enqueueAndForget((async()=>G_(await xc(s),l)))}}function _6(s,e){const t=new Cn;return s.asyncQueue.enqueueAndForget((async()=>(async function(a,l,u){try{const m=await(function(y,_){const x=ve(y);return x.persistence.runTransaction("read document","readonly",(T=>x.localDocuments.getDocument(T,_)))})(a,l);m.isFoundDocument()?u.resolve(m):m.isNoDocument()?u.resolve(null):u.reject(new ce(X.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(m){const g=Vc(m,`Failed to get document '${l} from cache`);u.reject(g)}})(await eb(s),e,t))),t.promise}function GA(s,e,t={}){const r=new Cn;return s.asyncQueue.enqueueAndForget((async()=>(function(l,u,m,g,y){const _=new sp({next:T=>{_.Nu(),u.enqueueAndForget((()=>G_(l,x)));const S=T.docs.has(m);!S&&T.fromCache?y.reject(new ce(X.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&T.fromCache&&g&&g.source==="server"?y.reject(new ce(X.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),x=new K_(Rc(m.path),_,{includeMetadataChanges:!0,Ka:!0});return H_(l,x)})(await xc(s),s.asyncQueue,e,t,r))),r.promise}function b6(s,e){const t=new Cn;return s.asyncQueue.enqueueAndForget((async()=>(async function(a,l,u){try{const m=await Tm(a,l,!0),g=new MA(l,m.ks),y=g.ru(m.documents),_=g.applyChanges(y,!1);u.resolve(_.snapshot)}catch(m){const g=Vc(m,`Failed to execute query '${l} against cache`);u.reject(g)}})(await eb(s),e,t))),t.promise}function QA(s,e,t={}){const r=new Cn;return s.asyncQueue.enqueueAndForget((async()=>(function(l,u,m,g,y){const _=new sp({next:T=>{_.Nu(),u.enqueueAndForget((()=>G_(l,x))),T.fromCache&&g.source==="server"?y.reject(new ce(X.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),x=new K_(m,_,{includeMetadataChanges:!0,Ka:!0});return H_(l,x)})(await xc(s),s.asyncQueue,e,t,r))),r.promise}function v6(s,e){const t=new Cn;return s.asyncQueue.enqueueAndForget((async()=>Q4(await tb(s),e,t))),t.promise}function x6(s,e){const t=new sp(e);return s.asyncQueue.enqueueAndForget((async()=>(function(a,l){ve(a).Ca.add(l),l.next()})(await xc(s),t))),()=>{t.Nu(),s.asyncQueue.enqueueAndForget((async()=>(function(a,l){ve(a).Ca.delete(l)})(await xc(s),t)))}}function w6(s,e,t){const r=new Cn;return s.asyncQueue.enqueueAndForget((async()=>{const a=await m6(s);new h6(s.asyncQueue,a,t,e,r).ju()})),r.promise}function E6(s,e,t,r){const a=(function(u,m){let g;return g=typeof u=="string"?U1().encode(u):u,(function(_,x){return new u6(_,x)})((function(_,x){if(_ instanceof Uint8Array)return FT(_,x);if(_ instanceof ArrayBuffer)return FT(new Uint8Array(_),x);if(_ instanceof ReadableStream)return _.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(g),m)})(t,rh(e));s.asyncQueue.enqueueAndForget((async()=>{o6(await tb(s),a,r)}))}function T6(s,e){return s.asyncQueue.enqueue((async()=>(function(r,a){const l=ve(r);return l.persistence.runTransaction("Get named query","readonly",(u=>l.Pi.getNamedQuery(u,a)))})(await eb(s),e)))}function KA(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const I6="ComponentProvider",GT=new Map;function S6(s,e,t,r,a){return new zO(s,e,t,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,KA(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,r)}const $A="firestore.googleapis.com",QT=!0;class KT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ce(X.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$A,this.ssl=QT}else this.host=e.host,this.ssl=e.ssl??QT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=iA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<BM)throw new ce(X.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=KA(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ce(X.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ce(X.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ce(X.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ih{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new KT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ce(X.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ce(X.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new KT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new JV;switch(r.type){case"firstParty":return new nO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ce(X.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=GT.get(t);r&&(he(I6,"Removing Datastore"),GT.delete(t),r.terminate())})(this),Promise.resolve()}}function A6(s,e,t,r={}){s=it(s,ih);const a=Ec(e),l=s._getSettings(),u={...l,emulatorOptions:s._getEmulatorOptions()},m=`${e}:${t}`;a&&(hI(`https://${m}`),fI("Firestore",!0)),l.host!==$A&&l.host!==m&&Bs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g={...l,host:m,ssl:a,emulatorOptions:r};if(!pa(g,u)&&(s._setSettings(g),r.mockUserToken)){let y,_;if(typeof r.mockUserToken=="string")y=r.mockUserToken,_=bn.MOCK_USER;else{y=mC(r.mockUserToken,s._app?.options.projectId);const x=r.mockUserToken.sub||r.mockUserToken.user_id;if(!x)throw new ce(X.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new bn(x)}s._authCredentials=new ZV(new LS(y,_))}}let Kn=class YA{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new YA(this.firestore,e,this._query)}},xt=class td{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ma(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new td(this.firestore,e,this._key)}toJSON(){return{type:td._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if($d(t,td._jsonSchema))return new td(e,r||null,new ye(Ye.fromString(t.referencePath)))}};xt._jsonSchemaVersion="firestore/documentReference/1.0",xt._jsonSchema={type:cn("string",xt._jsonSchemaVersion),referencePath:cn("string")};let ma=class WA extends Kn{constructor(e,t,r){super(e,t,Rc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new xt(this.firestore,null,new ye(e))}withConverter(e){return new WA(this.firestore,e,this._path)}};function XA(s,e,...t){if(s=je(s),u_("collection","path",e),s instanceof ih){const r=Ye.fromString(e,...t);return VE(r),new ma(s,null,r)}{if(!(s instanceof xt||s instanceof ma))throw new ce(X.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child(Ye.fromString(e,...t));return VE(r),new ma(s.firestore,null,r)}}function N6(s,e){if(s=it(s,ih),u_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ce(X.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Kn(s,null,(function(r){return new _i(Ye.emptyPath(),r)})(e))}function Nm(s,e,...t){if(s=je(s),arguments.length===1&&(e=c_.newId()),u_("doc","path",e),s instanceof ih){const r=Ye.fromString(e,...t);return PE(r),new xt(s,null,new ye(r))}{if(!(s instanceof xt||s instanceof ma))throw new ce(X.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child(Ye.fromString(e,...t));return PE(r),new xt(s.firestore,s instanceof ma?s.converter:null,new ye(r))}}function JA(s,e){return s=je(s),e=je(e),(s instanceof xt||s instanceof ma)&&(e instanceof xt||e instanceof ma)&&s.firestore===e.firestore&&s.path===e.path&&s.converter===e.converter}function ZA(s,e){return s=je(s),e=je(e),s instanceof Kn&&e instanceof Kn&&s.firestore===e.firestore&&Jd(s._query,e._query)&&s.converter===e.converter}const $T="AsyncQueue";class YT{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new U_(this,"async_queue_retry"),this._c=()=>{const r=nm();r&&he($T,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=nm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=nm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Cn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Ra(e))throw e;he($T,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,$t("INTERNAL UNHANDLED ERROR: ",WT(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=F_.createAndSchedule(this,e,t,r,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&we(47125,{Pc:WT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function WT(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class R6{constructor(){this._progressObserver={},this._taskCompletionResolver=new Cn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const C6=-1;let Wt=class extends ih{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new YT,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new YT(e),this._firestoreClient=void 0,await e}}};function Un(s){if(s._terminated)throw new ce(X.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||eN(s),s._firestoreClient}function eN(s){const e=s._freezeSettings(),t=S6(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new f6(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(s._componentsProvider))}function k6(s,e){Bs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=s._freezeSettings();return tN(s,Md.provider,{build:r=>new qA(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function D6(s){Bs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=s._freezeSettings();tN(s,Md.provider,{build:t=>new c6(t,e.cacheSizeBytes)})}function tN(s,e,t){if((s=it(s,Wt))._firestoreClient||s._terminated)throw new ce(X.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(s._componentsProvider||s._getSettings().localCache)throw new ce(X.FAILED_PRECONDITION,"SDK cache is already specified.");s._componentsProvider={_online:e,_offline:t},eN(s)}function j6(s){if(s._initialized&&!s._terminated)throw new ce(X.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Cn;return s._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!Ms.v())return Promise.resolve();const a=r+mA;await Ms.delete(a)})(V_(s._databaseId,s._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function P6(s){return(function(t){const r=new Cn;return t.asyncQueue.enqueueAndForget((async()=>W4(await tb(t),r))),r.promise})(Un(s=it(s,Wt)))}function V6(s){return p6(Un(s=it(s,Wt)))}function O6(s){return g6(Un(s=it(s,Wt)))}function M6(s,e){const t=Un(s=it(s,Wt)),r=new R6;return E6(t,s._databaseId,e,r),r}function L6(s,e){return T6(Un(s=it(s,Wt)),e).then((t=>t?new Kn(s,null,t.query):null))}class Mn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mn(Bt.fromBase64String(e))}catch(t){throw new ce(X.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Mn(Bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($d(e,Mn._jsonSchema))return Mn.fromBase64String(e.bytes)}}Mn._jsonSchemaVersion="firestore/bytes/1.0",Mn._jsonSchema={type:cn("string",Mn._jsonSchemaVersion),bytes:cn("string")};let Uo=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ce(X.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let Ho=class{constructor(e){this._methodName=e}};class ns{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ce(X.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ce(X.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Oe(this._lat,e._lat)||Oe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ns._jsonSchemaVersion}}static fromJSON(e){if($d(e,ns._jsonSchema))return new ns(e.latitude,e.longitude)}}ns._jsonSchemaVersion="firestore/geoPoint/1.0",ns._jsonSchema={type:cn("string",ns._jsonSchemaVersion),latitude:cn("number"),longitude:cn("number")};class rs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let l=0;l<r.length;++l)if(r[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:rs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($d(e,rs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new rs(e.vectorValues);throw new ce(X.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}rs._jsonSchemaVersion="firestore/vectorValue/1.0",rs._jsonSchema={type:cn("string",rs._jsonSchemaVersion),vectorValues:cn("object")};const U6=/^__.*__$/;class z6{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new vi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Cc(e,this.data,t,this.fieldTransforms)}}class nN{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new vi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function rN(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we(40011,{dataSource:s})}}class ap{constructor(e,t,r,a,l,u){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new ap({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){const t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Rm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(rN(this.dataSource)&&U6.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class B6{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||rh(e)}createContext(e,t,r,a=!1){return new ap({dataSource:e,methodName:t,targetDoc:r,path:kt.emptyPath(),arrayElement:!1,hasConverter:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Go(s){const e=s._freezeSettings(),t=rh(s._databaseId);return new B6(s._databaseId,!!e.ignoreUndefinedProperties,t)}function op(s,e,t,r,a,l={}){const u=s.createContext(l.merge||l.mergeFields?2:0,e,t,a);lb("Data must be an object, but it was:",u,r);const m=aN(r,u);let g,y;if(l.merge)g=new ar(u.fieldMask),y=u.fieldTransforms;else if(l.mergeFields){const _=[];for(const x of l.mergeFields){const T=zo(e,x,t);if(!u.contains(T))throw new ce(X.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);cN(_,T)||_.push(T)}g=new ar(_),y=u.fieldTransforms.filter((x=>g.covers(x.field)))}else g=null,y=u.fieldTransforms;return new z6(new Rn(m),g,y)}class ah extends Ho{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ah}}function sN(s,e,t){return new ap({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class nb extends Ho{_toFieldTransform(e){return new eh(e.path,new fc)}isEqual(e){return e instanceof nb}}class rb extends Ho{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=sN(this,e,!0),r=this.Ac.map((l=>Qo(l,t))),a=new jo(r);return new eh(e.path,a)}isEqual(e){return e instanceof rb&&pa(this.Ac,e.Ac)}}class sb extends Ho{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=sN(this,e,!0),r=this.Ac.map((l=>Qo(l,t))),a=new Po(r);return new eh(e.path,a)}isEqual(e){return e instanceof sb&&pa(this.Ac,e.Ac)}}class ib extends Ho{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new mc(e.serializer,C1(e.serializer,this.Vc));return new eh(e.path,t)}isEqual(e){return e instanceof ib&&this.Vc===e.Vc}}function ab(s,e,t,r){const a=s.createContext(1,e,t);lb("Data must be an object, but it was:",a,r);const l=[],u=Rn.empty();Ca(r,((g,y)=>{const _=lN(e,g,t);y=je(y);const x=a.childContextForFieldPath(_);if(y instanceof ah)l.push(_);else{const T=Qo(y,x);T!=null&&(l.push(_),u.set(_,T))}}));const m=new ar(l);return new nN(u,m,a.fieldTransforms)}function ob(s,e,t,r,a,l){const u=s.createContext(1,e,t),m=[zo(e,r,t)],g=[a];if(l.length%2!=0)throw new ce(X.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<l.length;T+=2)m.push(zo(e,l[T])),g.push(l[T+1]);const y=[],_=Rn.empty();for(let T=m.length-1;T>=0;--T)if(!cN(y,m[T])){const S=m[T];let V=g[T];V=je(V);const U=u.childContextForFieldPath(S);if(V instanceof ah)y.push(S);else{const $=Qo(V,U);$!=null&&(y.push(S),_.set(S,$))}}const x=new ar(y);return new nN(_,x,u.fieldTransforms)}function iN(s,e,t,r=!1){return Qo(t,s.createContext(r?4:3,e))}function Qo(s,e){if(oN(s=je(s)))return lb("Unsupported field value:",e,s),aN(s,e);if(s instanceof Ho)return(function(r,a){if(!rN(a.dataSource))throw a.createError(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.createError(`${r._methodName}() is not currently supported inside arrays`);const l=r._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,a){const l=[];let u=0;for(const m of r){let g=Qo(m,a.childContextForArray(u));g==null&&(g={nullValue:"NULL_VALUE"}),l.push(g),u++}return{arrayValue:{values:l}}})(s,e)}return(function(r,a){if((r=je(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return C1(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const l=ct.fromDate(r);return{timestampValue:pc(a.serializer,l)}}if(r instanceof ct){const l=new ct(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:pc(a.serializer,l)}}if(r instanceof ns)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Mn)return{bytesValue:q1(a.serializer,r._byteString)};if(r instanceof xt){const l=a.databaseId,u=r.firestore._databaseId;if(!u.isEqual(l))throw a.createError(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:N_(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof rs)return(function(u,m){const g=u instanceof rs?u.toArray():u;return{mapValue:{fields:{[y_]:{stringValue:__},[uc]:{arrayValue:{values:g.map((_=>{if(typeof _!="number")throw m.createError("VectorValues must only contain numeric values.");return w_(m.serializer,_)}))}}}}}})(r,a);if(eA(r))return r._toProto(a.serializer);throw a.createError(`Unsupported field value: ${Fm(r)}`)})(s,e)}function aN(s,e){const t={};return i1(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ca(s,((r,a)=>{const l=Qo(a,e.childContextForField(r));l!=null&&(t[r]=l)})),{mapValue:{fields:t}}}function oN(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof ct||s instanceof ns||s instanceof Mn||s instanceof xt||s instanceof Ho||s instanceof rs||eA(s))}function lb(s,e,t){if(!oN(t)||!BS(t)){const r=Fm(t);throw r==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+r)}}function zo(s,e,t){if((e=je(e))instanceof Uo)return e._internalPath;if(typeof e=="string")return lN(s,e);throw Rm("Field path arguments must be of type string or ",s,!1,void 0,t)}const q6=new RegExp("[~\\*/\\[\\]]");function lN(s,e,t){if(e.search(q6)>=0)throw Rm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Uo(...e.split("."))._internalPath}catch{throw Rm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Rm(s,e,t,r,a){const l=r&&!r.isEmpty(),u=a!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let g="";return(l||u)&&(g+=" (found",l&&(g+=` in field ${r}`),u&&(g+=` in document ${a}`),g+=")"),new ce(X.INVALID_ARGUMENT,m+s+g)}function cN(s,e){return s.some((t=>t.isEqual(e)))}class cb{convertValue(e,t="none"){switch(xa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Rt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(pi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw we(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ca(e,((a,l)=>{r[a]=this.convertValue(l,t)})),r}convertVectorValue(e){const t=e.fields?.[uc].arrayValue?.values?.map((r=>Rt(r.doubleValue)));return new rs(t)}convertGeoPoint(e){return new ns(Rt(e.latitude),Rt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Ym(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Cd(e));default:return null}}convertTimestamp(e){const t=mi(e);return new ct(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ye.fromString(e);Ie(Z1(r),9688,{name:e});const a=new va(r.get(1),r.get(3)),l=new ye(r.popFirst(5));return a.isEqual(t)||$t(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}class Ko extends cb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new xt(this.firestore,null,t)}}function F6(){return new ah("deleteField")}function H6(){return new nb("serverTimestamp")}function G6(...s){return new rb("arrayUnion",s)}function Q6(...s){return new sb("arrayRemove",s)}function K6(s){return new ib("increment",s)}const XT="@firebase/firestore",JT="4.10.0";function wy(s){return(function(t,r){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of r)if(l in a&&typeof a[l]=="function")return!0;return!1})(s,["next","error","complete"])}class Ld{constructor(e,t,r,a,l){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new xt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new $6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(zo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class $6 extends Ld{data(){return super.data()}}function uN(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new ce(X.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ub{}class oh extends ub{}function sa(s,e,...t){let r=[];e instanceof ub&&r.push(e),r=r.concat(t),(function(l){const u=l.filter((g=>g instanceof db)).length,m=l.filter((g=>g instanceof lp)).length;if(u>1||u>0&&m>0)throw new ce(X.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const a of r)s=a._apply(s);return s}class lp extends oh{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new lp(e,t,r)}_apply(e){const t=this._parse(e);return hN(e._query,t),new Kn(e.firestore,e.converter,cy(e._query,t))}_parse(e){const t=Go(e.firestore);return(function(l,u,m,g,y,_,x){let T;if(y.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new ce(X.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){eI(x,_);const V=[];for(const U of x)V.push(ZT(g,l,U));T={arrayValue:{values:V}}}else T=ZT(g,l,x)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||eI(x,_),T=iN(m,u,x,_==="in"||_==="not-in");return Ze.create(y,_,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Y6(s,e,t){const r=e,a=zo("where",s);return lp._create(a,r,t)}class db extends ub{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new db(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:ft.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let u=a;const m=l.getFlattenedFilters();for(const g of m)hN(u,g),u=cy(u,g)})(e._query,t),new Kn(e.firestore,e.converter,cy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class hb extends oh{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new hb(e,t)}_apply(e){const t=(function(a,l,u){if(a.startAt!==null)throw new ce(X.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new ce(X.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new jd(l,u)})(e._query,this._field,this._direction);return new Kn(e.firestore,e.converter,eM(e._query,t))}}function W6(s,e="asc"){const t=e,r=zo("orderBy",s);return hb._create(r,t)}class cp extends oh{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new cp(e,t,r)}_apply(e){return new Kn(e.firestore,e.converter,bm(e._query,this._limit,this._limitType))}}function X6(s){return qS("limit",s),cp._create("limit",s,"F")}function J6(s){return qS("limitToLast",s),cp._create("limitToLast",s,"L")}class up extends oh{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new up(e,t,r)}_apply(e){const t=dN(e,this.type,this._docOrFields,this._inclusive);return new Kn(e.firestore,e.converter,tM(e._query,t))}}function Z6(...s){return up._create("startAt",s,!0)}function e3(...s){return up._create("startAfter",s,!1)}class dp extends oh{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new dp(e,t,r)}_apply(e){const t=dN(e,this.type,this._docOrFields,this._inclusive);return new Kn(e.firestore,e.converter,nM(e._query,t))}}function t3(...s){return dp._create("endBefore",s,!1)}function n3(...s){return dp._create("endAt",s,!0)}function dN(s,e,t,r){if(t[0]=je(t[0]),t[0]instanceof Ld)return(function(l,u,m,g,y){if(!g)throw new ce(X.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${m}().`);const _=[];for(const x of Xl(l))if(x.field.isKeyField())_.push(ko(u,g.key));else{const T=g.data.field(x.field);if($m(T))throw new ce(X.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+x.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(T===null){const S=x.field.canonicalString();throw new ce(X.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}_.push(T)}return new Ea(_,y)})(s._query,s.firestore._databaseId,e,t[0]._document,r);{const a=Go(s.firestore);return(function(u,m,g,y,_,x){const T=u.explicitOrderBy;if(_.length>T.length)throw new ce(X.INVALID_ARGUMENT,`Too many arguments provided to ${y}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const S=[];for(let V=0;V<_.length;V++){const U=_[V];if(T[V].field.isKeyField()){if(typeof U!="string")throw new ce(X.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${y}(), but got a ${typeof U}`);if(!v_(u)&&U.indexOf("/")!==-1)throw new ce(X.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${y}() must be a plain document ID, but '${U}' contains a slash.`);const $=u.path.child(Ye.fromString(U));if(!ye.isDocumentKey($))throw new ce(X.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${y}() must result in a valid document path, but '${$}' is not because it contains an odd number of segments.`);const H=new ye($);S.push(ko(m,H))}else{const $=iN(g,y,U);S.push($)}}return new Ea(S,x)})(s._query,s.firestore._databaseId,a,e,t,r)}}function ZT(s,e,t){if(typeof(t=je(t))=="string"){if(t==="")throw new ce(X.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!v_(e)&&t.indexOf("/")!==-1)throw new ce(X.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ye.fromString(t));if(!ye.isDocumentKey(r))throw new ce(X.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ko(s,new ye(r))}if(t instanceof xt)return ko(s,t._key);throw new ce(X.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Fm(t)}.`)}function eI(s,e){if(!Array.isArray(s)||s.length===0)throw new ce(X.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hN(s,e){const t=(function(a,l){for(const u of a)for(const m of u.getFlattenedFilters())if(l.indexOf(m.op)>=0)return m.op;return null})(s.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ce(X.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ce(X.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function hp(s,e,t){let r;return r=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,r}class r3 extends cb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new xt(this.firestore,null,t)}}class xo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Mr=class fN extends Ld{constructor(e,t,r,a,l,u){super(e,t,r,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new gd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(zo("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(X.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=fN._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Mr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Mr._jsonSchema={type:cn("string",Mr._jsonSchemaVersion),bundleSource:cn("string","DocumentSnapshot"),bundleName:cn("string"),bundle:cn("string")};let gd=class extends Mr{data(e={}){return super.data(e)}},ss=class mN{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new xo(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new gd(this._firestore,this._userDataWriter,r.key,r,new xo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ce(X.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((m=>{const g=new gd(a._firestore,a._userDataWriter,m.doc.key,m.doc,new xo(a._snapshot.mutatedKeys.has(m.doc.key),a._snapshot.fromCache),a.query.converter);return m.doc,{type:"added",doc:g,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((m=>l||m.type!==3)).map((m=>{const g=new gd(a._firestore,a._userDataWriter,m.doc.key,m.doc,new xo(a._snapshot.mutatedKeys.has(m.doc.key),a._snapshot.fromCache),a.query.converter);let y=-1,_=-1;return m.type!==0&&(y=u.indexOf(m.doc.key),u=u.delete(m.doc.key)),m.type!==1&&(u=u.add(m.doc),_=u.indexOf(m.doc.key)),{type:s3(m.type),doc:g,oldIndex:y,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(X.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=mN._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=c_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),r.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function s3(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we(61501,{type:s})}}function pN(s,e){return s instanceof Mr&&e instanceof Mr?s._firestore===e._firestore&&s._key.isEqual(e._key)&&(s._document===null?e._document===null:s._document.isEqual(e._document))&&s._converter===e._converter:s instanceof ss&&e instanceof ss&&s._firestore===e._firestore&&ZA(s.query,e.query)&&s.metadata.isEqual(e.metadata)&&s._snapshot.isEqual(e._snapshot)}ss._jsonSchemaVersion="firestore/querySnapshot/1.0",ss._jsonSchema={type:cn("string",ss._jsonSchemaVersion),bundleSource:cn("string","QuerySnapshot"),bundleName:cn("string"),bundle:cn("string")};const i3={maxAttempts:5};let a3=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Go(e)}set(e,t,r){this._verifyNotCommitted();const a=ca(e,this._firestore),l=hp(a.converter,t,r),u=op(this._dataReader,"WriteBatch.set",a._key,l,a.converter!==null,r);return this._mutations.push(u.toMutation(a._key,Dt.none())),this}update(e,t,r,...a){this._verifyNotCommitted();const l=ca(e,this._firestore);let u;return u=typeof(t=je(t))=="string"||t instanceof Uo?ob(this._dataReader,"WriteBatch.update",l._key,t,r,a):ab(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(u.toMutation(l._key,Dt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ca(e,this._firestore);return this._mutations=this._mutations.concat(new kc(t._key,Dt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ce(X.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ca(s,e){if((s=je(s)).firestore!==e)throw new ce(X.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}class o3{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Go(e)}get(e){const t=ca(e,this._firestore),r=new r3(this._firestore);return this._transaction.lookup([t._key]).then((a=>{if(!a||a.length!==1)return we(24041);const l=a[0];if(l.isFoundDocument())return new Ld(this._firestore,r,l.key,l,t.converter);if(l.isNoDocument())return new Ld(this._firestore,r,t._key,null,t.converter);throw we(18433,{doc:l})}))}set(e,t,r){const a=ca(e,this._firestore),l=hp(a.converter,t,r),u=op(this._dataReader,"Transaction.set",a._key,l,a.converter!==null,r);return this._transaction.set(a._key,u),this}update(e,t,r,...a){const l=ca(e,this._firestore);let u;return u=typeof(t=je(t))=="string"||t instanceof Uo?ob(this._dataReader,"Transaction.update",l._key,t,r,a):ab(this._dataReader,"Transaction.update",l._key,t),this._transaction.update(l._key,u),this}delete(e){const t=ca(e,this._firestore);return this._transaction.delete(t._key),this}}let l3=class extends o3{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ca(e,this._firestore),r=new Ko(this._firestore);return super.get(e).then((a=>new Mr(this._firestore,r,t._key,a._document,new xo(!1,!1),t.converter)))}};function c3(s,e,t){s=it(s,Wt);const r={...i3,...t};(function(u){if(u.maxAttempts<1)throw new ce(X.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const a=Un(s);return w6(a,(l=>e(new l3(s,l))),r)}function u3(s){s=it(s,xt);const e=it(s.firestore,Wt),t=Un(e);return GA(t,s._key).then((r=>fb(e,s,r)))}function d3(s){s=it(s,xt);const e=it(s.firestore,Wt),t=Un(e),r=new Ko(e);return _6(t,s._key).then((a=>new Mr(e,r,s._key,a,new xo(a!==null&&a.hasLocalMutations,!0),s.converter)))}function h3(s){s=it(s,xt);const e=it(s.firestore,Wt),t=Un(e);return GA(t,s._key,{source:"server"}).then((r=>fb(e,s,r)))}function f3(s){s=it(s,Kn);const e=it(s.firestore,Wt),t=Un(e),r=new Ko(e);return uN(s._query),QA(t,s._query).then((a=>new ss(e,r,s,a)))}function m3(s){s=it(s,Kn);const e=it(s.firestore,Wt),t=Un(e),r=new Ko(e);return b6(t,s._query).then((a=>new ss(e,r,s,a)))}function p3(s){s=it(s,Kn);const e=it(s.firestore,Wt),t=Un(e),r=new Ko(e);return QA(t,s._query,{source:"server"}).then((a=>new ss(e,r,s,a)))}function tI(s,e,t){s=it(s,xt);const r=it(s.firestore,Wt),a=hp(s.converter,e,t),l=Go(r);return lh(r,[op(l,"setDoc",s._key,a,s.converter!==null,t).toMutation(s._key,Dt.none())])}function nI(s,e,t,...r){s=it(s,xt);const a=it(s.firestore,Wt),l=Go(a);let u;return u=typeof(e=je(e))=="string"||e instanceof Uo?ob(l,"updateDoc",s._key,e,t,r):ab(l,"updateDoc",s._key,e),lh(a,[u.toMutation(s._key,Dt.exists(!0))])}function g3(s){return lh(it(s.firestore,Wt),[new kc(s._key,Dt.none())])}function y3(s,e){const t=it(s.firestore,Wt),r=Nm(s),a=hp(s.converter,e),l=Go(s.firestore);return lh(t,[op(l,"addDoc",r._key,a,s.converter!==null,{}).toMutation(r._key,Dt.exists(!1))]).then((()=>r))}function gN(s,...e){s=je(s);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||wy(e[r])||(t=e[r++]);const a={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(wy(e[r])){const y=e[r];e[r]=y.next?.bind(y),e[r+1]=y.error?.bind(y),e[r+2]=y.complete?.bind(y)}let l,u,m;if(s instanceof xt)u=it(s.firestore,Wt),m=Rc(s._key.path),l={next:y=>{e[r]&&e[r](fb(u,s,y))},error:e[r+1],complete:e[r+2]};else{const y=it(s,Kn);u=it(y.firestore,Wt),m=y._query;const _=new Ko(u);l={next:x=>{e[r]&&e[r](new ss(u,_,y,x))},error:e[r+1],complete:e[r+2]},uN(s._query)}const g=Un(u);return y6(g,m,a,l)}function _3(s,e){s=it(s,Wt);const t=Un(s),r=wy(e)?e:{next:e};return x6(t,r)}function lh(s,e){const t=Un(s);return v6(t,e)}function fb(s,e,t){const r=t.docs.get(e._key),a=new Ko(s);return new Mr(s,a,e._key,r,new xo(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){YV(Sa),_a(new Us("firestore",((r,{instanceIdentifier:a,options:l})=>{const u=r.getProvider("app").getImmediate(),m=new Wt(new eO(r.getProvider("auth-internal")),new rO(u,r.getProvider("app-check-internal")),BO(u,a),u);return l={useFetchStreams:t,...l},m._setSettings(l),m}),"PUBLIC").setMultipleInstances(!0)),es(XT,JT,e),es(XT,JT,"esm2020")})();const b3="@firebase/firestore-compat",v3="0.4.4";function mb(s,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new ce("invalid-argument",`Invalid options passed to function ${s}(): You cannot specify both "merge" and "mergeFields".`);return e}function rI(){if(typeof Uint8Array>"u")throw new ce("unimplemented","Uint8Arrays are not available in this environment.")}function sI(){if(!LO())throw new ce("unimplemented","Blobs are unavailable in Firestore in this environment.")}let yN=class Ey{constructor(e){this._delegate=e}static fromBase64String(e){return sI(),new Ey(Mn.fromBase64String(e))}static fromUint8Array(e){return rI(),new Ey(Mn.fromUint8Array(e))}toBase64(){return sI(),this._delegate.toBase64()}toUint8Array(){return rI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Ty(s){return x3(s,["next","error","complete"])}function x3(s,e){if(typeof s!="object"||s===null)return!1;const t=s;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class w3{enableIndexedDbPersistence(e,t){return k6(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return D6(e._delegate)}clearIndexedDbPersistence(e){return j6(e._delegate)}}class _N{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof va||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Bs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){A6(this._delegate,e,t,r)}enableNetwork(){return V6(this._delegate)}disableNetwork(){return O6(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,zS("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return P6(this._delegate)}onSnapshotsInSync(e){return _3(this._delegate,e)}get app(){if(!this._appCompat)throw new ce("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new wc(this,XA(this._delegate,e))}catch(t){throw Hn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Or(this,Nm(this._delegate,e))}catch(t){throw Hn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Fn(this,N6(this._delegate,e))}catch(t){throw Hn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return c3(this._delegate,t=>e(new bN(this,t)))}batch(){return Un(this._delegate),new vN(new a3(this._delegate,e=>lh(this._delegate,e)))}loadBundle(e){return M6(this._delegate,e)}namedQuery(e){return L6(this._delegate,e).then(t=>t?new Fn(this,t):null)}}class fp extends cb{constructor(e){super(),this.firestore=e}convertBytes(e){return new yN(new Mn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Or.forKey(t,this.firestore,null)}}function E3(s){WV(s)}class bN{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new fp(e)}get(e){const t=wo(e);return this._delegate.get(t).then(r=>new Ud(this._firestore,new Mr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const a=wo(e);return r?(mb("Transaction.set",r),this._delegate.set(a,t,r)):this._delegate.set(a,t),this}update(e,t,r,...a){const l=wo(e);return arguments.length===2?this._delegate.update(l,t):this._delegate.update(l,t,r,...a),this}delete(e){const t=wo(e);return this._delegate.delete(t),this}}class vN{constructor(e){this._delegate=e}set(e,t,r){const a=wo(e);return r?(mb("WriteBatch.set",r),this._delegate.set(a,t,r)):this._delegate.set(a,t),this}update(e,t,r,...a){const l=wo(e);return arguments.length===2?this._delegate.update(l,t):this._delegate.update(l,t,r,...a),this}delete(e){const t=wo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Bo{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new gd(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new zd(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Bo.INSTANCES;let a=r.get(e);a||(a=new WeakMap,r.set(e,a));let l=a.get(t);return l||(l=new Bo(e,new fp(e),t),a.set(t,l)),l}}Bo.INSTANCES=new WeakMap;class Or{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new fp(e)}static forPath(e,t,r){if(e.length%2!==0)throw new ce("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Or(t,new xt(t._delegate,r,new ye(e)))}static forKey(e,t,r){return new Or(t,new xt(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new wc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new wc(this.firestore,XA(this._delegate,e))}catch(t){throw Hn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=je(e),e instanceof xt?JA(this._delegate,e):!1}set(e,t){t=mb("DocumentReference.set",t);try{return t?tI(this._delegate,e,t):tI(this._delegate,e)}catch(r){throw Hn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?nI(this._delegate,e):nI(this._delegate,e,t,...r)}catch(a){throw Hn(a,"updateDoc()","DocumentReference.update()")}}delete(){return g3(this._delegate)}onSnapshot(...e){const t=xN(e),r=wN(e,a=>new Ud(this.firestore,new Mr(this.firestore._delegate,this._userDataWriter,a._key,a._document,a.metadata,this._delegate.converter)));return gN(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=d3(this._delegate):e?.source==="server"?t=h3(this._delegate):t=u3(this._delegate),t.then(r=>new Ud(this.firestore,new Mr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Or(this.firestore,e?this._delegate.withConverter(Bo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Hn(s,e,t){return s.message=s.message.replace(e,t),s}function xN(s){for(const e of s)if(typeof e=="object"&&!Ty(e))return e;return{}}function wN(s,e){let t;return Ty(s[0])?t=s[0]:Ty(s[1])?t=s[1]:typeof s[0]=="function"?t={next:s[0],error:s[1],complete:s[2]}:t={next:s[1],error:s[2],complete:s[3]},{next:r=>{t.next&&t.next(e(r))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}class Ud{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Or(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return pN(this._delegate,e._delegate)}}class zd extends Ud{data(e){const t=this._delegate.data(e);return this._delegate._converter||XV(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class Fn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new fp(e)}where(e,t,r){try{return new Fn(this.firestore,sa(this._delegate,Y6(e,t,r)))}catch(a){throw Hn(a,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Fn(this.firestore,sa(this._delegate,W6(e,t)))}catch(r){throw Hn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Fn(this.firestore,sa(this._delegate,X6(e)))}catch(t){throw Hn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Fn(this.firestore,sa(this._delegate,J6(e)))}catch(t){throw Hn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Fn(this.firestore,sa(this._delegate,Z6(...e)))}catch(t){throw Hn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Fn(this.firestore,sa(this._delegate,e3(...e)))}catch(t){throw Hn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Fn(this.firestore,sa(this._delegate,t3(...e)))}catch(t){throw Hn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Fn(this.firestore,sa(this._delegate,n3(...e)))}catch(t){throw Hn(t,"endAt()","Query.endAt()")}}isEqual(e){return ZA(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=m3(this._delegate):e?.source==="server"?t=p3(this._delegate):t=f3(this._delegate),t.then(r=>new Iy(this.firestore,new ss(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=xN(e),r=wN(e,a=>new Iy(this.firestore,new ss(this.firestore._delegate,this._userDataWriter,this._delegate,a._snapshot)));return gN(this._delegate,t,r)}withConverter(e){return new Fn(this.firestore,e?this._delegate.withConverter(Bo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class T3{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new zd(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Iy{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Fn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new zd(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new T3(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new zd(this._firestore,r))})}isEqual(e){return pN(this._delegate,e._delegate)}}class wc extends Fn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Or(this.firestore,e):null}doc(e){try{return e===void 0?new Or(this.firestore,Nm(this._delegate)):new Or(this.firestore,Nm(this._delegate,e))}catch(t){throw Hn(t,"doc()","CollectionReference.doc()")}}add(e){return y3(this._delegate,e).then(t=>new Or(this.firestore,t))}isEqual(e){return JA(this._delegate,e._delegate)}withConverter(e){return new wc(this.firestore,e?this._delegate.withConverter(Bo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function wo(s){return it(s,xt)}class pb{constructor(...e){this._delegate=new Uo(...e)}static documentId(){return new pb(kt.keyField().canonicalString())}isEqual(e){return e=je(e),e instanceof Uo?this._delegate._internalPath.isEqual(e._internalPath):!1}}class _o{static serverTimestamp(){const e=H6();return e._methodName="FieldValue.serverTimestamp",new _o(e)}static delete(){const e=F6();return e._methodName="FieldValue.delete",new _o(e)}static arrayUnion(...e){const t=G6(...e);return t._methodName="FieldValue.arrayUnion",new _o(t)}static arrayRemove(...e){const t=Q6(...e);return t._methodName="FieldValue.arrayRemove",new _o(t)}static increment(e){const t=K6(e);return t._methodName="FieldValue.increment",new _o(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}const I3={Firestore:_N,GeoPoint:ns,Timestamp:ct,Blob:yN,Transaction:bN,WriteBatch:vN,DocumentReference:Or,DocumentSnapshot:Ud,Query:Fn,QueryDocumentSnapshot:zd,QuerySnapshot:Iy,CollectionReference:wc,FieldPath:pb,FieldValue:_o,setLogLevel:E3,CACHE_SIZE_UNLIMITED:C6};function S3(s,e){s.INTERNAL.registerComponent(new Us("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),a=t.getProvider("firestore").getImmediate();return e(r,a)},"PUBLIC").setServiceProps({...I3}))}function A3(s){S3(s,(e,t)=>new _N(e,t,new w3)),s.registerVersion(b3,v3)}A3(ts);const N3={apiKey:"AIzaSyDS5RsnYL49tertpcIUXPa3dppw_soU1FQ",authDomain:"led-react-6204e.firebaseapp.com",projectId:"led-react-6204e",storageBucket:"led-react-6204e.firebasestorage.app",messagingSenderId:"500086523818",appId:"1:500086523818:web:74b4a57f9c55730eee4dd3",measurementId:"G-B0D52YG6QQ"};let Sy;ts.apps.length?Sy=ts.app():Sy=ts.initializeApp(N3);const Ay=ts.auth(),Vt=ts.firestore(),R3=Sy,hn="admire-signage-external",Me=(s,e="INR",t=!1,r=!1)=>{let a=0,l=0;if(t)l=1;else if(r){const u=s%1===0;a=u?0:2,l=u?0:2}else a=0,l=0;return new Intl.NumberFormat(e==="INR"?"en-IN":"en-US",{style:"currency",currency:e,minimumFractionDigits:a,maximumFractionDigits:l,notation:t?"compact":"standard"}).format(s)},Ny=()=>Math.random().toString(36).substr(2,9).toUpperCase(),Eo=(s,e,t,r)=>{if(!s||!e)return null;const{screenQty:a,targetWidth:l,targetHeight:u,unit:m,selectedIndoor:g,assemblyMode:y,selectedPitch:_,selectedModuleId:x,selectedCabinetId:T,selectedCardId:S,selectedSMPSId:V,selectedProcId:U,sizingMode:$,readyId:H,margin:se,extras:te,overrides:be,extraComponents:ae,pricingMode:ee,targetSellPrice:C,commercials:N,terms:E}=s,D=Number(a||1),k=xe=>{if(!xe)return 0;const Ve=Number(xe.price||0),Ge=Number(xe.carriage||0),zr=Ve+Ge;return xe.currency==="USD"?zr*r:zr};let j,R,_e,Ne,z,me=0;if(y==="assembled"){if(j=e.find(xe=>xe.id===x),R=e.find(xe=>xe.id===T),_e=e.find(xe=>xe.id===S),Ne=e.find(xe=>xe.id===V),z=e.find(xe=>xe.id===U),!j||!R)return null}else{const xe=e.find(Ve=>Ve.id===H);if(z=e.find(Ve=>Ve.id===U),!xe)return null;j=xe,R=xe}const Ee=m==="m"?l*1e3:l*304.8,Ue=m==="m"?u*1e3:u*304.8,De=Ee/R.width,O=Ue/R.height;let ne,q;$==="up"?(ne=Math.ceil(De),q=Math.ceil(O)):$==="down"?(ne=Math.max(1,Math.floor(De)),q=Math.max(1,Math.floor(O))):(ne=Math.max(1,Math.round(De)),q=Math.max(1,Math.round(O)));const K=ne*R.width,le=q*R.height,de=ne*q,pe=K*le/92903;let Ce=[];if(y==="assembled"){const xe=Math.floor(R.width/j.width)*Math.floor(R.height/j.height);me=de*xe;let Ve=de,Ge=1;if(j.maxPower&&Ne&&Ne.amps&&Ne.voltage){const wi=R.width/1e3*(R.height/1e3)*Number(j.maxPower),Pa=Number(Ne.amps)*Number(Ne.voltage);Pa>0&&(Ge=Math.ceil(wi/Pa),Ve=Ge*de)}Ce=[{id:"modules",inventoryId:x,name:"Modules",spec:`${j.brand} ${j.model}`,qty:me,unit:k(j),total:me*k(j),type:"led"},{id:"cabinets",inventoryId:T,name:"Cabinets",spec:`${R.brand} ${R.model}`,qty:de,unit:k(R),total:de*k(R),type:"led"},{id:"cards",inventoryId:S,name:"Cards",spec:_e?_e.brand:"-",qty:de,unit:k(_e),total:de*k(_e),type:"led"},{id:"smps",inventoryId:V,name:"SMPS",spec:Ne?`${Ne.brand} (${Ge}/cab)`:"-",qty:Ve,unit:k(Ne),total:Ve*k(Ne),type:"led"}]}else Ce=[{id:"ready",inventoryId:H,name:"LED Panels (Ready)",spec:`${R.brand} ${R.model}`,qty:de,unit:k(R),total:de*k(R),type:"led"}],me=de;Ce.push({id:"processor",inventoryId:U,name:"Processor",spec:z?z.brand:"Select Processor",qty:1,unit:z?k(z):0,total:z?k(z):0,type:"service"}),ae&&ae.length>0&&ae.forEach(xe=>{const Ve=e.find(Ge=>Ge.id===xe.componentId);if(Ve){const Ge=xe.type==="cabinet"?xe.qty*de:xe.qty;Ce.push({id:xe.id,inventoryId:xe.componentId,name:`Extra: ${Ve.type}`,spec:`${Ve.brand} ${Ve.model}`,qty:Ge,unit:k(Ve),total:Ge*k(Ve),type:Ve.type==="processor"?"service":"led"})}else Ce.push({id:xe.id,inventoryId:"",name:"Extra Component",spec:"Select Item...",qty:xe.qty||1,unit:0,total:0,type:"led"})});const nt=Ce.map(xe=>{if(be&&be[xe.id]){const Ve=be[xe.id],Ge=Ve.qty!==void 0&&Ve.qty!==""?Number(Ve.qty):xe.qty,zr=Ve.rate!==void 0&&Ve.rate!==""?Number(Ve.rate):xe.unit;return{...xe,qty:Ge,unit:zr,total:Ge*zr,isOverridden:!0}}return xe}),lr=nt.filter(xe=>xe.type==="led").reduce((xe,Ve)=>xe+Ve.total,0),Ht=nt.filter(xe=>xe.type!=="led").reduce((xe,Ve)=>xe+Ve.total,0),xn={};let Er=0,un=0;Array.isArray(te)&&te.forEach(xe=>{let Ve=0;const Ge=lr;xe.type==="pct"?Ve=Ge*(Number(xe.val)/100):Ve=Number(xe.val),xn[xe.id]=Ve,Er+=Ve});const $n=N?.installation||{cost:0,costType:"abs"};let Dn=0;$n.costType==="pct"?Dn=Ht*(Number($n.cost)/100):($n.unit||"sqft")==="sqft"?Dn=Number($n.cost)*pe:Dn=Number($n.cost),xn.install=Dn,un+=Dn;const Yn=N?.structure||{cost:0,costType:"abs"};let Wn=0;Yn.costType==="pct"?Wn=Ht*(Number(Yn.cost)/100):(Yn.unit||"sqft")==="sqft"?Wn=Number(Yn.cost)*pe:Wn=Number(Yn.cost),xn.structure=Wn,un+=Wn;const We=lr+Er,Et=Ht+un,jn=We+Et,W=jn*D,Se=N||{processor:{val:0},installation:{val:0},structure:{val:0}};let Fe=0;if(Se.processor.unit==="unit"){const xe=nt.find(Ge=>Ge.id==="processor"),Ve=xe?xe.qty:1;Fe=Number(Se.processor.val)*Ve*D}else Fe=Number(Se.processor.val)*D;let ue=0;Se.installation.unit==="sqft"?ue=Number(Se.installation.val)*pe*D:ue=Number(Se.installation.val)*D;let jt=0;Se.structure.unit==="sqft"?jt=Number(Se.structure.val)*pe*D:jt=Number(Se.structure.val)*D;const wn=Fe+ue+jt;let Xt=0,ja=se;const Fs=ee||"margin";if(Fs==="margin")Xt=We*(1+se/100);else{const xe=Number(C||0);Fs==="screen"?Xt=xe:Fs==="sqft"?Xt=xe*pe:Fs==="sqm"&&(Xt=xe*(pe/10.7639)),We>0?ja=(Xt-We)/We*100:ja=0}const Ur=Xt*D+wn,zn=Ur-W;return{gridCols:ne,gridRows:q,finalWidth:(K/1e3).toFixed(2),finalHeight:(le/1e3).toFixed(2),totalCabinets:de,moduleType:j,cabinetType:R,processor:z,breakdown:{qtyModules:me,ledOps:Er,serviceOps:un},detailedItems:nt,calculatedExtras:xn,costLEDPerScreen:We,costServicesPerScreen:Et,costPerScreen:jn,totalProjectCost:W,finalPrice:Ur,totalProjectSell:Ur,assemblyMode:y,screenQty:D,commercials:{sellProcTotal:Fe,sellInstallTotal:ue,sellStructureTotal:jt},terms:E||{price:"Ex-works Mumbai",deliveryWeeks:10,payment:[]},matrix:{cost:{sqft:jn/pe,unit:jn,total:W},margin:{sqft:zn/D/pe,unit:zn/D,total:zn},sell:{sqft:Ur/D/pe,unit:Ur/D,total:Ur},led:{cost:We,sell:Xt,margin:Xt-We,marginPct:ja},sqft:{perScreen:pe,total:pe*D}}}},Pt={COMPANY:{NAME:"ADMIRE SIGN & DISPLAY PVT. LTD.",ADDRESS_1:"102, Priya Industrial Estate 4, K.T. Industrial Estate",ADDRESS_2:"Kherpada, Waliv, Vasai East, Mumbai - 401208",EMAIL:"info@admiresign.com",WEB:"www.admiresign.com"},DEFAULTS:{EXCHANGE_RATE:90,GST_RATE:18,DELIVERY_WEEKS:10,PRICE_BASIS:"Ex-works Mumbai",PAYMENT_TERMS:[{name:"Advance with PO",percent:60},{name:"Before dispatch",percent:30},{name:"After installation",percent:10}]},TEXT:{WARRANTY:"Against any manufacturing defect. Offsite support for troubleshooting. Client can sign up for Admires excellent AMC services for on-site support. Serious fault will be attended to by our technical team within 48-72 hours upon receipt of written complaints with pictures/videos of the fault. 2% Extra spares includes Modules, Power Supply, Receiver Card (if there are over 100 cabinets), Flat cables, 5V connectors, Power and Data Cable. Any damage to the screen due to force majure, natural disasters, electricity surge, earthing, accident, etc is not covered under the warranty. Power supplies damage due to power fluctuation will not be covered under warranty. Power supply will be under the direct warranty of the OEM supplier. If the repair requires additional components then these will be charged extra. Brightness control meter, Video Processor & Timer can be supplied at extra cost. Maintenance team visit in six months during warranty period.",SCOPE_STRUCTURE:"Foundation & Structure. Structural stability certificate from a consultant. For wall mounted outdoor screen, Client to ensure strong and solid brick wall, RCC beams and column base. For front access indoor screen, Client to ensure a strong base. Indoor Structures cannot be mounted on ACP Sheets, Gypsum boards etc. Scaffolding, Aluminium composite panelling if required. Personnel for troubleshooting training during the screen installation. Helpers for loading, unloading and installing the display at site.",SCOPE_ELEC:"Electricity 3 phase electric power near the site, not more than 5m from the site, before the commencement of work. Electrical distribution board within 5m from the screen. Conduited electrical cable. 4mm 2 core armored cable or 4mm 3 core cables, 32 ampere MCB, 1 switch board with 2 sockets. Good quality Stabiliser and timers. 1 Certified electrical engineer for all connections from power Main to the unit. Ventilation machineries such as Air Conditioners or Fans.",SCOPE_NET:"CAT 6 or Optic Fiber Data cable and its terminations. Data points near the screen. Space with power sockets for Video wall Controllers. Data source/AV room within 80 meters of the screen. Connections to be availed through CAT 6 cables duly terminated with RJ45. If the length is farther then Fiber optic converter will be required. Fiber optic converters, if required, will be charged extra. In case the fiber optic converter is required, single mode Fiber optic cable is to be provided by client from source point to the display, terminated as per specs with Patch Chords from the splicing unit to connect to screen.",SCOPE_SOFT:"3rd party Software for Content upload on screen will be provided by the controller card supplier. Admire cannot provide regular updates and application stability.",SCOPE_PERM:"All permissions such as PTW, work permits & gate passes for workers, engineers and executives.",SCOPE_PC:"As per specification, to be arranged by client.",VALIDITY:"30 days."}},C3=({user:s,transactions:e=[],readOnly:t=!1,exchangeRate:r=1})=>{const[a,l]=zt.useState([]),[u,m]=zt.useState(null),[g,y]=zt.useState(!1),[_,x]=zt.useState({type:"module",brand:"",model:"",vendor:"",pitch:"",width:"",height:"",price:"",carriage:"",currency:"INR",indoor:!0,brightness:"",refreshRate:"",ledType:"",lampMake:"",material:"",weight:"",avgPower:"",maxPower:"",contrast:"",viewAngleH:"",viewAngleV:"",ipFront:"",ipBack:"",ports:"",amps:"",voltage:""}),[T,S]=zt.useState(!0),[V,U]=zt.useState(!1),[$,H]=zt.useState(null);zt.useEffect(()=>{if(!s||!Vt)return;const E=Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("inventory").onSnapshot(D=>{const k=D.docs.map(j=>({id:j.id,...j.data()}));l(k),S(!1)},D=>{});return()=>E()},[s]);const se=async()=>{if(_.type==="module"){if(!_.pitch||!_.brand||!_.model||!_.price||!_.width||!_.height||!_.weight||!_.avgPower||!_.maxPower||!_.brightness||!_.refreshRate||!_.contrast||!_.viewAngleH||!_.viewAngleV||!_.ipFront||!_.ipBack)return alert("Please fill all compulsory (*) fields.")}else if(_.type==="cabinet"){if(!_.brand||!_.material||!_.model||!_.price||!_.width||!_.height)return alert("Please fill all compulsory (*) fields.")}else if(_.type==="card"||_.type==="processor"){if(!_.brand||!_.model||!_.price||!_.vendor)return alert("Please fill all compulsory (*) fields.")}else if(_.type==="smps"){if(!_.brand||!_.model||!_.price||!_.vendor||!_.amps||!_.voltage)return alert("Please fill all compulsory (*) fields.")}else if(_.type==="ready"){if(!_.pitch||!_.brand||!_.model||!_.price||!_.material||!_.width||!_.height||!_.weight||!_.avgPower||!_.maxPower||!_.brightness||!_.refreshRate||!_.contrast||!_.viewAngleH||!_.viewAngleV||!_.ipFront||!_.ipBack)return alert("Please fill all compulsory (*) fields.")}else if(!_.brand||!_.model)return alert("Brand and Model are required");try{const E=Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("inventory"),D={..._,width:Number(_.width),height:Number(_.height),price:Number(_.price),carriage:Number(_.carriage||0),pitch:Number(_.pitch),currency:_.currency||"INR",indoor:_.indoor==="true"||_.indoor===!0,material:_.material||"",weight:_.weight?Number(_.weight):0,avgPower:_.avgPower?Number(_.avgPower):0,maxPower:_.maxPower?Number(_.maxPower):0,brightness:_.brightness?parseInt(_.brightness):0,refreshRate:_.refreshRate?parseInt(_.refreshRate):0,viewAngleH:_.viewAngleH?parseInt(_.viewAngleH):0,viewAngleV:_.viewAngleV?parseInt(_.viewAngleV):0,ipFront:_.ipFront?parseInt(_.ipFront):0,ipBack:_.ipBack?parseInt(_.ipBack):0,ports:_.ports?parseInt(_.ports):0,amps:_.amps?Number(_.amps):0,voltage:_.voltage?Number(_.voltage):0,updatedAt:new Date};u?(await E.doc(u).update(D),m(null),y(!1)):(await E.add({...D,createdAt:new Date}),x({type:_.type,brand:"",model:"",vendor:"",pitch:"",width:"",height:"",price:"",carriage:"",currency:"INR",indoor:!0,brightness:"",refreshRate:"",ledType:"",lampMake:"",material:"",weight:"",avgPower:"",maxPower:"",contrast:"",viewAngleH:"",viewAngleV:"",ipFront:"",ipBack:"",ports:"",amps:""}),alert("Item Added!"))}catch{}},te=E=>{x({...E,vendor:E.vendor||"",currency:E.currency||"INR",carriage:E.carriage||0}),m(E.id),y(!0),window.scrollTo({top:0,behavior:"smooth"})},be=()=>{m(null),y(!1),x({type:"module",brand:"",model:"",vendor:"",pitch:"",width:"",height:"",price:"",carriage:"",currency:"INR",indoor:!0,brightness:"",refreshRate:"",ledType:"",lampMake:"",material:"",weight:"",avgPower:"",maxPower:"",contrast:"",viewAngleH:"",viewAngleV:"",ipFront:"",ipBack:"",ports:"",amps:"",voltage:""})},ae=async E=>{confirm("Delete this item?")&&await Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("inventory").doc(E).delete()},ee=E=>{H(E),U(!0)},C=E=>{const D=e.filter(j=>j.itemId===E),k={};return D.forEach(j=>{const R=j.batch||"Unbatched",_e=j.type==="in"?Number(j.qty):-Number(j.qty);k[R]||(k[R]=0),k[R]+=_e}),Object.entries(k).map(([j,R])=>({name:j,qty:R})).filter(j=>j.qty!==0).sort((j,R)=>R.qty-j.qty)},N=[...a].sort((E,D)=>{const k=(E.type||"").toLowerCase(),j=(D.type||"").toLowerCase();if(k<j)return-1;if(k>j)return 1;const R=(E.brand+" "+E.model).toLowerCase(),_e=(D.brand+" "+D.model).toLowerCase();return R<_e?-1:R>_e?1:0});return d.jsxs("div",{className:"p-6 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-slate-800 dark:text-white",children:[d.jsx(ky,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"})," Components Management"]}),!g&&!t&&d.jsxs("button",{onClick:()=>y(!0),className:"bg-teal-600 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2 hover:bg-teal-700 transition-colors",children:[d.jsx(aa,{size:16})," Add New Component"]})]}),g&&d.jsxs("div",{className:`grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 p-6 rounded-lg transition-colors border shadow-sm ${u?"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-700":"bg-slate-50 dark:bg-slate-700/50 border-slate-200 dark:border-slate-600"}`,children:[d.jsxs("div",{className:"col-span-2 md:col-span-4 flex justify-between items-center mb-2 pb-2 border-b border-slate-200 dark:border-slate-600",children:[d.jsx("h3",{className:"text-sm font-bold uppercase text-slate-500 dark:text-slate-400",children:u?"Editing Item":"Add New Item"}),d.jsxs("button",{onClick:be,className:"text-xs text-slate-500 hover:text-red-500 flex items-center gap-1",children:[d.jsx(yd,{size:14})," Close"]})]}),d.jsxs("select",{className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.type,onChange:E=>x({..._,type:E.target.value}),children:[d.jsx("option",{value:"module",children:"Module"}),d.jsx("option",{value:"cabinet",children:"Cabinet"}),d.jsx("option",{value:"ready",children:"Ready Unit"}),d.jsx("option",{value:"card",children:"Receiving Card"}),d.jsx("option",{value:"smps",children:"SMPS"}),d.jsx("option",{value:"processor",children:"Processor"})]}),(_.type==="module"||_.type==="ready")&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"Pitch*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white border-teal-500 ring-1 ring-teal-500",value:_.pitch,onChange:E=>x({..._,pitch:E.target.value})}),d.jsxs("select",{className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white border-teal-500 ring-1 ring-teal-500",value:_.indoor,onChange:E=>x({..._,indoor:E.target.value}),children:[d.jsx("option",{value:"true",children:"Indoor"}),d.jsx("option",{value:"false",children:"Outdoor"})]})]}),d.jsx("input",{placeholder:_.type==="module"||_.type==="ready"||_.type==="cabinet"||_.type==="card"||_.type==="processor"||_.type==="smps"?"Brand*":"Brand",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.brand,onChange:E=>x({..._,brand:E.target.value})}),d.jsx("input",{placeholder:_.type==="module"||_.type==="ready"||_.type==="cabinet"||_.type==="card"||_.type==="processor"||_.type==="psu"?"Model/SKU*":"Model",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.model,onChange:E=>x({..._,model:E.target.value})}),d.jsxs("div",{className:"flex gap-2 items-center col-span-2 md:col-span-1",children:[d.jsxs("div",{className:"flex-1 min-w-[100px]",title:"Base Price",children:[d.jsx("input",{placeholder:"Base Rate*",type:"number",className:"p-2 w-full border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.price,onChange:E=>x({..._,price:E.target.value})}),d.jsx("div",{className:"text-[9px] text-slate-400 mt-0.5 ml-1",children:"BASE RATE*"})]}),d.jsx("span",{className:"text-slate-400 font-bold mb-3",children:"+"}),d.jsxs("div",{className:"flex-1 min-w-[80px]",title:"Carriage Inwards",children:[d.jsx("input",{placeholder:"Carriage",type:"number",className:"p-2 w-full border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.carriage,onChange:E=>x({..._,carriage:E.target.value})}),d.jsx("div",{className:"text-[9px] text-slate-400 mt-0.5 ml-1",children:"CARRIAGE"})]}),d.jsx("div",{className:"flex-none mb-3",children:d.jsxs("select",{className:"p-2 border rounded bg-slate-100 dark:bg-slate-600 dark:border-slate-600 dark:text-white",value:_.currency,onChange:E=>x({..._,currency:E.target.value}),children:[d.jsx("option",{value:"INR",children:"INR"}),d.jsx("option",{value:"USD",children:"USD"})]})})]}),_.type!=="cabinet"&&d.jsx("input",{placeholder:_.type==="card"||_.type==="processor"||_.type==="smps"?"Vendor*":"Vendor",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.vendor,onChange:E=>x({..._,vendor:E.target.value})}),(_.type==="card"||_.type==="processor")&&d.jsx("input",{placeholder:"Ports (Optional)",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.ports,onChange:E=>x({..._,ports:E.target.value})}),_.type==="smps"&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"Capacity (Amps)*",type:"number",step:"0.1",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.amps,onChange:E=>x({..._,amps:E.target.value})}),d.jsx("input",{placeholder:"Voltage (V)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.voltage,onChange:E=>x({..._,voltage:E.target.value})})]}),_.type==="module"&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"LED Type",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.ledType,onChange:E=>x({..._,ledType:E.target.value})}),d.jsx("input",{placeholder:"Lamp Make",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.lampMake,onChange:E=>x({..._,lampMake:E.target.value})}),d.jsx("input",{placeholder:"Width (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.width,onChange:E=>x({..._,width:E.target.value})}),d.jsx("input",{placeholder:"Height (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.height,onChange:E=>x({..._,height:E.target.value})}),d.jsx("input",{placeholder:"Weight/sqm (kg)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.weight,onChange:E=>x({..._,weight:E.target.value})}),d.jsx("input",{placeholder:"Avg Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.avgPower,onChange:E=>x({..._,avgPower:E.target.value})}),d.jsx("input",{placeholder:"Max Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.maxPower,onChange:E=>x({..._,maxPower:E.target.value})}),d.jsx("input",{placeholder:"Brightness (nits)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.brightness,onChange:E=>x({..._,brightness:E.target.value})}),d.jsx("input",{placeholder:"Refresh Rate*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.refreshRate,onChange:E=>x({..._,refreshRate:E.target.value})}),d.jsx("input",{placeholder:"Contrast* (e.g. 5000:1)",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.contrast,onChange:E=>x({..._,contrast:E.target.value})}),d.jsx("input",{placeholder:"Viewing Angle (H)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.viewAngleH,onChange:E=>x({..._,viewAngleH:E.target.value})}),d.jsx("input",{placeholder:"Viewing Angle (V)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.viewAngleV,onChange:E=>x({..._,viewAngleV:E.target.value})}),d.jsx("input",{placeholder:"IP Protection (Front)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.ipFront,onChange:E=>x({..._,ipFront:E.target.value})}),d.jsx("input",{placeholder:"IP Protection (Back)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.ipBack,onChange:E=>x({..._,ipBack:E.target.value})})]}),_.type==="cabinet"&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"Material*",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.material,onChange:E=>x({..._,material:E.target.value})}),d.jsxs("select",{className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.indoor,onChange:E=>x({..._,indoor:E.target.value}),children:[d.jsx("option",{value:"true",children:"Indoor"}),d.jsx("option",{value:"false",children:"Outdoor"})]}),d.jsx("input",{placeholder:"Width (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.width,onChange:E=>x({..._,width:E.target.value})}),d.jsx("input",{placeholder:"Height (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.height,onChange:E=>x({..._,height:E.target.value})}),d.jsx("input",{placeholder:"Weight (kg)",type:"number",step:"1",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.weight,onChange:E=>x({..._,weight:E.target.value})})]}),_.type==="ready"&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"Cabinet Material*",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.material,onChange:E=>x({..._,material:E.target.value})}),d.jsx("input",{placeholder:"LED Type",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.ledType,onChange:E=>x({..._,ledType:E.target.value})}),d.jsx("input",{placeholder:"Lamp Make",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.lampMake,onChange:E=>x({..._,lampMake:E.target.value})}),d.jsx("input",{placeholder:"Width (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.width,onChange:E=>x({..._,width:E.target.value})}),d.jsx("input",{placeholder:"Height (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.height,onChange:E=>x({..._,height:E.target.value})}),d.jsx("input",{placeholder:"Weight/sqm (kg)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.weight,onChange:E=>x({..._,weight:E.target.value})}),d.jsx("input",{placeholder:"Avg Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.avgPower,onChange:E=>x({..._,avgPower:E.target.value})}),d.jsx("input",{placeholder:"Max Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.maxPower,onChange:E=>x({..._,maxPower:E.target.value})}),d.jsx("input",{placeholder:"Brightness (nits)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.brightness,onChange:E=>x({..._,brightness:E.target.value})}),d.jsx("input",{placeholder:"Refresh Rate*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.refreshRate,onChange:E=>x({..._,refreshRate:E.target.value})}),d.jsx("input",{placeholder:"Contrast* (e.g. 5000:1)",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.contrast,onChange:E=>x({..._,contrast:E.target.value})}),d.jsx("input",{placeholder:"Viewing Angle (H)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.viewAngleH,onChange:E=>x({..._,viewAngleH:E.target.value})}),d.jsx("input",{placeholder:"Viewing Angle (V)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.viewAngleV,onChange:E=>x({..._,viewAngleV:E.target.value})}),d.jsx("input",{placeholder:"IP Protection (Front)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.ipFront,onChange:E=>x({..._,ipFront:E.target.value})}),d.jsx("input",{placeholder:"IP Protection (Back)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:_.ipBack,onChange:E=>x({..._,ipBack:E.target.value})})]}),d.jsxs("button",{onClick:se,className:`px-4 py-2 rounded text-white flex items-center justify-center gap-2 hover:opacity-90 transition ${u?"bg-amber-600":"bg-teal-600"} col-span-2 md:col-span-1`,children:[u?d.jsx(To,{size:16}):d.jsx(aa,{size:16}),u?"Update Item":"Add Item"]})]}),d.jsxs("div",{className:"mt-6",children:[d.jsx("div",{className:"md:hidden space-y-4",children:N.map(E=>{const D=e.filter(k=>k.itemId===E.id).reduce((k,j)=>k+(j.type==="in"?Number(j.qty):-Number(j.qty)),0);return d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm relative overflow-hidden",children:[d.jsx("div",{className:`absolute top-0 right-0 px-3 py-1 rounded-bl-lg text-[10px] font-bold uppercase tracking-wider ${E.type==="module"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-600 dark:bg-slate-700 dark:text-slate-300"}`,children:E.type}),d.jsxs("div",{className:"pr-16 mb-3",children:[d.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white text-lg",children:[E.brand," ",E.model]}),E.vendor&&d.jsx("div",{className:"text-xs text-teal-600 font-medium",children:E.vendor})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-xs text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-700/50 p-3 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("span",{className:"block text-[10px] uppercase font-bold text-slate-400",children:"Specs"}),E.type==="module"?d.jsxs("span",{children:["P",E.pitch," ",E.indoor?"In":"Out","  ",E.width,"x",E.height]}):d.jsx("span",{children:E.width?`${E.width}x${E.height}`:"Standard"})]}),d.jsxs("div",{children:[d.jsx("span",{className:"block text-[10px] uppercase font-bold text-slate-400",children:"Stock"}),d.jsx("span",{className:`font-bold text-sm ${D<0?"text-red-500":"text-slate-700 dark:text-slate-200"}`,children:D})]}),d.jsxs("div",{className:`border-t border-slate-200 dark:border-slate-600 pt-2 mt-1 ${t?"col-span-2":"col-span-1"}`,children:[d.jsx("span",{className:"block text-[10px] uppercase font-bold text-slate-400",children:"Landed Cost"}),d.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:Me((E.price||0)+(E.carriage||0),E.currency||"INR",!1,!0)})]}),!t&&d.jsxs("div",{className:"col-span-1 border-t border-slate-200 dark:border-slate-600 pt-2 mt-1 text-right",children:[d.jsx("span",{className:"block text-[10px] uppercase font-bold text-slate-400",children:"Stock Value ()"}),d.jsx("span",{className:"font-bold text-teal-600 dark:text-teal-400",children:Me(E.currency==="USD"?((E.price||0)+(E.carriage||0))*D*r:((E.price||0)+(E.carriage||0))*D,"INR",!1,!0)})]})]}),d.jsxs("div",{className:"flex gap-2",children:[E.type==="module"&&d.jsxs("button",{onClick:()=>ee(E),className:"flex-1 py-2 bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 rounded-lg text-xs font-bold flex justify-center items-center gap-2 hover:bg-purple-100 dark:hover:bg-purple-900/30 transition-colors",children:[d.jsx(Kw,{size:14})," Batches"]}),!t&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:()=>te(E),className:"flex-1 py-2 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg text-xs font-bold flex justify-center items-center gap-2 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors",children:[d.jsx(To,{size:14})," Edit"]}),d.jsxs("button",{onClick:()=>ae(E.id),className:"flex-1 py-2 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg text-xs font-bold flex justify-center items-center gap-2 hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors",children:[d.jsx(Os,{size:14})," Delete"]})]})]})]},E.id)})}),d.jsx("div",{className:"hidden md:block overflow-x-auto rounded border border-slate-200 dark:border-slate-700",children:d.jsxs("table",{className:"w-full text-sm text-left",children:[d.jsx("thead",{className:"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 uppercase",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-3",children:"Type"}),d.jsx("th",{className:"px-4 py-3",children:"Component"}),d.jsx("th",{className:"px-4 py-3",children:"Specs"}),d.jsx("th",{className:"px-4 py-3 text-center",children:"Stock"}),d.jsx("th",{className:"px-4 py-3",children:"Landed Cost"}),!t&&d.jsx("th",{className:"px-4 py-3 text-right",children:"Stock Value ()"}),d.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700 bg-white dark:bg-slate-800",children:N.map(E=>{const D=e.filter(j=>j.itemId===E.id).reduce((j,R)=>j+(R.type==="in"?Number(R.qty):-Number(R.qty)),0),k=(E.price||0)+(E.carriage||0);return d.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-slate-700/50 ${u===E.id?"bg-amber-50 dark:bg-amber-900/20":""}`,children:[d.jsx("td",{className:"px-4 py-3 capitalize",children:d.jsx("span",{className:`px-2 py-1 rounded-full text-xs capitalize ${E.type==="module"?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":E.type==="cabinet"?"bg-teal-100 dark:bg-teal-900 text-teal-700 dark:text-teal-300":E.type==="card"?"bg-amber-100 dark:bg-amber-900 text-amber-700 dark:text-amber-300":E.type==="smps"?"bg-rose-100 dark:bg-rose-900 text-rose-700 dark:text-rose-300":E.type==="processor"?"bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300":E.type==="ready"?"bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:E.type==="smps"?"SMPS":E.type})}),d.jsxs("td",{className:"px-4 py-3 dark:text-slate-200",children:[d.jsxs("div",{className:"font-medium",children:[E.brand," ",E.model]}),E.vendor&&d.jsx("div",{className:"text-[10px] text-teal-600 dark:text-teal-400 mt-0.5",children:E.vendor})]}),d.jsxs("td",{className:"px-4 py-3 text-slate-500 dark:text-slate-400 text-xs",children:[E.type==="module"&&d.jsxs("div",{className:"flex flex-col",children:[d.jsxs("span",{children:["P",E.pitch," ",E.indoor?"Indoor":"Outdoor"]}),d.jsxs("span",{children:[E.width,"x",E.height,"mm"]})]}),E.type==="cabinet"&&d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{children:E.material}),d.jsxs("span",{children:[E.width,"x",E.height,"mm"]}),d.jsx("span",{children:E.indoor?"Indoor":"Outdoor"})]}),(E.type==="card"||E.type==="processor")&&d.jsx("span",{children:E.ports?`${E.ports} Ports`:""}),E.type==="smps"&&d.jsx("span",{children:E.amps?`${E.amps} Amps`:""}),E.type==="ready"&&d.jsxs("span",{children:[E.width,"x",E.height,"mm P",E.pitch]})]}),d.jsx("td",{className:"px-4 py-3 font-bold dark:text-slate-200 text-teal-600 text-center",children:D}),d.jsx("td",{className:"px-4 py-3 dark:text-slate-200",children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-semibold",children:Me(k,E.currency||"INR",!1,!0)}),E.carriage>0&&d.jsxs("span",{className:"text-[10px] text-slate-400",children:["Base: ",E.price," + Carr: ",E.carriage]})]})}),!t&&d.jsx("td",{className:"px-4 py-3 font-bold text-right text-teal-600 dark:text-teal-400",children:Me(E.currency==="USD"?k*D*r:k*D,"INR",!1,!0)}),d.jsxs("td",{className:"px-4 py-3 flex gap-2 justify-end",children:[E.type==="module"&&d.jsx("button",{onClick:()=>ee(E),title:"Manage Batches",className:"text-purple-500 hover:text-purple-700 p-1 bg-purple-50 dark:bg-purple-900/30 rounded",children:d.jsx(Kw,{size:14})}),!t&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>te(E),className:"text-blue-500 hover:text-blue-700 p-1 bg-blue-50 dark:bg-blue-900/30 rounded",children:d.jsx(To,{size:14})}),d.jsx("button",{onClick:()=>ae(E.id),className:"text-red-400 hover:text-red-600 p-1 bg-red-50 dark:bg-red-900/30 rounded",children:d.jsx(Os,{size:14})})]})]})]},E.id)})})]})}),a.length===0&&!T&&d.jsx("div",{className:"text-center py-12 text-slate-400 bg-white dark:bg-slate-800",children:"No items found."})]}),V&&$&&d.jsx("div",{className:"fixed inset-0 z-50 bg-black/80 flex justify-center items-center p-4",children:d.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-xl shadow-2xl overflow-hidden",children:[d.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-800",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-slate-800 dark:text-white",children:"Batch Management"}),d.jsxs("p",{className:"text-xs text-slate-500",children:[$.brand," ",$.model]})]}),d.jsx("button",{onClick:()=>U(!1),className:"text-slate-400 hover:text-slate-600",children:d.jsx(yd,{size:20})})]}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"mb-4 text-xs text-slate-500 dark:text-slate-400 bg-blue-50 dark:bg-blue-900/20 p-3 rounded border border-blue-100 dark:border-blue-800",children:[" To add stock or new batches, please use the ",d.jsx("b",{children:"Stock Ledger"})," tab. This list shows current calculated balances."]}),d.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-800 overflow-hidden",children:[d.jsxs("div",{className:"grid grid-cols-2 bg-slate-100 dark:bg-slate-800 p-2 text-xs font-bold text-slate-500 uppercase",children:[d.jsx("div",{children:"Batch No"}),d.jsx("div",{className:"text-right",children:"Current Balance"})]}),d.jsxs("div",{className:"max-h-60 overflow-y-auto",children:[C($.id).length===0&&d.jsx("div",{className:"p-4 text-center text-xs text-slate-400",children:"No active batches found in ledger."}),C($.id).map((E,D)=>d.jsxs("div",{className:"grid grid-cols-2 p-2 border-b border-slate-100 dark:border-slate-700/50 last:border-0 text-sm items-center",children:[d.jsx("div",{className:"font-medium text-slate-700 dark:text-slate-200",children:E.name==="Unbatched"?d.jsx("span",{className:"italic text-slate-400",children:"Unbatched Stock"}):E.name}),d.jsx("div",{className:"text-right font-bold text-slate-900 dark:text-white",children:E.qty})]},D))]}),d.jsxs("div",{className:"p-3 bg-teal-50 dark:bg-teal-900/20 flex justify-between items-center border-t border-teal-100 dark:border-teal-800",children:[d.jsx("span",{className:"text-xs font-bold text-teal-800 dark:text-teal-400 uppercase",children:"Total in Batches"}),d.jsx("span",{className:"text-sm font-bold text-teal-700 dark:text-teal-300",children:C($.id).reduce((E,D)=>E+D.qty,0)})]})]})]})]})})]})},k3=({user:s,inventory:e=[],transactions:t=[],readOnly:r=!1})=>{const[a,l]=lt.useState({date:new Date().toISOString().split("T")[0],type:"in",itemId:"",qty:"",remarks:"",batch:""}),[u,m]=lt.useState(null),g=async()=>{if(!a.itemId||!a.qty)return alert("Select Item and Qty");try{const S=Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("transactions");u?(await S.doc(u).update({...a,qty:Number(a.qty),updatedAt:new Date}),m(null)):await S.add({...a,qty:Number(a.qty),createdAt:new Date}),l({date:new Date().toISOString().split("T")[0],type:"in",itemId:"",qty:"",remarks:"",batch:""})}catch{}},y=S=>{l({...S,qty:S.qty}),m(S.id),window.scrollTo({top:0,behavior:"smooth"})},_=()=>{m(null),l({date:new Date().toISOString().split("T")[0],type:"in",itemId:"",qty:"",remarks:"",batch:""})},x=async S=>{confirm("Delete record?")&&await Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("transactions").doc(S).delete()},T=[...t].sort((S,V)=>new Date(V.date)-new Date(S.date));return d.jsxs("div",{className:"p-4 md:p-6 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[d.jsx(oI,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"}),d.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:"Stock Ledger"})]}),!r&&d.jsxs("div",{className:`p-4 rounded-lg border mb-6 transition-colors ${u?"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-700":"bg-slate-50 dark:bg-slate-700/30 border-slate-200 dark:border-slate-700"}`,children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-xs font-bold uppercase text-slate-500 dark:text-slate-400",children:u?"Edit Transaction":"New Transaction"}),u&&d.jsxs("button",{onClick:_,className:"text-xs text-red-500 flex items-center gap-1",children:[d.jsx(yd,{size:14})," Cancel"]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Date & Action"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"date",value:a.date,onChange:S=>l({...a,date:S.target.value}),className:"flex-1 p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"}),d.jsxs("div",{className:"flex rounded overflow-hidden border border-slate-200 dark:border-slate-600",children:[d.jsx("button",{onClick:()=>l({...a,type:"in"}),className:`flex-1 py-2 text-xs font-bold transition-colors flex items-center justify-center gap-1 ${a.type==="in"?"bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-400":"bg-white dark:bg-slate-700 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-600"}`,children:"+ STOCK IN"}),d.jsx("button",{onClick:()=>l({...a,type:"out"}),className:`flex-1 py-2 text-xs font-bold transition-colors flex items-center justify-center gap-1 ${a.type==="out"?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400":"bg-white dark:bg-slate-700 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-600"}`,children:"- STOCK OUT"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Component"}),d.jsxs("select",{value:a.itemId,onChange:S=>l({...a,itemId:S.target.value}),className:"w-full p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select Item..."}),e.sort((S,V)=>(S.brand+" "+S.model).localeCompare(V.brand+" "+V.model)).map(S=>d.jsxs("option",{value:S.id,children:[S.brand," ",S.model," (",S.type,")"]},S.id))]}),e.find(S=>S.id===a.itemId)?.type==="module"&&d.jsx("input",{type:"text",placeholder:"Batch No. (e.g. BATCH-A)",value:a.batch||"",onChange:S=>l({...a,batch:S.target.value}),className:"w-full mt-2 p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white font-bold text-purple-600 border-purple-200 focus:border-purple-500 focus:ring-purple-500"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Quantity"}),d.jsx("input",{type:"number",placeholder:"Qty",value:a.qty,onChange:S=>l({...a,qty:S.target.value}),className:"w-full p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Location / Source"}),d.jsx("input",{type:"text",placeholder:"Source/Loc",value:a.remarks,onChange:S=>l({...a,remarks:S.target.value}),className:"w-full p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"})]})]}),d.jsx("button",{onClick:g,className:`w-full md:w-auto text-white px-6 py-2 rounded-lg font-bold text-sm transition-colors shadow-sm ${u?"bg-amber-600 hover:bg-amber-700":"bg-teal-600 hover:bg-teal-700"}`,children:u?"Update Transaction":"Add Transaction"})]}),d.jsxs("div",{className:"mt-8",children:[d.jsx("h3",{className:"text-sm font-bold uppercase text-slate-500 dark:text-slate-400 mb-4",children:"Transaction History"}),d.jsxs("div",{className:"md:hidden space-y-3",children:[T.map(S=>{const V=e.find(U=>U.id===S.itemId)||{};return d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-200 dark:border-slate-700 shadow-sm flex items-center justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${S.type==="in"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:S.type==="in"?"IN":"OUT"}),d.jsx("span",{className:"text-xs text-slate-400",children:new Date(S.date).toLocaleDateString()})]}),d.jsxs("div",{className:"font-bold text-slate-800 dark:text-white text-sm mb-0.5",children:[V.brand," ",V.model,S.batch&&d.jsx("span",{className:"ml-2 inline-block bg-purple-100 text-purple-700 dark:bg-purple-900/40 dark:text-purple-300 text-[10px] px-1.5 py-0.5 rounded border border-purple-200 dark:border-purple-800",children:S.batch})]}),d.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:S.remarks||"-"})]}),d.jsxs("div",{className:"text-right pl-4 border-l border-slate-100 dark:border-slate-700 ml-2",children:[d.jsxs("span",{className:`block text-lg font-bold ${S.type==="in"?"text-green-600":"text-red-500"}`,children:[S.type==="in"?"+":"-",S.qty]}),!r&&d.jsxs("div",{className:"flex gap-3 justify-end mt-1",children:[d.jsx("button",{onClick:()=>y(S),className:"text-[10px] text-blue-500 hover:text-blue-700 underline",children:"Edit"}),d.jsx("button",{onClick:()=>x(S.id),className:"text-[10px] text-red-400 hover:text-red-600 underline",children:"Delete"})]})]})]},S.id)}),T.length===0&&d.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"No transactions yet."})]}),d.jsxs("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700",children:[d.jsxs("table",{className:"w-full text-sm text-left",children:[d.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700/50 text-slate-500 dark:text-slate-400 uppercase text-xs",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-3",children:"Date"}),d.jsx("th",{className:"px-4 py-3 text-center",children:"Type"}),d.jsx("th",{className:"px-4 py-3",children:"Component"}),d.jsx("th",{className:"px-4 py-3",children:"Specs"}),d.jsx("th",{className:"px-4 py-3 text-center",children:"Qty"}),d.jsx("th",{className:"px-4 py-3",children:"Loc/Source"}),d.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700 bg-white dark:bg-slate-800",children:T.map(S=>{const V=e.find(U=>U.id===S.itemId)||{};return d.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[d.jsx("td",{className:"px-4 py-3 whitespace-nowrap dark:text-slate-300",children:new Date(S.date).toLocaleDateString()}),d.jsx("td",{className:"px-4 py-3 text-center",children:d.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${S.type==="in"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:S.type.toUpperCase()})}),d.jsxs("td",{className:"px-4 py-3 font-medium dark:text-white",children:[V.brand," ",V.model,S.batch&&d.jsx("div",{className:"text-[10px] bg-purple-100 text-purple-700 dark:bg-purple-900/40 dark:text-purple-300 px-1.5 py-0.5 rounded w-fit mt-1 font-bold border border-purple-200 dark:border-purple-800",children:S.batch})]}),d.jsx("td",{className:"px-4 py-3 text-xs text-slate-500 dark:text-slate-400",children:V.type}),d.jsxs("td",{className:`px-4 py-3 text-center font-bold ${S.type==="in"?"text-green-600":"text-red-500"}`,children:[S.type==="in"?"+":"-",S.qty]}),d.jsx("td",{className:"px-4 py-3 text-slate-500 dark:text-slate-400 text-xs",children:S.remarks}),d.jsx("td",{className:"px-4 py-3 text-right",children:!r&&d.jsxs("div",{className:"flex justify-end gap-1",children:[d.jsx("button",{onClick:()=>y(S),className:"text-blue-400 hover:text-blue-600 p-1.5 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded",children:d.jsx(To,{size:14})}),d.jsx("button",{onClick:()=>x(S.id),className:"text-red-400 hover:text-red-600 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:d.jsx(Os,{size:14})})]})})]},S.id)})})]}),T.length===0&&d.jsx("div",{className:"text-center py-8 text-slate-400",children:"No transactions recorded."})]})]})]})};var D3=iI();const EN=Ry(D3),j3=({cols:s,rows:e,module:t,cabinet:r,unit:a})=>{if(!t||!r)return null;const l=r.width,u=r.height,m=l*s,g=u*e,y=_=>{const x=(_/1e3).toFixed(2)+"m",T=(_/304.8).toFixed(2)+"ft";return`${x} / ${T}`};return d.jsx("div",{className:"w-full flex flex-col bg-white rounded-lg border border-slate-200 overflow-hidden",children:d.jsx("div",{className:"w-full h-full min-h-[300px] p-10 flex items-center justify-center",children:d.jsxs("div",{className:"relative",style:{aspectRatio:`${m}/${g}`,width:"100%",maxHeight:"400px"},children:[d.jsxs("div",{className:"absolute -top-8 left-0 right-0 text-center text-xs font-bold text-slate-600 flex items-center justify-center gap-2",children:[d.jsx("div",{className:"h-[1px] flex-1 bg-slate-300"}),d.jsxs("span",{className:"bg-white px-1 whitespace-nowrap",children:[y(m)," (",s," Cabinets)"]}),d.jsx("div",{className:"h-[1px] flex-1 bg-slate-300"})]}),d.jsxs("div",{className:"absolute -left-8 top-0 bottom-0 text-center text-xs font-bold text-slate-600 flex flex-col items-center justify-center gap-2",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"},children:[d.jsx("div",{className:"w-[1px] flex-1 bg-slate-300"}),d.jsxs("span",{className:"bg-white px-1 whitespace-nowrap",children:[y(g)," (",e," Cabinets)"]}),d.jsx("div",{className:"w-[1px] flex-1 bg-slate-300"})]}),d.jsx("div",{className:"w-full h-full grid bg-white border-2 border-slate-900 shadow-sm",style:{gridTemplateColumns:`repeat(${s}, 1fr)`,gridTemplateRows:`repeat(${e}, 1fr)`},children:Array.from({length:s*e}).map((_,x)=>d.jsx("div",{className:"border border-slate-300 relative"},x))})]})})})},TN=({data:s,allScreensData:e,currency:t="INR",exchangeRate:r,date:a})=>{const l=e&&e.calculations&&e.calculations.length>1,u=l?e.calculations:s?[s]:[];if(u.length===0)return null;const m=(l?e.clientName:s?.clientName)||"",g=(l?e.projectName:s?.projectName)||"",y=u[0].terms||{},_=l?e.totalProjectSell:s?.totalProjectSell,x=T=>d.jsxs("div",{className:`bg-white text-slate-800 font-sans text-xs ${T?"print-version-container p-0":"preview-version-container w-full h-full p-8"}`,children:[d.jsx("div",{className:"flex justify-between items-start mb-6 border-b-2 border-slate-800 pb-4",children:d.jsxs("div",{className:"flex gap-4 items-center",children:[d.jsx("img",{src:"/AdmireLED/logo.png",alt:"Company Logo",className:"h-16 w-auto object-contain"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-slate-900 uppercase tracking-wide",children:Pt.COMPANY.NAME}),d.jsxs("div",{className:"text-[10px] text-slate-600 mt-1 space-y-0.5",children:[d.jsx("p",{children:Pt.COMPANY.ADDRESS_1}),d.jsx("p",{children:Pt.COMPANY.ADDRESS_2}),d.jsxs("p",{children:["Email: ",Pt.COMPANY.EMAIL," | Web: ",Pt.COMPANY.WEB]})]})]})]})}),u.map((S,V)=>{const{finalWidth:U,finalHeight:$,totalCabinets:H,moduleType:se={},cabinetType:te={},processor:be,screenQty:ae,totalProjectSell:ee,gridCols:C,gridRows:N,commercials:E}=S,D=Number(U),k=Number($),j=D*k,R=j*10.7639,_e=Number(se.pitch||0),Ne=_e>0?Math.round(D*1e3/_e):0,z=_e>0?Math.round(k*1e3/_e):0,me=(se.weight||0)*j,Ee=(te.weight||0)*H,Ue=me+Ee,De=(se.avgPower||0)*j,O=(se.maxPower||0)*j,ne=E||{sellProcTotal:0,sellInstallTotal:0,sellStructureTotal:0},q=ee/(ae||1),K=(ne.sellProcTotal||0)/(ae||1),le=(ne.sellInstallTotal||0)/(ae||1),de=(ne.sellStructureTotal||0)/(ae||1),pe=q-K-le-de,Ce=pe*.02,lr=[{name:"LED Panel",rate:pe-Ce},{name:"Processor",rate:K},{name:"Installation",rate:le},{name:"Spares (2%)",rate:Ce},{name:"Structure",rate:de}].filter(Ht=>Ht.rate>0);return d.jsxs("div",{className:"mb-10 pb-6 border-b-2 border-slate-100 break-inside-avoid print-break-avoid",children:[l&&d.jsx("div",{className:"mb-4 pb-2 border-b border-teal-500",children:d.jsxs("h2",{className:"text-lg font-bold text-teal-800 uppercase",children:["Configuration #",V+1]})}),d.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2",children:"Project Details"}),d.jsxs("div",{className:"grid grid-cols-3 gap-y-1 text-[11px]",children:[d.jsx("span",{className:"font-semibold text-slate-500",children:"Client:"})," ",d.jsx("span",{className:"col-span-2 font-bold",children:m}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Project:"})," ",d.jsx("span",{className:"col-span-2 font-bold",children:g}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Screen Size:"}),d.jsxs("span",{className:"col-span-2",children:[D,"m x ",k,"m ",d.jsxs("span",{className:"text-slate-400",children:["/ ",(D*3.28084).toFixed(2),"ft x ",(k*3.28084).toFixed(2),"ft"]})]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Quantity:"})," ",d.jsxs("span",{className:"col-span-2",children:[ae," Nos"]})]}),d.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mt-4 mb-2",children:"Module & Cabinet"}),d.jsxs("div",{className:"grid grid-cols-3 gap-y-1 text-[11px]",children:[d.jsx("span",{className:"font-semibold text-slate-500",children:"Module:"})," ",d.jsxs("span",{className:"col-span-2",children:[se.brand," P",se.pitch]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Mod Size:"})," ",d.jsxs("span",{className:"col-span-2",children:[se.width," x ",se.height," mm"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Lamp:"})," ",d.jsx("span",{className:"col-span-2",children:se.lampMake||"-"}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Cabinet:"})," ",d.jsx("span",{className:"col-span-2",children:te.material||"Standard"}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Cab Size:"})," ",d.jsxs("span",{className:"col-span-2",children:[te.width," x ",te.height," mm"]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2",children:"Screen Specifications"}),d.jsxs("div",{className:"grid grid-cols-3 gap-y-1 text-[11px]",children:[d.jsx("span",{className:"font-semibold text-slate-500",children:"Resolution:"})," ",d.jsxs("span",{className:"col-span-2",children:[Ne," x ",z," pixels"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Total Area:"})," ",d.jsxs("span",{className:"col-span-2",children:[R.toFixed(2)," Sq.ft / ",j.toFixed(2)," Sq.m"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Total Weight:"})," ",d.jsxs("span",{className:"col-span-2",children:[Ue.toFixed(1)," kg"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Avg Power:"})," ",d.jsxs("span",{className:"col-span-2",children:[De.toFixed(0)," Watts"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Max Power:"})," ",d.jsxs("span",{className:"col-span-2",children:[O.toFixed(0)," Watts"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Brightness:"})," ",d.jsxs("span",{className:"col-span-2",children:[se.brightness," nits"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Refresh Rate:"})," ",d.jsxs("span",{className:"col-span-2",children:[se.refreshRate," Hz"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Controller:"})," ",d.jsx("span",{className:"col-span-2",children:be?`${be.brand} ${be.model}`:"Standard"}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Viewing:"})," ",d.jsxs("span",{className:"col-span-2",children:["H: ",se.viewAngleH," / V: ",se.viewAngleV,""]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"IP Rating:"})," ",d.jsxs("span",{className:"col-span-2",children:["Front: IP",se.ipFront," / Back: IP",se.ipBack]})]})]})]}),d.jsxs("div",{className:"mb-2 break-inside-avoid print-break-avoid",children:[d.jsxs("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2 pb-1",children:["Commercial Proposal ",l?`(Config #${V+1})`:""]}),d.jsxs("table",{className:"w-full border-collapse border border-slate-300 text-[11px]",children:[d.jsx("thead",{className:"bg-slate-800 text-white",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-2 border border-slate-600 text-left w-12",children:"#"}),d.jsx("th",{className:"p-2 border border-slate-600 text-left",children:"Item Description"}),d.jsx("th",{className:"p-2 border border-slate-600 text-right w-32",children:"Amount (1 Screen)"}),d.jsxs("th",{className:"p-2 border border-slate-600 text-right w-32",children:["Amount (",ae," Screens)"]})]})}),d.jsxs("tbody",{children:[lr.map((Ht,xn)=>d.jsxs("tr",{children:[d.jsx("td",{className:"p-2 border border-slate-300 text-center",children:xn+1}),d.jsx("td",{className:"p-2 border border-slate-300 font-bold",children:Ht.name}),d.jsx("td",{className:"p-2 border border-slate-300 text-right",children:Me(Ht.rate,t)}),d.jsx("td",{className:"p-2 border border-slate-300 text-right font-bold",children:Me(Ht.rate*ae,t)})]},xn)),d.jsxs("tr",{className:"bg-slate-100",children:[d.jsx("td",{colSpan:"3",className:"p-2 border border-slate-300 text-right font-bold uppercase",children:"Subtotal (Excl. GST)"}),d.jsx("td",{className:"p-2 border border-slate-300 text-right font-bold text-sm",children:Me(ee,t)})]})]})]})]})]},V)}),l&&d.jsx("div",{className:"mb-8 break-inside-avoid print-break-avoid",children:d.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-lg flex justify-between items-center shadow-lg",children:[d.jsx("div",{className:"text-lg font-bold uppercase tracking-wide",children:"Grand Total"}),d.jsxs("div",{className:"text-2xl font-bold",children:[Me(_,t)," ",d.jsx("span",{className:"text-xs font-normal opacity-70",children:"(Excl. GST)"})]})]})}),d.jsxs("div",{className:"mt-8 break-inside-avoid print-break-avoid",children:[d.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2 pb-1",children:"Terms & Conditions"}),d.jsx("div",{className:"text-[10px] text-slate-600 space-y-3",children:d.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-y-2 gap-x-4",children:[d.jsx("div",{className:"font-bold text-slate-800",children:"PRICE"}),d.jsx("div",{children:y.price}),d.jsx("div",{className:"font-bold text-slate-800",children:"PAYMENT"}),d.jsx("div",{children:(y.payment||[]).map((S,V)=>d.jsxs("span",{children:[S.percent,"% ",S.name,V<(y.payment||[]).length-1?", ":""]},V))}),d.jsx("div",{className:"font-bold text-slate-800",children:"DELIVERY"}),d.jsxs("div",{children:[y.deliveryWeeks," weeks"]}),d.jsx("div",{className:"font-bold text-slate-800",children:"GST"}),d.jsxs("div",{children:["Extra as applicable (currently ",Pt.DEFAULTS.GST_RATE,"%)"]}),d.jsx("div",{className:"font-bold text-slate-800",children:"WARRANTY"}),d.jsx("div",{className:"text-justify leading-snug",children:y.warranty||Pt.TEXT.WARRANTY})]})}),d.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mt-4 mb-2 pb-1",children:"Client's Scope"}),d.jsxs("div",{className:"text-[10px] text-slate-600 grid gap-y-2",children:[y.scope?.structure&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Structure:"}),y.scope.structure]}),y.scope?.elec&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Electricity:"}),y.scope.elec]}),y.scope?.net&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Internet:"}),y.scope.net]}),y.scope?.soft&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Software:"}),y.scope.soft]}),y.scope?.perm&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Permissions:"}),y.scope.perm]}),y.scope?.pc&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Computer:"}),y.scope.pc]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Validity:"}),y.validity||Pt.TEXT.VALIDITY]})]}),d.jsxs("div",{className:"mt-8 pt-8 border-t border-slate-200 flex justify-between items-end",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"h-12 mb-2"}),d.jsx("p",{className:"text-[10px] font-bold border-t border-slate-400 px-4 pt-1",children:"Client Acceptance"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"h-12 mb-2"}),d.jsx("p",{className:"text-[10px] font-bold border-t border-slate-400 px-4 pt-1",children:"For Admire Sign & Display Pvt. Ltd."})]})]})]})]});return d.jsxs(zt.Fragment,{children:[d.jsx("div",{className:"screen-preview-wrapper",children:x(!1)}),EN.createPortal(d.jsx("div",{className:"print-only-portal",children:x(!0)}),document.body)]})},P3=({user:s,inventory:e,transactions:t,exchangeRate:r,onLoadQuote:a,readOnly:l=!1})=>{const[u,m]=zt.useState([]),[g,y]=zt.useState(null);zt.useEffect(()=>{if(!s)return;const S=Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("quotes").orderBy("updatedAt","desc").onSnapshot(V=>{m(V.docs.map(U=>({id:U.id,...U.data()})))});return()=>S()},[s]);const _=async S=>{confirm("Are you sure you want to delete this quote?")&&await Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("quotes").doc(S).delete()},x=S=>{if(S.allScreensData){y({allScreensData:S.allScreensData,client:S.client,project:S.project});return}const V=S.calculatorState;if(V.screens&&V.screens.length>0){const $=V.screens.map(H=>{const se={...V,...H};return Eo(se,e,t,r)}).filter(H=>H!==null);if($.length>0){const H={totalProjectCost:$.reduce((se,te)=>se+te.totalProjectCost,0),totalProjectSell:$.reduce((se,te)=>se+te.totalProjectSell,0),totalLEDSell:$.reduce((se,te)=>se+te.matrix.led.sell*te.screenQty,0),totalServicesSell:$.reduce((se,te)=>se+(te.matrix.sell.total-te.matrix.led.sell*te.screenQty),0),totalMargin:0,totalScreenQty:$.reduce((se,te)=>se+Number(te.screenQty),0),calculations:$,screenConfigs:V.screens};H.totalMargin=H.totalProjectSell-H.totalProjectCost,y({allScreensData:H,client:S.client,project:S.project});return}}const U=Eo(V,e,t,r);U?y({data:U,client:S.client,project:S.project}):alert("Could not calculate quote. Inventory items might be missing.")},T=S=>{let V=[],U=0,$=0;if(S.allScreensData&&S.allScreensData.calculations)V=S.allScreensData.calculations,U=S.allScreensData.totalProjectSell,$=S.allScreensData.totalProjectCost;else{const C=S.calculatorState;if(C&&C.screens&&C.screens.length>0)V=C.screens.map(N=>{const E={...C,...N};return Eo(E,e,t,r)}).filter(N=>N!==null);else{const N=Eo(C,e,t,r);N&&(V=[N])}V.length>0&&($=V.reduce((N,E)=>N+E.totalProjectCost,0),U=V.reduce((N,E)=>N+E.totalProjectSell,0))}if(V.length===0)return alert("Calculation failed. Inventory items might be missing.");const H=(S.project||"").replace(/,/g," "),se=(S.client||"").replace(/,/g," ");let te=`Project,${H}
Client,${se}
Date,${new Date().toLocaleDateString()}

`;V.forEach((C,N)=>{te+=`SCREEN CONFIGURATION #${N+1}
`,te+=`Dimensions,${C.finalWidth}m x ${C.finalHeight}m
`,te+=`Quantity,${C.screenQty}
`,te+=`
Bill of Materials (Config #${N+1})
Component,Specification,Qty/Scrn,Total Qty,Rate,Total Amount
`,C.detailedItems.forEach(E=>{const D=(E.name||"").replace(/"/g,'""'),k=(E.spec||"").replace(/"/g,'""'),j=E.qty*C.screenQty,R=E.total*C.screenQty;te+=`"${D}","${k}",${E.qty},${j},${E.unit.toFixed(2)},${R.toFixed(2)}
`}),te+=`
Subtotal (Cost),${C.totalProjectCost.toFixed(2)}
`,te+=`Subtotal (Sell),${C.totalProjectSell.toFixed(2)}
`,te+=`
--------------------------------

`}),te+=`PROJECT SUMMARY
`,te+=`Grand Total Cost,${$.toFixed(2)}
`,te+=`Grand Total Sell,${U.toFixed(2)}
`,te+=`Net Margin,${(U-$).toFixed(2)}
`;const be=new Blob([te],{type:"text/csv;charset=utf-8;"}),ae=window.URL.createObjectURL(be),ee=document.createElement("a");ee.href=ae,ee.download=`${se.replace(/[^a-z0-9]/gi,"_")}_${H.replace(/[^a-z0-9]/gi,"_")}_BOM.csv`,ee.click(),window.URL.revokeObjectURL(ae)};return d.jsxs("div",{className:"p-4 md:p-6 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[g&&d.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex justify-center items-center p-4",children:d.jsxs("div",{className:"bg-white max-w-4xl w-full h-[90vh] rounded-lg shadow-2xl flex flex-col",children:[d.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-slate-100 rounded-t-lg",children:[d.jsxs("h2",{className:"font-bold text-lg text-slate-800 flex items-center gap-2",children:[d.jsx(M0,{size:20})," View Saved Quote"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>y(null),className:"px-4 py-2 text-slate-600 hover:bg-slate-200 rounded",children:"Close"}),d.jsxs("button",{onClick:()=>{const S=document.title;document.title=`${g.client}_${g.project}_Quote`.replace(/[^a-zA-Z0-9_]/g,"_"),window.print(),document.title=S},className:"px-4 py-2 bg-teal-600 text-white hover:bg-teal-700 rounded flex items-center gap-2",children:[d.jsx(Bf,{size:16})," Print / PDF"]})]})]}),d.jsx("div",{className:"flex-1 overflow-auto p-8 bg-slate-200",children:d.jsx(TN,{data:g.data?{...g.data,clientName:g.client,projectName:g.project}:null,allScreensData:g.allScreensData?{...g.allScreensData,clientName:g.client,projectName:g.project}:null,currency:"INR",exchangeRate:r})})]})}),d.jsx("div",{className:"flex justify-between items-center mb-6",children:d.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-slate-800 dark:text-white",children:[d.jsx(rm,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"})," Saved Quotes"]})}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[u.map(S=>{const V=S.calculatorState||{};V.unit;const U=V.selectedPitch||"N/A",$=V.selectedIndoor==="true";return d.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden flex flex-col",children:[d.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white line-clamp-1",title:S.project,children:S.project||"Untitled"}),d.jsx("div",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:S.client||"No Client"})]}),d.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${$?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"}`,children:$?"Indoor":"Outdoor"})]}),d.jsx("div",{className:"text-xs text-slate-400 mb-4",children:new Date(S.updatedAt?.seconds*1e3).toLocaleString()}),d.jsx("div",{className:"bg-slate-50 dark:bg-slate-700/30 p-2 rounded-lg mb-4 space-y-1.5 flex-1",children:S.allScreensData?.calculations?S.allScreensData.calculations.map((H,se)=>d.jsxs("div",{className:"flex justify-between items-center text-xs border-b border-slate-100 dark:border-slate-600 last:border-0 pb-1 last:pb-0",children:[d.jsxs("span",{className:"text-slate-600 dark:text-slate-300 font-medium",children:["Screen #",se+1," ",d.jsxs("span",{className:"text-slate-400 font-normal",children:["(",H.finalWidth,"x",H.finalHeight,"m / ",(Number(H.finalWidth)*3.28084).toFixed(2),"x",(Number(H.finalHeight)*3.28084).toFixed(2),"ft ",H.screenQty,")"]})]}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:Me(H.totalProjectSell,"INR",!0)})]},se)):d.jsxs("div",{className:"flex justify-between items-center text-xs",children:[d.jsxs("span",{className:"text-slate-600 dark:text-slate-300 font-medium",children:["Screen #1 ",d.jsxs("span",{className:"text-slate-400 font-normal",children:["(P",U," ",V.screenQty||1,")"]})]}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:Me(S.finalAmount,"INR",!0)})]})}),d.jsxs("div",{className:"flex justify-between items-end pt-2 border-t border-slate-100 dark:border-slate-700 mt-auto",children:[d.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:"Total Estimate"}),d.jsx("span",{className:"text-xl font-bold text-teal-600 dark:text-teal-400",children:Me(S.finalAmount,"INR")})]})]}),d.jsxs("div",{className:`grid ${l?"grid-cols-2":"grid-cols-5"} border-t border-slate-100 dark:border-slate-700 divide-x divide-slate-100 dark:divide-slate-700 bg-slate-50 dark:bg-slate-800`,children:[d.jsxs("button",{onClick:()=>x(S),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"View",children:[d.jsx(M0,{size:16})," ",d.jsx("span",{className:"hidden sm:inline",children:"View"})]}),!l&&d.jsxs("button",{onClick:()=>a(S,!1),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-blue-600 dark:text-blue-400 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"Edit",children:[d.jsx(To,{size:16})," ",d.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),d.jsxs("button",{onClick:()=>T(S),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-green-600 dark:text-green-400 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"Excel",children:[d.jsx(T2,{size:16})," ",d.jsx("span",{className:"hidden sm:inline",children:"Excel"})]}),!l&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:()=>a(S,!0),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-slate-500 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"Clone",children:[d.jsx(O0,{size:16})," ",d.jsx("span",{className:"hidden sm:inline",children:"Clone"})]}),d.jsxs("button",{onClick:()=>_(S.id),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Delete",children:[d.jsx(Os,{size:16})," ",d.jsx("span",{className:"hidden sm:inline",children:"Del"})]})]})]})]},S.id)}),u.length===0&&d.jsx("p",{className:"text-center text-slate-400 py-10 col-span-full",children:"No saved quotes found."})]})]})},V3=({data:s,allScreensData:e,inventory:t=[],transactions:r=[]})=>{if(!s&&!e)return null;const a=e&&e.calculations&&e.calculations.length>1;if(!a&&!s)return null;const l=(a?e.clientName:s?.clientName)||"",u=(a?e.projectName:s?.projectName)||"",m=(_,x,T)=>{const{detailedItems:S,screenQty:V,moduleType:U,cabinetType:$,finalWidth:H,finalHeight:se}=_;return d.jsxs("div",{className:"mb-8 break-inside-avoid print-break-avoid",children:[a&&d.jsxs("div",{className:"bg-teal-50 dark:bg-teal-900/20 p-3 rounded-lg mb-3 border border-teal-200 dark:border-teal-800",children:[d.jsxs("h3",{className:"font-bold text-teal-800 dark:text-teal-300 text-sm",children:["Screen Configuration #",x+1]}),d.jsxs("div",{className:"flex flex-wrap gap-x-8 gap-y-3 mt-3 text-xs text-teal-800 dark:text-teal-300",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Target Size"}),T.targetWidth,"  ",T.targetHeight," ",T.unit||"m"]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Final Dimensions"}),H,"m  ",se,"m ",d.jsxs("span",{className:"text-teal-600/70",children:["/ ",(Number(H)*3.28084).toFixed(2),"ft  ",(Number(se)*3.28084).toFixed(2),"ft"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Quantity"}),V," Screens"]}),U&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Type"}),"P",U.pitch," ",U.indoor?"Indoor":"Outdoor"]})]})]}),d.jsxs("table",{className:"w-full border-collapse border border-slate-300 text-[10px]",children:[d.jsx("thead",{className:"bg-slate-100 text-slate-700",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-2 border border-slate-300 text-left w-10",children:"#"}),d.jsx("th",{className:"p-2 border border-slate-300 text-left w-32",children:"Component"}),d.jsx("th",{className:"p-2 border border-slate-300 text-left",children:"Specification / Details"}),d.jsx("th",{className:"p-2 border border-slate-300 text-center w-16",children:"Qty/Scrn"}),d.jsx("th",{className:"p-2 border border-slate-300 text-center w-16",children:"Total Qty"})]})}),d.jsx("tbody",{children:S.map((te,be)=>{const ae=t.find(C=>C.id===te.inventoryId);let ee=null;return ae&&(ae.type==="module"?ee=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",ae.width,"x",ae.height,"mm"]}),d.jsxs("span",{children:["LED: ",ae.ledType||"-"]}),d.jsxs("span",{children:["Bright: ",ae.brightness," nits"]}),d.jsxs("span",{children:["Ref: ",ae.refreshRate," Hz"]}),d.jsxs("span",{children:["Ang: ",ae.viewAngleH,"/",ae.viewAngleV]}),d.jsxs("span",{children:["IP: ",ae.ipFront,"/",ae.ipBack]}),d.jsxs("span",{children:["Pwr: ",ae.avgPower,"/",ae.maxPower," W"]}),d.jsxs("span",{children:["Wt: ",ae.weight," kg"]})]}):ae.type==="cabinet"?ee=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",ae.width,"x",ae.height,"mm"]}),d.jsxs("span",{children:["Mat: ",ae.material]}),d.jsxs("span",{children:["Weight: ",ae.weight," kg"]})]}):ae.type==="ready"?ee=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",ae.width,"x",ae.height,"mm"]}),d.jsxs("span",{children:["Mat: ",ae.material||"-"]}),d.jsxs("span",{children:["Bright: ",ae.brightness," nits"]}),d.jsxs("span",{children:["Ref: ",ae.refreshRate," Hz"]}),d.jsxs("span",{children:["IP: ",ae.ipFront,"/",ae.ipBack]})]}):ae.type==="card"?ee=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",ae.brand]}),d.jsxs("span",{children:["Model: ",ae.model]}),ae.ports&&d.jsxs("span",{children:["Ports: ",ae.ports]})]}):ae.type==="smps"||ae.type==="psu"?ee=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",ae.brand]}),d.jsxs("span",{children:["Model: ",ae.model]}),ae.amps&&d.jsxs("span",{children:["Amps: ",ae.amps,"A"]})]}):ae.type==="processor"&&(ee=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",ae.brand]}),d.jsxs("span",{children:["Model: ",ae.model]}),ae.ports&&d.jsxs("span",{children:["Ports: ",ae.ports]})]}))),d.jsxs("tr",{children:[d.jsx("td",{className:"p-2 border border-slate-300 text-center",children:be+1}),d.jsx("td",{className:"p-2 border border-slate-300 font-bold align-top",children:te.name}),d.jsxs("td",{className:"p-2 border border-slate-300 align-top",children:[d.jsx("div",{className:"font-semibold",children:te.spec}),ee]}),d.jsx("td",{className:"p-2 border border-slate-300 text-center align-top",children:te.qty}),d.jsx("td",{className:"p-2 border border-slate-300 text-center font-bold align-top",children:te.qty*V})]},be)})})]})]},x)},g=()=>{if(!a)return null;const _={},x=S=>r?r.filter(V=>V.itemId===S).reduce((V,U)=>V+(U.type==="in"?Number(U.qty):-Number(U.qty)),0):0;e.calculations.forEach((S,V)=>{S.detailedItems.forEach(U=>{const $=U.inventoryId?U.inventoryId:`${U.name}_${U.spec}`;_[$]||(_[$]={name:U.name,spec:U.spec,inventoryId:U.inventoryId,id:U.id,totalQty:0});const H=U.qty*S.screenQty;_[$].totalQty+=H})});const T=Object.values(_);return d.jsxs("div",{className:"mt-8 break-inside-avoid print-break-avoid border-t-4 border-slate-800 pt-6",children:[d.jsx("div",{className:"bg-slate-800 text-white p-3 rounded-t-lg mb-0 flex justify-between items-center",children:d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-lg uppercase tracking-wide",children:"Consolidated Bill of Materials"}),d.jsx("p",{className:"text-xs text-slate-300 mt-1",children:"Combined quantities across all screen configurations"})]})}),d.jsxs("table",{className:"w-full border-collapse border border-slate-300 text-[10px]",children:[d.jsx("thead",{className:"bg-slate-700 text-white",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-2 border border-slate-600 text-left w-10",children:"#"}),d.jsx("th",{className:"p-2 border border-slate-600 text-left w-32",children:"Component"}),d.jsx("th",{className:"p-2 border border-slate-600 text-left",children:"Specification"}),d.jsx("th",{className:"p-2 border border-slate-600 text-center w-16",children:"Stock"}),d.jsx("th",{className:"p-2 border border-slate-600 text-center w-16",children:"Required"}),d.jsx("th",{className:"p-2 border border-slate-600 text-center w-16",children:"Balance"})]})}),d.jsx("tbody",{children:T.map((S,V)=>{const U=S.inventoryId?x(S.inventoryId):0,$=U-S.totalQty,H=S.inventoryId?t.find(te=>te.id===S.inventoryId):null;let se=null;return H&&(H.type==="module"?se=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",H.width,"x",H.height,"mm"]}),d.jsxs("span",{children:["LED: ",H.ledType||"-"]}),d.jsxs("span",{children:["Bright: ",H.brightness," nits"]}),d.jsxs("span",{children:["Ref: ",H.refreshRate," Hz"]}),d.jsxs("span",{children:["Ang: ",H.viewAngleH,"/",H.viewAngleV]}),d.jsxs("span",{children:["IP: ",H.ipFront,"/",H.ipBack]}),d.jsxs("span",{children:["Pwr: ",H.avgPower,"/",H.maxPower," W"]}),d.jsxs("span",{children:["Wt: ",H.weight," kg"]})]}):H.type==="cabinet"?se=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",H.width,"x",H.height,"mm"]}),d.jsxs("span",{children:["Mat: ",H.material]}),d.jsxs("span",{children:["Weight: ",H.weight," kg"]})]}):H.type==="ready"?se=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",H.width,"x",H.height,"mm"]}),d.jsxs("span",{children:["Mat: ",H.material||"-"]}),d.jsxs("span",{children:["Bright: ",H.brightness," nits"]}),d.jsxs("span",{children:["Ref: ",H.refreshRate," Hz"]}),d.jsxs("span",{children:["IP: ",H.ipFront,"/",H.ipBack]})]}):H.type==="card"?se=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",H.brand]}),d.jsxs("span",{children:["Model: ",H.model]}),H.ports&&d.jsxs("span",{children:["Ports: ",H.ports]})]}):H.type==="smps"||H.type==="psu"?se=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",H.brand]}),d.jsxs("span",{children:["Model: ",H.model]}),H.amps&&d.jsxs("span",{children:["Amps: ",H.amps,"A"]})]}):H.type==="processor"&&(se=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",H.brand]}),d.jsxs("span",{children:["Model: ",H.model]}),H.ports&&d.jsxs("span",{children:["Ports: ",H.ports]})]}))),d.jsxs("tr",{className:V%2===0?"bg-slate-50":"bg-white",children:[d.jsx("td",{className:"p-2 border border-slate-300 text-center",children:V+1}),d.jsx("td",{className:"p-2 border border-slate-300 font-bold align-top",children:S.name}),d.jsxs("td",{className:"p-2 border border-slate-300 align-top",children:[d.jsx("div",{className:"font-semibold",children:S.spec}),se]}),d.jsx("td",{className:"p-2 border border-slate-300 text-center font-medium text-slate-600 align-top",children:S.inventoryId?U:"-"}),d.jsx("td",{className:"p-2 border border-slate-300 text-center font-bold align-top text-slate-800",children:S.totalQty}),d.jsx("td",{className:`p-2 border border-slate-300 text-center font-bold align-top ${$>=0?"text-green-600":"text-red-600"}`,children:S.inventoryId?$:"-"})]},V)})})]}),d.jsx("div",{className:"mt-4 p-3 bg-teal-50 dark:bg-teal-900/20 rounded-lg border border-teal-200 dark:border-teal-800",children:d.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-teal-800 dark:text-teal-300",children:"Total Configurations:"}),d.jsx("span",{className:"ml-2 font-bold text-lg text-teal-600 dark:text-teal-400",children:e.calculations.length})]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-teal-800 dark:text-teal-300",children:"Total Screens:"}),d.jsx("span",{className:"ml-2 font-bold text-lg text-teal-600 dark:text-teal-400",children:e.totalScreenQty})]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-teal-800 dark:text-teal-300",children:"Unique Components:"}),d.jsx("span",{className:"ml-2 font-bold text-lg text-teal-600 dark:text-teal-400",children:T.length})]})]})})]})},y=_=>d.jsxs("div",{className:`p-8 max-w-[210mm] mx-auto bg-white min-h-screen text-slate-800 font-sans text-xs ${_?"print-version-container p-0 w-full":""}`,children:[d.jsxs("div",{className:"flex justify-between items-start mb-6 border-b-2 border-slate-800 pb-4",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("img",{src:"/AdmireLED/logo.png",alt:"Logo",className:"h-12 w-auto"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-slate-900 uppercase tracking-wide",children:"Bill of Materials"}),d.jsxs("div",{className:"mt-1 space-y-0.5",children:[d.jsxs("p",{className:"text-sm font-bold text-slate-700",children:["Project: ",d.jsx("span",{className:"font-normal",children:u})]}),d.jsxs("p",{className:"text-sm font-bold text-slate-700",children:["Client: ",d.jsx("span",{className:"font-normal",children:l})]}),a&&d.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[e.calculations.length," Configs  ",e.totalScreenQty," Screens"]}),!a&&s.moduleType&&d.jsxs("p",{className:"text-xs text-slate-500 mt-1 font-medium flex items-center gap-2",children:[d.jsxs("span",{className:"inline-block bg-slate-100 px-2 py-0.5 rounded text-slate-700 font-bold border border-slate-200",children:["P",s.moduleType.pitch," ",s.moduleType.indoor?"Indoor":"Outdoor"]}),d.jsxs("span",{children:[s.finalWidth,"m x ",s.finalHeight,"m ",d.jsxs("span",{className:"text-slate-400",children:["/ ",(Number(s.finalWidth)*3.28084).toFixed(2),"ft x ",(Number(s.finalHeight)*3.28084).toFixed(2),"ft"]})]}),d.jsxs("span",{className:"font-bold text-slate-700 border-l border-slate-300 pl-2 ml-1",children:[s.screenQty," Screens"]})]})]})]})]}),d.jsx("div",{className:"text-right",children:d.jsx("p",{className:"text-xs text-slate-500",children:new Date().toLocaleDateString()})})]}),a?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mb-6",children:d.jsx("h2",{className:"text-sm font-bold text-slate-700 uppercase mb-3 pb-2 border-b border-slate-300",children:"Individual Screen Configurations"})}),e.calculations.map((x,T)=>m(x,T,e.screenConfigs?e.screenConfigs[T]:{})),g()]}):m(s,0,{}),d.jsx("div",{className:"mt-8 text-[10px] text-slate-400 border-t border-slate-200 pt-2 text-center",children:"Internal Document  Generated by Admire Sign LED Calculator"})]});return d.jsxs(zt.Fragment,{children:[d.jsx("div",{className:"screen-preview-wrapper",children:y(!1)}),EN.createPortal(d.jsx("div",{className:"print-only-portal",children:y(!0)}),document.body)]})},O3=(s,e)=>{const[t,r]=zt.useState(s);return zt.useEffect(()=>{const a=setTimeout(()=>{r(s)},e);return()=>{clearTimeout(a)}},[s,e]),t},M3=({calculation:s,state:e,updateState:t,updateExtra:r,updateScreenProp:a,inventory:l,getStock:u,overrides:m,onOverride:g,editingRow:y,setEditingRow:_,onClearOverride:x})=>{const T=e.screens[e.activeScreenIndex],{screenQty:S,selectedPitch:V,selectedModuleId:U,selectedCabinetId:$,selectedCardId:H,selectedSMPSId:se,selectedProcId:te,extraComponents:be,extras:ae,commercials:ee}=T,{assemblyMode:C,selectedIndoor:N}=e,E=()=>Math.random().toString(36).substr(2,9).toUpperCase(),D=N==="true",k=l.filter(W=>W.type==="module"&&W.indoor===D),j=[...new Set(k.map(W=>W.pitch))].sort((W,Se)=>W-Se),R=V?k.filter(W=>W.pitch==V):[],_e=l.find(W=>W.id===U),Ne=l.filter(W=>W.type!=="cabinet"?!1:_e?W.width%_e.width===0&&W.height%_e.height===0:!0),z=l.filter(W=>W.type==="ready"&&W.indoor===D),me=W=>{const Se=(ue,jt)=>a(e.activeScreenIndex,ue,jt);if(W.id==="modules")return d.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[d.jsxs("select",{value:V,onChange:ue=>{Se("selectedPitch",ue.target.value),Se("selectedModuleId","")},className:"w-full md:w-20 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Pitch"}),j.map(ue=>d.jsxs("option",{value:ue,children:["P",ue]},ue))]}),d.jsxs("select",{value:U,onChange:ue=>Se("selectedModuleId",ue.target.value),disabled:!V,className:"w-full md:flex-1 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white disabled:opacity-50",children:[d.jsx("option",{value:"",children:"Select Module..."}),R.map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (",u(ue.id),")"]},ue.id))]})]});if(W.id==="cabinets")return d.jsxs("select",{value:$,onChange:ue=>Se("selectedCabinetId",ue.target.value),disabled:!_e,className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white disabled:opacity-50",children:[d.jsx("option",{value:"",children:"Select Cabinet..."}),Ne.map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (",ue.width,"x",ue.height,") - Stock: ",u(ue.id)]},ue.id))]});if(W.id==="cards")return d.jsxs("select",{value:H,onChange:ue=>Se("selectedCardId",ue.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select Card..."}),l.filter(ue=>ue.type==="card").map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (",u(ue.id),")"]},ue.id))]});if(W.id==="smps")return d.jsxs("select",{value:se,onChange:ue=>Se("selectedSMPSId",ue.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select SMPS..."}),l.filter(ue=>ue.type==="smps").map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (",u(ue.id),")"]},ue.id))]});if(W.id==="processor")return d.jsxs("div",{className:"flex flex-col gap-2 md:gap-1",children:[d.jsxs("select",{value:te,onChange:ue=>Se("selectedProcId",ue.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select Processor..."}),l.filter(ue=>ue.type==="processor").map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (",u(ue.id),")"]},ue.id))]}),d.jsxs("div",{className:"flex items-center gap-2 md:gap-1",children:[d.jsx("span",{className:"text-xs md:text-[10px] text-green-600 font-bold",children:"Sell:"}),d.jsx("input",{type:"number",className:"flex-1 md:w-20 p-2 md:p-0.5 text-xs border border-green-200 rounded bg-green-50 text-green-800",value:ee.processor?.val||0,onChange:ue=>a(e.activeScreenIndex,"commercials",{...ee,processor:{...ee.processor,val:ue.target.value}})})]})]});if(W.id==="ready")return d.jsxs("select",{value:T.readyId,onChange:ue=>Se("readyId",ue.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select Screen Model..."}),z.map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (P",ue.pitch,")"]},ue.id))]});const Fe=be?be.findIndex(ue=>ue.id===W.id):-1;return Fe!==-1?d.jsxs("div",{className:"flex gap-1 items-center",children:[d.jsxs("select",{value:be[Fe].componentId,onChange:ue=>{const jt=[...be];jt[Fe].componentId=ue.target.value,Se("extraComponents",jt)},className:"flex-1 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select..."}),["module","cabinet","card","smps"].map(ue=>{const jt=l.filter(wn=>wn.type===ue).sort((wn,Xt)=>(wn.brand+" "+wn.model).localeCompare(Xt.brand+" "+Xt.model));return jt.length===0?null:d.jsx("optgroup",{label:ue==="smps"?"SMPS":ue.toUpperCase(),children:jt.map(wn=>d.jsxs("option",{value:wn.id,children:[wn.brand," ",wn.model]},wn.id))},ue)})]}),d.jsxs("select",{value:be[Fe].type,onChange:ue=>{const jt=[...be];jt[Fe].type=ue.target.value,Se("extraComponents",jt)},className:"w-16 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"screen",children:"/Scrn"}),d.jsx("option",{value:"cabinet",children:"/Cab"})]}),d.jsx("button",{type:"button",onClick:()=>Se("extraComponents",be.filter((ue,jt)=>jt!==Fe)),className:"text-red-400 hover:text-red-600",children:d.jsx(Os,{size:16})})]}):d.jsxs("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:[W.name," ",d.jsxs("span",{className:"text-[10px] text-slate-400 font-normal",children:["(",W.spec,")"]})]})},Ee=W=>s?.calculatedExtras?.[W]||0,Ue=s?.matrix?.sqft?.perScreen||1;let De=s?s.detailedItems:C==="assembled"?[{id:"modules",type:"led",name:"Modules",qty:0,unit:0,total:0},{id:"cabinets",type:"led",name:"Cabinets",qty:0,unit:0,total:0},{id:"cards",type:"led",name:"Receiving Cards",qty:0,unit:0,total:0},{id:"smps",type:"led",name:"SMPS",qty:0,unit:0,total:0},{id:"processor",type:"service",name:"Processor",qty:1,unit:0,total:0}]:[{id:"ready",type:"led",name:"Ready Unit",qty:0,unit:0,total:0},{id:"processor",type:"service",name:"Processor",qty:1,unit:0,total:0}];!s&&be?.length>0&&(De=[...De,...be.map(W=>({id:W.id,type:"led",name:"Extra",spec:"Select...",qty:W.qty,unit:0,total:0}))]);const O=De.filter(W=>W.type==="led"),ne=(Array.isArray(ae)?ae:[]).reduce((W,Se)=>W+Ee(Se.id),0),K=O.reduce((W,Se)=>W+Se.total*S,0)+ne*S,le=K/(S||1),de=le/Ue,pe=De.filter(W=>W.type!=="led"),Ce=Ee("install"),nt=Ee("structure"),Ht=pe.reduce((W,Se)=>W+Se.total*S,0)+(Ce+nt)*S,xn=Ht/(S||1),Er=xn/Ue,un=K+Ht,$n=un/(S||1),Dn=$n/Ue,Yn=()=>{const W={id:E(),name:"New Cost",val:0,type:"abs"};a(e.activeScreenIndex,"extras",[...ae||[],W])},Wn=W=>{const Se=[...ae];Se.splice(W,1),a(e.activeScreenIndex,"extras",Se)},We=(W,Se,Fe)=>{const ue=[...ae];ue[W]={...ue[W],[Se]:Fe},a(e.activeScreenIndex,"extras",ue)},Et=W=>d.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors ${W.isOverridden?"bg-amber-50 dark:bg-amber-900/20":""}`,children:[d.jsx("td",{className:"p-2 pl-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"flex-1",children:me(W)}),s&&d.jsxs(d.Fragment,{children:[d.jsx("button",{type:"button",onClick:()=>_(y===W.id?null:W.id),className:`p-1 rounded ${y===W.id?"bg-teal-100 text-teal-700":"text-slate-300 hover:text-teal-600"}`,children:d.jsx(To,{size:12})}),W.isOverridden&&d.jsx("button",{type:"button",onClick:()=>x(W.id),className:"text-amber-500 hover:text-red-500",children:d.jsx(L0,{size:12})})]})]})}),d.jsx("td",{className:"p-2 text-right w-24",children:y===W.id?d.jsx("input",{type:"number",className:"w-full p-1 text-right text-xs border rounded",value:m[W.id]?.rate??W.unit,onChange:Se=>g(W.id,"rate",Se.target.value)}):Me(W.unit,"INR",!1)}),d.jsx("td",{className:"p-2 text-center border-l border-slate-100 dark:border-slate-700 w-16",children:y===W.id?d.jsx("input",{type:"number",className:"w-full p-1 text-center text-xs border rounded",value:m[W.id]?.qty??W.qty,onChange:Se=>g(W.id,"qty",Se.target.value)}):W.qty}),d.jsx("td",{className:"p-2 text-right text-slate-500 w-24",children:Me(W.total,"INR",!1)}),d.jsx("td",{className:"p-2 text-right font-medium border-l border-slate-100 dark:border-slate-700 w-28",children:Me(W.total*S,"INR",!1)})]},W.id),jn=W=>d.jsxs("div",{className:`bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 mb-3 shadow-sm ${W.isOverridden?"ring-1 ring-amber-400 bg-amber-50 dark:bg-amber-900/10":""}`,children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("span",{className:"text-xs font-bold uppercase text-slate-500",children:W.name}),s&&d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{type:"button",onClick:()=>_(y===W.id?null:W.id),className:`p-1 rounded ${y===W.id?"bg-teal-100 text-teal-700":"text-slate-300 hover:text-teal-600"}`,children:d.jsx(To,{size:14})}),W.isOverridden&&d.jsx("button",{type:"button",onClick:()=>x(W.id),className:"text-amber-500 hover:text-red-500",children:d.jsx(L0,{size:14})})]})]}),d.jsx("div",{className:"mb-3",children:me(W)}),d.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs bg-slate-50 dark:bg-slate-700/50 p-2 rounded",children:[d.jsxs("div",{children:[d.jsx("span",{className:"block text-[9px] uppercase text-slate-400 font-bold mb-1",children:"Rate"}),y===W.id?d.jsx("input",{type:"number",className:"w-full p-1 text-right text-xs border rounded",value:m[W.id]?.rate??W.unit,onChange:Se=>g(W.id,"rate",Se.target.value)}):d.jsx("span",{className:"block font-medium dark:text-slate-200",children:Me(W.unit,"INR",!1)})]}),d.jsxs("div",{className:"text-center border-l border-slate-200 dark:border-slate-600",children:[d.jsx("span",{className:"block text-[9px] uppercase text-slate-400 font-bold mb-1",children:"Qty"}),y===W.id?d.jsx("input",{type:"number",className:"w-full p-1 text-center text-xs border rounded",value:m[W.id]?.qty??W.qty,onChange:Se=>g(W.id,"qty",Se.target.value)}):d.jsx("span",{className:"block font-medium dark:text-slate-200",children:W.qty})]}),d.jsxs("div",{className:"text-right border-l border-slate-200 dark:border-slate-600",children:[d.jsx("span",{className:"block text-[9px] uppercase text-slate-400 font-bold mb-1",children:"Total"}),d.jsx("span",{className:"block font-bold text-teal-600 dark:text-teal-400",children:Me(W.total*S,"INR",!1)})]})]})]},W.id);return d.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[d.jsx("div",{className:"hidden md:block overflow-x-auto",children:d.jsxs("table",{className:"w-full text-xs text-left border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold",children:[d.jsx("th",{className:"p-2",children:"Component Selection"}),d.jsx("th",{className:"p-2 text-right",children:"Rate (Cost)"}),d.jsx("th",{className:"p-2 text-center border-l border-slate-200 dark:border-slate-700",children:"Qty/Scrn"}),d.jsx("th",{className:"p-2 text-right",children:"Cost/Scrn"}),d.jsx("th",{className:"p-2 text-right border-l border-slate-200 dark:border-slate-700",children:"Total Cost"})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:[d.jsx("tr",{className:"bg-slate-50 dark:bg-slate-800/50",children:d.jsx("td",{colSpan:"5",className:"p-2 font-bold text-teal-700 dark:text-teal-400 uppercase tracking-wider text-[10px]",children:"A. LED Panel & Logistics"})}),O.map(Et),d.jsx("tr",{className:"bg-white dark:bg-slate-900",children:d.jsx("td",{colSpan:"5",className:"p-2 text-center",children:d.jsxs("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"extraComponents",[...be||[],{id:E(),componentId:"",qty:1,type:"screen"}]),className:"text-[10px] text-teal-600 hover:underline flex items-center justify-center gap-1 w-full",children:[d.jsx(aa,{size:10})," Add Component to Panel"]})})}),(Array.isArray(ae)?ae:[]).map((W,Se)=>d.jsxs("tr",{className:"text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700/50 group",children:[d.jsx("td",{className:"p-2 pl-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>Wn(Se),className:"text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:d.jsx(Os,{size:12})}),d.jsx("input",{type:"text",value:W.name,onChange:Fe=>We(Se,"name",Fe.target.value),className:"text-xs border-b border-transparent hover:border-slate-300 focus:border-teal-500 bg-transparent outline-none w-full text-slate-600 dark:text-slate-300 font-medium"})]})}),d.jsx("td",{className:"p-2 text-right",children:d.jsxs("div",{className:"flex items-center justify-end gap-1",children:[d.jsx("input",{type:"number",value:W.val,onChange:Fe=>We(Se,"val",Fe.target.value),className:"w-16 p-1 text-right text-xs border rounded bg-white dark:bg-slate-800 dark:border-slate-600"}),d.jsx("button",{type:"button",onClick:()=>We(Se,"type",W.type==="abs"?"pct":"abs"),className:"px-1 text-[10px] font-bold border rounded bg-slate-100 dark:bg-slate-700",children:W.type==="abs"?"":"%"})]})}),d.jsx("td",{className:"p-2 text-center border-l border-slate-100 dark:border-slate-700 text-[10px] text-slate-400",children:W.type==="pct"?`${W.val}%`:"-"}),d.jsx("td",{className:"p-2 text-right",children:Me(Ee(W.id),"INR",!1)}),d.jsx("td",{className:"p-2 text-right border-l border-slate-100 dark:border-slate-700",children:Me(Ee(W.id)*S,"INR",!1)})]},W.id)),d.jsx("tr",{className:"bg-slate-50 dark:bg-slate-800/20",children:d.jsx("td",{colSpan:"5",className:"p-1 text-center",children:d.jsxs("button",{onClick:Yn,className:"text-[10px] text-blue-600 hover:text-blue-700 font-bold uppercase tracking-wider flex items-center justify-center gap-1 py-1 w-full hover:bg-slate-100 dark:hover:bg-slate-700 rounded transition-colors",children:[d.jsx(aa,{size:10})," Add Extra Cost"]})})}),d.jsxs("tr",{className:"bg-teal-50 dark:bg-teal-900/20 font-bold border-t border-teal-100 dark:border-teal-800",children:[d.jsx("td",{className:"p-2 text-right text-teal-800 dark:text-teal-300",children:"Sub-total (LED Panel)"}),d.jsxs("td",{className:"p-2 text-right text-teal-700 dark:text-teal-400 text-[10px] font-normal",children:[Me(de,"INR"),"/sqft"]}),d.jsx("td",{className:"p-2 text-center border-l border-teal-100 dark:border-teal-800",children:"-"}),d.jsx("td",{className:"p-2 text-right text-teal-800 dark:text-teal-300",children:Me(le,"INR",!1)}),d.jsx("td",{className:"p-2 text-right text-teal-800 dark:text-teal-300 border-l border-teal-100 dark:border-teal-800",children:Me(K,"INR",!1)})]}),d.jsx("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-700",children:d.jsx("td",{colSpan:"5",className:"p-2 font-bold text-blue-700 dark:text-blue-400 uppercase tracking-wider text-[10px]",children:"B. Additional Costs"})}),pe.map(Et),["installation","structure"].map(W=>{const Se=W==="installation"?"install":"structure",Fe=W==="installation"?"Installation":"Structure";return d.jsxs("tr",{className:"text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[d.jsx("td",{className:"p-2 pl-4",children:d.jsxs("div",{className:"flex flex-col gap-1",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-xs font-medium",children:Fe}),d.jsxs("select",{value:ee[W]?.unit||"sqft",onChange:ue=>a(e.activeScreenIndex,"commercials",{...ee,[W]:{...ee[W],unit:ue.target.value}}),className:"text-[10px] p-0.5 border rounded bg-slate-50 dark:bg-slate-700",children:[d.jsx("option",{value:"sqft",children:"/Sq.Ft"}),d.jsx("option",{value:"screen",children:"/Screen"})]})]}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("span",{className:"text-[10px] text-green-600 font-bold",children:"Sell:"}),d.jsx("input",{type:"number",className:"w-20 p-0.5 text-xs border border-green-200 rounded bg-green-50 text-green-800",value:ee[W]?.val||0,onChange:ue=>a(e.activeScreenIndex,"commercials",{...ee,[W]:{...ee[W],val:ue.target.value}})})]})]})}),d.jsx("td",{className:"p-2 text-right",children:d.jsxs("div",{className:"flex items-center justify-end gap-1",children:[d.jsx("span",{className:"text-[10px] text-slate-400 mr-1",children:"Cost:"}),d.jsx("input",{type:"number",value:ee[W]?.cost||0,onChange:ue=>a(e.activeScreenIndex,"commercials",{...ee,[W]:{...ee[W],cost:ue.target.value}}),className:"w-16 p-1 text-right text-xs border rounded bg-white dark:bg-slate-800 dark:border-slate-600"}),d.jsx("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"commercials",{...ee,[W]:{...ee[W],costType:ee[W]?.costType==="abs"?"pct":"abs"}}),className:"px-1 text-[10px] font-bold border rounded bg-slate-100 dark:bg-slate-700",children:ee[W]?.costType==="abs"?"":"%"})]})}),d.jsx("td",{className:"p-2 text-center border-l border-slate-100 dark:border-slate-700 text-xs",children:ee[W]?.unit==="sqft"?s?.matrix.sqft.perScreen.toFixed(1)||"-":"1"}),d.jsx("td",{className:"p-2 text-right",children:Me(Ee(Se),"INR",!1)}),d.jsx("td",{className:"p-2 text-right border-l border-slate-100 dark:border-slate-700",children:Me(Ee(Se)*S,"INR",!1)})]},W)}),d.jsxs("tr",{className:"bg-blue-50 dark:bg-blue-900/20 font-bold border-t border-blue-100 dark:border-blue-800",children:[d.jsx("td",{className:"p-2 text-right text-blue-800 dark:text-blue-300",children:"Sub-total (Additional)"}),d.jsxs("td",{className:"p-2 text-right text-blue-700 dark:text-blue-400 text-[10px] font-normal",children:[Me(Er,"INR"),"/sqft"]}),d.jsx("td",{className:"p-2 text-center border-l border-blue-100 dark:border-blue-800",children:"-"}),d.jsx("td",{className:"p-2 text-right text-blue-800 dark:text-blue-300",children:Me(xn,"INR",!1)}),d.jsx("td",{className:"p-2 text-right text-blue-800 dark:text-blue-300 border-l border-blue-100 dark:border-blue-800",children:Me(Ht,"INR",!1)})]}),d.jsxs("tr",{className:"bg-slate-800 text-white font-bold border-t-2 border-slate-900 text-sm",children:[d.jsx("td",{className:"p-3 text-right uppercase",children:"Grand Total (Cost)"}),d.jsxs("td",{className:"p-3 text-right text-slate-300 text-xs font-normal",children:[Me(Dn,"INR"),"/sqft"]}),d.jsx("td",{className:"p-3 text-center border-l border-slate-600",children:"-"}),d.jsx("td",{className:"p-3 text-right border-l border-slate-600",children:Me($n,"INR",!1)}),d.jsx("td",{className:"p-3 text-right border-l border-slate-600",children:Me(un,"INR",!1)})]})]})]})}),d.jsxs("div",{className:"md:hidden bg-slate-50 dark:bg-slate-800/20 p-3",children:[d.jsx("div",{className:"mb-2 font-bold text-teal-700 text-xs uppercase tracking-wider",children:"A. LED Panel & Logistics"}),O.map(jn),d.jsxs("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"extraComponents",[...be||[],{id:E(),componentId:"",qty:1,type:"screen"}]),className:"w-full py-2 mb-4 bg-white dark:bg-slate-800 border border-teal-200 dark:border-teal-700 text-teal-600 dark:text-teal-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2",children:[d.jsx(aa,{size:14})," Add Component"]}),(Array.isArray(ae)?ae:[]).map((W,Se)=>d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 mb-3 shadow-sm flex items-center justify-between",children:[d.jsx("div",{className:"flex-1",children:d.jsx("input",{type:"text",value:W.name,onChange:Fe=>We(Se,"name",Fe.target.value),className:"text-xs font-bold border-b border-transparent focus:border-teal-500 bg-transparent outline-none w-full text-slate-600 dark:text-slate-300"})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"number",value:W.val,onChange:Fe=>We(Se,"val",Fe.target.value),className:"w-12 p-1 text-right text-xs border rounded bg-slate-50 dark:bg-slate-700"}),d.jsx("button",{type:"button",onClick:()=>We(Se,"type",W.type==="abs"?"pct":"abs"),className:"px-1 text-[10px] font-bold border rounded bg-slate-100 dark:bg-slate-600",children:W.type==="abs"?"":"%"}),d.jsx("button",{onClick:()=>Wn(Se),className:"text-red-400 p-1",children:d.jsx(Os,{size:14})})]})]},W.id)),d.jsxs("button",{onClick:Yn,className:"w-full py-2 mb-4 bg-white dark:bg-slate-800 border border-blue-200 dark:border-blue-700 text-blue-600 dark:text-blue-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2",children:[d.jsx(aa,{size:14})," Add Overhead Cost"]}),d.jsxs("div",{className:"bg-teal-50 dark:bg-teal-900/20 p-3 rounded-lg border border-teal-100 dark:border-teal-800 mb-6",children:[d.jsxs("div",{className:"flex justify-between items-center text-xs font-bold text-teal-800 dark:text-teal-300",children:[d.jsx("span",{children:"Sub-total (LED Panel)"}),d.jsx("span",{children:Me(K,"INR",!1)})]}),d.jsxs("div",{className:"text-[10px] text-right text-teal-600 dark:text-teal-400 mt-1",children:[Me(de,"INR"),"/sqft"]})]}),d.jsx("div",{className:"mb-2 font-bold text-blue-700 text-xs uppercase tracking-wider",children:"B. Additional Costs"}),pe.map(jn),["installation","structure"].map(W=>{const Se=W==="installation"?"install":"structure",Fe=W==="installation"?"Installation":"Structure";return d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 mb-3 shadow-sm",children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("span",{className:"text-xs font-bold uppercase text-slate-500",children:Fe}),d.jsxs("select",{value:ee[W]?.unit||"sqft",onChange:ue=>a(e.activeScreenIndex,"commercials",{...ee,[W]:{...ee[W],unit:ue.target.value}}),className:"text-[10px] p-0.5 border rounded bg-slate-50 dark:bg-slate-700",children:[d.jsx("option",{value:"sqft",children:"/Sq.Ft"}),d.jsx("option",{value:"screen",children:"/Screen"})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[d.jsxs("div",{className:"flex items-center gap-1 bg-green-50 p-1 rounded border border-green-100",children:[d.jsx("span",{className:"text-[10px] text-green-600 font-bold",children:"Sell:"}),d.jsx("input",{type:"number",className:"w-full p-0.5 text-xs bg-transparent outline-none text-green-800 font-bold",value:ee[W]?.val||0,onChange:ue=>a(e.activeScreenIndex,"commercials",{...ee,[W]:{...ee[W],val:ue.target.value}})})]}),d.jsxs("div",{className:"flex items-center gap-1 bg-slate-50 p-1 rounded border border-slate-100",children:[d.jsx("span",{className:"text-[10px] text-slate-400",children:"Cost:"}),d.jsx("input",{type:"number",className:"w-full p-0.5 text-xs bg-transparent outline-none",value:ee[W]?.cost||0,onChange:ue=>a(e.activeScreenIndex,"commercials",{...ee,[W]:{...ee[W],cost:ue.target.value}})}),d.jsx("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"commercials",{...ee,[W]:{...ee[W],costType:ee[W]?.costType==="abs"?"pct":"abs"}}),className:"px-1 text-[10px] font-bold",children:ee[W]?.costType==="abs"?"":"%"})]})]}),d.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-slate-100 dark:border-slate-700",children:[d.jsx("span",{className:"text-[10px] text-slate-400 font-bold",children:"Total Cost"}),d.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-300",children:Me(Ee(Se)*S,"INR",!1)})]})]},W)}),d.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-100 dark:border-blue-800 mb-6",children:d.jsxs("div",{className:"flex justify-between items-center text-xs font-bold text-blue-800 dark:text-blue-300",children:[d.jsx("span",{children:"Sub-total (Additional)"}),d.jsx("span",{children:Me(Ht,"INR",!1)})]})}),d.jsxs("div",{className:"bg-slate-900 p-4 rounded-lg text-white shadow-lg",children:[d.jsxs("div",{className:"flex justify-between items-end mb-1",children:[d.jsx("span",{className:"text-xs uppercase text-slate-400 font-bold",children:"Grand Total (Cost)"}),d.jsx("span",{className:"text-lg font-bold",children:Me(un,"INR",!1)})]}),d.jsxs("div",{className:"text-[10px] text-right text-slate-500",children:[Me(Dn,"INR"),"/sqft"]})]})]})]})},L3=({user:s,inventory:e,transactions:t,state:r,setState:a,exchangeRate:l,setExchangeRate:u,onSaveQuote:m,readOnly:g=!1})=>{const{client:y,project:_,screenQty:x,targetWidth:T,targetHeight:S,unit:V,selectedIndoor:U,assemblyMode:$,sizingMode:H,margin:se,extras:te,overrides:be,editingRow:ae}=r,[ee,C]=zt.useState(null),[N,E]=zt.useState(null),[D,k]=zt.useState(!1),[j,R]=zt.useState(!1),_e=O3(r,300),Ne=q=>t?t.filter(K=>K.itemId===q).reduce((K,le)=>K+(le.type==="in"?Number(le.qty):-Number(le.qty)),0):0,z=(q,K)=>a(le=>({...le,[q]:K})),me=(q,K,le)=>{const de=r.activeScreenIndex;a(pe=>{const Ce=[...pe.screens];return Ce[de]={...Ce[de],extras:{...Ce[de].extras,[q]:{...Ce[de].extras[q],[K]:le}}},{...pe,screens:Ce}})},Ee=()=>{confirm("Reset calculator to defaults?")&&a({client:"",project:"",unit:"ft",screens:[{id:Ny(),screenQty:0,targetWidth:0,targetHeight:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",extraComponents:[],overrides:{},editingRow:null,extras:[],commercials:{processor:{val:0,unit:"screen",cost:0,costType:"abs"},installation:{val:0,unit:"sqft",cost:0,costType:"abs"},structure:{val:0,unit:"sqft",cost:0,costType:"abs"}}}],activeScreenIndex:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",margin:0,pricingMode:"margin",targetSellPrice:0,extraComponents:[],commercials:{processor:{val:0,unit:"screen"},installation:{val:0,unit:"sqft"},structure:{val:0,unit:"sqft"}},terms:{price:Pt.DEFAULTS.PRICE_BASIS,deliveryWeeks:Pt.DEFAULTS.DELIVERY_WEEKS,payment:Pt.DEFAULTS.PAYMENT_TERMS},extras:[],overrides:{},editingRow:null})},Ue=()=>{const q={id:Ny(),screenQty:1,targetWidth:0,targetHeight:0,selectedIndoor:r.selectedIndoor,assemblyMode:r.assemblyMode,selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedPSUId:"",selectedProcId:"",sizingMode:"closest",readyId:"",extraComponents:[],overrides:{},editingRow:null,extras:[],commercials:{processor:{val:0,unit:"screen",cost:0,costType:"abs"},installation:{val:0,unit:"sqft",cost:0,costType:"abs"},structure:{val:0,unit:"sqft",cost:0,costType:"abs"}}};a(K=>({...K,screens:[...K.screens,q],activeScreenIndex:K.screens.length}))},De=(q,K,le)=>{a(de=>{const pe=[...de.screens];return pe[q]={...pe[q],[K]:le},{...de,screens:pe}})},O=(q,K,le)=>{const de=r.screens[r.activeScreenIndex];De(r.activeScreenIndex,"overrides",{...de.overrides,[q]:{...de.overrides[q],[K]:le}})},ne=q=>{const le={...r.screens[r.activeScreenIndex].overrides};delete le[q],De(r.activeScreenIndex,"overrides",le),De(r.activeScreenIndex,"editingRow",null)};return zt.useEffect(()=>{if(!_e.screens||_e.screens.length===0){C(null);return}const q=_e.screens[_e.activeScreenIndex];if(!q){C(null);return}const K={..._e,...q},le=Eo(K,e,t,l);C(le)},[_e,e,l]),zt.useEffect(()=>{const K=(()=>{if(!_e.screens||_e.screens.length===0)return null;const le=_e.screens.map(pe=>{const Ce={..._e,...pe};return Eo(Ce,e,t,l)}).filter(pe=>pe!==null);if(le.length===0)return null;const de={totalProjectCost:le.reduce((pe,Ce)=>pe+Ce.totalProjectCost,0),totalProjectSell:le.reduce((pe,Ce)=>pe+Ce.totalProjectSell,0),totalLEDSell:le.reduce((pe,Ce)=>pe+Ce.matrix.led.sell*Ce.screenQty,0),totalServicesSell:le.reduce((pe,Ce)=>pe+(Ce.matrix.sell.total-Ce.matrix.led.sell*Ce.screenQty),0),totalMargin:0,totalScreenQty:le.reduce((pe,Ce)=>pe+Number(Ce.screenQty),0),calculations:le,screenConfigs:_e.screens};return de.totalMargin=de.totalProjectSell-de.totalProjectCost,de})();E(K)},[_e,e,l]),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 relative items-start",children:[j&&(ee||N)&&d.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex justify-center items-center p-4",children:d.jsxs("div",{className:"bg-white dark:bg-slate-900 max-w-5xl w-full h-[90vh] rounded-lg shadow-2xl flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center bg-slate-50 dark:bg-slate-800",children:[d.jsx("div",{className:"flex items-center gap-4",children:d.jsxs("h2",{className:"font-bold text-lg text-slate-800 dark:text-white flex items-center gap-2",children:[d.jsx(rm,{size:20,className:"text-teal-600"})," BOM"]})}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>R(!1),className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 rounded text-sm font-bold",children:"Close"}),d.jsxs("button",{onClick:()=>{const q=document.title;document.title=`${y}_${_}_BOM`.replace(/[^a-zA-Z0-9_]/g,"_"),window.print(),document.title=q},className:"px-4 py-2 bg-slate-800 text-white hover:bg-slate-700 rounded flex items-center gap-2 text-sm font-bold",children:[d.jsx(Bf,{size:16})," Print"]})]})]}),d.jsx("div",{className:"flex-1 overflow-auto bg-slate-100 dark:bg-slate-800 p-8 flex justify-center",children:d.jsx(V3,{data:ee?{...ee,clientName:y,projectName:_}:null,allScreensData:N?{...N,clientName:y,projectName:_,screenConfigs:r.screens.map(q=>({targetWidth:q.targetWidth,targetHeight:q.targetHeight,unit:V}))}:null,inventory:e,transactions:t})})]})}),D&&(ee||N)&&d.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex justify-center items-center p-4",children:d.jsxs("div",{className:"bg-white max-w-4xl w-full h-[90vh] rounded-lg shadow-2xl flex flex-col",children:[d.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-slate-100 rounded-t-lg",children:[d.jsxs("h2",{className:"font-bold text-lg text-slate-800 flex items-center gap-2",children:[d.jsx(M0,{size:20})," Print Preview"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>k(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-200 rounded",children:"Close"}),d.jsxs("button",{onClick:()=>{const q=document.title;document.title=`${y}_${_}_Quote`.replace(/[^a-zA-Z0-9_]/g,"_"),window.print(),document.title=q},className:"px-4 py-2 bg-teal-600 text-white hover:bg-teal-700 rounded flex items-center gap-2",children:[d.jsx(Bf,{size:16})," Print / Save PDF"]})]})]}),d.jsx("div",{className:"flex-1 overflow-auto p-8 bg-slate-200",children:d.jsx(TN,{data:ee?{...ee,clientName:y,projectName:_,margin:se}:null,allScreensData:N?{...N,clientName:y,projectName:_}:null,currency:"INR",exchangeRate:l})})]})}),d.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[d.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden",children:[d.jsxs("div",{className:"bg-slate-50/50 dark:bg-slate-800/50 px-4 py-3 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[d.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2 text-sm",children:[d.jsx(G2,{className:"w-4 h-4 text-teal-600"})," Project Specs"]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("button",{onClick:Ee,className:"text-[10px] font-bold text-red-500 hover:text-red-700 uppercase hover:bg-red-50 dark:hover:bg-red-900/20 px-2 py-1 rounded transition-colors mr-2 flex items-center gap-1",children:[d.jsx(L0,{size:10})," Reset"]}),d.jsxs("div",{className:"flex bg-slate-200 dark:bg-slate-700 rounded-md p-0.5",children:[d.jsx("button",{onClick:()=>z("unit","m"),className:`px-2 py-0.5 text-[10px] font-bold rounded transition-all ${V==="m"?"bg-white dark:bg-slate-600 shadow text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400"}`,children:"M"}),d.jsx("button",{onClick:()=>z("unit","ft"),className:`px-2 py-0.5 text-[10px] font-bold rounded transition-all ${V==="ft"?"bg-white dark:bg-slate-600 shadow text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400"}`,children:"FT"})]})]})]}),d.jsxs("div",{className:"p-4 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsxs("div",{className:"relative group",children:[d.jsx("label",{className:"absolute -top-1.5 left-2 bg-white dark:bg-slate-800 px-1 text-[10px] font-bold text-teal-600 dark:text-teal-400",children:"CLIENT"}),d.jsx("input",{value:y,onChange:q=>z("client",q.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded text-sm outline-none focus:border-teal-500 focus:ring-1 focus:ring-teal-500 dark:text-white transition-all",placeholder:"Client Name"})]}),d.jsxs("div",{className:"relative group",children:[d.jsx("label",{className:"absolute -top-1.5 left-2 bg-white dark:bg-slate-800 px-1 text-[10px] font-bold text-teal-600 dark:text-teal-400",children:"PROJECT"}),d.jsx("input",{value:_,onChange:q=>z("project",q.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded text-sm outline-none focus:border-teal-500 focus:ring-1 focus:ring-teal-500 dark:text-white transition-all",placeholder:"Project Ref"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsxs("div",{className:"flex items-center border border-slate-200 dark:border-slate-600 rounded-md overflow-hidden h-8",children:[d.jsx("div",{className:"bg-slate-100 dark:bg-slate-700 px-3 h-full flex items-center border-r border-slate-200 dark:border-slate-600 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase w-20 justify-center",children:"Type"}),d.jsxs("div",{className:"flex-1 flex p-0.5 bg-slate-50 dark:bg-slate-800 h-full",children:[d.jsx("button",{onClick:()=>{z("selectedIndoor","true"),De(r.activeScreenIndex,"selectedIndoor","true")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${U==="true"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Indoor"}),d.jsx("button",{onClick:()=>{z("selectedIndoor","false"),De(r.activeScreenIndex,"selectedIndoor","false")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${U==="false"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Outdoor"})]})]}),d.jsxs("div",{className:"flex items-center border border-slate-200 dark:border-slate-600 rounded-md overflow-hidden h-8",children:[d.jsx("div",{className:"bg-slate-100 dark:bg-slate-700 px-3 h-full flex items-center border-r border-slate-200 dark:border-slate-600 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase w-20 justify-center",children:"Supply"}),d.jsxs("div",{className:"flex-1 flex p-0.5 bg-slate-50 dark:bg-slate-800 h-full",children:[d.jsx("button",{onClick:()=>{z("assemblyMode","assembled"),De(r.activeScreenIndex,"assemblyMode","assembled")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${$==="assembled"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Assm"}),d.jsx("button",{onClick:()=>{z("assemblyMode","ready"),De(r.activeScreenIndex,"assemblyMode","ready")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${$==="ready"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Ready"})]})]})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Screen Configurations"}),d.jsxs("button",{onClick:Ue,className:"text-[10px] font-bold text-teal-600 dark:text-teal-400 hover:text-teal-700 dark:hover:text-teal-300 flex items-center gap-1 bg-teal-50 dark:bg-teal-900/30 px-2 py-1 rounded transition-colors border border-teal-100 dark:border-teal-800",children:[d.jsx(aa,{size:12})," Add Size"]})]}),d.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-12 gap-2 mb-1 px-2 text-[9px] font-bold text-slate-400 uppercase tracking-wider hidden md:grid",children:[d.jsx("div",{className:"col-span-1 text-center",children:"#"}),d.jsxs("div",{className:"col-span-3",children:["Width (",V,")"]}),d.jsxs("div",{className:"col-span-3",children:["Height (",V,")"]}),d.jsx("div",{className:"col-span-2 text-center",children:"Qty"}),d.jsx("div",{className:"col-span-2",children:"Sizing"}),d.jsx("div",{className:"col-span-1 text-right",children:"Actions"})]}),d.jsx("div",{className:"space-y-1 max-h-[300px] overflow-y-auto pr-1 custom-scrollbar",children:r.screens.map((q,K)=>d.jsxs("div",{onClick:()=>a({...r,activeScreenIndex:K}),className:`grid grid-cols-4 md:grid-cols-12 gap-3 items-start p-3 rounded-lg border transition-all cursor-pointer ${r.activeScreenIndex===K?"border-teal-500 ring-1 ring-teal-500 bg-teal-50/50 dark:bg-teal-900/10":"border-slate-200 dark:border-slate-700 hover:border-teal-300"}`,children:[d.jsxs("div",{className:"col-span-4 md:col-span-1 flex justify-between md:justify-center items-center border-b md:border-b-0 pb-2 md:pb-0 mb-1 md:mb-0",children:[d.jsxs("span",{className:"text-xs font-bold text-slate-500 bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded",children:["#",K+1]}),d.jsxs("div",{className:"md:hidden flex gap-3",children:[d.jsx("button",{onClick:le=>{le.stopPropagation();const de=[...r.screens],pe=Math.random().toString(36).substr(2,9);de.splice(K+1,0,{...de[K],id:pe}),a({...r,screens:de,activeScreenIndex:K+1})},className:"text-blue-500 hover:text-blue-700 bg-blue-50 p-1.5 rounded",children:d.jsx(O0,{size:16})}),r.screens.length>1&&d.jsx("button",{onClick:le=>{le.stopPropagation();const de=r.screens.filter((pe,Ce)=>Ce!==K);a({...r,screens:de,activeScreenIndex:Math.max(0,K-1)})},className:"text-red-400 hover:text-red-600 bg-red-50 p-1.5 rounded",children:d.jsx(Os,{size:16})})]})]}),d.jsxs("div",{className:"col-span-2 md:col-span-3",children:[d.jsxs("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:["Width (",r.unit,")"]}),d.jsx("input",{type:"number",value:q.targetWidth,onChange:le=>De(K,"targetWidth",le.target.value),className:"w-full p-2 text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white focus:border-teal-500 outline-none",placeholder:"W"})]}),d.jsxs("div",{className:"col-span-2 md:col-span-3",children:[d.jsxs("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:["Height (",r.unit,")"]}),d.jsx("input",{type:"number",value:q.targetHeight,onChange:le=>De(K,"targetHeight",le.target.value),className:"w-full p-2 text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white focus:border-teal-500 outline-none",placeholder:"H"})]}),d.jsxs("div",{className:"col-span-2 md:col-span-2",children:[d.jsx("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:"Qty"}),d.jsx("input",{type:"number",value:q.screenQty,onChange:le=>De(K,"screenQty",le.target.value),className:"w-full p-2 text-center text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white focus:border-teal-500 outline-none",placeholder:"Qty"})]}),d.jsxs("div",{className:"col-span-2 md:col-span-2",children:[d.jsx("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:"Sizing"}),d.jsxs("select",{value:q.sizingMode,onChange:le=>De(K,"sizingMode",le.target.value),className:"w-full p-2 text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white bg-white outline-none",children:[d.jsx("option",{value:"closest",children:"Closest"}),d.jsx("option",{value:"up",children:"Round Up"}),d.jsx("option",{value:"down",children:"Round Down"})]})]}),d.jsxs("div",{className:"hidden md:flex col-span-1 justify-end gap-1",children:[d.jsx("button",{onClick:le=>{le.stopPropagation();const de=[...r.screens],pe=Math.random().toString(36).substr(2,9);de.splice(K+1,0,{...de[K],id:pe}),a({...r,screens:de,activeScreenIndex:K+1})},className:"p-1.5 text-slate-400 hover:text-blue-500 hover:bg-blue-50 rounded transition-colors",title:"Duplicate",children:d.jsx(O0,{size:14})}),r.screens.length>1&&d.jsx("button",{onClick:le=>{le.stopPropagation();const de=r.screens.filter((pe,Ce)=>Ce!==K);a({...r,screens:de,activeScreenIndex:Math.max(0,K-1)})},className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Remove",children:d.jsx(Os,{size:14})})]})]},q.id))})]})]})]}),d.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:d.jsxs("details",{className:"group p-4",open:!0,children:[d.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[d.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[d.jsx(ky,{className:"w-4 h-4 text-teal-600"})," Hardware & Cost Breakdown",r.screens.length>1&&d.jsxs("span",{className:"text-xs font-normal text-slate-500 dark:text-slate-400",children:["(Screen #",r.activeScreenIndex+1," of ",r.screens.length,")"]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-teal-600 text-xs font-bold group-open:hidden",children:"Show Table"}),d.jsx("span",{className:"text-slate-400 text-xs hidden group-open:block",children:"Hide Table"})]})]}),d.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 dark:border-slate-700",children:[r.screens.length>1&&d.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:r.screens.map((q,K)=>{const le=r.activeScreenIndex===K,de=q.targetWidth&&q.targetHeight?`${q.targetWidth}${q.targetHeight}${V} (${q.screenQty})`:`Screen #${K+1}`;return d.jsx("button",{onClick:()=>z("activeScreenIndex",K),className:`flex-shrink-0 px-4 py-2 rounded-lg text-xs font-bold transition-all ${le?"bg-teal-600 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("span",{children:["#",K+1]}),d.jsx("span",{className:"text-[10px] opacity-75",children:de})]})},q.id)})}),r.screens[r.activeScreenIndex]&&d.jsx("div",{className:"mb-4 p-3 bg-slate-50 dark:bg-slate-700/30 rounded-lg border border-slate-200 dark:border-slate-600",children:d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Dimensions:"}),d.jsxs("span",{className:"ml-2 font-bold text-slate-800 dark:text-white",children:[r.screens[r.activeScreenIndex].targetWidth||0,"  ",r.screens[r.activeScreenIndex].targetHeight||0," ",V]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Quantity:"}),d.jsxs("span",{className:"ml-2 font-bold text-teal-600 dark:text-teal-400",children:[r.screens[r.activeScreenIndex].screenQty||0," screens"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Sizing:"}),d.jsx("span",{className:"ml-2 font-bold text-slate-800 dark:text-white capitalize",children:r.screens[r.activeScreenIndex].sizingMode})]}),ee&&d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Final Size:"}),d.jsxs("span",{className:"ml-2 font-bold text-slate-800 dark:text-white",children:[ee.finalWidth,"  ",ee.finalHeight," m"]})]})]})}),d.jsx(M3,{calculation:ee,state:r,updateState:z,updateExtra:me,updateScreenProp:De,inventory:e,getStock:Ne,overrides:r.screens[r.activeScreenIndex]?.overrides||{},onOverride:O,editingRow:r.screens[r.activeScreenIndex]?.editingRow,setEditingRow:q=>De(r.activeScreenIndex,"editingRow",q),onClearOverride:ne})]})]})}),d.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:d.jsxs("details",{className:"group p-4",children:[d.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[d.jsx("span",{className:"text-sm font-bold text-slate-600 dark:text-slate-300",children:"Terms & Conditions"}),d.jsx("span",{className:"text-teal-600 text-xs group-open:hidden",children:"Show Details"})]}),d.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-slate-100 dark:border-slate-700",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Price Basis"}),d.jsx("input",{value:r.terms?.price,onChange:q=>a(K=>({...K,terms:{...K.terms,price:q.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Delivery Weeks"}),d.jsx("input",{type:"number",value:r.terms?.deliveryWeeks,onChange:q=>a(K=>({...K,terms:{...K.terms,deliveryWeeks:q.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),d.jsxs("div",{className:"col-span-1 md:col-span-2",children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 block mb-2",children:"Payment Milestones"}),(r.terms?.payment||[]).map((q,K)=>d.jsxs("div",{className:"flex gap-2 mb-2",children:[d.jsx("input",{value:q.name,onChange:le=>{const de=[...r.terms.payment];de[K].name=le.target.value,a(pe=>({...pe,terms:{...pe.terms,payment:de}}))},className:"flex-1 p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white",placeholder:"Milestone Name"}),d.jsx("input",{type:"number",value:q.percent,onChange:le=>{const de=[...r.terms.payment];de[K].percent=Number(le.target.value),a(pe=>({...pe,terms:{...pe.terms,payment:de}}))},className:"w-16 p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white",placeholder:"%"}),d.jsx("button",{onClick:()=>{const le=r.terms.payment.filter((de,pe)=>pe!==K);a(de=>({...de,terms:{...de.terms,payment:le}}))},className:"text-red-400",children:d.jsx(yd,{size:14})})]},K)),d.jsx("button",{onClick:()=>a(q=>({...q,terms:{...q.terms,payment:[...q.terms.payment||[],{name:"",percent:0}]}})),className:"text-xs text-teal-600 font-bold",children:"+ Add Milestone"})]}),d.jsxs("div",{className:"col-span-1 md:col-span-2 space-y-4 pt-4 border-t border-slate-100 dark:border-slate-700",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Validity"}),d.jsx("input",{value:r.terms?.validity,onChange:q=>a(K=>({...K,terms:{...K.terms,validity:q.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Warranty Terms"}),d.jsx("textarea",{rows:4,value:r.terms?.warranty,onChange:q=>a(K=>({...K,terms:{...K.terms,warranty:q.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-teal-600 dark:text-teal-400 mb-2 block",children:"Client Scope of Work"}),d.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(r.terms?.scope||{}).map(([q,K])=>d.jsxs("div",{children:[d.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase",children:q==="elec"?"Electricity":q==="net"?"Internet":q==="soft"?"Software":q==="perm"?"Permissions":q==="pc"?"Computer":q}),d.jsx("textarea",{rows:2,value:K,onChange:le=>a(de=>({...de,terms:{...de.terms,scope:{...de.terms.scope,[q]:le.target.value}}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]},q))})]})]})]})]})}),d.jsx("div",{className:"h-10"})]}),d.jsxs("div",{className:"lg:col-span-4 space-y-6 lg:sticky lg:top-24",children:[d.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700 overflow-hidden",children:[d.jsxs("div",{className:"p-5 bg-gradient-to-br from-slate-50 to-white dark:from-slate-700 dark:to-slate-800",children:[r.screens.length>1&&N&&d.jsxs("div",{className:"mb-4 pb-4 border-b border-slate-200 dark:border-slate-600",children:[d.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400 mb-2",children:"Project Summary"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[d.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-2 rounded",children:[d.jsx("div",{className:"text-[10px] text-blue-600 dark:text-blue-400 font-semibold",children:"Screen Types"}),d.jsx("div",{className:"font-bold text-blue-800 dark:text-blue-300",children:r.screens.length})]}),d.jsxs("div",{className:"bg-teal-50 dark:bg-teal-900/20 p-2 rounded",children:[d.jsx("div",{className:"text-[10px] text-teal-600 dark:text-teal-400 font-semibold",children:"Total Qty"}),d.jsx("div",{className:"font-bold text-teal-800 dark:text-teal-300",children:N.totalScreenQty})]})]})]}),d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Margin Strategy"}),d.jsxs("select",{value:r.pricingMode||"margin",onChange:q=>{const K=q.target.value;if(z("pricingMode",K),K!=="margin"&&ee){let le=0;K==="screen"?le=ee.matrix.sell.unit:K==="sqft"?le=ee.matrix.sell.sqft:K==="sqm"&&(le=ee.matrix.sell.sqft*10.7639),z("targetSellPrice",Math.round(le))}},className:"text-xs border-none bg-transparent font-bold text-teal-600 dark:text-teal-400 focus:ring-0 cursor-pointer outline-none",children:[d.jsx("option",{value:"margin",children:"Margin %"}),d.jsx("option",{value:"sqft",children:"Price / Sq.Ft"}),d.jsx("option",{value:"sqm",children:"Price / Sq.Mtr"}),d.jsx("option",{value:"screen",children:"Price / Screen"})]})]}),d.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[d.jsx("input",{type:"number",value:r.pricingMode==="margin"?se:r.targetSellPrice,onChange:q=>{const K=parseFloat(q.target.value)||0;r.pricingMode==="margin"?z("margin",K):z("targetSellPrice",K)},className:"w-24 text-center text-xl font-bold p-2 border rounded-lg bg-white dark:bg-slate-600 dark:border-slate-500 shadow-sm focus:ring-2 focus:ring-teal-500/50 outline-none dark:text-white"}),d.jsx("span",{className:"text-lg font-bold text-slate-400",children:r.pricingMode==="margin"?"%":""}),d.jsxs("div",{className:"flex-1 text-right",children:[d.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold",children:r.screens.length>1?"Total Profit":"Est. Profit"}),d.jsx("div",{className:`text-sm font-bold ${(N?N.totalMargin:ee?.matrix.margin.total||0)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:N?Me(N.totalMargin,"INR"):ee?Me(ee.matrix.margin.total,"INR"):"-"})]})]}),d.jsx("div",{className:"space-y-3 pt-4 border-t border-slate-100 dark:border-slate-600",children:r.screens.length>1?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex justify-between items-end",children:[d.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"LED Panels (All)"}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:N?Me(N.totalLEDSell,"INR"):"-"})]}),d.jsxs("div",{className:"flex justify-between items-end",children:[d.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Services & Extras"}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:N?Me(N.totalServicesSell,"INR"):"-"})]}),d.jsxs("details",{className:"group",children:[d.jsx("summary",{className:"text-[10px] text-teal-600 dark:text-teal-400 font-bold uppercase cursor-pointer hover:underline",children:"View Screen Breakdown"}),d.jsx("div",{className:"mt-2 space-y-2 pl-2 border-l-2 border-slate-200 dark:border-slate-600",children:N?.calculations.map((q,K)=>d.jsx("div",{className:"text-xs",children:d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:["Screen #",K+1,d.jsxs("span",{className:"text-[10px] ml-1",children:["(",r.screens[K].targetWidth,"",r.screens[K].targetHeight,V," ",q.screenQty,")"]})]}),d.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-300",children:Me(q.totalProjectSell,"INR")})]})},K))})]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex justify-between items-end",children:[d.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"LED Panel Price"}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:ee?Me(ee.matrix.led.sell*ee.screenQty,"INR"):"-"})]}),d.jsxs("div",{className:"flex justify-between items-end",children:[d.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Services & Extras"}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:ee?Me(ee.matrix.sell.total-ee.matrix.led.sell*ee.screenQty,"INR"):"-"})]}),d.jsxs("div",{className:"flex justify-between items-end pt-2 mt-2 border-t border-dashed border-slate-200 dark:border-slate-600",children:[d.jsx("span",{className:"text-sm font-bold text-slate-600 dark:text-slate-300",children:"Rate / Sq.Ft"}),d.jsx("span",{className:"font-bold text-slate-500 dark:text-slate-400",children:ee?Me(ee.matrix.sell.sqft,"INR"):"-"})]})]})})]}),d.jsxs("div",{className:"bg-slate-900 p-5 text-white",children:[d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsx("span",{className:"text-sm text-slate-400",children:"Grand Total (Ex. GST)"}),r.screens.length>1&&d.jsxs("span",{className:"text-xs text-teal-400 font-bold",children:[N?.totalScreenQty||0," screens"]})]}),d.jsx("div",{className:"flex justify-between items-baseline",children:d.jsx("span",{className:"text-3xl font-bold tracking-tight",children:N?Me(N.totalProjectSell,"INR"):ee?Me(ee.totalProjectSell,"INR"):"-"})}),d.jsxs("div",{className:"flex gap-2 mt-4",children:[d.jsxs("button",{onClick:()=>R(!0),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 transition-colors border border-slate-700 py-2",children:[d.jsx(rm,{size:16,className:"text-blue-400"})," BOM"]}),d.jsxs("button",{onClick:()=>k(!0),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 transition-colors border border-slate-700 py-2",children:[d.jsx(Bf,{size:16})," Print"]}),!g&&d.jsxs("button",{onClick:()=>m(N?N.totalProjectSell:ee?.totalProjectSell),className:"flex-[2] bg-teal-600 hover:bg-teal-500 text-white font-bold rounded-lg shadow-lg shadow-teal-900/20 transition-all flex justify-center items-center gap-2 py-2",children:[d.jsx(lI,{size:18})," Save"]})]})]})]}),d.jsx("div",{className:"bg-slate-900 rounded-xl shadow-lg p-6 text-white overflow-hidden relative min-h-[250px] flex items-center justify-center",children:ee?d.jsx("div",{className:"w-full h-full flex items-center justify-center p-4",children:d.jsx(j3,{cols:ee.gridCols,rows:ee.gridRows,module:ee.moduleType,cabinet:ee.cabinetType,unit:V})}):d.jsxs("div",{className:"text-slate-500 flex flex-col items-center",children:[d.jsx(O2,{size:32,className:"mb-2 opacity-50"}),d.jsx("span",{children:"Enter dimensions"})]})})]})]})},U3=()=>{const[s,e]=lt.useState([]),[t,r]=lt.useState({username:"",password:"",role:"labour"}),[a,l]=lt.useState(!1);lt.useEffect(()=>{const g=Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("user_roles").onSnapshot(y=>{e(y.docs.map(_=>({id:_.id,..._.data()})))});return()=>g()},[]);const u=async()=>{if(!t.username||!t.password)return alert("Missing fields");l(!0);const g=ts.initializeApp(R3.options,"Secondary");try{const y=`${t.username.trim().toLowerCase()}@admire.internal`,x=(await g.auth().createUserWithEmailAndPassword(y,t.password)).user.uid;await Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("user_roles").doc(x).set({username:t.username.trim().toLowerCase(),role:t.role,createdAt:new Date().toISOString()}),r({username:"",password:"",role:"labour"}),alert("User created successfully")}catch(y){alert("Error: "+y.message)}finally{g.auth().signOut(),g.delete(),l(!1)}},m=async g=>{confirm(`Remove access for ${g}? (Note: This removes their role. To fully delete login access, use Firebase Console)`)&&await Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("user_roles").doc(g).delete()};return d.jsxs("div",{className:"p-6 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[d.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 mb-6 text-slate-800 dark:text-white",children:[d.jsx(cI,{className:"text-teal-600"})," User Management"]}),d.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/30 p-4 rounded-lg border border-slate-200 dark:border-slate-700 mb-8",children:[d.jsx("h3",{className:"text-xs font-bold uppercase text-slate-500 mb-3",children:"Create New User"}),d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsx("input",{placeholder:"Username",value:t.username,onChange:g=>r({...t,username:g.target.value}),className:"flex-1 min-w-[150px] p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"}),d.jsx("input",{type:"password",placeholder:"Password",value:t.password,onChange:g=>r({...t,password:g.target.value}),className:"flex-1 min-w-[150px] p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"}),d.jsxs("select",{value:t.role,onChange:g=>r({...t,role:g.target.value}),className:"p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"labour",children:"Labour (Read Only)"}),d.jsx("option",{value:"supervisor",children:"Supervisor (Stock Write)"}),d.jsx("option",{value:"manager",children:"Manager (Full Access)"}),d.jsx("option",{value:"super_admin",children:"Super Admin"})]}),d.jsx("button",{onClick:u,disabled:a,className:"bg-teal-600 text-white px-4 py-2 rounded font-bold hover:bg-teal-700 disabled:opacity-50 text-sm",children:a?"...":d.jsx(aa,{size:18})})]})]}),d.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200 dark:border-slate-700",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 uppercase font-bold text-xs",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-3",children:"Username"}),d.jsx("th",{className:"p-3",children:"Role"}),d.jsx("th",{className:"p-3 text-right",children:"Action"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700 bg-white dark:bg-slate-800",children:s.map(g=>d.jsxs("tr",{children:[d.jsx("td",{className:"p-3 font-medium dark:text-white",children:g.id}),d.jsx("td",{className:"p-3",children:d.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${g.role==="super_admin"?"bg-purple-100 text-purple-700":g.role==="manager"?"bg-blue-100 text-blue-700":g.role==="supervisor"?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-700"}`,children:g.role})}),d.jsx("td",{className:"p-3 text-right",children:d.jsx("button",{onClick:()=>m(g.id),className:"text-red-400 hover:text-red-600 p-1 hover:bg-red-50 rounded",children:d.jsx(Os,{size:16})})})]},g.id))})]})})]})},z3=()=>{const[s,e]=lt.useState([]),[t,r]=lt.useState(!1),[a,l]=lt.useState(null);lt.useEffect(()=>{const T=Vt.collection("artifacts").doc(hn).collection("private").doc("system").collection("backups").orderBy("timestamp","desc").limit(20).onSnapshot(S=>{const V=S.docs.map(U=>({id:U.id,...U.data()}));if(e(V),V.length>0){const U=V.filter($=>!$.isSafetySnapshot);U.length>0&&l(new Date(U[0].timestamp))}});return()=>T()},[]);const u=async()=>{const T=Vt.collection("artifacts").doc(hn).collection("public").doc("data"),[S,V,U,$]=await Promise.all([T.collection("inventory").get(),T.collection("quotes").get(),T.collection("transactions").get(),T.collection("user_roles").get()]);return{timestamp:new Date().toISOString(),stats:{inventory:S.size,quotes:V.size,transactions:U.size,roles:$.size},data:{inventory:S.docs.map(H=>({id:H.id,...H.data()})),quotes:V.docs.map(H=>({id:H.id,...H.data()})),transactions:U.docs.map(H=>({id:H.id,...H.data()})),user_roles:$.docs.map(H=>({id:H.id,...H.data()}))}}},m=async(T,S=!1)=>{const V=T.timestamp.replace(/[:.]/g,"-"),U=S?`SAFETY-${V}`:V;await Vt.collection("artifacts").doc(hn).collection("private").doc("system").collection("backups").doc(U).set({timestamp:T.timestamp,stats:T.stats,isSafetySnapshot:S,payload:JSON.stringify(T.data)})},g=async()=>{r(!0);try{const T=await u();await m(T,!1),await _(),alert("Snapshot Created Successfully!")}catch(T){alert("Backup Failed: "+T.message)}finally{r(!1)}},y=async T=>{if(!confirm(`WARNING: You are about to restore data from ${new Date(T.timestamp).toLocaleString()}.

Current data will be overwritten.`))return;if(prompt("Type 'RESTORE' to confirm:")!=="RESTORE")return alert("Cancelled.");r(!0);try{if(!T.isSafetySnapshot){const H=await u();await m(H,!0)}const V=JSON.parse(T.payload),U=Vt.collection("artifacts").doc(hn).collection("public").doc("data"),$=async(H,se)=>{if(!se)return;const te=[];for(let be=0;be<se.length;be+=400)te.push(se.slice(be,be+400));for(const be of te){const ae=Vt.batch();be.forEach(ee=>{const C=U.collection(H).doc(ee.id);ae.set(C,ee)}),await ae.commit()}};await $("inventory",V.inventory),await $("transactions",V.transactions),await $("quotes",V.quotes),await $("user_roles",V.user_roles),alert("System Restored. A 'Safety Snapshot' of your previous data was created just in case."),window.location.reload()}catch(V){alert("Restore Failed: "+V.message)}finally{r(!1)}},_=async()=>{const T=new Date;T.setDate(T.getDate()-30);const S=await Vt.collection("artifacts").doc(hn).collection("private").doc("system").collection("backups").where("timestamp","<",T.toISOString()).get(),V=Vt.batch();S.forEach(U=>V.delete(U.ref)),await V.commit(),S.empty},x=a&&new Date-a<1440*60*1e3;return d.jsxs("div",{className:"p-6 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[d.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 mb-6 text-slate-800 dark:text-white",children:[d.jsx(Yw,{className:"text-blue-600"})," Disaster Recovery"]}),d.jsxs("div",{className:`p-4 rounded-lg mb-6 border flex flex-col md:flex-row justify-between items-center gap-4 ${x?"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800":"bg-amber-50 border-amber-200 dark:bg-amber-900/20 dark:border-amber-800"}`,children:[d.jsxs("div",{children:[d.jsxs("h3",{className:`text-sm font-bold flex items-center gap-2 ${x?"text-green-800 dark:text-green-300":"text-amber-800 dark:text-amber-300"}`,children:[x?d.jsx(x2,{size:16}):d.jsx(eC,{size:16}),x?"System is Backed Up":"Daily Backup Pending"]}),d.jsx("p",{className:"text-xs opacity-80 mt-1",children:a?`Last manual snapshot: ${a.toLocaleString()}`:"No manual backups found."})]}),d.jsxs("button",{onClick:g,disabled:t,className:`whitespace-nowrap flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-colors shadow-sm ${x?"bg-white text-green-700 border border-green-200 hover:bg-green-50":"bg-amber-600 text-white hover:bg-amber-700"}`,children:[t?d.jsx(R2,{className:"animate-spin",size:16}):d.jsx(lI,{size:16}),x?"Create New Snapshot":"Backup Now"]})]}),d.jsxs("div",{className:"mt-8",children:[d.jsx("h3",{className:"text-xs font-bold uppercase text-slate-500 mb-3",children:"Snapshot History"}),d.jsxs("div",{className:"space-y-3",children:[s.map(T=>d.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-lg ${T.isSafetySnapshot?"bg-indigo-50 border-indigo-200 dark:bg-indigo-900/20 dark:border-indigo-800":"bg-slate-50 border-slate-200 dark:bg-slate-700/30 dark:border-slate-700"}`,children:[d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-2",children:[T.isSafetySnapshot&&d.jsxs("span",{className:"bg-indigo-100 text-indigo-700 text-[10px] font-bold px-1.5 rounded border border-indigo-200 flex items-center gap-1",children:[d.jsx(K2,{size:10})," Safety Auto-Save"]}),d.jsx("div",{className:"text-sm font-bold text-slate-700 dark:text-white",children:new Date(T.timestamp).toLocaleString()})]}),d.jsxs("div",{className:"text-[10px] text-slate-500 mt-1 flex gap-2 flex-wrap",children:[d.jsxs("span",{className:"bg-white dark:bg-slate-600 px-1.5 py-0.5 rounded border border-slate-200 dark:border-slate-500",children:[" ",T.stats.inventory," Items"]}),d.jsxs("span",{className:"bg-white dark:bg-slate-600 px-1.5 py-0.5 rounded border border-slate-200 dark:border-slate-500",children:[" ",T.stats.quotes," Quotes"]}),d.jsxs("span",{className:"bg-white dark:bg-slate-600 px-1.5 py-0.5 rounded border border-slate-200 dark:border-slate-500",children:[" ",T.stats.transactions," Tx"]})]})]}),d.jsxs("button",{onClick:()=>y(T),className:"text-blue-500 hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-3 py-1.5 rounded text-xs font-bold border border-transparent hover:border-blue-200 transition-all flex items-center gap-1",children:[d.jsx(Yw,{size:12})," Restore"]})]},T.id)),s.length===0&&d.jsx("div",{className:"text-center text-xs text-slate-400 py-4",children:"No backups found."})]})]})]})},B3=()=>{const[s,e]=lt.useState({username:"",password:""}),[t,r]=lt.useState(""),a=async l=>{l.preventDefault(),r("");try{const u=`${s.username.trim().toLowerCase()}@admire.internal`;await Ay.signInWithEmailAndPassword(u,s.password)}catch{r("Invalid credentials")}};return d.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4 font-sans",children:d.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg w-full max-w-sm border border-slate-200",children:[d.jsxs("div",{className:"flex flex-col items-center mb-6",children:[d.jsx("img",{src:"/AdmireLED/logo.png",alt:"Logo",className:"h-12 mb-4"}),d.jsx("h1",{className:"text-xl font-bold text-slate-800",children:"Staff Portal"}),d.jsx("p",{className:"text-slate-500 text-xs",children:"Please log in to continue"})]}),d.jsxs("form",{onSubmit:a,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Username"}),d.jsxs("div",{className:"relative",children:[d.jsx(nC,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),d.jsx("input",{type:"text",className:"w-full pl-10 p-2 text-sm border rounded focus:ring-2 focus:ring-teal-500 outline-none",placeholder:"Enter username",value:s.username,onChange:l=>e({...s,username:l.target.value})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Password"}),d.jsxs("div",{className:"relative",children:[d.jsx(k2,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),d.jsx("input",{type:"password",className:"w-full pl-10 p-2 text-sm border rounded focus:ring-2 focus:ring-teal-500 outline-none",placeholder:"Enter password",value:s.password,onChange:l=>e({...s,password:l.target.value})})]})]}),t&&d.jsx("div",{className:"text-red-500 text-xs text-center font-bold bg-red-50 p-2 rounded",children:t}),d.jsx("button",{type:"submit",className:"w-full bg-teal-600 text-white py-2 rounded-lg font-bold hover:bg-teal-700 transition shadow-sm text-sm",children:"Login"})]})]})})},q3=()=>{const[s,e]=lt.useState(null),[t,r]=lt.useState(null),[a,l]=lt.useState("quote"),[u,m]=lt.useState(!0),[g,y]=lt.useState(!1),[_,x]=lt.useState([]),[T,S]=lt.useState([]),[V,U]=lt.useState(!1),[$,H]=lt.useState(Pt.DEFAULTS.EXCHANGE_RATE),se={client:"",project:"",unit:"m",screens:[{id:Ny(),screenQty:0,targetWidth:0,targetHeight:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",extraComponents:[],overrides:{},editingRow:null,extras:[],commercials:{processor:{val:0,unit:"screen",cost:0,costType:"abs"},installation:{val:0,unit:"sqft",cost:0,costType:"abs"},structure:{val:0,unit:"sqft",cost:0,costType:"abs"}}}],activeScreenIndex:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",margin:0,targetSellPrice:0,pricingMode:"margin",commercials:{processor:{val:0,unit:"screen"},installation:{val:0,unit:"sqft"},structure:{val:0,unit:"sqft"}},terms:{price:Pt.DEFAULTS.PRICE_BASIS,deliveryWeeks:Pt.DEFAULTS.DELIVERY_WEEKS,payment:Pt.DEFAULTS.PAYMENT_TERMS,validity:Pt.TEXT.VALIDITY,warranty:Pt.TEXT.WARRANTY,scope:{structure:Pt.TEXT.SCOPE_STRUCTURE,elec:Pt.TEXT.SCOPE_ELEC,net:Pt.TEXT.SCOPE_NET,soft:Pt.TEXT.SCOPE_SOFT,perm:Pt.TEXT.SCOPE_PERM,pc:Pt.TEXT.SCOPE_PC}},extraComponents:[],extras:[],overrides:{},editingRow:null},[te,be]=lt.useState(se);lt.useEffect(()=>{const j=Ay.onAuthStateChanged(async R=>{if(R){const _e=R.email.split("@")[0].toLowerCase();e({...R,username:_e});const Ne=await Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("user_roles").doc(R.uid).get();Ne.exists?r(Ne.data().role):r(_e==="admin"?"super_admin":"labour")}else e(null),r(null);m(!1)});return()=>j()},[]),lt.useEffect(()=>{if(!s||!Vt)return;const j=Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("inventory").onSnapshot(_e=>x(_e.docs.map(Ne=>({id:Ne.id,...Ne.data()})))),R=Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("transactions").onSnapshot(_e=>S(_e.docs.map(Ne=>({id:Ne.id,...Ne.data()}))));return()=>{j(),R()}},[s]),lt.useEffect(()=>{document.documentElement.classList.toggle("dark",V)},[V]);const ae=()=>Ay.signOut(),ee=async j=>{if(!te.client||!te.project)return alert("Please enter Client and Project names.");let R=null;if(te.screens&&te.screens.length>0){const _e=te.screens.map(Ne=>{const z={...te,...Ne};return Eo(z,_,T,$)}).filter(Ne=>Ne!==null);_e.length>0&&(R={totalProjectCost:_e.reduce((Ne,z)=>Ne+z.totalProjectCost,0),totalProjectSell:_e.reduce((Ne,z)=>Ne+z.totalProjectSell,0),totalLEDSell:_e.reduce((Ne,z)=>Ne+z.matrix.led.sell*z.screenQty,0),totalServicesSell:_e.reduce((Ne,z)=>Ne+(z.matrix.sell.total-z.matrix.led.sell*z.screenQty),0),totalMargin:0,totalScreenQty:_e.reduce((Ne,z)=>Ne+z.screenQty,0),calculations:_e,screenConfigs:te.screens},R.totalMargin=R.totalProjectSell-R.totalProjectCost)}try{await Vt.collection("artifacts").doc(hn).collection("public").doc("data").collection("quotes").add({client:te.client,project:te.project,calculatorState:te,finalAmount:j||0,screenCount:te.screens.length,totalScreenQty:R?.totalScreenQty||0,allScreensData:R,updatedAt:new Date}),alert("Quote Saved Successfully!")}catch{alert("Error saving quote.")}},C=(j,R)=>{const _e={...se,...j.calculatorState};_e.terms={...se.terms,...j.calculatorState.terms||{},scope:{...se.terms.scope,...j.calculatorState.terms?.scope||{}}},R&&(_e.client=_e.client+" (Copy)",_e.project=_e.project+" (Copy)"),be(_e),l("quote")};if(u)return d.jsx("div",{className:"h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})});if(!s)return d.jsx(B3,{});const N=["super_admin"].includes(t),E=["labour","supervisor"].includes(t),D=["labour","supervisor"].includes(t),k=["labour"].includes(t);return d.jsxs("div",{className:"min-h-screen no-print pb-20 bg-slate-50 dark:bg-slate-900 transition-colors font-sans text-slate-900 dark:text-slate-100",children:[d.jsxs("nav",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-0 z-50 px-4 md:px-6 h-16 flex items-center justify-between shadow-sm",children:[d.jsx("div",{className:"flex items-center gap-3",children:d.jsx("img",{src:"/AdmireLED/logo.png",alt:"Logo",className:"h-10 w-auto"})}),d.jsxs("div",{className:"flex gap-4 items-center",children:[d.jsxs("div",{className:"hidden md:flex gap-1 bg-slate-100 dark:bg-slate-700 p-1 rounded-lg",children:[d.jsx("button",{onClick:()=>l("quote"),className:`px-4 py-1.5 rounded-md text-sm font-semibold transition-all ${a==="quote"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Calculator"}),d.jsx("button",{onClick:()=>l("inventory"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${a==="inventory"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Components"}),d.jsx("button",{onClick:()=>l("ledger"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${a==="ledger"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Stock"}),d.jsx("button",{onClick:()=>l("saved"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${a==="saved"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Quotes"}),N&&d.jsx("button",{onClick:()=>l("admin"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${a==="admin"?"bg-white dark:bg-slate-600 shadow-sm text-purple-600 dark:text-purple-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Admin"})]}),d.jsxs("div",{className:"flex items-center gap-2 pl-4 border-l border-slate-200 dark:border-slate-700",children:[d.jsxs("div",{className:"text-right mr-2 hidden lg:block",children:[d.jsx("div",{className:"text-[10px] font-bold text-teal-600 dark:text-teal-400 uppercase",children:t?.replace("_"," ")}),d.jsx("div",{className:"text-[10px] text-slate-400",children:s.username})]}),d.jsx("button",{onClick:ae,className:"hidden md:block p-2 bg-slate-100 dark:bg-slate-700 hover:bg-red-50 dark:hover:bg-red-900/20 text-slate-500 dark:text-slate-400 hover:text-red-500 rounded-lg transition-colors",children:d.jsx($w,{size:18})}),d.jsx("button",{onClick:()=>U(!V),className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-400 transition-colors",children:V?d.jsx(X2,{size:18}):d.jsx(L2,{size:18})}),d.jsx("button",{onClick:()=>y(!g),className:"md:hidden p-2 text-slate-600 dark:text-slate-300",children:g?d.jsx(yd,{size:24}):d.jsx(P2,{size:24})})]})]})]}),g&&d.jsx("div",{className:"md:hidden bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 shadow-xl absolute w-full z-50 animate-in slide-in-from-top-2",children:d.jsxs("div",{className:"flex flex-col p-2 space-y-1",children:[d.jsxs("button",{onClick:()=>{l("quote"),y(!1)},className:`p-3 rounded-lg text-sm font-bold text-left flex items-center gap-3 ${a==="quote"?"bg-teal-50 text-teal-700 dark:bg-slate-700 dark:text-teal-400":"text-slate-600 dark:text-slate-400"}`,children:[d.jsx(b2,{size:18})," Calculator"]}),d.jsxs("button",{onClick:()=>{l("inventory"),y(!1)},className:`p-3 rounded-lg text-sm font-bold text-left flex items-center gap-3 ${a==="inventory"?"bg-teal-50 text-teal-700 dark:bg-slate-700 dark:text-teal-400":"text-slate-600 dark:text-slate-400"}`,children:[d.jsx(ky,{size:18})," Components"]}),d.jsxs("button",{onClick:()=>{l("ledger"),y(!1)},className:`p-3 rounded-lg text-sm font-bold text-left flex items-center gap-3 ${a==="ledger"?"bg-teal-50 text-teal-700 dark:bg-slate-700 dark:text-teal-400":"text-slate-600 dark:text-slate-400"}`,children:[d.jsx(oI,{size:18})," Stock Ledger"]}),d.jsxs("button",{onClick:()=>{l("saved"),y(!1)},className:`p-3 rounded-lg text-sm font-bold text-left flex items-center gap-3 ${a==="saved"?"bg-teal-50 text-teal-700 dark:bg-slate-700 dark:text-teal-400":"text-slate-600 dark:text-slate-400"}`,children:[d.jsx(rm,{size:18})," Quotes"]}),N&&d.jsxs("button",{onClick:()=>{l("admin"),y(!1)},className:`p-3 rounded-lg text-sm font-bold text-left flex items-center gap-3 ${a==="admin"?"bg-purple-50 text-purple-700 dark:bg-slate-700 dark:text-purple-400":"text-slate-600 dark:text-slate-400"}`,children:[d.jsx(cI,{size:18})," Admin"]}),d.jsx("div",{className:"border-t border-slate-100 dark:border-slate-700 my-2 pt-2",children:d.jsxs("button",{onClick:ae,className:"w-full p-3 rounded-lg text-sm font-bold text-left flex items-center gap-3 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",children:[d.jsx($w,{size:18})," Logout"]})})]})}),d.jsxs("main",{className:"max-w-[1600px] mx-auto p-4 md:p-6",children:[a==="inventory"&&d.jsx(C3,{user:s,transactions:T,readOnly:D,exchangeRate:$}),a==="ledger"&&d.jsx(k3,{user:s,inventory:_,transactions:T,readOnly:k}),a==="saved"&&d.jsx(P3,{user:s,inventory:_,transactions:T,exchangeRate:$,onLoadQuote:C,readOnly:E}),a==="admin"&&N&&d.jsxs("div",{className:"space-y-8 animate-in fade-in duration-300",children:[d.jsx(U3,{user:s}),d.jsx(z3,{})]}),a==="quote"&&d.jsx(L3,{user:s,inventory:_,transactions:T,state:te,setState:be,exchangeRate:$,setExchangeRate:H,onSaveQuote:ee,readOnly:E})]})]})};u2.createRoot(document.getElementById("root")).render(d.jsx(zt.StrictMode,{children:d.jsx(q3,{})}));
