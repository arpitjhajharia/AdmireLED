(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function Ry(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var c0={exports:{}},Ou={};var Vw;function WR(){if(Vw)return Ou;Vw=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var p in a)p!=="key"&&(l[p]=a[p])}else l=a;return a=l.ref,{$$typeof:s,type:r,key:u,ref:a!==void 0?a:null,props:l}}return Ou.Fragment=e,Ou.jsx=t,Ou.jsxs=t,Ou}var Ow;function XR(){return Ow||(Ow=1,c0.exports=WR()),c0.exports}var d=XR(),u0={exports:{}},Oe={};var Mw;function JR(){if(Mw)return Oe;Mw=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),I=Symbol.iterator;function S(V){return V===null||typeof V!="object"?null:(V=I&&V[I]||V["@@iterator"],typeof V=="function"?V:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z=Object.assign,ee={};function Q(V,te,B){this.props=V,this.context=te,this.refs=ee,this.updater=B||M}Q.prototype.isReactComponent={},Q.prototype.setState=function(V,te){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,te,"setState")},Q.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function ae(){}ae.prototype=Q.prototype;function se(V,te,B){this.props=V,this.context=te,this.refs=ee,this.updater=B||M}var xe=se.prototype=new ae;xe.constructor=se,z(xe,Q.prototype),xe.isPureReactComponent=!0;var oe=Array.isArray;function Z(){}var k={H:null,A:null,T:null,S:null},x=Object.prototype.hasOwnProperty;function R(V,te,B){var G=B.ref;return{$$typeof:s,type:V,key:te,ref:G!==void 0?G:null,props:B}}function D(V,te){return R(V.type,te,V.props)}function C(V){return typeof V=="object"&&V!==null&&V.$$typeof===s}function P(V){var te={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(B){return te[B]})}var N=/\/+/g;function we(V,te){return typeof V=="object"&&V!==null&&V.key!=null?P(""+V.key):te.toString(36)}function Ye(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(Z,Z):(V.status="pending",V.then(function(te){V.status==="pending"&&(V.status="fulfilled",V.value=te)},function(te){V.status==="pending"&&(V.status="rejected",V.reason=te)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function K(V,te,B,G,le){var de=typeof V;(de==="undefined"||de==="boolean")&&(V=null);var pe=!1;if(V===null)pe=!0;else switch(de){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(V.$$typeof){case s:case e:pe=!0;break;case b:return pe=V._init,K(pe(V._payload),te,B,G,le)}}if(pe)return le=le(V),pe=G===""?"."+we(V,0):G,oe(le)?(B="",pe!=null&&(B=pe.replace(N,"$&/")+"/"),K(le,te,B,"",function(lr){return lr})):le!=null&&(C(le)&&(le=D(le,B+(le.key==null||V&&V.key===le.key?"":(""+le.key).replace(N,"$&/")+"/")+pe)),te.push(le)),1;pe=0;var Re=G===""?".":G+":";if(oe(V))for(var nt=0;nt<V.length;nt++)G=V[nt],de=Re+we(G,nt),pe+=K(G,te,B,de,le);else if(nt=S(V),typeof nt=="function")for(V=nt.call(V),nt=0;!(G=V.next()).done;)G=G.value,de=Re+we(G,nt++),pe+=K(G,te,B,de,le);else if(de==="object"){if(typeof V.then=="function")return K(Ye(V),te,B,G,le);throw te=String(V),Error("Objects are not valid as a React child (found: "+(te==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":te)+"). If you meant to render a collection of children, use an array instead.")}return pe}function me(V,te,B){if(V==null)return V;var G=[],le=0;return K(V,G,"","",function(de){return te.call(B,de,le++)}),G}function Ee(V){if(V._status===-1){var te=V._result;te=te(),te.then(function(B){(V._status===0||V._status===-1)&&(V._status=1,V._result=B)},function(B){(V._status===0||V._status===-1)&&(V._status=2,V._result=B)}),V._status===-1&&(V._status=0,V._result=te)}if(V._status===1)return V._result.default;throw V._result}var Me=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var te=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(te))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},ke={map:me,forEach:function(V,te,B){me(V,function(){te.apply(this,arguments)},B)},count:function(V){var te=0;return me(V,function(){te++}),te},toArray:function(V){return me(V,function(te){return te})||[]},only:function(V){if(!C(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return Oe.Activity=E,Oe.Children=ke,Oe.Component=Q,Oe.Fragment=t,Oe.Profiler=a,Oe.PureComponent=se,Oe.StrictMode=r,Oe.Suspense=y,Oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Oe.__COMPILER_RUNTIME={__proto__:null,c:function(V){return k.H.useMemoCache(V)}},Oe.cache=function(V){return function(){return V.apply(null,arguments)}},Oe.cacheSignal=function(){return null},Oe.cloneElement=function(V,te,B){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var G=z({},V.props),le=V.key;if(te!=null)for(de in te.key!==void 0&&(le=""+te.key),te)!x.call(te,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&te.ref===void 0||(G[de]=te[de]);var de=arguments.length-2;if(de===1)G.children=B;else if(1<de){for(var pe=Array(de),Re=0;Re<de;Re++)pe[Re]=arguments[Re+2];G.children=pe}return R(V.type,le,G)},Oe.createContext=function(V){return V={$$typeof:u,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:l,_context:V},V},Oe.createElement=function(V,te,B){var G,le={},de=null;if(te!=null)for(G in te.key!==void 0&&(de=""+te.key),te)x.call(te,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(le[G]=te[G]);var pe=arguments.length-2;if(pe===1)le.children=B;else if(1<pe){for(var Re=Array(pe),nt=0;nt<pe;nt++)Re[nt]=arguments[nt+2];le.children=Re}if(V&&V.defaultProps)for(G in pe=V.defaultProps,pe)le[G]===void 0&&(le[G]=pe[G]);return R(V,de,le)},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(V){return{$$typeof:p,render:V}},Oe.isValidElement=C,Oe.lazy=function(V){return{$$typeof:b,_payload:{_status:-1,_result:V},_init:Ee}},Oe.memo=function(V,te){return{$$typeof:m,type:V,compare:te===void 0?null:te}},Oe.startTransition=function(V){var te=k.T,B={};k.T=B;try{var G=V(),le=k.S;le!==null&&le(B,G),typeof G=="object"&&G!==null&&typeof G.then=="function"&&G.then(Z,Me)}catch(de){Me(de)}finally{te!==null&&B.types!==null&&(te.types=B.types),k.T=te}},Oe.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},Oe.use=function(V){return k.H.use(V)},Oe.useActionState=function(V,te,B){return k.H.useActionState(V,te,B)},Oe.useCallback=function(V,te){return k.H.useCallback(V,te)},Oe.useContext=function(V){return k.H.useContext(V)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(V,te){return k.H.useDeferredValue(V,te)},Oe.useEffect=function(V,te){return k.H.useEffect(V,te)},Oe.useEffectEvent=function(V){return k.H.useEffectEvent(V)},Oe.useId=function(){return k.H.useId()},Oe.useImperativeHandle=function(V,te,B){return k.H.useImperativeHandle(V,te,B)},Oe.useInsertionEffect=function(V,te){return k.H.useInsertionEffect(V,te)},Oe.useLayoutEffect=function(V,te){return k.H.useLayoutEffect(V,te)},Oe.useMemo=function(V,te){return k.H.useMemo(V,te)},Oe.useOptimistic=function(V,te){return k.H.useOptimistic(V,te)},Oe.useReducer=function(V,te,B){return k.H.useReducer(V,te,B)},Oe.useRef=function(V){return k.H.useRef(V)},Oe.useState=function(V){return k.H.useState(V)},Oe.useSyncExternalStore=function(V,te,B){return k.H.useSyncExternalStore(V,te,B)},Oe.useTransition=function(){return k.H.useTransition()},Oe.version="19.2.3",Oe}var Lw;function Cy(){return Lw||(Lw=1,u0.exports=JR()),u0.exports}var bt=Cy();const Lt=Ry(bt);var d0={exports:{}},Mu={},h0={exports:{}},f0={};var Uw;function ZR(){return Uw||(Uw=1,(function(s){function e(K,me){var Ee=K.length;K.push(me);e:for(;0<Ee;){var Me=Ee-1>>>1,ke=K[Me];if(0<a(ke,me))K[Me]=me,K[Ee]=ke,Ee=Me;else break e}}function t(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var me=K[0],Ee=K.pop();if(Ee!==me){K[0]=Ee;e:for(var Me=0,ke=K.length,V=ke>>>1;Me<V;){var te=2*(Me+1)-1,B=K[te],G=te+1,le=K[G];if(0>a(B,Ee))G<ke&&0>a(le,B)?(K[Me]=le,K[G]=Ee,Me=G):(K[Me]=B,K[te]=Ee,Me=te);else if(G<ke&&0>a(le,Ee))K[Me]=le,K[G]=Ee,Me=G;else break e}}return me}function a(K,me){var Ee=K.sortIndex-me.sortIndex;return Ee!==0?Ee:K.id-me.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var u=Date,p=u.now();s.unstable_now=function(){return u.now()-p}}var y=[],m=[],b=1,E=null,I=3,S=!1,M=!1,z=!1,ee=!1,Q=typeof setTimeout=="function"?setTimeout:null,ae=typeof clearTimeout=="function"?clearTimeout:null,se=typeof setImmediate<"u"?setImmediate:null;function xe(K){for(var me=t(m);me!==null;){if(me.callback===null)r(m);else if(me.startTime<=K)r(m),me.sortIndex=me.expirationTime,e(y,me);else break;me=t(m)}}function oe(K){if(z=!1,xe(K),!M)if(t(y)!==null)M=!0,Z||(Z=!0,P());else{var me=t(m);me!==null&&Ye(oe,me.startTime-K)}}var Z=!1,k=-1,x=5,R=-1;function D(){return ee?!0:!(s.unstable_now()-R<x)}function C(){if(ee=!1,Z){var K=s.unstable_now();R=K;var me=!0;try{e:{M=!1,z&&(z=!1,ae(k),k=-1),S=!0;var Ee=I;try{t:{for(xe(K),E=t(y);E!==null&&!(E.expirationTime>K&&D());){var Me=E.callback;if(typeof Me=="function"){E.callback=null,I=E.priorityLevel;var ke=Me(E.expirationTime<=K);if(K=s.unstable_now(),typeof ke=="function"){E.callback=ke,xe(K),me=!0;break t}E===t(y)&&r(y),xe(K)}else r(y);E=t(y)}if(E!==null)me=!0;else{var V=t(m);V!==null&&Ye(oe,V.startTime-K),me=!1}}break e}finally{E=null,I=Ee,S=!1}me=void 0}}finally{me?P():Z=!1}}}var P;if(typeof se=="function")P=function(){se(C)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,we=N.port2;N.port1.onmessage=C,P=function(){we.postMessage(null)}}else P=function(){Q(C,0)};function Ye(K,me){k=Q(function(){K(s.unstable_now())},me)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(K){K.callback=null},s.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<K?Math.floor(1e3/K):5},s.unstable_getCurrentPriorityLevel=function(){return I},s.unstable_next=function(K){switch(I){case 1:case 2:case 3:var me=3;break;default:me=I}var Ee=I;I=me;try{return K()}finally{I=Ee}},s.unstable_requestPaint=function(){ee=!0},s.unstable_runWithPriority=function(K,me){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var Ee=I;I=K;try{return me()}finally{I=Ee}},s.unstable_scheduleCallback=function(K,me,Ee){var Me=s.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?Me+Ee:Me):Ee=Me,K){case 1:var ke=-1;break;case 2:ke=250;break;case 5:ke=1073741823;break;case 4:ke=1e4;break;default:ke=5e3}return ke=Ee+ke,K={id:b++,callback:me,priorityLevel:K,startTime:Ee,expirationTime:ke,sortIndex:-1},Ee>Me?(K.sortIndex=Ee,e(m,K),t(y)===null&&K===t(m)&&(z?(ae(k),k=-1):z=!0,Ye(oe,Ee-Me))):(K.sortIndex=ke,e(y,K),M||S||(M=!0,Z||(Z=!0,P()))),K},s.unstable_shouldYield=D,s.unstable_wrapCallback=function(K){var me=I;return function(){var Ee=I;I=me;try{return K.apply(this,arguments)}finally{I=Ee}}}})(f0)),f0}var zw;function eC(){return zw||(zw=1,h0.exports=ZR()),h0.exports}var m0={exports:{}},Dn={};var Bw;function tC(){if(Bw)return Dn;Bw=1;var s=Cy();function e(y){var m="https://react.dev/errors/"+y;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)m+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+y+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(y,m,b){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:E==null?null:""+E,children:y,containerInfo:m,implementation:b}}var u=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(y,m){if(y==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Dn.createPortal=function(y,m){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return l(y,m,null,b)},Dn.flushSync=function(y){var m=u.T,b=r.p;try{if(u.T=null,r.p=2,y)return y()}finally{u.T=m,r.p=b,r.d.f()}},Dn.preconnect=function(y,m){typeof y=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(y,m))},Dn.prefetchDNS=function(y){typeof y=="string"&&r.d.D(y)},Dn.preinit=function(y,m){if(typeof y=="string"&&m&&typeof m.as=="string"){var b=m.as,E=p(b,m.crossOrigin),I=typeof m.integrity=="string"?m.integrity:void 0,S=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;b==="style"?r.d.S(y,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:E,integrity:I,fetchPriority:S}):b==="script"&&r.d.X(y,{crossOrigin:E,integrity:I,fetchPriority:S,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Dn.preinitModule=function(y,m){if(typeof y=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var b=p(m.as,m.crossOrigin);r.d.M(y,{crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(y)},Dn.preload=function(y,m){if(typeof y=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var b=m.as,E=p(b,m.crossOrigin);r.d.L(y,b,{crossOrigin:E,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Dn.preloadModule=function(y,m){if(typeof y=="string")if(m){var b=p(m.as,m.crossOrigin);r.d.m(y,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:b,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(y)},Dn.requestFormReset=function(y){r.d.r(y)},Dn.unstable_batchedUpdates=function(y,m){return y(m)},Dn.useFormState=function(y,m,b){return u.H.useFormState(y,m,b)},Dn.useFormStatus=function(){return u.H.useHostTransitionStatus()},Dn.version="19.2.3",Dn}var qw;function nI(){if(qw)return m0.exports;qw=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),m0.exports=tC(),m0.exports}var Fw;function nC(){if(Fw)return Mu;Fw=1;var s=eC(),e=Cy(),t=nI();function r(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,o=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(o=i.return),n=i.return;while(n)}return i.tag===3?o:null}function u(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function p(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function y(n){if(l(n)!==n)throw Error(r(188))}function m(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(r(188));return i!==n?null:n}for(var o=n,c=i;;){var f=o.return;if(f===null)break;var g=f.alternate;if(g===null){if(c=f.return,c!==null){o=c;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===o)return y(f),n;if(g===c)return y(f),i;g=g.sibling}throw Error(r(188))}if(o.return!==c.return)o=f,c=g;else{for(var v=!1,T=f.child;T;){if(T===o){v=!0,o=f,c=g;break}if(T===c){v=!0,c=f,o=g;break}T=T.sibling}if(!v){for(T=g.child;T;){if(T===o){v=!0,o=g,c=f;break}if(T===c){v=!0,c=g,o=f;break}T=T.sibling}if(!v)throw Error(r(189))}}if(o.alternate!==c)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?n:i}function b(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=b(n),i!==null)return i;n=n.sibling}return null}var E=Object.assign,I=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),M=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),Q=Symbol.for("react.profiler"),ae=Symbol.for("react.consumer"),se=Symbol.for("react.context"),xe=Symbol.for("react.forward_ref"),oe=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),C=Symbol.iterator;function P(n){return n===null||typeof n!="object"?null:(n=C&&n[C]||n["@@iterator"],typeof n=="function"?n:null)}var N=Symbol.for("react.client.reference");function we(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===N?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case z:return"Fragment";case Q:return"Profiler";case ee:return"StrictMode";case oe:return"Suspense";case Z:return"SuspenseList";case R:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case M:return"Portal";case se:return n.displayName||"Context";case ae:return(n._context.displayName||"Context")+".Consumer";case xe:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case k:return i=n.displayName||null,i!==null?i:we(n.type)||"Memo";case x:i=n._payload,n=n._init;try{return we(n(i))}catch{}}return null}var Ye=Array.isArray,K=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ee={pending:!1,data:null,method:null,action:null},Me=[],ke=-1;function V(n){return{current:n}}function te(n){0>ke||(n.current=Me[ke],Me[ke]=null,ke--)}function B(n,i){ke++,Me[ke]=n.current,n.current=i}var G=V(null),le=V(null),de=V(null),pe=V(null);function Re(n,i){switch(B(de,i),B(le,n),B(G,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?sw(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=sw(i),n=iw(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}te(G),B(G,n)}function nt(){te(G),te(le),te(de)}function lr(n){n.memoizedState!==null&&B(pe,n);var i=G.current,o=iw(i,n.type);i!==o&&(B(le,n),B(G,o))}function Ft(n){le.current===n&&(te(G),te(le)),pe.current===n&&(te(pe),Du._currentValue=Ee)}var bn,Er;function cn(n){if(bn===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);bn=i&&i[1]||"",Er=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+bn+n+Er}var Kn=!1;function Cn(n,i){if(!n||Kn)return"";Kn=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(i){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(J){var $=J}Reflect.construct(n,[],ie)}else{try{ie.call()}catch(J){$=J}n.call(ie.prototype)}}else{try{throw Error()}catch(J){$=J}(ie=n())&&typeof ie.catch=="function"&&ie.catch(function(){})}}catch(J){if(J&&$&&typeof J.stack=="string")return[J.stack,$.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),v=g[0],T=g[1];if(v&&T){var j=v.split(`
`),H=T.split(`
`);for(f=c=0;c<j.length&&!j[c].includes("DetermineComponentFrameRoot");)c++;for(;f<H.length&&!H[f].includes("DetermineComponentFrameRoot");)f++;if(c===j.length||f===H.length)for(c=j.length-1,f=H.length-1;1<=c&&0<=f&&j[c]!==H[f];)f--;for(;1<=c&&0<=f;c--,f--)if(j[c]!==H[f]){if(c!==1||f!==1)do if(c--,f--,0>f||j[c]!==H[f]){var ne=`
`+j[c].replace(" at new "," at ");return n.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",n.displayName)),ne}while(1<=c&&0<=f);break}}}finally{Kn=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?cn(o):""}function $n(n,i){switch(n.tag){case 26:case 27:case 5:return cn(n.type);case 16:return cn("Lazy");case 13:return n.child!==i&&i!==null?cn("Suspense Fallback"):cn("Suspense");case 19:return cn("SuspenseList");case 0:case 15:return Cn(n.type,!1);case 11:return Cn(n.type.render,!1);case 1:return Cn(n.type,!0);case 31:return cn("Activity");default:return""}}function Yn(n){try{var i="",o=null;do i+=$n(n,o),o=n,n=n.return;while(n);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var We=Object.prototype.hasOwnProperty,wt=s.unstable_scheduleCallback,kn=s.unstable_cancelCallback,Y=s.unstable_shouldYield,Se=s.unstable_requestPaint,qe=s.unstable_now,ue=s.unstable_getCurrentPriorityLevel,Dt=s.unstable_ImmediatePriority,vn=s.unstable_UserBlockingPriority,Wt=s.unstable_NormalPriority,Pa=s.unstable_LowPriority,Fs=s.unstable_IdlePriority,Oc=s.log,Ur=s.unstable_setDisableYieldValue,Un=null,be=null;function je(n){if(typeof Oc=="function"&&Ur(n),be&&typeof be.setStrictMode=="function")try{be.setStrictMode(Un,n)}catch{}}var He=Math.clz32?Math.clz32:ja,zr=Math.log,wi=Math.LN2;function ja(n){return n>>>=0,n===0?32:31-(zr(n)/wi|0)|0}var as=256,Va=262144,Xt=4194304;function os(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function ls(n,i,o){var c=n.pendingLanes;if(c===0)return 0;var f=0,g=n.suspendedLanes,v=n.pingedLanes;n=n.warmLanes;var T=c&134217727;return T!==0?(c=T&~g,c!==0?f=os(c):(v&=T,v!==0?f=os(v):o||(o=T&~n,o!==0&&(f=os(o))))):(T=c&~g,T!==0?f=os(T):v!==0?f=os(v):o||(o=c&~n,o!==0&&(f=os(o)))),f===0?0:i!==0&&i!==f&&(i&g)===0&&(g=f&-f,o=i&-i,g>=o||g===32&&(o&4194048)!==0)?i:f}function Br(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function fp(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lh(){var n=Xt;return Xt<<=1,(Xt&62914560)===0&&(Xt=4194304),n}function cs(n){for(var i=[],o=0;31>o;o++)i.push(n);return i}function Oa(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function mp(n,i,o,c,f,g){var v=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var T=n.entanglements,j=n.expirationTimes,H=n.hiddenUpdates;for(o=v&~o;0<o;){var ne=31-He(o),ie=1<<ne;T[ne]=0,j[ne]=-1;var $=H[ne];if($!==null)for(H[ne]=null,ne=0;ne<$.length;ne++){var J=$[ne];J!==null&&(J.lane&=-536870913)}o&=~ie}c!==0&&Ma(n,c,0),g!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=g&~(v&~i))}function Ma(n,i,o){n.pendingLanes|=i,n.suspendedLanes&=~i;var c=31-He(i);n.entangledLanes|=i,n.entanglements[c]=n.entanglements[c]|1073741824|o&261930}function Mc(n,i){var o=n.entangledLanes|=i;for(n=n.entanglements;o;){var c=31-He(o),f=1<<c;f&i|n[c]&i&&(n[c]|=i),o&=~f}}function Lc(n,i){var o=i&-i;return o=(o&42)!==0?1:La(o),(o&(n.suspendedLanes|i))!==0?0:o}function La(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Hs(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function ch(){var n=me.p;return n!==0?n:(n=window.event,n===void 0?32:Nw(n.type))}function qr(n,i){var o=me.p;try{return me.p=n,i()}finally{me.p=o}}var Fr=Math.random().toString(36).slice(2),Jt="__reactFiber$"+Fr,fn="__reactProps$"+Fr,us="__reactContainer$"+Fr,$o="__reactEvents$"+Fr,pp="__reactListeners$"+Fr,uh="__reactHandles$"+Fr,dh="__reactResources$"+Fr,ds="__reactMarker$"+Fr;function Yo(n){delete n[Jt],delete n[fn],delete n[$o],delete n[pp],delete n[uh]}function hs(n){var i=n[Jt];if(i)return i;for(var o=n.parentNode;o;){if(i=o[us]||o[Jt]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(n=hw(n);n!==null;){if(o=n[Jt])return o;n=hw(n)}return i}n=o,o=n.parentNode}return null}function Tr(n){if(n=n[Jt]||n[us]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function cr(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(r(33))}function fs(n){var i=n[dh];return i||(i=n[dh]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function Zt(n){n[ds]=!0}var Uc=new Set,zc={};function ms(n,i){ps(n,i),ps(n+"Capture",i)}function ps(n,i){for(zc[n]=i,n=0;n<i.length;n++)Uc.add(i[n])}var Bc=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qc={},Fc={};function hh(n){return We.call(Fc,n)?!0:We.call(qc,n)?!1:Bc.test(n)?Fc[n]=!0:(qc[n]=!0,!1)}function Wo(n,i,o){if(hh(i))if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var c=i.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+o)}}function ur(n,i,o){if(o===null)n.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+o)}}function en(n,i,o,c){if(c===null)n.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(i,o,""+c)}}function mn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ei(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Hc(n,i,o){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,g=c.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return f.call(this)},set:function(v){o=""+v,g.call(this,v)}}),Object.defineProperty(n,i,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(v){o=""+v},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function ct(n){if(!n._valueTracker){var i=Ei(n)?"checked":"value";n._valueTracker=Hc(n,i,""+n[i])}}function Ua(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var o=i.getValue(),c="";return n&&(c=Ei(n)?n.checked?"true":"false":n.value),n=c,n!==o?(i.setValue(n),!0):!1}function gs(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var za=/[\n"\\]/g;function Wn(n){return n.replace(za,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Xo(n,i,o,c,f,g,v,T){n.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?n.type=v:n.removeAttribute("type"),i!=null?v==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+mn(i)):n.value!==""+mn(i)&&(n.value=""+mn(i)):v!=="submit"&&v!=="reset"||n.removeAttribute("value"),i!=null?Gc(n,v,mn(i)):o!=null?Gc(n,v,mn(o)):c!=null&&n.removeAttribute("value"),f==null&&g!=null&&(n.defaultChecked=!!g),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.name=""+mn(T):n.removeAttribute("name")}function fh(n,i,o,c,f,g,v,T){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(n.type=g),i!=null||o!=null){if(!(g!=="submit"&&g!=="reset"||i!=null)){ct(n);return}o=o!=null?""+mn(o):"",i=i!=null?""+mn(i):o,T||i===n.value||(n.value=i),n.defaultValue=i}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=T?n.checked:!!c,n.defaultChecked=!!c,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(n.name=v),ct(n)}function Gc(n,i,o){i==="number"&&gs(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Ti(n,i,o,c){if(n=n.options,i){i={};for(var f=0;f<o.length;f++)i["$"+o[f]]=!0;for(o=0;o<n.length;o++)f=i.hasOwnProperty("$"+n[o].value),n[o].selected!==f&&(n[o].selected=f),f&&c&&(n[o].defaultSelected=!0)}else{for(o=""+mn(o),i=null,f=0;f<n.length;f++){if(n[f].value===o){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}i!==null||n[f].disabled||(i=n[f])}i!==null&&(i.selected=!0)}}function mh(n,i,o){if(i!=null&&(i=""+mn(i),i!==n.value&&(n.value=i),o==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=o!=null?""+mn(o):""}function Ii(n,i,o,c){if(i==null){if(c!=null){if(o!=null)throw Error(r(92));if(Ye(c)){if(1<c.length)throw Error(r(93));c=c[0]}o=c}o==null&&(o=""),i=o}o=mn(i),n.defaultValue=o,c=n.textContent,c===o&&c!==""&&c!==null&&(n.value=c),ct(n)}function Xn(n,i){if(i){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=i;return}}n.textContent=i}var ph=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Qc(n,i,o){var c=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":c?n.setProperty(i,o):typeof o!="number"||o===0||ph.has(i)?i==="float"?n.cssFloat=o:n[i]=(""+o).trim():n[i]=o+"px"}function Kc(n,i,o){if(i!=null&&typeof i!="object")throw Error(r(62));if(n=n.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||i!=null&&i.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in i)c=i[f],i.hasOwnProperty(f)&&o[f]!==c&&Qc(n,f,c)}else for(var g in i)i.hasOwnProperty(g)&&Qc(n,g,i[g])}function Jo(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Si=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zo(n){return Si.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Hr(){}var $c=null;function Ir(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ai=null,ys=null;function Ba(n){var i=Tr(n);if(i&&(n=i.stateNode)){var o=n[fn]||null;e:switch(n=i.stateNode,i.type){case"input":if(Xo(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Wn(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var c=o[i];if(c!==n&&c.form===n.form){var f=c[fn]||null;if(!f)throw Error(r(90));Xo(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(i=0;i<o.length;i++)c=o[i],c.form===n.form&&Ua(c)}break e;case"textarea":mh(n,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&Ti(n,!!o.multiple,i,!1)}}}var el=!1;function Ni(n,i,o){if(el)return n(i,o);el=!0;try{var c=n(i);return c}finally{if(el=!1,(Ai!==null||ys!==null)&&(uf(),Ai&&(i=Ai,n=ys,ys=Ai=null,Ba(i),n)))for(i=0;i<n.length;i++)Ba(n[i])}}function Gr(n,i){var o=n.stateNode;if(o===null)return null;var c=o[fn]||null;if(c===null)return null;o=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(r(231,i,typeof o));return o}var Sr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qa=!1;if(Sr)try{var mt={};Object.defineProperty(mt,"passive",{get:function(){qa=!0}}),window.addEventListener("test",mt,mt),window.removeEventListener("test",mt,mt)}catch{qa=!1}var _s=null,Yc=null,Fa=null;function Wc(){if(Fa)return Fa;var n,i=Yc,o=i.length,c,f="value"in _s?_s.value:_s.textContent,g=f.length;for(n=0;n<o&&i[n]===f[n];n++);var v=o-n;for(c=1;c<=v&&i[o-c]===f[g-c];c++);return Fa=f.slice(n,1<c?1-c:void 0)}function Ha(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Gs(){return!0}function Qr(){return!1}function xn(n){function i(o,c,f,g,v){this._reactName=o,this._targetInst=f,this.type=c,this.nativeEvent=g,this.target=v,this.currentTarget=null;for(var T in n)n.hasOwnProperty(T)&&(o=n[T],this[T]=o?o(g):g[T]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Gs:Qr,this.isPropagationStopped=Qr,this}return E(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Gs)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Gs)},persist:function(){},isPersistent:Gs}),i}var Qs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bs=xn(Qs),Ri=E({},Qs,{view:0,detail:0}),Xc=xn(Ri),Ci,tl,vs,nl=E({},Ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ki,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==vs&&(vs&&n.type==="mousemove"?(Ci=n.screenX-vs.screenX,tl=n.screenY-vs.screenY):tl=Ci=0,vs=n),Ci)},movementY:function(n){return"movementY"in n?n.movementY:tl}}),Jc=xn(nl),Ga=E({},nl,{dataTransfer:0}),yh=xn(Ga),_h=E({},Ri,{relatedTarget:0}),Qa=xn(_h),Zc=E({},Qs,{animationName:0,elapsedTime:0,pseudoElement:0}),bh=xn(Zc),rl=E({},Qs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),vh=xn(rl),xh=E({},Qs,{data:0}),xs=xn(xh),wh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Eh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Th={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ih(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=Th[n])?!!i[n]:!1}function ki(){return Ih}var zn=E({},Ri,{key:function(n){if(n.key){var i=wh[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Ha(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Eh[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ki,charCode:function(n){return n.type==="keypress"?Ha(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ha(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Sh=xn(zn),Ah=E({},nl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ks=xn(Ah),h=E({},Ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ki}),_=xn(h),w=E({},Qs,{propertyName:0,elapsedTime:0,pseudoElement:0}),A=xn(w),q=E({},nl,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),X=xn(q),ge=E({},Qs,{newState:0,oldState:0}),Ue=xn(ge),Ht=[9,13,27,32],at=Sr&&"CompositionEvent"in window,St=null;Sr&&"documentMode"in document&&(St=document.documentMode);var Ar=Sr&&"TextEvent"in window&&!St,ws=Sr&&(!at||St&&8<St&&11>=St),Kr=" ",$r=!1;function Ka(n,i){switch(n){case"keyup":return Ht.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sl(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var il=!1;function vN(n,i){switch(n){case"compositionend":return sl(i);case"keypress":return i.which!==32?null:($r=!0,Kr);case"textInput":return n=i.data,n===Kr&&$r?null:n;default:return null}}function xN(n,i){if(il)return n==="compositionend"||!at&&Ka(n,i)?(n=Wc(),Fa=Yc=_s=null,il=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return ws&&i.locale!=="ko"?null:i.data;default:return null}}var wN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pb(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!wN[n.type]:i==="textarea"}function gb(n,i,o,c){Ai?ys?ys.push(c):ys=[c]:Ai=c,i=yf(i,"onChange"),0<i.length&&(o=new bs("onChange","change",null,o,c),n.push({event:o,listeners:i}))}var eu=null,tu=null;function EN(n){Jx(n,0)}function Nh(n){var i=cr(n);if(Ua(i))return n}function yb(n,i){if(n==="change")return i}var _b=!1;if(Sr){var gp;if(Sr){var yp="oninput"in document;if(!yp){var bb=document.createElement("div");bb.setAttribute("oninput","return;"),yp=typeof bb.oninput=="function"}gp=yp}else gp=!1;_b=gp&&(!document.documentMode||9<document.documentMode)}function vb(){eu&&(eu.detachEvent("onpropertychange",xb),tu=eu=null)}function xb(n){if(n.propertyName==="value"&&Nh(tu)){var i=[];gb(i,tu,n,Ir(n)),Ni(EN,i)}}function TN(n,i,o){n==="focusin"?(vb(),eu=i,tu=o,eu.attachEvent("onpropertychange",xb)):n==="focusout"&&vb()}function IN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Nh(tu)}function SN(n,i){if(n==="click")return Nh(i)}function AN(n,i){if(n==="input"||n==="change")return Nh(i)}function NN(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var dr=typeof Object.is=="function"?Object.is:NN;function nu(n,i){if(dr(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var o=Object.keys(n),c=Object.keys(i);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var f=o[c];if(!We.call(i,f)||!dr(n[f],i[f]))return!1}return!0}function wb(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Eb(n,i){var o=wb(n);n=0;for(var c;o;){if(o.nodeType===3){if(c=n+o.textContent.length,n<=i&&c>=i)return{node:o,offset:i-n};n=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=wb(o)}}function Tb(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?Tb(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Ib(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=gs(n.document);i instanceof n.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)n=i.contentWindow;else break;i=gs(n.document)}return i}function _p(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var RN=Sr&&"documentMode"in document&&11>=document.documentMode,al=null,bp=null,ru=null,vp=!1;function Sb(n,i,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;vp||al==null||al!==gs(c)||(c=al,"selectionStart"in c&&_p(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ru&&nu(ru,c)||(ru=c,c=yf(bp,"onSelect"),0<c.length&&(i=new bs("onSelect","select",null,i,o),n.push({event:i,listeners:c}),i.target=al)))}function $a(n,i){var o={};return o[n.toLowerCase()]=i.toLowerCase(),o["Webkit"+n]="webkit"+i,o["Moz"+n]="moz"+i,o}var ol={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionrun:$a("Transition","TransitionRun"),transitionstart:$a("Transition","TransitionStart"),transitioncancel:$a("Transition","TransitionCancel"),transitionend:$a("Transition","TransitionEnd")},xp={},Ab={};Sr&&(Ab=document.createElement("div").style,"AnimationEvent"in window||(delete ol.animationend.animation,delete ol.animationiteration.animation,delete ol.animationstart.animation),"TransitionEvent"in window||delete ol.transitionend.transition);function Ya(n){if(xp[n])return xp[n];if(!ol[n])return n;var i=ol[n],o;for(o in i)if(i.hasOwnProperty(o)&&o in Ab)return xp[n]=i[o];return n}var Nb=Ya("animationend"),Rb=Ya("animationiteration"),Cb=Ya("animationstart"),CN=Ya("transitionrun"),kN=Ya("transitionstart"),DN=Ya("transitioncancel"),kb=Ya("transitionend"),Db=new Map,wp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wp.push("scrollEnd");function Yr(n,i){Db.set(n,i),ms(i,[n])}var Rh=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Nr=[],ll=0,Ep=0;function Ch(){for(var n=ll,i=Ep=ll=0;i<n;){var o=Nr[i];Nr[i++]=null;var c=Nr[i];Nr[i++]=null;var f=Nr[i];Nr[i++]=null;var g=Nr[i];if(Nr[i++]=null,c!==null&&f!==null){var v=c.pending;v===null?f.next=f:(f.next=v.next,v.next=f),c.pending=f}g!==0&&Pb(o,f,g)}}function kh(n,i,o,c){Nr[ll++]=n,Nr[ll++]=i,Nr[ll++]=o,Nr[ll++]=c,Ep|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Tp(n,i,o,c){return kh(n,i,o,c),Dh(n)}function Wa(n,i){return kh(n,null,null,i),Dh(n)}function Pb(n,i,o){n.lanes|=o;var c=n.alternate;c!==null&&(c.lanes|=o);for(var f=!1,g=n.return;g!==null;)g.childLanes|=o,c=g.alternate,c!==null&&(c.childLanes|=o),g.tag===22&&(n=g.stateNode,n===null||n._visibility&1||(f=!0)),n=g,g=g.return;return n.tag===3?(g=n.stateNode,f&&i!==null&&(f=31-He(o),n=g.hiddenUpdates,c=n[f],c===null?n[f]=[i]:c.push(i),i.lane=o|536870912),g):null}function Dh(n){if(50<Iu)throw Iu=0,Pg=null,Error(r(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var cl={};function PN(n,i,o,c){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hr(n,i,o,c){return new PN(n,i,o,c)}function Ip(n){return n=n.prototype,!(!n||!n.isReactComponent)}function $s(n,i){var o=n.alternate;return o===null?(o=hr(n.tag,i,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=i,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,i=n.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function jb(n,i){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,i=o.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function Ph(n,i,o,c,f,g){var v=0;if(c=n,typeof n=="function")Ip(n)&&(v=1);else if(typeof n=="string")v=LR(n,o,G.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case R:return n=hr(31,o,i,f),n.elementType=R,n.lanes=g,n;case z:return Xa(o.children,f,g,i);case ee:v=8,f|=24;break;case Q:return n=hr(12,o,i,f|2),n.elementType=Q,n.lanes=g,n;case oe:return n=hr(13,o,i,f),n.elementType=oe,n.lanes=g,n;case Z:return n=hr(19,o,i,f),n.elementType=Z,n.lanes=g,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case se:v=10;break e;case ae:v=9;break e;case xe:v=11;break e;case k:v=14;break e;case x:v=16,c=null;break e}v=29,o=Error(r(130,n===null?"null":typeof n,"")),c=null}return i=hr(v,o,i,f),i.elementType=n,i.type=c,i.lanes=g,i}function Xa(n,i,o,c){return n=hr(7,n,c,i),n.lanes=o,n}function Sp(n,i,o){return n=hr(6,n,null,i),n.lanes=o,n}function Vb(n){var i=hr(18,null,null,0);return i.stateNode=n,i}function Ap(n,i,o){return i=hr(4,n.children!==null?n.children:[],n.key,i),i.lanes=o,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var Ob=new WeakMap;function Rr(n,i){if(typeof n=="object"&&n!==null){var o=Ob.get(n);return o!==void 0?o:(i={value:n,source:i,stack:Yn(i)},Ob.set(n,i),i)}return{value:n,source:i,stack:Yn(i)}}var ul=[],dl=0,jh=null,su=0,Cr=[],kr=0,Di=null,Es=1,Ts="";function Ys(n,i){ul[dl++]=su,ul[dl++]=jh,jh=n,su=i}function Mb(n,i,o){Cr[kr++]=Es,Cr[kr++]=Ts,Cr[kr++]=Di,Di=n;var c=Es;n=Ts;var f=32-He(c)-1;c&=~(1<<f),o+=1;var g=32-He(i)+f;if(30<g){var v=f-f%5;g=(c&(1<<v)-1).toString(32),c>>=v,f-=v,Es=1<<32-He(i)+f|o<<f|c,Ts=g+n}else Es=1<<g|o<<f|c,Ts=n}function Np(n){n.return!==null&&(Ys(n,1),Mb(n,1,0))}function Rp(n){for(;n===jh;)jh=ul[--dl],ul[dl]=null,su=ul[--dl],ul[dl]=null;for(;n===Di;)Di=Cr[--kr],Cr[kr]=null,Ts=Cr[--kr],Cr[kr]=null,Es=Cr[--kr],Cr[kr]=null}function Lb(n,i){Cr[kr++]=Es,Cr[kr++]=Ts,Cr[kr++]=Di,Es=i.id,Ts=i.overflow,Di=n}var wn=null,Et=null,et=!1,Pi=null,Dr=!1,Cp=Error(r(519));function ji(n){var i=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw iu(Rr(i,n)),Cp}function Ub(n){var i=n.stateNode,o=n.type,c=n.memoizedProps;switch(i[Jt]=n,i[fn]=c,o){case"dialog":Qe("cancel",i),Qe("close",i);break;case"iframe":case"object":case"embed":Qe("load",i);break;case"video":case"audio":for(o=0;o<Au.length;o++)Qe(Au[o],i);break;case"source":Qe("error",i);break;case"img":case"image":case"link":Qe("error",i),Qe("load",i);break;case"details":Qe("toggle",i);break;case"input":Qe("invalid",i),fh(i,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Qe("invalid",i);break;case"textarea":Qe("invalid",i),Ii(i,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||c.suppressHydrationWarning===!0||nw(i.textContent,o)?(c.popover!=null&&(Qe("beforetoggle",i),Qe("toggle",i)),c.onScroll!=null&&Qe("scroll",i),c.onScrollEnd!=null&&Qe("scrollend",i),c.onClick!=null&&(i.onclick=Hr),i=!0):i=!1,i||ji(n,!0)}function zb(n){for(wn=n.return;wn;)switch(wn.tag){case 5:case 31:case 13:Dr=!1;return;case 27:case 3:Dr=!0;return;default:wn=wn.return}}function hl(n){if(n!==wn)return!1;if(!et)return zb(n),et=!0,!1;var i=n.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||$g(n.type,n.memoizedProps)),o=!o),o&&Et&&ji(n),zb(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Et=dw(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));Et=dw(n)}else i===27?(i=Et,$i(n.type)?(n=Zg,Zg=null,Et=n):Et=i):Et=wn?jr(n.stateNode.nextSibling):null;return!0}function Ja(){Et=wn=null,et=!1}function kp(){var n=Pi;return n!==null&&(tr===null?tr=n:tr.push.apply(tr,n),Pi=null),n}function iu(n){Pi===null?Pi=[n]:Pi.push(n)}var Dp=V(null),Za=null,Ws=null;function Vi(n,i,o){B(Dp,i._currentValue),i._currentValue=o}function Xs(n){n._currentValue=Dp.current,te(Dp)}function Pp(n,i,o){for(;n!==null;){var c=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),n===o)break;n=n.return}}function jp(n,i,o,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var g=f.dependencies;if(g!==null){var v=f.child;g=g.firstContext;e:for(;g!==null;){var T=g;g=f;for(var j=0;j<i.length;j++)if(T.context===i[j]){g.lanes|=o,T=g.alternate,T!==null&&(T.lanes|=o),Pp(g.return,o,n),c||(v=null);break e}g=T.next}}else if(f.tag===18){if(v=f.return,v===null)throw Error(r(341));v.lanes|=o,g=v.alternate,g!==null&&(g.lanes|=o),Pp(v,o,n),v=null}else v=f.child;if(v!==null)v.return=f;else for(v=f;v!==null;){if(v===n){v=null;break}if(f=v.sibling,f!==null){f.return=v.return,v=f;break}v=v.return}f=v}}function fl(n,i,o,c){n=null;for(var f=i,g=!1;f!==null;){if(!g){if((f.flags&524288)!==0)g=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var v=f.alternate;if(v===null)throw Error(r(387));if(v=v.memoizedProps,v!==null){var T=f.type;dr(f.pendingProps.value,v.value)||(n!==null?n.push(T):n=[T])}}else if(f===pe.current){if(v=f.alternate,v===null)throw Error(r(387));v.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Du):n=[Du])}f=f.return}n!==null&&jp(i,n,o,c),i.flags|=262144}function Vh(n){for(n=n.firstContext;n!==null;){if(!dr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function eo(n){Za=n,Ws=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function En(n){return Bb(Za,n)}function Oh(n,i){return Za===null&&eo(n),Bb(n,i)}function Bb(n,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Ws===null){if(n===null)throw Error(r(308));Ws=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else Ws=Ws.next=i;return o}var jN=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(o,c){n.push(c)}};this.abort=function(){i.aborted=!0,n.forEach(function(o){return o()})}},VN=s.unstable_scheduleCallback,ON=s.unstable_NormalPriority,tn={$$typeof:se,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Vp(){return{controller:new jN,data:new Map,refCount:0}}function au(n){n.refCount--,n.refCount===0&&VN(ON,function(){n.controller.abort()})}var ou=null,Op=0,ml=0,pl=null;function MN(n,i){if(ou===null){var o=ou=[];Op=0,ml=Ug(),pl={status:"pending",value:void 0,then:function(c){o.push(c)}}}return Op++,i.then(qb,qb),i}function qb(){if(--Op===0&&ou!==null){pl!==null&&(pl.status="fulfilled");var n=ou;ou=null,ml=0,pl=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function LN(n,i){var o=[],c={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return n.then(function(){c.status="fulfilled",c.value=i;for(var f=0;f<o.length;f++)(0,o[f])(i)},function(f){for(c.status="rejected",c.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),c}var Fb=K.S;K.S=function(n,i){Sx=qe(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&MN(n,i),Fb!==null&&Fb(n,i)};var to=V(null);function Mp(){var n=to.current;return n!==null?n:_t.pooledCache}function Mh(n,i){i===null?B(to,to.current):B(to,i.pool)}function Hb(){var n=Mp();return n===null?null:{parent:tn._currentValue,pool:n}}var gl=Error(r(460)),Lp=Error(r(474)),Lh=Error(r(542)),Uh={then:function(){}};function Gb(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Qb(n,i,o){switch(o=n[o],o===void 0?n.push(i):o!==i&&(i.then(Hr,Hr),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,$b(n),n;default:if(typeof i.status=="string")i.then(Hr,Hr);else{if(n=_t,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=i,n.status="pending",n.then(function(c){if(i.status==="pending"){var f=i;f.status="fulfilled",f.value=c}},function(c){if(i.status==="pending"){var f=i;f.status="rejected",f.reason=c}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,$b(n),n}throw ro=i,gl}}function no(n){try{var i=n._init;return i(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(ro=o,gl):o}}var ro=null;function Kb(){if(ro===null)throw Error(r(459));var n=ro;return ro=null,n}function $b(n){if(n===gl||n===Lh)throw Error(r(483))}var yl=null,lu=0;function zh(n){var i=lu;return lu+=1,yl===null&&(yl=[]),Qb(yl,n,i)}function cu(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function Bh(n,i){throw i.$$typeof===I?Error(r(525)):(n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Yb(n){function i(L,O){if(n){var F=L.deletions;F===null?(L.deletions=[O],L.flags|=16):F.push(O)}}function o(L,O){if(!n)return null;for(;O!==null;)i(L,O),O=O.sibling;return null}function c(L){for(var O=new Map;L!==null;)L.key!==null?O.set(L.key,L):O.set(L.index,L),L=L.sibling;return O}function f(L,O){return L=$s(L,O),L.index=0,L.sibling=null,L}function g(L,O,F){return L.index=F,n?(F=L.alternate,F!==null?(F=F.index,F<O?(L.flags|=67108866,O):F):(L.flags|=67108866,O)):(L.flags|=1048576,O)}function v(L){return n&&L.alternate===null&&(L.flags|=67108866),L}function T(L,O,F,re){return O===null||O.tag!==6?(O=Sp(F,L.mode,re),O.return=L,O):(O=f(O,F),O.return=L,O)}function j(L,O,F,re){var Ce=F.type;return Ce===z?ne(L,O,F.props.children,re,F.key):O!==null&&(O.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===x&&no(Ce)===O.type)?(O=f(O,F.props),cu(O,F),O.return=L,O):(O=Ph(F.type,F.key,F.props,null,L.mode,re),cu(O,F),O.return=L,O)}function H(L,O,F,re){return O===null||O.tag!==4||O.stateNode.containerInfo!==F.containerInfo||O.stateNode.implementation!==F.implementation?(O=Ap(F,L.mode,re),O.return=L,O):(O=f(O,F.children||[]),O.return=L,O)}function ne(L,O,F,re,Ce){return O===null||O.tag!==7?(O=Xa(F,L.mode,re,Ce),O.return=L,O):(O=f(O,F),O.return=L,O)}function ie(L,O,F){if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return O=Sp(""+O,L.mode,F),O.return=L,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case S:return F=Ph(O.type,O.key,O.props,null,L.mode,F),cu(F,O),F.return=L,F;case M:return O=Ap(O,L.mode,F),O.return=L,O;case x:return O=no(O),ie(L,O,F)}if(Ye(O)||P(O))return O=Xa(O,L.mode,F,null),O.return=L,O;if(typeof O.then=="function")return ie(L,zh(O),F);if(O.$$typeof===se)return ie(L,Oh(L,O),F);Bh(L,O)}return null}function $(L,O,F,re){var Ce=O!==null?O.key:null;if(typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint")return Ce!==null?null:T(L,O,""+F,re);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case S:return F.key===Ce?j(L,O,F,re):null;case M:return F.key===Ce?H(L,O,F,re):null;case x:return F=no(F),$(L,O,F,re)}if(Ye(F)||P(F))return Ce!==null?null:ne(L,O,F,re,null);if(typeof F.then=="function")return $(L,O,zh(F),re);if(F.$$typeof===se)return $(L,O,Oh(L,F),re);Bh(L,F)}return null}function J(L,O,F,re,Ce){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return L=L.get(F)||null,T(O,L,""+re,Ce);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case S:return L=L.get(re.key===null?F:re.key)||null,j(O,L,re,Ce);case M:return L=L.get(re.key===null?F:re.key)||null,H(O,L,re,Ce);case x:return re=no(re),J(L,O,F,re,Ce)}if(Ye(re)||P(re))return L=L.get(F)||null,ne(O,L,re,Ce,null);if(typeof re.then=="function")return J(L,O,F,zh(re),Ce);if(re.$$typeof===se)return J(L,O,F,Oh(O,re),Ce);Bh(O,re)}return null}function Te(L,O,F,re){for(var Ce=null,rt=null,Ae=O,Fe=O=0,Je=null;Ae!==null&&Fe<F.length;Fe++){Ae.index>Fe?(Je=Ae,Ae=null):Je=Ae.sibling;var st=$(L,Ae,F[Fe],re);if(st===null){Ae===null&&(Ae=Je);break}n&&Ae&&st.alternate===null&&i(L,Ae),O=g(st,O,Fe),rt===null?Ce=st:rt.sibling=st,rt=st,Ae=Je}if(Fe===F.length)return o(L,Ae),et&&Ys(L,Fe),Ce;if(Ae===null){for(;Fe<F.length;Fe++)Ae=ie(L,F[Fe],re),Ae!==null&&(O=g(Ae,O,Fe),rt===null?Ce=Ae:rt.sibling=Ae,rt=Ae);return et&&Ys(L,Fe),Ce}for(Ae=c(Ae);Fe<F.length;Fe++)Je=J(Ae,L,Fe,F[Fe],re),Je!==null&&(n&&Je.alternate!==null&&Ae.delete(Je.key===null?Fe:Je.key),O=g(Je,O,Fe),rt===null?Ce=Je:rt.sibling=Je,rt=Je);return n&&Ae.forEach(function(Zi){return i(L,Zi)}),et&&Ys(L,Fe),Ce}function Pe(L,O,F,re){if(F==null)throw Error(r(151));for(var Ce=null,rt=null,Ae=O,Fe=O=0,Je=null,st=F.next();Ae!==null&&!st.done;Fe++,st=F.next()){Ae.index>Fe?(Je=Ae,Ae=null):Je=Ae.sibling;var Zi=$(L,Ae,st.value,re);if(Zi===null){Ae===null&&(Ae=Je);break}n&&Ae&&Zi.alternate===null&&i(L,Ae),O=g(Zi,O,Fe),rt===null?Ce=Zi:rt.sibling=Zi,rt=Zi,Ae=Je}if(st.done)return o(L,Ae),et&&Ys(L,Fe),Ce;if(Ae===null){for(;!st.done;Fe++,st=F.next())st=ie(L,st.value,re),st!==null&&(O=g(st,O,Fe),rt===null?Ce=st:rt.sibling=st,rt=st);return et&&Ys(L,Fe),Ce}for(Ae=c(Ae);!st.done;Fe++,st=F.next())st=J(Ae,L,Fe,st.value,re),st!==null&&(n&&st.alternate!==null&&Ae.delete(st.key===null?Fe:st.key),O=g(st,O,Fe),rt===null?Ce=st:rt.sibling=st,rt=st);return n&&Ae.forEach(function(YR){return i(L,YR)}),et&&Ys(L,Fe),Ce}function yt(L,O,F,re){if(typeof F=="object"&&F!==null&&F.type===z&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case S:e:{for(var Ce=F.key;O!==null;){if(O.key===Ce){if(Ce=F.type,Ce===z){if(O.tag===7){o(L,O.sibling),re=f(O,F.props.children),re.return=L,L=re;break e}}else if(O.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===x&&no(Ce)===O.type){o(L,O.sibling),re=f(O,F.props),cu(re,F),re.return=L,L=re;break e}o(L,O);break}else i(L,O);O=O.sibling}F.type===z?(re=Xa(F.props.children,L.mode,re,F.key),re.return=L,L=re):(re=Ph(F.type,F.key,F.props,null,L.mode,re),cu(re,F),re.return=L,L=re)}return v(L);case M:e:{for(Ce=F.key;O!==null;){if(O.key===Ce)if(O.tag===4&&O.stateNode.containerInfo===F.containerInfo&&O.stateNode.implementation===F.implementation){o(L,O.sibling),re=f(O,F.children||[]),re.return=L,L=re;break e}else{o(L,O);break}else i(L,O);O=O.sibling}re=Ap(F,L.mode,re),re.return=L,L=re}return v(L);case x:return F=no(F),yt(L,O,F,re)}if(Ye(F))return Te(L,O,F,re);if(P(F)){if(Ce=P(F),typeof Ce!="function")throw Error(r(150));return F=Ce.call(F),Pe(L,O,F,re)}if(typeof F.then=="function")return yt(L,O,zh(F),re);if(F.$$typeof===se)return yt(L,O,Oh(L,F),re);Bh(L,F)}return typeof F=="string"&&F!==""||typeof F=="number"||typeof F=="bigint"?(F=""+F,O!==null&&O.tag===6?(o(L,O.sibling),re=f(O,F),re.return=L,L=re):(o(L,O),re=Sp(F,L.mode,re),re.return=L,L=re),v(L)):o(L,O)}return function(L,O,F,re){try{lu=0;var Ce=yt(L,O,F,re);return yl=null,Ce}catch(Ae){if(Ae===gl||Ae===Lh)throw Ae;var rt=hr(29,Ae,null,L.mode);return rt.lanes=re,rt.return=L,rt}}}var so=Yb(!0),Wb=Yb(!1),Oi=!1;function Up(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zp(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Mi(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Li(n,i,o){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(ot&2)!==0){var f=c.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),c.pending=i,i=Dh(n),Pb(n,null,o),i}return kh(n,c,i,o),Dh(n)}function uu(n,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var c=i.lanes;c&=n.pendingLanes,o|=c,i.lanes=o,Mc(n,o)}}function Bp(n,i){var o=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var f=null,g=null;if(o=o.firstBaseUpdate,o!==null){do{var v={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};g===null?f=g=v:g=g.next=v,o=o.next}while(o!==null);g===null?f=g=i:g=g.next=i}else f=g=i;o={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=i:n.next=i,o.lastBaseUpdate=i}var qp=!1;function du(){if(qp){var n=pl;if(n!==null)throw n}}function hu(n,i,o,c){qp=!1;var f=n.updateQueue;Oi=!1;var g=f.firstBaseUpdate,v=f.lastBaseUpdate,T=f.shared.pending;if(T!==null){f.shared.pending=null;var j=T,H=j.next;j.next=null,v===null?g=H:v.next=H,v=j;var ne=n.alternate;ne!==null&&(ne=ne.updateQueue,T=ne.lastBaseUpdate,T!==v&&(T===null?ne.firstBaseUpdate=H:T.next=H,ne.lastBaseUpdate=j))}if(g!==null){var ie=f.baseState;v=0,ne=H=j=null,T=g;do{var $=T.lane&-536870913,J=$!==T.lane;if(J?(Xe&$)===$:(c&$)===$){$!==0&&$===ml&&(qp=!0),ne!==null&&(ne=ne.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var Te=n,Pe=T;$=i;var yt=o;switch(Pe.tag){case 1:if(Te=Pe.payload,typeof Te=="function"){ie=Te.call(yt,ie,$);break e}ie=Te;break e;case 3:Te.flags=Te.flags&-65537|128;case 0:if(Te=Pe.payload,$=typeof Te=="function"?Te.call(yt,ie,$):Te,$==null)break e;ie=E({},ie,$);break e;case 2:Oi=!0}}$=T.callback,$!==null&&(n.flags|=64,J&&(n.flags|=8192),J=f.callbacks,J===null?f.callbacks=[$]:J.push($))}else J={lane:$,tag:T.tag,payload:T.payload,callback:T.callback,next:null},ne===null?(H=ne=J,j=ie):ne=ne.next=J,v|=$;if(T=T.next,T===null){if(T=f.shared.pending,T===null)break;J=T,T=J.next,J.next=null,f.lastBaseUpdate=J,f.shared.pending=null}}while(!0);ne===null&&(j=ie),f.baseState=j,f.firstBaseUpdate=H,f.lastBaseUpdate=ne,g===null&&(f.shared.lanes=0),Fi|=v,n.lanes=v,n.memoizedState=ie}}function Xb(n,i){if(typeof n!="function")throw Error(r(191,n));n.call(i)}function Jb(n,i){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)Xb(o[n],i)}var _l=V(null),qh=V(0);function Zb(n,i){n=ai,B(qh,n),B(_l,i),ai=n|i.baseLanes}function Fp(){B(qh,ai),B(_l,_l.current)}function Hp(){ai=qh.current,te(_l),te(qh)}var fr=V(null),Pr=null;function Ui(n){var i=n.alternate;B(Gt,Gt.current&1),B(fr,n),Pr===null&&(i===null||_l.current!==null||i.memoizedState!==null)&&(Pr=n)}function Gp(n){B(Gt,Gt.current),B(fr,n),Pr===null&&(Pr=n)}function ev(n){n.tag===22?(B(Gt,Gt.current),B(fr,n),Pr===null&&(Pr=n)):zi()}function zi(){B(Gt,Gt.current),B(fr,fr.current)}function mr(n){te(fr),Pr===n&&(Pr=null),te(Gt)}var Gt=V(0);function Fh(n){for(var i=n;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Xg(o)||Jg(o)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Js=0,ze=null,pt=null,nn=null,Hh=!1,bl=!1,io=!1,Gh=0,fu=0,vl=null,UN=0;function Ot(){throw Error(r(321))}function Qp(n,i){if(i===null)return!1;for(var o=0;o<i.length&&o<n.length;o++)if(!dr(n[o],i[o]))return!1;return!0}function Kp(n,i,o,c,f,g){return Js=g,ze=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,K.H=n===null||n.memoizedState===null?Mv:lg,io=!1,g=o(c,f),io=!1,bl&&(g=nv(i,o,c,f)),tv(n),g}function tv(n){K.H=gu;var i=pt!==null&&pt.next!==null;if(Js=0,nn=pt=ze=null,Hh=!1,fu=0,vl=null,i)throw Error(r(300));n===null||rn||(n=n.dependencies,n!==null&&Vh(n)&&(rn=!0))}function nv(n,i,o,c){ze=n;var f=0;do{if(bl&&(vl=null),fu=0,bl=!1,25<=f)throw Error(r(301));if(f+=1,nn=pt=null,n.updateQueue!=null){var g=n.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}K.H=Lv,g=i(o,c)}while(bl);return g}function zN(){var n=K.H,i=n.useState()[0];return i=typeof i.then=="function"?mu(i):i,n=n.useState()[0],(pt!==null?pt.memoizedState:null)!==n&&(ze.flags|=1024),i}function $p(){var n=Gh!==0;return Gh=0,n}function Yp(n,i,o){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~o}function Wp(n){if(Hh){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Hh=!1}Js=0,nn=pt=ze=null,bl=!1,fu=Gh=0,vl=null}function Bn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nn===null?ze.memoizedState=nn=n:nn=nn.next=n,nn}function Qt(){if(pt===null){var n=ze.alternate;n=n!==null?n.memoizedState:null}else n=pt.next;var i=nn===null?ze.memoizedState:nn.next;if(i!==null)nn=i,pt=n;else{if(n===null)throw ze.alternate===null?Error(r(467)):Error(r(310));pt=n,n={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},nn===null?ze.memoizedState=nn=n:nn=nn.next=n}return nn}function Qh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function mu(n){var i=fu;return fu+=1,vl===null&&(vl=[]),n=Qb(vl,n,i),i=ze,(nn===null?i.memoizedState:nn.next)===null&&(i=i.alternate,K.H=i===null||i.memoizedState===null?Mv:lg),n}function Kh(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return mu(n);if(n.$$typeof===se)return En(n)}throw Error(r(438,String(n)))}function Xp(n){var i=null,o=ze.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var c=ze.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(i={data:c.data.map(function(f){return f.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Qh(),ze.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(n),c=0;c<n;c++)o[c]=D;return i.index++,o}function Zs(n,i){return typeof i=="function"?i(n):i}function $h(n){var i=Qt();return Jp(i,pt,n)}function Jp(n,i,o){var c=n.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=o;var f=n.baseQueue,g=c.pending;if(g!==null){if(f!==null){var v=f.next;f.next=g.next,g.next=v}i.baseQueue=f=g,c.pending=null}if(g=n.baseState,f===null)n.memoizedState=g;else{i=f.next;var T=v=null,j=null,H=i,ne=!1;do{var ie=H.lane&-536870913;if(ie!==H.lane?(Xe&ie)===ie:(Js&ie)===ie){var $=H.revertLane;if($===0)j!==null&&(j=j.next={lane:0,revertLane:0,gesture:null,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null}),ie===ml&&(ne=!0);else if((Js&$)===$){H=H.next,$===ml&&(ne=!0);continue}else ie={lane:0,revertLane:H.revertLane,gesture:null,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null},j===null?(T=j=ie,v=g):j=j.next=ie,ze.lanes|=$,Fi|=$;ie=H.action,io&&o(g,ie),g=H.hasEagerState?H.eagerState:o(g,ie)}else $={lane:ie,revertLane:H.revertLane,gesture:H.gesture,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null},j===null?(T=j=$,v=g):j=j.next=$,ze.lanes|=ie,Fi|=ie;H=H.next}while(H!==null&&H!==i);if(j===null?v=g:j.next=T,!dr(g,n.memoizedState)&&(rn=!0,ne&&(o=pl,o!==null)))throw o;n.memoizedState=g,n.baseState=v,n.baseQueue=j,c.lastRenderedState=g}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function Zp(n){var i=Qt(),o=i.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=n;var c=o.dispatch,f=o.pending,g=i.memoizedState;if(f!==null){o.pending=null;var v=f=f.next;do g=n(g,v.action),v=v.next;while(v!==f);dr(g,i.memoizedState)||(rn=!0),i.memoizedState=g,i.baseQueue===null&&(i.baseState=g),o.lastRenderedState=g}return[g,c]}function rv(n,i,o){var c=ze,f=Qt(),g=et;if(g){if(o===void 0)throw Error(r(407));o=o()}else o=i();var v=!dr((pt||f).memoizedState,o);if(v&&(f.memoizedState=o,rn=!0),f=f.queue,ng(av.bind(null,c,f,n),[n]),f.getSnapshot!==i||v||nn!==null&&nn.memoizedState.tag&1){if(c.flags|=2048,xl(9,{destroy:void 0},iv.bind(null,c,f,o,i),null),_t===null)throw Error(r(349));g||(Js&127)!==0||sv(c,i,o)}return o}function sv(n,i,o){n.flags|=16384,n={getSnapshot:i,value:o},i=ze.updateQueue,i===null?(i=Qh(),ze.updateQueue=i,i.stores=[n]):(o=i.stores,o===null?i.stores=[n]:o.push(n))}function iv(n,i,o,c){i.value=o,i.getSnapshot=c,ov(i)&&lv(n)}function av(n,i,o){return o(function(){ov(i)&&lv(n)})}function ov(n){var i=n.getSnapshot;n=n.value;try{var o=i();return!dr(n,o)}catch{return!0}}function lv(n){var i=Wa(n,2);i!==null&&nr(i,n,2)}function eg(n){var i=Bn();if(typeof n=="function"){var o=n;if(n=o(),io){je(!0);try{o()}finally{je(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:n},i}function cv(n,i,o,c){return n.baseState=o,Jp(n,pt,typeof c=="function"?c:Zs)}function BN(n,i,o,c,f){if(Xh(n))throw Error(r(485));if(n=i.action,n!==null){var g={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){g.listeners.push(v)}};K.T!==null?o(!0):g.isTransition=!1,c(g),o=i.pending,o===null?(g.next=i.pending=g,uv(i,g)):(g.next=o.next,i.pending=o.next=g)}}function uv(n,i){var o=i.action,c=i.payload,f=n.state;if(i.isTransition){var g=K.T,v={};K.T=v;try{var T=o(f,c),j=K.S;j!==null&&j(v,T),dv(n,i,T)}catch(H){tg(n,i,H)}finally{g!==null&&v.types!==null&&(g.types=v.types),K.T=g}}else try{g=o(f,c),dv(n,i,g)}catch(H){tg(n,i,H)}}function dv(n,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){hv(n,i,c)},function(c){return tg(n,i,c)}):hv(n,i,o)}function hv(n,i,o){i.status="fulfilled",i.value=o,fv(i),n.state=o,i=n.pending,i!==null&&(o=i.next,o===i?n.pending=null:(o=o.next,i.next=o,uv(n,o)))}function tg(n,i,o){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do i.status="rejected",i.reason=o,fv(i),i=i.next;while(i!==c)}n.action=null}function fv(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function mv(n,i){return i}function pv(n,i){if(et){var o=_t.formState;if(o!==null){e:{var c=ze;if(et){if(Et){t:{for(var f=Et,g=Dr;f.nodeType!==8;){if(!g){f=null;break t}if(f=jr(f.nextSibling),f===null){f=null;break t}}g=f.data,f=g==="F!"||g==="F"?f:null}if(f){Et=jr(f.nextSibling),c=f.data==="F!";break e}}ji(c)}c=!1}c&&(i=o[0])}}return o=Bn(),o.memoizedState=o.baseState=i,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mv,lastRenderedState:i},o.queue=c,o=jv.bind(null,ze,c),c.dispatch=o,c=eg(!1),g=og.bind(null,ze,!1,c.queue),c=Bn(),f={state:i,dispatch:null,action:n,pending:null},c.queue=f,o=BN.bind(null,ze,f,g,o),f.dispatch=o,c.memoizedState=n,[i,o,!1]}function gv(n){var i=Qt();return yv(i,pt,n)}function yv(n,i,o){if(i=Jp(n,i,mv)[0],n=$h(Zs)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var c=mu(i)}catch(v){throw v===gl?Lh:v}else c=i;i=Qt();var f=i.queue,g=f.dispatch;return o!==i.memoizedState&&(ze.flags|=2048,xl(9,{destroy:void 0},qN.bind(null,f,o),null)),[c,g,n]}function qN(n,i){n.action=i}function _v(n){var i=Qt(),o=pt;if(o!==null)return yv(i,o,n);Qt(),i=i.memoizedState,o=Qt();var c=o.queue.dispatch;return o.memoizedState=n,[i,c,!1]}function xl(n,i,o,c){return n={tag:n,create:o,deps:c,inst:i,next:null},i=ze.updateQueue,i===null&&(i=Qh(),ze.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=n.next=n:(c=o.next,o.next=n,n.next=c,i.lastEffect=n),n}function bv(){return Qt().memoizedState}function Yh(n,i,o,c){var f=Bn();ze.flags|=n,f.memoizedState=xl(1|i,{destroy:void 0},o,c===void 0?null:c)}function Wh(n,i,o,c){var f=Qt();c=c===void 0?null:c;var g=f.memoizedState.inst;pt!==null&&c!==null&&Qp(c,pt.memoizedState.deps)?f.memoizedState=xl(i,g,o,c):(ze.flags|=n,f.memoizedState=xl(1|i,g,o,c))}function vv(n,i){Yh(8390656,8,n,i)}function ng(n,i){Wh(2048,8,n,i)}function FN(n){ze.flags|=4;var i=ze.updateQueue;if(i===null)i=Qh(),ze.updateQueue=i,i.events=[n];else{var o=i.events;o===null?i.events=[n]:o.push(n)}}function xv(n){var i=Qt().memoizedState;return FN({ref:i,nextImpl:n}),function(){if((ot&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}function wv(n,i){return Wh(4,2,n,i)}function Ev(n,i){return Wh(4,4,n,i)}function Tv(n,i){if(typeof i=="function"){n=n();var o=i(n);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Iv(n,i,o){o=o!=null?o.concat([n]):null,Wh(4,4,Tv.bind(null,i,n),o)}function rg(){}function Sv(n,i){var o=Qt();i=i===void 0?null:i;var c=o.memoizedState;return i!==null&&Qp(i,c[1])?c[0]:(o.memoizedState=[n,i],n)}function Av(n,i){var o=Qt();i=i===void 0?null:i;var c=o.memoizedState;if(i!==null&&Qp(i,c[1]))return c[0];if(c=n(),io){je(!0);try{n()}finally{je(!1)}}return o.memoizedState=[c,i],c}function sg(n,i,o){return o===void 0||(Js&1073741824)!==0&&(Xe&261930)===0?n.memoizedState=i:(n.memoizedState=o,n=Nx(),ze.lanes|=n,Fi|=n,o)}function Nv(n,i,o,c){return dr(o,i)?o:_l.current!==null?(n=sg(n,o,c),dr(n,i)||(rn=!0),n):(Js&42)===0||(Js&1073741824)!==0&&(Xe&261930)===0?(rn=!0,n.memoizedState=o):(n=Nx(),ze.lanes|=n,Fi|=n,i)}function Rv(n,i,o,c,f){var g=me.p;me.p=g!==0&&8>g?g:8;var v=K.T,T={};K.T=T,og(n,!1,i,o);try{var j=f(),H=K.S;if(H!==null&&H(T,j),j!==null&&typeof j=="object"&&typeof j.then=="function"){var ne=LN(j,c);pu(n,i,ne,yr(n))}else pu(n,i,c,yr(n))}catch(ie){pu(n,i,{then:function(){},status:"rejected",reason:ie},yr())}finally{me.p=g,v!==null&&T.types!==null&&(v.types=T.types),K.T=v}}function HN(){}function ig(n,i,o,c){if(n.tag!==5)throw Error(r(476));var f=Cv(n).queue;Rv(n,f,i,Ee,o===null?HN:function(){return kv(n),o(c)})}function Cv(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:Ee,baseState:Ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:Ee},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:o},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function kv(n){var i=Cv(n);i.next===null&&(i=n.alternate.memoizedState),pu(n,i.next.queue,{},yr())}function ag(){return En(Du)}function Dv(){return Qt().memoizedState}function Pv(){return Qt().memoizedState}function GN(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var o=yr();n=Mi(o);var c=Li(i,n,o);c!==null&&(nr(c,i,o),uu(c,i,o)),i={cache:Vp()},n.payload=i;return}i=i.return}}function QN(n,i,o){var c=yr();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Xh(n)?Vv(i,o):(o=Tp(n,i,o,c),o!==null&&(nr(o,n,c),Ov(o,i,c)))}function jv(n,i,o){var c=yr();pu(n,i,o,c)}function pu(n,i,o,c){var f={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Xh(n))Vv(i,f);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=i.lastRenderedReducer,g!==null))try{var v=i.lastRenderedState,T=g(v,o);if(f.hasEagerState=!0,f.eagerState=T,dr(T,v))return kh(n,i,f,0),_t===null&&Ch(),!1}catch{}if(o=Tp(n,i,f,c),o!==null)return nr(o,n,c),Ov(o,i,c),!0}return!1}function og(n,i,o,c){if(c={lane:2,revertLane:Ug(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Xh(n)){if(i)throw Error(r(479))}else i=Tp(n,o,c,2),i!==null&&nr(i,n,2)}function Xh(n){var i=n.alternate;return n===ze||i!==null&&i===ze}function Vv(n,i){bl=Hh=!0;var o=n.pending;o===null?i.next=i:(i.next=o.next,o.next=i),n.pending=i}function Ov(n,i,o){if((o&4194048)!==0){var c=i.lanes;c&=n.pendingLanes,o|=c,i.lanes=o,Mc(n,o)}}var gu={readContext:En,use:Kh,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useLayoutEffect:Ot,useInsertionEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useSyncExternalStore:Ot,useId:Ot,useHostTransitionStatus:Ot,useFormState:Ot,useActionState:Ot,useOptimistic:Ot,useMemoCache:Ot,useCacheRefresh:Ot};gu.useEffectEvent=Ot;var Mv={readContext:En,use:Kh,useCallback:function(n,i){return Bn().memoizedState=[n,i===void 0?null:i],n},useContext:En,useEffect:vv,useImperativeHandle:function(n,i,o){o=o!=null?o.concat([n]):null,Yh(4194308,4,Tv.bind(null,i,n),o)},useLayoutEffect:function(n,i){return Yh(4194308,4,n,i)},useInsertionEffect:function(n,i){Yh(4,2,n,i)},useMemo:function(n,i){var o=Bn();i=i===void 0?null:i;var c=n();if(io){je(!0);try{n()}finally{je(!1)}}return o.memoizedState=[c,i],c},useReducer:function(n,i,o){var c=Bn();if(o!==void 0){var f=o(i);if(io){je(!0);try{o(i)}finally{je(!1)}}}else f=i;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=QN.bind(null,ze,n),[c.memoizedState,n]},useRef:function(n){var i=Bn();return n={current:n},i.memoizedState=n},useState:function(n){n=eg(n);var i=n.queue,o=jv.bind(null,ze,i);return i.dispatch=o,[n.memoizedState,o]},useDebugValue:rg,useDeferredValue:function(n,i){var o=Bn();return sg(o,n,i)},useTransition:function(){var n=eg(!1);return n=Rv.bind(null,ze,n.queue,!0,!1),Bn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,o){var c=ze,f=Bn();if(et){if(o===void 0)throw Error(r(407));o=o()}else{if(o=i(),_t===null)throw Error(r(349));(Xe&127)!==0||sv(c,i,o)}f.memoizedState=o;var g={value:o,getSnapshot:i};return f.queue=g,vv(av.bind(null,c,g,n),[n]),c.flags|=2048,xl(9,{destroy:void 0},iv.bind(null,c,g,o,i),null),o},useId:function(){var n=Bn(),i=_t.identifierPrefix;if(et){var o=Ts,c=Es;o=(c&~(1<<32-He(c)-1)).toString(32)+o,i="_"+i+"R_"+o,o=Gh++,0<o&&(i+="H"+o.toString(32)),i+="_"}else o=UN++,i="_"+i+"r_"+o.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:ag,useFormState:pv,useActionState:pv,useOptimistic:function(n){var i=Bn();i.memoizedState=i.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=og.bind(null,ze,!0,o),o.dispatch=i,[n,i]},useMemoCache:Xp,useCacheRefresh:function(){return Bn().memoizedState=GN.bind(null,ze)},useEffectEvent:function(n){var i=Bn(),o={impl:n};return i.memoizedState=o,function(){if((ot&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}},lg={readContext:En,use:Kh,useCallback:Sv,useContext:En,useEffect:ng,useImperativeHandle:Iv,useInsertionEffect:wv,useLayoutEffect:Ev,useMemo:Av,useReducer:$h,useRef:bv,useState:function(){return $h(Zs)},useDebugValue:rg,useDeferredValue:function(n,i){var o=Qt();return Nv(o,pt.memoizedState,n,i)},useTransition:function(){var n=$h(Zs)[0],i=Qt().memoizedState;return[typeof n=="boolean"?n:mu(n),i]},useSyncExternalStore:rv,useId:Dv,useHostTransitionStatus:ag,useFormState:gv,useActionState:gv,useOptimistic:function(n,i){var o=Qt();return cv(o,pt,n,i)},useMemoCache:Xp,useCacheRefresh:Pv};lg.useEffectEvent=xv;var Lv={readContext:En,use:Kh,useCallback:Sv,useContext:En,useEffect:ng,useImperativeHandle:Iv,useInsertionEffect:wv,useLayoutEffect:Ev,useMemo:Av,useReducer:Zp,useRef:bv,useState:function(){return Zp(Zs)},useDebugValue:rg,useDeferredValue:function(n,i){var o=Qt();return pt===null?sg(o,n,i):Nv(o,pt.memoizedState,n,i)},useTransition:function(){var n=Zp(Zs)[0],i=Qt().memoizedState;return[typeof n=="boolean"?n:mu(n),i]},useSyncExternalStore:rv,useId:Dv,useHostTransitionStatus:ag,useFormState:_v,useActionState:_v,useOptimistic:function(n,i){var o=Qt();return pt!==null?cv(o,pt,n,i):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:Xp,useCacheRefresh:Pv};Lv.useEffectEvent=xv;function cg(n,i,o,c){i=n.memoizedState,o=o(c,i),o=o==null?i:E({},i,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var ug={enqueueSetState:function(n,i,o){n=n._reactInternals;var c=yr(),f=Mi(c);f.payload=i,o!=null&&(f.callback=o),i=Li(n,f,c),i!==null&&(nr(i,n,c),uu(i,n,c))},enqueueReplaceState:function(n,i,o){n=n._reactInternals;var c=yr(),f=Mi(c);f.tag=1,f.payload=i,o!=null&&(f.callback=o),i=Li(n,f,c),i!==null&&(nr(i,n,c),uu(i,n,c))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var o=yr(),c=Mi(o);c.tag=2,i!=null&&(c.callback=i),i=Li(n,c,o),i!==null&&(nr(i,n,o),uu(i,n,o))}};function Uv(n,i,o,c,f,g,v){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,g,v):i.prototype&&i.prototype.isPureReactComponent?!nu(o,c)||!nu(f,g):!0}function zv(n,i,o,c){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,c),i.state!==n&&ug.enqueueReplaceState(i,i.state,null)}function ao(n,i){var o=i;if("ref"in i){o={};for(var c in i)c!=="ref"&&(o[c]=i[c])}if(n=n.defaultProps){o===i&&(o=E({},o));for(var f in n)o[f]===void 0&&(o[f]=n[f])}return o}function Bv(n){Rh(n)}function qv(n){console.error(n)}function Fv(n){Rh(n)}function Jh(n,i){try{var o=n.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(c){setTimeout(function(){throw c})}}function Hv(n,i,o){try{var c=n.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function dg(n,i,o){return o=Mi(o),o.tag=3,o.payload={element:null},o.callback=function(){Jh(n,i)},o}function Gv(n){return n=Mi(n),n.tag=3,n}function Qv(n,i,o,c){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var g=c.value;n.payload=function(){return f(g)},n.callback=function(){Hv(i,o,c)}}var v=o.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(n.callback=function(){Hv(i,o,c),typeof f!="function"&&(Hi===null?Hi=new Set([this]):Hi.add(this));var T=c.stack;this.componentDidCatch(c.value,{componentStack:T!==null?T:""})})}function KN(n,i,o,c,f){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(i=o.alternate,i!==null&&fl(i,o,f,!0),o=fr.current,o!==null){switch(o.tag){case 31:case 13:return Pr===null?df():o.alternate===null&&Mt===0&&(Mt=3),o.flags&=-257,o.flags|=65536,o.lanes=f,c===Uh?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([c]):i.add(c),Og(n,c,f)),!1;case 22:return o.flags|=65536,c===Uh?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([c]):o.add(c)),Og(n,c,f)),!1}throw Error(r(435,o.tag))}return Og(n,c,f),df(),!1}if(et)return i=fr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=f,c!==Cp&&(n=Error(r(422),{cause:c}),iu(Rr(n,o)))):(c!==Cp&&(i=Error(r(423),{cause:c}),iu(Rr(i,o))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Rr(c,o),f=dg(n.stateNode,c,f),Bp(n,f),Mt!==4&&(Mt=2)),!1;var g=Error(r(520),{cause:c});if(g=Rr(g,o),Tu===null?Tu=[g]:Tu.push(g),Mt!==4&&(Mt=2),i===null)return!0;c=Rr(c,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,n=f&-f,o.lanes|=n,n=dg(o.stateNode,c,n),Bp(o,n),!1;case 1:if(i=o.type,g=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Hi===null||!Hi.has(g))))return o.flags|=65536,f&=-f,o.lanes|=f,f=Gv(f),Qv(f,n,o,c),Bp(o,f),!1}o=o.return}while(o!==null);return!1}var hg=Error(r(461)),rn=!1;function Tn(n,i,o,c){i.child=n===null?Wb(i,null,o,c):so(i,n.child,o,c)}function Kv(n,i,o,c,f){o=o.render;var g=i.ref;if("ref"in c){var v={};for(var T in c)T!=="ref"&&(v[T]=c[T])}else v=c;return eo(i),c=Kp(n,i,o,v,g,f),T=$p(),n!==null&&!rn?(Yp(n,i,f),ei(n,i,f)):(et&&T&&Np(i),i.flags|=1,Tn(n,i,c,f),i.child)}function $v(n,i,o,c,f){if(n===null){var g=o.type;return typeof g=="function"&&!Ip(g)&&g.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=g,Yv(n,i,g,c,f)):(n=Ph(o.type,null,c,i,i.mode,f),n.ref=i.ref,n.return=i,i.child=n)}if(g=n.child,!vg(n,f)){var v=g.memoizedProps;if(o=o.compare,o=o!==null?o:nu,o(v,c)&&n.ref===i.ref)return ei(n,i,f)}return i.flags|=1,n=$s(g,c),n.ref=i.ref,n.return=i,i.child=n}function Yv(n,i,o,c,f){if(n!==null){var g=n.memoizedProps;if(nu(g,c)&&n.ref===i.ref)if(rn=!1,i.pendingProps=c=g,vg(n,f))(n.flags&131072)!==0&&(rn=!0);else return i.lanes=n.lanes,ei(n,i,f)}return fg(n,i,o,c,f)}function Wv(n,i,o,c){var f=c.children,g=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((i.flags&128)!==0){if(g=g!==null?g.baseLanes|o:o,n!==null){for(c=i.child=n.child,f=0;c!==null;)f=f|c.lanes|c.childLanes,c=c.sibling;c=f&~g}else c=0,i.child=null;return Xv(n,i,g,o,c)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&Mh(i,g!==null?g.cachePool:null),g!==null?Zb(i,g):Fp(),ev(i);else return c=i.lanes=536870912,Xv(n,i,g!==null?g.baseLanes|o:o,o,c)}else g!==null?(Mh(i,g.cachePool),Zb(i,g),zi(),i.memoizedState=null):(n!==null&&Mh(i,null),Fp(),zi());return Tn(n,i,f,o),i.child}function yu(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function Xv(n,i,o,c,f){var g=Mp();return g=g===null?null:{parent:tn._currentValue,pool:g},i.memoizedState={baseLanes:o,cachePool:g},n!==null&&Mh(i,null),Fp(),ev(i),n!==null&&fl(n,i,c,!0),i.childLanes=f,null}function Zh(n,i){return i=tf({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function Jv(n,i,o){return so(i,n.child,null,o),n=Zh(i,i.pendingProps),n.flags|=2,mr(i),i.memoizedState=null,n}function $N(n,i,o){var c=i.pendingProps,f=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(et){if(c.mode==="hidden")return n=Zh(i,c),i.lanes=536870912,yu(null,n);if(Gp(i),(n=Et)?(n=uw(n,Dr),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Di!==null?{id:Es,overflow:Ts}:null,retryLane:536870912,hydrationErrors:null},o=Vb(n),o.return=i,i.child=o,wn=i,Et=null)):n=null,n===null)throw ji(i);return i.lanes=536870912,null}return Zh(i,c)}var g=n.memoizedState;if(g!==null){var v=g.dehydrated;if(Gp(i),f)if(i.flags&256)i.flags&=-257,i=Jv(n,i,o);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(r(558));else if(rn||fl(n,i,o,!1),f=(o&n.childLanes)!==0,rn||f){if(c=_t,c!==null&&(v=Lc(c,o),v!==0&&v!==g.retryLane))throw g.retryLane=v,Wa(n,v),nr(c,n,v),hg;df(),i=Jv(n,i,o)}else n=g.treeContext,Et=jr(v.nextSibling),wn=i,et=!0,Pi=null,Dr=!1,n!==null&&Lb(i,n),i=Zh(i,c),i.flags|=4096;return i}return n=$s(n.child,{mode:c.mode,children:c.children}),n.ref=i.ref,i.child=n,n.return=i,n}function ef(n,i){var o=i.ref;if(o===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(n===null||n.ref!==o)&&(i.flags|=4194816)}}function fg(n,i,o,c,f){return eo(i),o=Kp(n,i,o,c,void 0,f),c=$p(),n!==null&&!rn?(Yp(n,i,f),ei(n,i,f)):(et&&c&&Np(i),i.flags|=1,Tn(n,i,o,f),i.child)}function Zv(n,i,o,c,f,g){return eo(i),i.updateQueue=null,o=nv(i,c,o,f),tv(n),c=$p(),n!==null&&!rn?(Yp(n,i,g),ei(n,i,g)):(et&&c&&Np(i),i.flags|=1,Tn(n,i,o,g),i.child)}function ex(n,i,o,c,f){if(eo(i),i.stateNode===null){var g=cl,v=o.contextType;typeof v=="object"&&v!==null&&(g=En(v)),g=new o(c,g),i.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=ug,i.stateNode=g,g._reactInternals=i,g=i.stateNode,g.props=c,g.state=i.memoizedState,g.refs={},Up(i),v=o.contextType,g.context=typeof v=="object"&&v!==null?En(v):cl,g.state=i.memoizedState,v=o.getDerivedStateFromProps,typeof v=="function"&&(cg(i,o,v,c),g.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(v=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),v!==g.state&&ug.enqueueReplaceState(g,g.state,null),hu(i,c,g,f),du(),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308),c=!0}else if(n===null){g=i.stateNode;var T=i.memoizedProps,j=ao(o,T);g.props=j;var H=g.context,ne=o.contextType;v=cl,typeof ne=="object"&&ne!==null&&(v=En(ne));var ie=o.getDerivedStateFromProps;ne=typeof ie=="function"||typeof g.getSnapshotBeforeUpdate=="function",T=i.pendingProps!==T,ne||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T||H!==v)&&zv(i,g,c,v),Oi=!1;var $=i.memoizedState;g.state=$,hu(i,c,g,f),du(),H=i.memoizedState,T||$!==H||Oi?(typeof ie=="function"&&(cg(i,o,ie,c),H=i.memoizedState),(j=Oi||Uv(i,o,j,c,$,H,v))?(ne||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(i.flags|=4194308)):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=H),g.props=c,g.state=H,g.context=v,c=j):(typeof g.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{g=i.stateNode,zp(n,i),v=i.memoizedProps,ne=ao(o,v),g.props=ne,ie=i.pendingProps,$=g.context,H=o.contextType,j=cl,typeof H=="object"&&H!==null&&(j=En(H)),T=o.getDerivedStateFromProps,(H=typeof T=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(v!==ie||$!==j)&&zv(i,g,c,j),Oi=!1,$=i.memoizedState,g.state=$,hu(i,c,g,f),du();var J=i.memoizedState;v!==ie||$!==J||Oi||n!==null&&n.dependencies!==null&&Vh(n.dependencies)?(typeof T=="function"&&(cg(i,o,T,c),J=i.memoizedState),(ne=Oi||Uv(i,o,ne,c,$,J,j)||n!==null&&n.dependencies!==null&&Vh(n.dependencies))?(H||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,J,j),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,J,j)),typeof g.componentDidUpdate=="function"&&(i.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof g.componentDidUpdate!="function"||v===n.memoizedProps&&$===n.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&$===n.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=J),g.props=c,g.state=J,g.context=j,c=ne):(typeof g.componentDidUpdate!="function"||v===n.memoizedProps&&$===n.memoizedState||(i.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||v===n.memoizedProps&&$===n.memoizedState||(i.flags|=1024),c=!1)}return g=c,ef(n,i),c=(i.flags&128)!==0,g||c?(g=i.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:g.render(),i.flags|=1,n!==null&&c?(i.child=so(i,n.child,null,f),i.child=so(i,null,o,f)):Tn(n,i,o,f),i.memoizedState=g.state,n=i.child):n=ei(n,i,f),n}function tx(n,i,o,c){return Ja(),i.flags|=256,Tn(n,i,o,c),i.child}var mg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function pg(n){return{baseLanes:n,cachePool:Hb()}}function gg(n,i,o){return n=n!==null?n.childLanes&~o:0,i&&(n|=gr),n}function nx(n,i,o){var c=i.pendingProps,f=!1,g=(i.flags&128)!==0,v;if((v=g)||(v=n!==null&&n.memoizedState===null?!1:(Gt.current&2)!==0),v&&(f=!0,i.flags&=-129),v=(i.flags&32)!==0,i.flags&=-33,n===null){if(et){if(f?Ui(i):zi(),(n=Et)?(n=uw(n,Dr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:Di!==null?{id:Es,overflow:Ts}:null,retryLane:536870912,hydrationErrors:null},o=Vb(n),o.return=i,i.child=o,wn=i,Et=null)):n=null,n===null)throw ji(i);return Jg(n)?i.lanes=32:i.lanes=536870912,null}var T=c.children;return c=c.fallback,f?(zi(),f=i.mode,T=tf({mode:"hidden",children:T},f),c=Xa(c,f,o,null),T.return=i,c.return=i,T.sibling=c,i.child=T,c=i.child,c.memoizedState=pg(o),c.childLanes=gg(n,v,o),i.memoizedState=mg,yu(null,c)):(Ui(i),yg(i,T))}var j=n.memoizedState;if(j!==null&&(T=j.dehydrated,T!==null)){if(g)i.flags&256?(Ui(i),i.flags&=-257,i=_g(n,i,o)):i.memoizedState!==null?(zi(),i.child=n.child,i.flags|=128,i=null):(zi(),T=c.fallback,f=i.mode,c=tf({mode:"visible",children:c.children},f),T=Xa(T,f,o,null),T.flags|=2,c.return=i,T.return=i,c.sibling=T,i.child=c,so(i,n.child,null,o),c=i.child,c.memoizedState=pg(o),c.childLanes=gg(n,v,o),i.memoizedState=mg,i=yu(null,c));else if(Ui(i),Jg(T)){if(v=T.nextSibling&&T.nextSibling.dataset,v)var H=v.dgst;v=H,c=Error(r(419)),c.stack="",c.digest=v,iu({value:c,source:null,stack:null}),i=_g(n,i,o)}else if(rn||fl(n,i,o,!1),v=(o&n.childLanes)!==0,rn||v){if(v=_t,v!==null&&(c=Lc(v,o),c!==0&&c!==j.retryLane))throw j.retryLane=c,Wa(n,c),nr(v,n,c),hg;Xg(T)||df(),i=_g(n,i,o)}else Xg(T)?(i.flags|=192,i.child=n.child,i=null):(n=j.treeContext,Et=jr(T.nextSibling),wn=i,et=!0,Pi=null,Dr=!1,n!==null&&Lb(i,n),i=yg(i,c.children),i.flags|=4096);return i}return f?(zi(),T=c.fallback,f=i.mode,j=n.child,H=j.sibling,c=$s(j,{mode:"hidden",children:c.children}),c.subtreeFlags=j.subtreeFlags&65011712,H!==null?T=$s(H,T):(T=Xa(T,f,o,null),T.flags|=2),T.return=i,c.return=i,c.sibling=T,i.child=c,yu(null,c),c=i.child,T=n.child.memoizedState,T===null?T=pg(o):(f=T.cachePool,f!==null?(j=tn._currentValue,f=f.parent!==j?{parent:j,pool:j}:f):f=Hb(),T={baseLanes:T.baseLanes|o,cachePool:f}),c.memoizedState=T,c.childLanes=gg(n,v,o),i.memoizedState=mg,yu(n.child,c)):(Ui(i),o=n.child,n=o.sibling,o=$s(o,{mode:"visible",children:c.children}),o.return=i,o.sibling=null,n!==null&&(v=i.deletions,v===null?(i.deletions=[n],i.flags|=16):v.push(n)),i.child=o,i.memoizedState=null,o)}function yg(n,i){return i=tf({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function tf(n,i){return n=hr(22,n,null,i),n.lanes=0,n}function _g(n,i,o){return so(i,n.child,null,o),n=yg(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function rx(n,i,o){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i),Pp(n.return,i,o)}function bg(n,i,o,c,f,g){var v=n.memoizedState;v===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:f,treeForkCount:g}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=o,v.tailMode=f,v.treeForkCount=g)}function sx(n,i,o){var c=i.pendingProps,f=c.revealOrder,g=c.tail;c=c.children;var v=Gt.current,T=(v&2)!==0;if(T?(v=v&1|2,i.flags|=128):v&=1,B(Gt,v),Tn(n,i,c,o),c=et?su:0,!T&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&rx(n,o,i);else if(n.tag===19)rx(n,o,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(o=i.child,f=null;o!==null;)n=o.alternate,n!==null&&Fh(n)===null&&(f=o),o=o.sibling;o=f,o===null?(f=i.child,i.child=null):(f=o.sibling,o.sibling=null),bg(i,!1,f,o,g,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,f=i.child,i.child=null;f!==null;){if(n=f.alternate,n!==null&&Fh(n)===null){i.child=f;break}n=f.sibling,f.sibling=o,o=f,f=n}bg(i,!0,o,null,g,c);break;case"together":bg(i,!1,null,null,void 0,c);break;default:i.memoizedState=null}return i.child}function ei(n,i,o){if(n!==null&&(i.dependencies=n.dependencies),Fi|=i.lanes,(o&i.childLanes)===0)if(n!==null){if(fl(n,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,o=$s(n,n.pendingProps),i.child=o,o.return=i;n.sibling!==null;)n=n.sibling,o=o.sibling=$s(n,n.pendingProps),o.return=i;o.sibling=null}return i.child}function vg(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&Vh(n)))}function YN(n,i,o){switch(i.tag){case 3:Re(i,i.stateNode.containerInfo),Vi(i,tn,n.memoizedState.cache),Ja();break;case 27:case 5:lr(i);break;case 4:Re(i,i.stateNode.containerInfo);break;case 10:Vi(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Gp(i),null;break;case 13:var c=i.memoizedState;if(c!==null)return c.dehydrated!==null?(Ui(i),i.flags|=128,null):(o&i.child.childLanes)!==0?nx(n,i,o):(Ui(i),n=ei(n,i,o),n!==null?n.sibling:null);Ui(i);break;case 19:var f=(n.flags&128)!==0;if(c=(o&i.childLanes)!==0,c||(fl(n,i,o,!1),c=(o&i.childLanes)!==0),f){if(c)return sx(n,i,o);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),B(Gt,Gt.current),c)break;return null;case 22:return i.lanes=0,Wv(n,i,o,i.pendingProps);case 24:Vi(i,tn,n.memoizedState.cache)}return ei(n,i,o)}function ix(n,i,o){if(n!==null)if(n.memoizedProps!==i.pendingProps)rn=!0;else{if(!vg(n,o)&&(i.flags&128)===0)return rn=!1,YN(n,i,o);rn=(n.flags&131072)!==0}else rn=!1,et&&(i.flags&1048576)!==0&&Mb(i,su,i.index);switch(i.lanes=0,i.tag){case 16:e:{var c=i.pendingProps;if(n=no(i.elementType),i.type=n,typeof n=="function")Ip(n)?(c=ao(n,c),i.tag=1,i=ex(null,i,n,c,o)):(i.tag=0,i=fg(null,i,n,c,o));else{if(n!=null){var f=n.$$typeof;if(f===xe){i.tag=11,i=Kv(null,i,n,c,o);break e}else if(f===k){i.tag=14,i=$v(null,i,n,c,o);break e}}throw i=we(n)||n,Error(r(306,i,""))}}return i;case 0:return fg(n,i,i.type,i.pendingProps,o);case 1:return c=i.type,f=ao(c,i.pendingProps),ex(n,i,c,f,o);case 3:e:{if(Re(i,i.stateNode.containerInfo),n===null)throw Error(r(387));c=i.pendingProps;var g=i.memoizedState;f=g.element,zp(n,i),hu(i,c,null,o);var v=i.memoizedState;if(c=v.cache,Vi(i,tn,c),c!==g.cache&&jp(i,[tn],o,!0),du(),c=v.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:v.cache},i.updateQueue.baseState=g,i.memoizedState=g,i.flags&256){i=tx(n,i,c,o);break e}else if(c!==f){f=Rr(Error(r(424)),i),iu(f),i=tx(n,i,c,o);break e}else for(n=i.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Et=jr(n.firstChild),wn=i,et=!0,Pi=null,Dr=!0,o=Wb(i,null,c,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ja(),c===f){i=ei(n,i,o);break e}Tn(n,i,c,o)}i=i.child}return i;case 26:return ef(n,i),n===null?(o=gw(i.type,null,i.pendingProps,null))?i.memoizedState=o:et||(o=i.type,n=i.pendingProps,c=_f(de.current).createElement(o),c[Jt]=i,c[fn]=n,In(c,o,n),Zt(c),i.stateNode=c):i.memoizedState=gw(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return lr(i),n===null&&et&&(c=i.stateNode=fw(i.type,i.pendingProps,de.current),wn=i,Dr=!0,f=Et,$i(i.type)?(Zg=f,Et=jr(c.firstChild)):Et=f),Tn(n,i,i.pendingProps.children,o),ef(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&et&&((f=c=Et)&&(c=IR(c,i.type,i.pendingProps,Dr),c!==null?(i.stateNode=c,wn=i,Et=jr(c.firstChild),Dr=!1,f=!0):f=!1),f||ji(i)),lr(i),f=i.type,g=i.pendingProps,v=n!==null?n.memoizedProps:null,c=g.children,$g(f,g)?c=null:v!==null&&$g(f,v)&&(i.flags|=32),i.memoizedState!==null&&(f=Kp(n,i,zN,null,null,o),Du._currentValue=f),ef(n,i),Tn(n,i,c,o),i.child;case 6:return n===null&&et&&((n=o=Et)&&(o=SR(o,i.pendingProps,Dr),o!==null?(i.stateNode=o,wn=i,Et=null,n=!0):n=!1),n||ji(i)),null;case 13:return nx(n,i,o);case 4:return Re(i,i.stateNode.containerInfo),c=i.pendingProps,n===null?i.child=so(i,null,c,o):Tn(n,i,c,o),i.child;case 11:return Kv(n,i,i.type,i.pendingProps,o);case 7:return Tn(n,i,i.pendingProps,o),i.child;case 8:return Tn(n,i,i.pendingProps.children,o),i.child;case 12:return Tn(n,i,i.pendingProps.children,o),i.child;case 10:return c=i.pendingProps,Vi(i,i.type,c.value),Tn(n,i,c.children,o),i.child;case 9:return f=i.type._context,c=i.pendingProps.children,eo(i),f=En(f),c=c(f),i.flags|=1,Tn(n,i,c,o),i.child;case 14:return $v(n,i,i.type,i.pendingProps,o);case 15:return Yv(n,i,i.type,i.pendingProps,o);case 19:return sx(n,i,o);case 31:return $N(n,i,o);case 22:return Wv(n,i,o,i.pendingProps);case 24:return eo(i),c=En(tn),n===null?(f=Mp(),f===null&&(f=_t,g=Vp(),f.pooledCache=g,g.refCount++,g!==null&&(f.pooledCacheLanes|=o),f=g),i.memoizedState={parent:c,cache:f},Up(i),Vi(i,tn,f)):((n.lanes&o)!==0&&(zp(n,i),hu(i,null,null,o),du()),f=n.memoizedState,g=i.memoizedState,f.parent!==c?(f={parent:c,cache:c},i.memoizedState=f,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=f),Vi(i,tn,c)):(c=g.cache,Vi(i,tn,c),c!==f.cache&&jp(i,[tn],o,!0))),Tn(n,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function ti(n){n.flags|=4}function xg(n,i,o,c,f){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(Dx())n.flags|=8192;else throw ro=Uh,Lp}else n.flags&=-16777217}function ax(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!xw(i))if(Dx())n.flags|=8192;else throw ro=Uh,Lp}function nf(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?lh():536870912,n.lanes|=i,Il|=i)}function _u(n,i){if(!et)switch(n.tailMode){case"hidden":i=n.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Tt(n){var i=n.alternate!==null&&n.alternate.child===n.child,o=0,c=0;if(i)for(var f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)o|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=o,i}function WN(n,i,o){var c=i.pendingProps;switch(Rp(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(i),null;case 1:return Tt(i),null;case 3:return o=i.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Xs(tn),nt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(hl(i)?ti(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,kp())),Tt(i),null;case 26:var f=i.type,g=i.memoizedState;return n===null?(ti(i),g!==null?(Tt(i),ax(i,g)):(Tt(i),xg(i,f,null,c,o))):g?g!==n.memoizedState?(ti(i),Tt(i),ax(i,g)):(Tt(i),i.flags&=-16777217):(n=n.memoizedProps,n!==c&&ti(i),Tt(i),xg(i,f,n,c,o)),null;case 27:if(Ft(i),o=de.current,f=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==c&&ti(i);else{if(!c){if(i.stateNode===null)throw Error(r(166));return Tt(i),null}n=G.current,hl(i)?Ub(i):(n=fw(f,c,o),i.stateNode=n,ti(i))}return Tt(i),null;case 5:if(Ft(i),f=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==c&&ti(i);else{if(!c){if(i.stateNode===null)throw Error(r(166));return Tt(i),null}if(g=G.current,hl(i))Ub(i);else{var v=_f(de.current);switch(g){case 1:g=v.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:g=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":g=v.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":g=v.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":g=v.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?v.createElement("select",{is:c.is}):v.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?v.createElement(f,{is:c.is}):v.createElement(f)}}g[Jt]=i,g[fn]=c;e:for(v=i.child;v!==null;){if(v.tag===5||v.tag===6)g.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===i)break e;for(;v.sibling===null;){if(v.return===null||v.return===i)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}i.stateNode=g;e:switch(In(g,f,c),f){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ti(i)}}return Tt(i),xg(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,o),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==c&&ti(i);else{if(typeof c!="string"&&i.stateNode===null)throw Error(r(166));if(n=de.current,hl(i)){if(n=i.stateNode,o=i.memoizedProps,c=null,f=wn,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[Jt]=i,n=!!(n.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||nw(n.nodeValue,o)),n||ji(i,!0)}else n=_f(n).createTextNode(c),n[Jt]=i,i.stateNode=n}return Tt(i),null;case 31:if(o=i.memoizedState,n===null||n.memoizedState!==null){if(c=hl(i),o!==null){if(n===null){if(!c)throw Error(r(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(557));n[Jt]=i}else Ja(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Tt(i),n=!1}else o=kp(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return i.flags&256?(mr(i),i):(mr(i),null);if((i.flags&128)!==0)throw Error(r(558))}return Tt(i),null;case 13:if(c=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=hl(i),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(r(318));if(f=i.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));f[Jt]=i}else Ja(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Tt(i),f=!1}else f=kp(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return i.flags&256?(mr(i),i):(mr(i),null)}return mr(i),(i.flags&128)!==0?(i.lanes=o,i):(o=c!==null,n=n!==null&&n.memoizedState!==null,o&&(c=i.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==f&&(c.flags|=2048)),o!==n&&o&&(i.child.flags|=8192),nf(i,i.updateQueue),Tt(i),null);case 4:return nt(),n===null&&Fg(i.stateNode.containerInfo),Tt(i),null;case 10:return Xs(i.type),Tt(i),null;case 19:if(te(Gt),c=i.memoizedState,c===null)return Tt(i),null;if(f=(i.flags&128)!==0,g=c.rendering,g===null)if(f)_u(c,!1);else{if(Mt!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(g=Fh(n),g!==null){for(i.flags|=128,_u(c,!1),n=g.updateQueue,i.updateQueue=n,nf(i,n),i.subtreeFlags=0,n=o,o=i.child;o!==null;)jb(o,n),o=o.sibling;return B(Gt,Gt.current&1|2),et&&Ys(i,c.treeForkCount),i.child}n=n.sibling}c.tail!==null&&qe()>lf&&(i.flags|=128,f=!0,_u(c,!1),i.lanes=4194304)}else{if(!f)if(n=Fh(g),n!==null){if(i.flags|=128,f=!0,n=n.updateQueue,i.updateQueue=n,nf(i,n),_u(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!et)return Tt(i),null}else 2*qe()-c.renderingStartTime>lf&&o!==536870912&&(i.flags|=128,f=!0,_u(c,!1),i.lanes=4194304);c.isBackwards?(g.sibling=i.child,i.child=g):(n=c.last,n!==null?n.sibling=g:i.child=g,c.last=g)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=qe(),n.sibling=null,o=Gt.current,B(Gt,f?o&1|2:o&1),et&&Ys(i,c.treeForkCount),n):(Tt(i),null);case 22:case 23:return mr(i),Hp(),c=i.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(i.flags|=8192):c&&(i.flags|=8192),c?(o&536870912)!==0&&(i.flags&128)===0&&(Tt(i),i.subtreeFlags&6&&(i.flags|=8192)):Tt(i),o=i.updateQueue,o!==null&&nf(i,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),c=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),c!==o&&(i.flags|=2048),n!==null&&te(to),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Xs(tn),Tt(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function XN(n,i){switch(Rp(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Xs(tn),nt(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return Ft(i),null;case 31:if(i.memoizedState!==null){if(mr(i),i.alternate===null)throw Error(r(340));Ja()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(mr(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));Ja()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return te(Gt),null;case 4:return nt(),null;case 10:return Xs(i.type),null;case 22:case 23:return mr(i),Hp(),n!==null&&te(to),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Xs(tn),null;case 25:return null;default:return null}}function ox(n,i){switch(Rp(i),i.tag){case 3:Xs(tn),nt();break;case 26:case 27:case 5:Ft(i);break;case 4:nt();break;case 31:i.memoizedState!==null&&mr(i);break;case 13:mr(i);break;case 19:te(Gt);break;case 10:Xs(i.type);break;case 22:case 23:mr(i),Hp(),n!==null&&te(to);break;case 24:Xs(tn)}}function bu(n,i){try{var o=i.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var f=c.next;o=f;do{if((o.tag&n)===n){c=void 0;var g=o.create,v=o.inst;c=g(),v.destroy=c}o=o.next}while(o!==f)}}catch(T){dt(i,i.return,T)}}function Bi(n,i,o){try{var c=i.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var g=f.next;c=g;do{if((c.tag&n)===n){var v=c.inst,T=v.destroy;if(T!==void 0){v.destroy=void 0,f=i;var j=o,H=T;try{H()}catch(ne){dt(f,j,ne)}}}c=c.next}while(c!==g)}}catch(ne){dt(i,i.return,ne)}}function lx(n){var i=n.updateQueue;if(i!==null){var o=n.stateNode;try{Jb(i,o)}catch(c){dt(n,n.return,c)}}}function cx(n,i,o){o.props=ao(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(c){dt(n,i,c)}}function vu(n,i){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof o=="function"?n.refCleanup=o(c):o.current=c}}catch(f){dt(n,i,f)}}function Is(n,i){var o=n.ref,c=n.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(f){dt(n,i,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){dt(n,i,f)}else o.current=null}function ux(n){var i=n.type,o=n.memoizedProps,c=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(f){dt(n,n.return,f)}}function wg(n,i,o){try{var c=n.stateNode;bR(c,n.type,o,i),c[fn]=i}catch(f){dt(n,n.return,f)}}function dx(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&$i(n.type)||n.tag===4}function Eg(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||dx(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&$i(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Tg(n,i,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(n),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Hr));else if(c!==4&&(c===27&&$i(n.type)&&(o=n.stateNode,i=null),n=n.child,n!==null))for(Tg(n,i,o),n=n.sibling;n!==null;)Tg(n,i,o),n=n.sibling}function rf(n,i,o){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?o.insertBefore(n,i):o.appendChild(n);else if(c!==4&&(c===27&&$i(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(rf(n,i,o),n=n.sibling;n!==null;)rf(n,i,o),n=n.sibling}function hx(n){var i=n.stateNode,o=n.memoizedProps;try{for(var c=n.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);In(i,c,o),i[Jt]=n,i[fn]=o}catch(g){dt(n,n.return,g)}}var ni=!1,sn=!1,Ig=!1,fx=typeof WeakSet=="function"?WeakSet:Set,pn=null;function JN(n,i){if(n=n.containerInfo,Qg=If,n=Ib(n),_p(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var f=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{o.nodeType,g.nodeType}catch{o=null;break e}var v=0,T=-1,j=-1,H=0,ne=0,ie=n,$=null;t:for(;;){for(var J;ie!==o||f!==0&&ie.nodeType!==3||(T=v+f),ie!==g||c!==0&&ie.nodeType!==3||(j=v+c),ie.nodeType===3&&(v+=ie.nodeValue.length),(J=ie.firstChild)!==null;)$=ie,ie=J;for(;;){if(ie===n)break t;if($===o&&++H===f&&(T=v),$===g&&++ne===c&&(j=v),(J=ie.nextSibling)!==null)break;ie=$,$=ie.parentNode}ie=J}o=T===-1||j===-1?null:{start:T,end:j}}else o=null}o=o||{start:0,end:0}}else o=null;for(Kg={focusedElem:n,selectionRange:o},If=!1,pn=i;pn!==null;)if(i=pn,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,pn=n;else for(;pn!==null;){switch(i=pn,g=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)f=n[o],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&g!==null){n=void 0,o=i,f=g.memoizedProps,g=g.memoizedState,c=o.stateNode;try{var Te=ao(o.type,f);n=c.getSnapshotBeforeUpdate(Te,g),c.__reactInternalSnapshotBeforeUpdate=n}catch(Pe){dt(o,o.return,Pe)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,o=n.nodeType,o===9)Wg(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Wg(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=i.sibling,n!==null){n.return=i.return,pn=n;break}pn=i.return}}function mx(n,i,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:si(n,o),c&4&&bu(5,o);break;case 1:if(si(n,o),c&4)if(n=o.stateNode,i===null)try{n.componentDidMount()}catch(v){dt(o,o.return,v)}else{var f=ao(o.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(f,i,n.__reactInternalSnapshotBeforeUpdate)}catch(v){dt(o,o.return,v)}}c&64&&lx(o),c&512&&vu(o,o.return);break;case 3:if(si(n,o),c&64&&(n=o.updateQueue,n!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{Jb(n,i)}catch(v){dt(o,o.return,v)}}break;case 27:i===null&&c&4&&hx(o);case 26:case 5:si(n,o),i===null&&c&4&&ux(o),c&512&&vu(o,o.return);break;case 12:si(n,o);break;case 31:si(n,o),c&4&&yx(n,o);break;case 13:si(n,o),c&4&&_x(n,o),c&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=oR.bind(null,o),AR(n,o))));break;case 22:if(c=o.memoizedState!==null||ni,!c){i=i!==null&&i.memoizedState!==null||sn,f=ni;var g=sn;ni=c,(sn=i)&&!g?ii(n,o,(o.subtreeFlags&8772)!==0):si(n,o),ni=f,sn=g}break;case 30:break;default:si(n,o)}}function px(n){var i=n.alternate;i!==null&&(n.alternate=null,px(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&Yo(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var At=null,Jn=!1;function ri(n,i,o){for(o=o.child;o!==null;)gx(n,i,o),o=o.sibling}function gx(n,i,o){if(be&&typeof be.onCommitFiberUnmount=="function")try{be.onCommitFiberUnmount(Un,o)}catch{}switch(o.tag){case 26:sn||Is(o,i),ri(n,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:sn||Is(o,i);var c=At,f=Jn;$i(o.type)&&(At=o.stateNode,Jn=!1),ri(n,i,o),Ru(o.stateNode),At=c,Jn=f;break;case 5:sn||Is(o,i);case 6:if(c=At,f=Jn,At=null,ri(n,i,o),At=c,Jn=f,At!==null)if(Jn)try{(At.nodeType===9?At.body:At.nodeName==="HTML"?At.ownerDocument.body:At).removeChild(o.stateNode)}catch(g){dt(o,i,g)}else try{At.removeChild(o.stateNode)}catch(g){dt(o,i,g)}break;case 18:At!==null&&(Jn?(n=At,lw(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Pl(n)):lw(At,o.stateNode));break;case 4:c=At,f=Jn,At=o.stateNode.containerInfo,Jn=!0,ri(n,i,o),At=c,Jn=f;break;case 0:case 11:case 14:case 15:Bi(2,o,i),sn||Bi(4,o,i),ri(n,i,o);break;case 1:sn||(Is(o,i),c=o.stateNode,typeof c.componentWillUnmount=="function"&&cx(o,i,c)),ri(n,i,o);break;case 21:ri(n,i,o);break;case 22:sn=(c=sn)||o.memoizedState!==null,ri(n,i,o),sn=c;break;default:ri(n,i,o)}}function yx(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Pl(n)}catch(o){dt(i,i.return,o)}}}function _x(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Pl(n)}catch(o){dt(i,i.return,o)}}function ZN(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new fx),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new fx),i;default:throw Error(r(435,n.tag))}}function sf(n,i){var o=ZN(n);i.forEach(function(c){if(!o.has(c)){o.add(c);var f=lR.bind(null,n,c);c.then(f,f)}})}function Zn(n,i){var o=i.deletions;if(o!==null)for(var c=0;c<o.length;c++){var f=o[c],g=n,v=i,T=v;e:for(;T!==null;){switch(T.tag){case 27:if($i(T.type)){At=T.stateNode,Jn=!1;break e}break;case 5:At=T.stateNode,Jn=!1;break e;case 3:case 4:At=T.stateNode.containerInfo,Jn=!0;break e}T=T.return}if(At===null)throw Error(r(160));gx(g,v,f),At=null,Jn=!1,g=f.alternate,g!==null&&(g.return=null),f.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)bx(i,n),i=i.sibling}var Wr=null;function bx(n,i){var o=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Zn(i,n),er(n),c&4&&(Bi(3,n,n.return),bu(3,n),Bi(5,n,n.return));break;case 1:Zn(i,n),er(n),c&512&&(sn||o===null||Is(o,o.return)),c&64&&ni&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var f=Wr;if(Zn(i,n),er(n),c&512&&(sn||o===null||Is(o,o.return)),c&4){var g=o!==null?o.memoizedState:null;if(c=n.memoizedState,o===null)if(c===null)if(n.stateNode===null){e:{c=n.type,o=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":g=f.getElementsByTagName("title")[0],(!g||g[ds]||g[Jt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=f.createElement(c),f.head.insertBefore(g,f.querySelector("head > title"))),In(g,c,o),g[Jt]=n,Zt(g),c=g;break e;case"link":var v=bw("link","href",f).get(c+(o.href||""));if(v){for(var T=0;T<v.length;T++)if(g=v[T],g.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&g.getAttribute("rel")===(o.rel==null?null:o.rel)&&g.getAttribute("title")===(o.title==null?null:o.title)&&g.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){v.splice(T,1);break t}}g=f.createElement(c),In(g,c,o),f.head.appendChild(g);break;case"meta":if(v=bw("meta","content",f).get(c+(o.content||""))){for(T=0;T<v.length;T++)if(g=v[T],g.getAttribute("content")===(o.content==null?null:""+o.content)&&g.getAttribute("name")===(o.name==null?null:o.name)&&g.getAttribute("property")===(o.property==null?null:o.property)&&g.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&g.getAttribute("charset")===(o.charSet==null?null:o.charSet)){v.splice(T,1);break t}}g=f.createElement(c),In(g,c,o),f.head.appendChild(g);break;default:throw Error(r(468,c))}g[Jt]=n,Zt(g),c=g}n.stateNode=c}else vw(f,n.type,n.stateNode);else n.stateNode=_w(f,c,n.memoizedProps);else g!==c?(g===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):g.count--,c===null?vw(f,n.type,n.stateNode):_w(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&wg(n,n.memoizedProps,o.memoizedProps)}break;case 27:Zn(i,n),er(n),c&512&&(sn||o===null||Is(o,o.return)),o!==null&&c&4&&wg(n,n.memoizedProps,o.memoizedProps);break;case 5:if(Zn(i,n),er(n),c&512&&(sn||o===null||Is(o,o.return)),n.flags&32){f=n.stateNode;try{Xn(f,"")}catch(Te){dt(n,n.return,Te)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,wg(n,f,o!==null?o.memoizedProps:f)),c&1024&&(Ig=!0);break;case 6:if(Zn(i,n),er(n),c&4){if(n.stateNode===null)throw Error(r(162));c=n.memoizedProps,o=n.stateNode;try{o.nodeValue=c}catch(Te){dt(n,n.return,Te)}}break;case 3:if(xf=null,f=Wr,Wr=bf(i.containerInfo),Zn(i,n),Wr=f,er(n),c&4&&o!==null&&o.memoizedState.isDehydrated)try{Pl(i.containerInfo)}catch(Te){dt(n,n.return,Te)}Ig&&(Ig=!1,vx(n));break;case 4:c=Wr,Wr=bf(n.stateNode.containerInfo),Zn(i,n),er(n),Wr=c;break;case 12:Zn(i,n),er(n);break;case 31:Zn(i,n),er(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,sf(n,c)));break;case 13:Zn(i,n),er(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(of=qe()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,sf(n,c)));break;case 22:f=n.memoizedState!==null;var j=o!==null&&o.memoizedState!==null,H=ni,ne=sn;if(ni=H||f,sn=ne||j,Zn(i,n),sn=ne,ni=H,er(n),c&8192)e:for(i=n.stateNode,i._visibility=f?i._visibility&-2:i._visibility|1,f&&(o===null||j||ni||sn||oo(n)),o=null,i=n;;){if(i.tag===5||i.tag===26){if(o===null){j=o=i;try{if(g=j.stateNode,f)v=g.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{T=j.stateNode;var ie=j.memoizedProps.style,$=ie!=null&&ie.hasOwnProperty("display")?ie.display:null;T.style.display=$==null||typeof $=="boolean"?"":(""+$).trim()}}catch(Te){dt(j,j.return,Te)}}}else if(i.tag===6){if(o===null){j=i;try{j.stateNode.nodeValue=f?"":j.memoizedProps}catch(Te){dt(j,j.return,Te)}}}else if(i.tag===18){if(o===null){j=i;try{var J=j.stateNode;f?cw(J,!0):cw(j.stateNode,!1)}catch(Te){dt(j,j.return,Te)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}c&4&&(c=n.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,sf(n,o))));break;case 19:Zn(i,n),er(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,sf(n,c)));break;case 30:break;case 21:break;default:Zn(i,n),er(n)}}function er(n){var i=n.flags;if(i&2){try{for(var o,c=n.return;c!==null;){if(dx(c)){o=c;break}c=c.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var f=o.stateNode,g=Eg(n);rf(n,g,f);break;case 5:var v=o.stateNode;o.flags&32&&(Xn(v,""),o.flags&=-33);var T=Eg(n);rf(n,T,v);break;case 3:case 4:var j=o.stateNode.containerInfo,H=Eg(n);Tg(n,H,j);break;default:throw Error(r(161))}}catch(ne){dt(n,n.return,ne)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function vx(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;vx(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function si(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)mx(n,i.alternate,i),i=i.sibling}function oo(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:Bi(4,i,i.return),oo(i);break;case 1:Is(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&cx(i,i.return,o),oo(i);break;case 27:Ru(i.stateNode);case 26:case 5:Is(i,i.return),oo(i);break;case 22:i.memoizedState===null&&oo(i);break;case 30:oo(i);break;default:oo(i)}n=n.sibling}}function ii(n,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var c=i.alternate,f=n,g=i,v=g.flags;switch(g.tag){case 0:case 11:case 15:ii(f,g,o),bu(4,g);break;case 1:if(ii(f,g,o),c=g,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(H){dt(c,c.return,H)}if(c=g,f=c.updateQueue,f!==null){var T=c.stateNode;try{var j=f.shared.hiddenCallbacks;if(j!==null)for(f.shared.hiddenCallbacks=null,f=0;f<j.length;f++)Xb(j[f],T)}catch(H){dt(c,c.return,H)}}o&&v&64&&lx(g),vu(g,g.return);break;case 27:hx(g);case 26:case 5:ii(f,g,o),o&&c===null&&v&4&&ux(g),vu(g,g.return);break;case 12:ii(f,g,o);break;case 31:ii(f,g,o),o&&v&4&&yx(f,g);break;case 13:ii(f,g,o),o&&v&4&&_x(f,g);break;case 22:g.memoizedState===null&&ii(f,g,o),vu(g,g.return);break;case 30:break;default:ii(f,g,o)}i=i.sibling}}function Sg(n,i){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&au(o))}function Ag(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&au(n))}function Xr(n,i,o,c){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)xx(n,i,o,c),i=i.sibling}function xx(n,i,o,c){var f=i.flags;switch(i.tag){case 0:case 11:case 15:Xr(n,i,o,c),f&2048&&bu(9,i);break;case 1:Xr(n,i,o,c);break;case 3:Xr(n,i,o,c),f&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&au(n)));break;case 12:if(f&2048){Xr(n,i,o,c),n=i.stateNode;try{var g=i.memoizedProps,v=g.id,T=g.onPostCommit;typeof T=="function"&&T(v,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(j){dt(i,i.return,j)}}else Xr(n,i,o,c);break;case 31:Xr(n,i,o,c);break;case 13:Xr(n,i,o,c);break;case 23:break;case 22:g=i.stateNode,v=i.alternate,i.memoizedState!==null?g._visibility&2?Xr(n,i,o,c):xu(n,i):g._visibility&2?Xr(n,i,o,c):(g._visibility|=2,wl(n,i,o,c,(i.subtreeFlags&10256)!==0||!1)),f&2048&&Sg(v,i);break;case 24:Xr(n,i,o,c),f&2048&&Ag(i.alternate,i);break;default:Xr(n,i,o,c)}}function wl(n,i,o,c,f){for(f=f&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var g=n,v=i,T=o,j=c,H=v.flags;switch(v.tag){case 0:case 11:case 15:wl(g,v,T,j,f),bu(8,v);break;case 23:break;case 22:var ne=v.stateNode;v.memoizedState!==null?ne._visibility&2?wl(g,v,T,j,f):xu(g,v):(ne._visibility|=2,wl(g,v,T,j,f)),f&&H&2048&&Sg(v.alternate,v);break;case 24:wl(g,v,T,j,f),f&&H&2048&&Ag(v.alternate,v);break;default:wl(g,v,T,j,f)}i=i.sibling}}function xu(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=n,c=i,f=c.flags;switch(c.tag){case 22:xu(o,c),f&2048&&Sg(c.alternate,c);break;case 24:xu(o,c),f&2048&&Ag(c.alternate,c);break;default:xu(o,c)}i=i.sibling}}var wu=8192;function El(n,i,o){if(n.subtreeFlags&wu)for(n=n.child;n!==null;)wx(n,i,o),n=n.sibling}function wx(n,i,o){switch(n.tag){case 26:El(n,i,o),n.flags&wu&&n.memoizedState!==null&&UR(o,Wr,n.memoizedState,n.memoizedProps);break;case 5:El(n,i,o);break;case 3:case 4:var c=Wr;Wr=bf(n.stateNode.containerInfo),El(n,i,o),Wr=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=wu,wu=16777216,El(n,i,o),wu=c):El(n,i,o));break;default:El(n,i,o)}}function Ex(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Eu(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var c=i[o];pn=c,Ix(c,n)}Ex(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Tx(n),n=n.sibling}function Tx(n){switch(n.tag){case 0:case 11:case 15:Eu(n),n.flags&2048&&Bi(9,n,n.return);break;case 3:Eu(n);break;case 12:Eu(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,af(n)):Eu(n);break;default:Eu(n)}}function af(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var c=i[o];pn=c,Ix(c,n)}Ex(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:Bi(8,i,i.return),af(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,af(i));break;default:af(i)}n=n.sibling}}function Ix(n,i){for(;pn!==null;){var o=pn;switch(o.tag){case 0:case 11:case 15:Bi(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:au(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,pn=c;else e:for(o=n;pn!==null;){c=pn;var f=c.sibling,g=c.return;if(px(c),c===o){pn=null;break e}if(f!==null){f.return=g,pn=f;break e}pn=g}}}var eR={getCacheForType:function(n){var i=En(tn),o=i.data.get(n);return o===void 0&&(o=n(),i.data.set(n,o)),o},cacheSignal:function(){return En(tn).controller.signal}},tR=typeof WeakMap=="function"?WeakMap:Map,ot=0,_t=null,Ge=null,Xe=0,ut=0,pr=null,qi=!1,Tl=!1,Ng=!1,ai=0,Mt=0,Fi=0,lo=0,Rg=0,gr=0,Il=0,Tu=null,tr=null,Cg=!1,of=0,Sx=0,lf=1/0,cf=null,Hi=null,un=0,Gi=null,Sl=null,oi=0,kg=0,Dg=null,Ax=null,Iu=0,Pg=null;function yr(){return(ot&2)!==0&&Xe!==0?Xe&-Xe:K.T!==null?Ug():ch()}function Nx(){if(gr===0)if((Xe&536870912)===0||et){var n=Va;Va<<=1,(Va&3932160)===0&&(Va=262144),gr=n}else gr=536870912;return n=fr.current,n!==null&&(n.flags|=32),gr}function nr(n,i,o){(n===_t&&(ut===2||ut===9)||n.cancelPendingCommit!==null)&&(Al(n,0),Qi(n,Xe,gr,!1)),Oa(n,o),((ot&2)===0||n!==_t)&&(n===_t&&((ot&2)===0&&(lo|=o),Mt===4&&Qi(n,Xe,gr,!1)),Ss(n))}function Rx(n,i,o){if((ot&6)!==0)throw Error(r(327));var c=!o&&(i&127)===0&&(i&n.expiredLanes)===0||Br(n,i),f=c?sR(n,i):Vg(n,i,!0),g=c;do{if(f===0){Tl&&!c&&Qi(n,i,0,!1);break}else{if(o=n.current.alternate,g&&!nR(o)){f=Vg(n,i,!1),g=!1;continue}if(f===2){if(g=i,n.errorRecoveryDisabledLanes&g)var v=0;else v=n.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){i=v;e:{var T=n;f=Tu;var j=T.current.memoizedState.isDehydrated;if(j&&(Al(T,v).flags|=256),v=Vg(T,v,!1),v!==2){if(Ng&&!j){T.errorRecoveryDisabledLanes|=g,lo|=g,f=4;break e}g=tr,tr=f,g!==null&&(tr===null?tr=g:tr.push.apply(tr,g))}f=v}if(g=!1,f!==2)continue}}if(f===1){Al(n,0),Qi(n,i,0,!0);break}e:{switch(c=n,g=f,g){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:Qi(c,i,gr,!qi);break e;case 2:tr=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(f=of+300-qe(),10<f)){if(Qi(c,i,gr,!qi),ls(c,0,!0)!==0)break e;oi=i,c.timeoutHandle=aw(Cx.bind(null,c,o,tr,cf,Cg,i,gr,lo,Il,qi,g,"Throttled",-0,0),f);break e}Cx(c,o,tr,cf,Cg,i,gr,lo,Il,qi,g,null,-0,0)}}break}while(!0);Ss(n)}function Cx(n,i,o,c,f,g,v,T,j,H,ne,ie,$,J){if(n.timeoutHandle=-1,ie=i.subtreeFlags,ie&8192||(ie&16785408)===16785408){ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Hr},wx(i,g,ie);var Te=(g&62914560)===g?of-qe():(g&4194048)===g?Sx-qe():0;if(Te=zR(ie,Te),Te!==null){oi=g,n.cancelPendingCommit=Te(Lx.bind(null,n,i,g,o,c,f,v,T,j,ne,ie,null,$,J)),Qi(n,g,v,!H);return}}Lx(n,i,g,o,c,f,v,T,j)}function nR(n){for(var i=n;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var f=o[c],g=f.getSnapshot;f=f.value;try{if(!dr(g(),f))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Qi(n,i,o,c){i&=~Rg,i&=~lo,n.suspendedLanes|=i,n.pingedLanes&=~i,c&&(n.warmLanes|=i),c=n.expirationTimes;for(var f=i;0<f;){var g=31-He(f),v=1<<g;c[g]=-1,f&=~v}o!==0&&Ma(n,o,i)}function uf(){return(ot&6)===0?(Su(0),!1):!0}function jg(){if(Ge!==null){if(ut===0)var n=Ge.return;else n=Ge,Ws=Za=null,Wp(n),yl=null,lu=0,n=Ge;for(;n!==null;)ox(n.alternate,n),n=n.return;Ge=null}}function Al(n,i){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,wR(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),oi=0,jg(),_t=n,Ge=o=$s(n.current,null),Xe=i,ut=0,pr=null,qi=!1,Tl=Br(n,i),Ng=!1,Il=gr=Rg=lo=Fi=Mt=0,tr=Tu=null,Cg=!1,(i&8)!==0&&(i|=i&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=i;0<c;){var f=31-He(c),g=1<<f;i|=n[f],c&=~g}return ai=i,Ch(),o}function kx(n,i){ze=null,K.H=gu,i===gl||i===Lh?(i=Kb(),ut=3):i===Lp?(i=Kb(),ut=4):ut=i===hg?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,pr=i,Ge===null&&(Mt=1,Jh(n,Rr(i,n.current)))}function Dx(){var n=fr.current;return n===null?!0:(Xe&4194048)===Xe?Pr===null:(Xe&62914560)===Xe||(Xe&536870912)!==0?n===Pr:!1}function Px(){var n=K.H;return K.H=gu,n===null?gu:n}function jx(){var n=K.A;return K.A=eR,n}function df(){Mt=4,qi||(Xe&4194048)!==Xe&&fr.current!==null||(Tl=!0),(Fi&134217727)===0&&(lo&134217727)===0||_t===null||Qi(_t,Xe,gr,!1)}function Vg(n,i,o){var c=ot;ot|=2;var f=Px(),g=jx();(_t!==n||Xe!==i)&&(cf=null,Al(n,i)),i=!1;var v=Mt;e:do try{if(ut!==0&&Ge!==null){var T=Ge,j=pr;switch(ut){case 8:jg(),v=6;break e;case 3:case 2:case 9:case 6:fr.current===null&&(i=!0);var H=ut;if(ut=0,pr=null,Nl(n,T,j,H),o&&Tl){v=0;break e}break;default:H=ut,ut=0,pr=null,Nl(n,T,j,H)}}rR(),v=Mt;break}catch(ne){kx(n,ne)}while(!0);return i&&n.shellSuspendCounter++,Ws=Za=null,ot=c,K.H=f,K.A=g,Ge===null&&(_t=null,Xe=0,Ch()),v}function rR(){for(;Ge!==null;)Vx(Ge)}function sR(n,i){var o=ot;ot|=2;var c=Px(),f=jx();_t!==n||Xe!==i?(cf=null,lf=qe()+500,Al(n,i)):Tl=Br(n,i);e:do try{if(ut!==0&&Ge!==null){i=Ge;var g=pr;t:switch(ut){case 1:ut=0,pr=null,Nl(n,i,g,1);break;case 2:case 9:if(Gb(g)){ut=0,pr=null,Ox(i);break}i=function(){ut!==2&&ut!==9||_t!==n||(ut=7),Ss(n)},g.then(i,i);break e;case 3:ut=7;break e;case 4:ut=5;break e;case 7:Gb(g)?(ut=0,pr=null,Ox(i)):(ut=0,pr=null,Nl(n,i,g,7));break;case 5:var v=null;switch(Ge.tag){case 26:v=Ge.memoizedState;case 5:case 27:var T=Ge;if(v?xw(v):T.stateNode.complete){ut=0,pr=null;var j=T.sibling;if(j!==null)Ge=j;else{var H=T.return;H!==null?(Ge=H,hf(H)):Ge=null}break t}}ut=0,pr=null,Nl(n,i,g,5);break;case 6:ut=0,pr=null,Nl(n,i,g,6);break;case 8:jg(),Mt=6;break e;default:throw Error(r(462))}}iR();break}catch(ne){kx(n,ne)}while(!0);return Ws=Za=null,K.H=c,K.A=f,ot=o,Ge!==null?0:(_t=null,Xe=0,Ch(),Mt)}function iR(){for(;Ge!==null&&!Y();)Vx(Ge)}function Vx(n){var i=ix(n.alternate,n,ai);n.memoizedProps=n.pendingProps,i===null?hf(n):Ge=i}function Ox(n){var i=n,o=i.alternate;switch(i.tag){case 15:case 0:i=Zv(o,i,i.pendingProps,i.type,void 0,Xe);break;case 11:i=Zv(o,i,i.pendingProps,i.type.render,i.ref,Xe);break;case 5:Wp(i);default:ox(o,i),i=Ge=jb(i,ai),i=ix(o,i,ai)}n.memoizedProps=n.pendingProps,i===null?hf(n):Ge=i}function Nl(n,i,o,c){Ws=Za=null,Wp(i),yl=null,lu=0;var f=i.return;try{if(KN(n,f,i,o,Xe)){Mt=1,Jh(n,Rr(o,n.current)),Ge=null;return}}catch(g){if(f!==null)throw Ge=f,g;Mt=1,Jh(n,Rr(o,n.current)),Ge=null;return}i.flags&32768?(et||c===1?n=!0:Tl||(Xe&536870912)!==0?n=!1:(qi=n=!0,(c===2||c===9||c===3||c===6)&&(c=fr.current,c!==null&&c.tag===13&&(c.flags|=16384))),Mx(i,n)):hf(i)}function hf(n){var i=n;do{if((i.flags&32768)!==0){Mx(i,qi);return}n=i.return;var o=WN(i.alternate,i,ai);if(o!==null){Ge=o;return}if(i=i.sibling,i!==null){Ge=i;return}Ge=i=n}while(i!==null);Mt===0&&(Mt=5)}function Mx(n,i){do{var o=XN(n.alternate,n);if(o!==null){o.flags&=32767,Ge=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(n=n.sibling,n!==null)){Ge=n;return}Ge=n=o}while(n!==null);Mt=6,Ge=null}function Lx(n,i,o,c,f,g,v,T,j){n.cancelPendingCommit=null;do ff();while(un!==0);if((ot&6)!==0)throw Error(r(327));if(i!==null){if(i===n.current)throw Error(r(177));if(g=i.lanes|i.childLanes,g|=Ep,mp(n,o,g,v,T,j),n===_t&&(Ge=_t=null,Xe=0),Sl=i,Gi=n,oi=o,kg=g,Dg=f,Ax=c,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,cR(Wt,function(){return Fx(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||c){c=K.T,K.T=null,f=me.p,me.p=2,v=ot,ot|=4;try{JN(n,i,o)}finally{ot=v,me.p=f,K.T=c}}un=1,Ux(),zx(),Bx()}}function Ux(){if(un===1){un=0;var n=Gi,i=Sl,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=K.T,K.T=null;var c=me.p;me.p=2;var f=ot;ot|=4;try{bx(i,n);var g=Kg,v=Ib(n.containerInfo),T=g.focusedElem,j=g.selectionRange;if(v!==T&&T&&T.ownerDocument&&Tb(T.ownerDocument.documentElement,T)){if(j!==null&&_p(T)){var H=j.start,ne=j.end;if(ne===void 0&&(ne=H),"selectionStart"in T)T.selectionStart=H,T.selectionEnd=Math.min(ne,T.value.length);else{var ie=T.ownerDocument||document,$=ie&&ie.defaultView||window;if($.getSelection){var J=$.getSelection(),Te=T.textContent.length,Pe=Math.min(j.start,Te),yt=j.end===void 0?Pe:Math.min(j.end,Te);!J.extend&&Pe>yt&&(v=yt,yt=Pe,Pe=v);var L=Eb(T,Pe),O=Eb(T,yt);if(L&&O&&(J.rangeCount!==1||J.anchorNode!==L.node||J.anchorOffset!==L.offset||J.focusNode!==O.node||J.focusOffset!==O.offset)){var F=ie.createRange();F.setStart(L.node,L.offset),J.removeAllRanges(),Pe>yt?(J.addRange(F),J.extend(O.node,O.offset)):(F.setEnd(O.node,O.offset),J.addRange(F))}}}}for(ie=[],J=T;J=J.parentNode;)J.nodeType===1&&ie.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<ie.length;T++){var re=ie[T];re.element.scrollLeft=re.left,re.element.scrollTop=re.top}}If=!!Qg,Kg=Qg=null}finally{ot=f,me.p=c,K.T=o}}n.current=i,un=2}}function zx(){if(un===2){un=0;var n=Gi,i=Sl,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=K.T,K.T=null;var c=me.p;me.p=2;var f=ot;ot|=4;try{mx(n,i.alternate,i)}finally{ot=f,me.p=c,K.T=o}}un=3}}function Bx(){if(un===4||un===3){un=0,Se();var n=Gi,i=Sl,o=oi,c=Ax;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?un=5:(un=0,Sl=Gi=null,qx(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(Hi=null),Hs(o),i=i.stateNode,be&&typeof be.onCommitFiberRoot=="function")try{be.onCommitFiberRoot(Un,i,void 0,(i.current.flags&128)===128)}catch{}if(c!==null){i=K.T,f=me.p,me.p=2,K.T=null;try{for(var g=n.onRecoverableError,v=0;v<c.length;v++){var T=c[v];g(T.value,{componentStack:T.stack})}}finally{K.T=i,me.p=f}}(oi&3)!==0&&ff(),Ss(n),f=n.pendingLanes,(o&261930)!==0&&(f&42)!==0?n===Pg?Iu++:(Iu=0,Pg=n):Iu=0,Su(0)}}function qx(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,au(i)))}function ff(){return Ux(),zx(),Bx(),Fx()}function Fx(){if(un!==5)return!1;var n=Gi,i=kg;kg=0;var o=Hs(oi),c=K.T,f=me.p;try{me.p=32>o?32:o,K.T=null,o=Dg,Dg=null;var g=Gi,v=oi;if(un=0,Sl=Gi=null,oi=0,(ot&6)!==0)throw Error(r(331));var T=ot;if(ot|=4,Tx(g.current),xx(g,g.current,v,o),ot=T,Su(0,!1),be&&typeof be.onPostCommitFiberRoot=="function")try{be.onPostCommitFiberRoot(Un,g)}catch{}return!0}finally{me.p=f,K.T=c,qx(n,i)}}function Hx(n,i,o){i=Rr(o,i),i=dg(n.stateNode,i,2),n=Li(n,i,2),n!==null&&(Oa(n,2),Ss(n))}function dt(n,i,o){if(n.tag===3)Hx(n,n,o);else for(;i!==null;){if(i.tag===3){Hx(i,n,o);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Hi===null||!Hi.has(c))){n=Rr(o,n),o=Gv(2),c=Li(i,o,2),c!==null&&(Qv(o,c,i,n),Oa(c,2),Ss(c));break}}i=i.return}}function Og(n,i,o){var c=n.pingCache;if(c===null){c=n.pingCache=new tR;var f=new Set;c.set(i,f)}else f=c.get(i),f===void 0&&(f=new Set,c.set(i,f));f.has(o)||(Ng=!0,f.add(o),n=aR.bind(null,n,i,o),i.then(n,n))}function aR(n,i,o){var c=n.pingCache;c!==null&&c.delete(i),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,_t===n&&(Xe&o)===o&&(Mt===4||Mt===3&&(Xe&62914560)===Xe&&300>qe()-of?(ot&2)===0&&Al(n,0):Rg|=o,Il===Xe&&(Il=0)),Ss(n)}function Gx(n,i){i===0&&(i=lh()),n=Wa(n,i),n!==null&&(Oa(n,i),Ss(n))}function oR(n){var i=n.memoizedState,o=0;i!==null&&(o=i.retryLane),Gx(n,o)}function lR(n,i){var o=0;switch(n.tag){case 31:case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(o=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(i),Gx(n,o)}function cR(n,i){return wt(n,i)}var mf=null,Rl=null,Mg=!1,pf=!1,Lg=!1,Ki=0;function Ss(n){n!==Rl&&n.next===null&&(Rl===null?mf=Rl=n:Rl=Rl.next=n),pf=!0,Mg||(Mg=!0,dR())}function Su(n,i){if(!Lg&&pf){Lg=!0;do for(var o=!1,c=mf;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var g=0;else{var v=c.suspendedLanes,T=c.pingedLanes;g=(1<<31-He(42|n)+1)-1,g&=f&~(v&~T),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(o=!0,Yx(c,g))}else g=Xe,g=ls(c,c===_t?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||Br(c,g)||(o=!0,Yx(c,g));c=c.next}while(o);Lg=!1}}function uR(){Qx()}function Qx(){pf=Mg=!1;var n=0;Ki!==0&&xR()&&(n=Ki);for(var i=qe(),o=null,c=mf;c!==null;){var f=c.next,g=Kx(c,i);g===0?(c.next=null,o===null?mf=f:o.next=f,f===null&&(Rl=o)):(o=c,(n!==0||(g&3)!==0)&&(pf=!0)),c=f}un!==0&&un!==5||Su(n),Ki!==0&&(Ki=0)}function Kx(n,i){for(var o=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,g=n.pendingLanes&-62914561;0<g;){var v=31-He(g),T=1<<v,j=f[v];j===-1?((T&o)===0||(T&c)!==0)&&(f[v]=fp(T,i)):j<=i&&(n.expiredLanes|=T),g&=~T}if(i=_t,o=Xe,o=ls(n,n===i?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,o===0||n===i&&(ut===2||ut===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&kn(c),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Br(n,o)){if(i=o&-o,i===n.callbackPriority)return i;switch(c!==null&&kn(c),Hs(o)){case 2:case 8:o=vn;break;case 32:o=Wt;break;case 268435456:o=Fs;break;default:o=Wt}return c=$x.bind(null,n),o=wt(o,c),n.callbackPriority=i,n.callbackNode=o,i}return c!==null&&c!==null&&kn(c),n.callbackPriority=2,n.callbackNode=null,2}function $x(n,i){if(un!==0&&un!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(ff()&&n.callbackNode!==o)return null;var c=Xe;return c=ls(n,n===_t?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(Rx(n,c,i),Kx(n,qe()),n.callbackNode!=null&&n.callbackNode===o?$x.bind(null,n):null)}function Yx(n,i){if(ff())return null;Rx(n,i,!0)}function dR(){ER(function(){(ot&6)!==0?wt(Dt,uR):Qx()})}function Ug(){if(Ki===0){var n=ml;n===0&&(n=as,as<<=1,(as&261888)===0&&(as=256)),Ki=n}return Ki}function Wx(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Zo(""+n)}function Xx(n,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,n.id&&o.setAttribute("form",n.id),i.parentNode.insertBefore(o,i),n=new FormData(n),o.parentNode.removeChild(o),n}function hR(n,i,o,c,f){if(i==="submit"&&o&&o.stateNode===f){var g=Wx((f[fn]||null).action),v=c.submitter;v&&(i=(i=v[fn]||null)?Wx(i.formAction):v.getAttribute("formAction"),i!==null&&(g=i,v=null));var T=new bs("action","action",null,c,f);n.push({event:T,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ki!==0){var j=v?Xx(f,v):new FormData(f);ig(o,{pending:!0,data:j,method:f.method,action:g},null,j)}}else typeof g=="function"&&(T.preventDefault(),j=v?Xx(f,v):new FormData(f),ig(o,{pending:!0,data:j,method:f.method,action:g},g,j))},currentTarget:f}]})}}for(var zg=0;zg<wp.length;zg++){var Bg=wp[zg],fR=Bg.toLowerCase(),mR=Bg[0].toUpperCase()+Bg.slice(1);Yr(fR,"on"+mR)}Yr(Nb,"onAnimationEnd"),Yr(Rb,"onAnimationIteration"),Yr(Cb,"onAnimationStart"),Yr("dblclick","onDoubleClick"),Yr("focusin","onFocus"),Yr("focusout","onBlur"),Yr(CN,"onTransitionRun"),Yr(kN,"onTransitionStart"),Yr(DN,"onTransitionCancel"),Yr(kb,"onTransitionEnd"),ps("onMouseEnter",["mouseout","mouseover"]),ps("onMouseLeave",["mouseout","mouseover"]),ps("onPointerEnter",["pointerout","pointerover"]),ps("onPointerLeave",["pointerout","pointerover"]),ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ms("onBeforeInput",["compositionend","keypress","textInput","paste"]),ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Au));function Jx(n,i){i=(i&4)!==0;for(var o=0;o<n.length;o++){var c=n[o],f=c.event;c=c.listeners;e:{var g=void 0;if(i)for(var v=c.length-1;0<=v;v--){var T=c[v],j=T.instance,H=T.currentTarget;if(T=T.listener,j!==g&&f.isPropagationStopped())break e;g=T,f.currentTarget=H;try{g(f)}catch(ne){Rh(ne)}f.currentTarget=null,g=j}else for(v=0;v<c.length;v++){if(T=c[v],j=T.instance,H=T.currentTarget,T=T.listener,j!==g&&f.isPropagationStopped())break e;g=T,f.currentTarget=H;try{g(f)}catch(ne){Rh(ne)}f.currentTarget=null,g=j}}}}function Qe(n,i){var o=i[$o];o===void 0&&(o=i[$o]=new Set);var c=n+"__bubble";o.has(c)||(Zx(i,n,2,!1),o.add(c))}function qg(n,i,o){var c=0;i&&(c|=4),Zx(o,n,c,i)}var gf="_reactListening"+Math.random().toString(36).slice(2);function Fg(n){if(!n[gf]){n[gf]=!0,Uc.forEach(function(o){o!=="selectionchange"&&(pR.has(o)||qg(o,!1,n),qg(o,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[gf]||(i[gf]=!0,qg("selectionchange",!1,i))}}function Zx(n,i,o,c){switch(Nw(i)){case 2:var f=FR;break;case 8:f=HR;break;default:f=s0}o=f.bind(null,i,o,n),f=void 0,!qa||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(i,o,{capture:!0,passive:f}):n.addEventListener(i,o,!0):f!==void 0?n.addEventListener(i,o,{passive:f}):n.addEventListener(i,o,!1)}function Hg(n,i,o,c,f){var g=c;if((i&1)===0&&(i&2)===0&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var T=c.stateNode.containerInfo;if(T===f)break;if(v===4)for(v=c.return;v!==null;){var j=v.tag;if((j===3||j===4)&&v.stateNode.containerInfo===f)return;v=v.return}for(;T!==null;){if(v=hs(T),v===null)return;if(j=v.tag,j===5||j===6||j===26||j===27){c=g=v;continue e}T=T.parentNode}}c=c.return}Ni(function(){var H=g,ne=Ir(o),ie=[];e:{var $=Db.get(n);if($!==void 0){var J=bs,Te=n;switch(n){case"keypress":if(Ha(o)===0)break e;case"keydown":case"keyup":J=Sh;break;case"focusin":Te="focus",J=Qa;break;case"focusout":Te="blur",J=Qa;break;case"beforeblur":case"afterblur":J=Qa;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=Jc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=yh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=_;break;case Nb:case Rb:case Cb:J=bh;break;case kb:J=A;break;case"scroll":case"scrollend":J=Xc;break;case"wheel":J=X;break;case"copy":case"cut":case"paste":J=vh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=Ks;break;case"toggle":case"beforetoggle":J=Ue}var Pe=(i&4)!==0,yt=!Pe&&(n==="scroll"||n==="scrollend"),L=Pe?$!==null?$+"Capture":null:$;Pe=[];for(var O=H,F;O!==null;){var re=O;if(F=re.stateNode,re=re.tag,re!==5&&re!==26&&re!==27||F===null||L===null||(re=Gr(O,L),re!=null&&Pe.push(Nu(O,re,F))),yt)break;O=O.return}0<Pe.length&&($=new J($,Te,null,o,ne),ie.push({event:$,listeners:Pe}))}}if((i&7)===0){e:{if($=n==="mouseover"||n==="pointerover",J=n==="mouseout"||n==="pointerout",$&&o!==$c&&(Te=o.relatedTarget||o.fromElement)&&(hs(Te)||Te[us]))break e;if((J||$)&&($=ne.window===ne?ne:($=ne.ownerDocument)?$.defaultView||$.parentWindow:window,J?(Te=o.relatedTarget||o.toElement,J=H,Te=Te?hs(Te):null,Te!==null&&(yt=l(Te),Pe=Te.tag,Te!==yt||Pe!==5&&Pe!==27&&Pe!==6)&&(Te=null)):(J=null,Te=H),J!==Te)){if(Pe=Jc,re="onMouseLeave",L="onMouseEnter",O="mouse",(n==="pointerout"||n==="pointerover")&&(Pe=Ks,re="onPointerLeave",L="onPointerEnter",O="pointer"),yt=J==null?$:cr(J),F=Te==null?$:cr(Te),$=new Pe(re,O+"leave",J,o,ne),$.target=yt,$.relatedTarget=F,re=null,hs(ne)===H&&(Pe=new Pe(L,O+"enter",Te,o,ne),Pe.target=F,Pe.relatedTarget=yt,re=Pe),yt=re,J&&Te)t:{for(Pe=gR,L=J,O=Te,F=0,re=L;re;re=Pe(re))F++;re=0;for(var Ce=O;Ce;Ce=Pe(Ce))re++;for(;0<F-re;)L=Pe(L),F--;for(;0<re-F;)O=Pe(O),re--;for(;F--;){if(L===O||O!==null&&L===O.alternate){Pe=L;break t}L=Pe(L),O=Pe(O)}Pe=null}else Pe=null;J!==null&&ew(ie,$,J,Pe,!1),Te!==null&&yt!==null&&ew(ie,yt,Te,Pe,!0)}}e:{if($=H?cr(H):window,J=$.nodeName&&$.nodeName.toLowerCase(),J==="select"||J==="input"&&$.type==="file")var rt=yb;else if(pb($))if(_b)rt=AN;else{rt=IN;var Ae=TN}else J=$.nodeName,!J||J.toLowerCase()!=="input"||$.type!=="checkbox"&&$.type!=="radio"?H&&Jo(H.elementType)&&(rt=yb):rt=SN;if(rt&&(rt=rt(n,H))){gb(ie,rt,o,ne);break e}Ae&&Ae(n,$,H),n==="focusout"&&H&&$.type==="number"&&H.memoizedProps.value!=null&&Gc($,"number",$.value)}switch(Ae=H?cr(H):window,n){case"focusin":(pb(Ae)||Ae.contentEditable==="true")&&(al=Ae,bp=H,ru=null);break;case"focusout":ru=bp=al=null;break;case"mousedown":vp=!0;break;case"contextmenu":case"mouseup":case"dragend":vp=!1,Sb(ie,o,ne);break;case"selectionchange":if(RN)break;case"keydown":case"keyup":Sb(ie,o,ne)}var Fe;if(at)e:{switch(n){case"compositionstart":var Je="onCompositionStart";break e;case"compositionend":Je="onCompositionEnd";break e;case"compositionupdate":Je="onCompositionUpdate";break e}Je=void 0}else il?Ka(n,o)&&(Je="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Je="onCompositionStart");Je&&(ws&&o.locale!=="ko"&&(il||Je!=="onCompositionStart"?Je==="onCompositionEnd"&&il&&(Fe=Wc()):(_s=ne,Yc="value"in _s?_s.value:_s.textContent,il=!0)),Ae=yf(H,Je),0<Ae.length&&(Je=new xs(Je,n,null,o,ne),ie.push({event:Je,listeners:Ae}),Fe?Je.data=Fe:(Fe=sl(o),Fe!==null&&(Je.data=Fe)))),(Fe=Ar?vN(n,o):xN(n,o))&&(Je=yf(H,"onBeforeInput"),0<Je.length&&(Ae=new xs("onBeforeInput","beforeinput",null,o,ne),ie.push({event:Ae,listeners:Je}),Ae.data=Fe)),hR(ie,n,H,o,ne)}Jx(ie,i)})}function Nu(n,i,o){return{instance:n,listener:i,currentTarget:o}}function yf(n,i){for(var o=i+"Capture",c=[];n!==null;){var f=n,g=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||g===null||(f=Gr(n,o),f!=null&&c.unshift(Nu(n,f,g)),f=Gr(n,i),f!=null&&c.push(Nu(n,f,g))),n.tag===3)return c;n=n.return}return[]}function gR(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function ew(n,i,o,c,f){for(var g=i._reactName,v=[];o!==null&&o!==c;){var T=o,j=T.alternate,H=T.stateNode;if(T=T.tag,j!==null&&j===c)break;T!==5&&T!==26&&T!==27||H===null||(j=H,f?(H=Gr(o,g),H!=null&&v.unshift(Nu(o,H,j))):f||(H=Gr(o,g),H!=null&&v.push(Nu(o,H,j)))),o=o.return}v.length!==0&&n.push({event:i,listeners:v})}var yR=/\r\n?/g,_R=/\u0000|\uFFFD/g;function tw(n){return(typeof n=="string"?n:""+n).replace(yR,`
`).replace(_R,"")}function nw(n,i){return i=tw(i),tw(n)===i}function gt(n,i,o,c,f,g){switch(o){case"children":typeof c=="string"?i==="body"||i==="textarea"&&c===""||Xn(n,c):(typeof c=="number"||typeof c=="bigint")&&i!=="body"&&Xn(n,""+c);break;case"className":ur(n,"class",c);break;case"tabIndex":ur(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ur(n,o,c);break;case"style":Kc(n,c,g);break;case"data":if(i!=="object"){ur(n,"data",c);break}case"src":case"href":if(c===""&&(i!=="a"||o!=="href")){n.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Zo(""+c),n.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(o==="formAction"?(i!=="input"&&gt(n,i,"name",f.name,f,null),gt(n,i,"formEncType",f.formEncType,f,null),gt(n,i,"formMethod",f.formMethod,f,null),gt(n,i,"formTarget",f.formTarget,f,null)):(gt(n,i,"encType",f.encType,f,null),gt(n,i,"method",f.method,f,null),gt(n,i,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(o);break}c=Zo(""+c),n.setAttribute(o,c);break;case"onClick":c!=null&&(n.onclick=Hr);break;case"onScroll":c!=null&&Qe("scroll",n);break;case"onScrollEnd":c!=null&&Qe("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}o=Zo(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""+c):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":c===!0?n.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(o,c):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(o,c):n.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(o):n.setAttribute(o,c);break;case"popover":Qe("beforetoggle",n),Qe("toggle",n),Wo(n,"popover",c);break;case"xlinkActuate":en(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":en(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":en(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":en(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":en(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":en(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":en(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":en(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":en(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Wo(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=gh.get(o)||o,Wo(n,o,c))}}function Gg(n,i,o,c,f,g){switch(o){case"style":Kc(n,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(o=c.__html,o!=null){if(f.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"children":typeof c=="string"?Xn(n,c):(typeof c=="number"||typeof c=="bigint")&&Xn(n,""+c);break;case"onScroll":c!=null&&Qe("scroll",n);break;case"onScrollEnd":c!=null&&Qe("scrollend",n);break;case"onClick":c!=null&&(n.onclick=Hr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zc.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),i=o.slice(2,f?o.length-7:void 0),g=n[fn]||null,g=g!=null?g[o]:null,typeof g=="function"&&n.removeEventListener(i,g,f),typeof c=="function")){typeof g!="function"&&g!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(i,c,f);break e}o in n?n[o]=c:c===!0?n.setAttribute(o,""):Wo(n,o,c)}}}function In(n,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qe("error",n),Qe("load",n);var c=!1,f=!1,g;for(g in o)if(o.hasOwnProperty(g)){var v=o[g];if(v!=null)switch(g){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:gt(n,i,g,v,o,null)}}f&&gt(n,i,"srcSet",o.srcSet,o,null),c&&gt(n,i,"src",o.src,o,null);return;case"input":Qe("invalid",n);var T=g=v=f=null,j=null,H=null;for(c in o)if(o.hasOwnProperty(c)){var ne=o[c];if(ne!=null)switch(c){case"name":f=ne;break;case"type":v=ne;break;case"checked":j=ne;break;case"defaultChecked":H=ne;break;case"value":g=ne;break;case"defaultValue":T=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(r(137,i));break;default:gt(n,i,c,ne,o,null)}}fh(n,g,T,j,H,v,f,!1);return;case"select":Qe("invalid",n),c=v=g=null;for(f in o)if(o.hasOwnProperty(f)&&(T=o[f],T!=null))switch(f){case"value":g=T;break;case"defaultValue":v=T;break;case"multiple":c=T;default:gt(n,i,f,T,o,null)}i=g,o=v,n.multiple=!!c,i!=null?Ti(n,!!c,i,!1):o!=null&&Ti(n,!!c,o,!0);return;case"textarea":Qe("invalid",n),g=f=c=null;for(v in o)if(o.hasOwnProperty(v)&&(T=o[v],T!=null))switch(v){case"value":c=T;break;case"defaultValue":f=T;break;case"children":g=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(r(91));break;default:gt(n,i,v,T,o,null)}Ii(n,c,f,g);return;case"option":for(j in o)o.hasOwnProperty(j)&&(c=o[j],c!=null)&&(j==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":gt(n,i,j,c,o,null));return;case"dialog":Qe("beforetoggle",n),Qe("toggle",n),Qe("cancel",n),Qe("close",n);break;case"iframe":case"object":Qe("load",n);break;case"video":case"audio":for(c=0;c<Au.length;c++)Qe(Au[c],n);break;case"image":Qe("error",n),Qe("load",n);break;case"details":Qe("toggle",n);break;case"embed":case"source":case"link":Qe("error",n),Qe("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(H in o)if(o.hasOwnProperty(H)&&(c=o[H],c!=null))switch(H){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:gt(n,i,H,c,o,null)}return;default:if(Jo(i)){for(ne in o)o.hasOwnProperty(ne)&&(c=o[ne],c!==void 0&&Gg(n,i,ne,c,o,void 0));return}}for(T in o)o.hasOwnProperty(T)&&(c=o[T],c!=null&&gt(n,i,T,c,o,null))}function bR(n,i,o,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,g=null,v=null,T=null,j=null,H=null,ne=null;for(J in o){var ie=o[J];if(o.hasOwnProperty(J)&&ie!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":j=ie;default:c.hasOwnProperty(J)||gt(n,i,J,null,c,ie)}}for(var $ in c){var J=c[$];if(ie=o[$],c.hasOwnProperty($)&&(J!=null||ie!=null))switch($){case"type":g=J;break;case"name":f=J;break;case"checked":H=J;break;case"defaultChecked":ne=J;break;case"value":v=J;break;case"defaultValue":T=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(r(137,i));break;default:J!==ie&&gt(n,i,$,J,c,ie)}}Xo(n,v,T,j,H,ne,g,f);return;case"select":J=v=T=$=null;for(g in o)if(j=o[g],o.hasOwnProperty(g)&&j!=null)switch(g){case"value":break;case"multiple":J=j;default:c.hasOwnProperty(g)||gt(n,i,g,null,c,j)}for(f in c)if(g=c[f],j=o[f],c.hasOwnProperty(f)&&(g!=null||j!=null))switch(f){case"value":$=g;break;case"defaultValue":T=g;break;case"multiple":v=g;default:g!==j&&gt(n,i,f,g,c,j)}i=T,o=v,c=J,$!=null?Ti(n,!!o,$,!1):!!c!=!!o&&(i!=null?Ti(n,!!o,i,!0):Ti(n,!!o,o?[]:"",!1));return;case"textarea":J=$=null;for(T in o)if(f=o[T],o.hasOwnProperty(T)&&f!=null&&!c.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:gt(n,i,T,null,c,f)}for(v in c)if(f=c[v],g=o[v],c.hasOwnProperty(v)&&(f!=null||g!=null))switch(v){case"value":$=f;break;case"defaultValue":J=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(r(91));break;default:f!==g&&gt(n,i,v,f,c,g)}mh(n,$,J);return;case"option":for(var Te in o)$=o[Te],o.hasOwnProperty(Te)&&$!=null&&!c.hasOwnProperty(Te)&&(Te==="selected"?n.selected=!1:gt(n,i,Te,null,c,$));for(j in c)$=c[j],J=o[j],c.hasOwnProperty(j)&&$!==J&&($!=null||J!=null)&&(j==="selected"?n.selected=$&&typeof $!="function"&&typeof $!="symbol":gt(n,i,j,$,c,J));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Pe in o)$=o[Pe],o.hasOwnProperty(Pe)&&$!=null&&!c.hasOwnProperty(Pe)&&gt(n,i,Pe,null,c,$);for(H in c)if($=c[H],J=o[H],c.hasOwnProperty(H)&&$!==J&&($!=null||J!=null))switch(H){case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(r(137,i));break;default:gt(n,i,H,$,c,J)}return;default:if(Jo(i)){for(var yt in o)$=o[yt],o.hasOwnProperty(yt)&&$!==void 0&&!c.hasOwnProperty(yt)&&Gg(n,i,yt,void 0,c,$);for(ne in c)$=c[ne],J=o[ne],!c.hasOwnProperty(ne)||$===J||$===void 0&&J===void 0||Gg(n,i,ne,$,c,J);return}}for(var L in o)$=o[L],o.hasOwnProperty(L)&&$!=null&&!c.hasOwnProperty(L)&&gt(n,i,L,null,c,$);for(ie in c)$=c[ie],J=o[ie],!c.hasOwnProperty(ie)||$===J||$==null&&J==null||gt(n,i,ie,$,c,J)}function rw(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function vR(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var f=o[c],g=f.transferSize,v=f.initiatorType,T=f.duration;if(g&&T&&rw(v)){for(v=0,T=f.responseEnd,c+=1;c<o.length;c++){var j=o[c],H=j.startTime;if(H>T)break;var ne=j.transferSize,ie=j.initiatorType;ne&&rw(ie)&&(j=j.responseEnd,v+=ne*(j<T?1:(T-H)/(j-H)))}if(--c,i+=8*(g+v)/(f.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Qg=null,Kg=null;function _f(n){return n.nodeType===9?n:n.ownerDocument}function sw(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function iw(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function $g(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Yg=null;function xR(){var n=window.event;return n&&n.type==="popstate"?n===Yg?!1:(Yg=n,!0):(Yg=null,!1)}var aw=typeof setTimeout=="function"?setTimeout:void 0,wR=typeof clearTimeout=="function"?clearTimeout:void 0,ow=typeof Promise=="function"?Promise:void 0,ER=typeof queueMicrotask=="function"?queueMicrotask:typeof ow<"u"?function(n){return ow.resolve(null).then(n).catch(TR)}:aw;function TR(n){setTimeout(function(){throw n})}function $i(n){return n==="head"}function lw(n,i){var o=i,c=0;do{var f=o.nextSibling;if(n.removeChild(o),f&&f.nodeType===8)if(o=f.data,o==="/$"||o==="/&"){if(c===0){n.removeChild(f),Pl(i);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Ru(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,Ru(o);for(var g=o.firstChild;g;){var v=g.nextSibling,T=g.nodeName;g[ds]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&g.rel.toLowerCase()==="stylesheet"||o.removeChild(g),g=v}}else o==="body"&&Ru(n.ownerDocument.body);o=f}while(o);Pl(i)}function cw(n,i){var o=n;n=0;do{var c=o.nextSibling;if(o.nodeType===1?i?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(i?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=c}while(o)}function Wg(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Wg(o),Yo(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function IR(n,i,o,c){for(;n.nodeType===1;){var f=o;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[ds])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(g=n.getAttribute("rel"),g==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(g!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(g=n.getAttribute("src"),(g!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&g&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var g=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===g)return n}else return n;if(n=jr(n.nextSibling),n===null)break}return null}function SR(n,i,o){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=jr(n.nextSibling),n===null))return null;return n}function uw(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=jr(n.nextSibling),n===null))return null;return n}function Xg(n){return n.data==="$?"||n.data==="$~"}function Jg(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function AR(n,i){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||o.readyState!=="loading")i();else{var c=function(){i(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function jr(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var Zg=null;function dw(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(i===0)return jr(n.nextSibling);i--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||i++}n=n.nextSibling}return null}function hw(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(i===0)return n;i--}else o!=="/$"&&o!=="/&"||i++}n=n.previousSibling}return null}function fw(n,i,o){switch(i=_f(o),n){case"html":if(n=i.documentElement,!n)throw Error(r(452));return n;case"head":if(n=i.head,!n)throw Error(r(453));return n;case"body":if(n=i.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function Ru(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);Yo(n)}var Vr=new Map,mw=new Set;function bf(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var li=me.d;me.d={f:NR,r:RR,D:CR,C:kR,L:DR,m:PR,X:VR,S:jR,M:OR};function NR(){var n=li.f(),i=uf();return n||i}function RR(n){var i=Tr(n);i!==null&&i.tag===5&&i.type==="form"?kv(i):li.r(n)}var Cl=typeof document>"u"?null:document;function pw(n,i,o){var c=Cl;if(c&&typeof i=="string"&&i){var f=Wn(i);f='link[rel="'+n+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),mw.has(f)||(mw.add(f),n={rel:n,crossOrigin:o,href:i},c.querySelector(f)===null&&(i=c.createElement("link"),In(i,"link",n),Zt(i),c.head.appendChild(i)))}}function CR(n){li.D(n),pw("dns-prefetch",n,null)}function kR(n,i){li.C(n,i),pw("preconnect",n,i)}function DR(n,i,o){li.L(n,i,o);var c=Cl;if(c&&n&&i){var f='link[rel="preload"][as="'+Wn(i)+'"]';i==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Wn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Wn(o.imageSizes)+'"]')):f+='[href="'+Wn(n)+'"]';var g=f;switch(i){case"style":g=kl(n);break;case"script":g=Dl(n)}Vr.has(g)||(n=E({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:n,as:i},o),Vr.set(g,n),c.querySelector(f)!==null||i==="style"&&c.querySelector(Cu(g))||i==="script"&&c.querySelector(ku(g))||(i=c.createElement("link"),In(i,"link",n),Zt(i),c.head.appendChild(i)))}}function PR(n,i){li.m(n,i);var o=Cl;if(o&&n){var c=i&&typeof i.as=="string"?i.as:"script",f='link[rel="modulepreload"][as="'+Wn(c)+'"][href="'+Wn(n)+'"]',g=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Dl(n)}if(!Vr.has(g)&&(n=E({rel:"modulepreload",href:n},i),Vr.set(g,n),o.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(ku(g)))return}c=o.createElement("link"),In(c,"link",n),Zt(c),o.head.appendChild(c)}}}function jR(n,i,o){li.S(n,i,o);var c=Cl;if(c&&n){var f=fs(c).hoistableStyles,g=kl(n);i=i||"default";var v=f.get(g);if(!v){var T={loading:0,preload:null};if(v=c.querySelector(Cu(g)))T.loading=5;else{n=E({rel:"stylesheet",href:n,"data-precedence":i},o),(o=Vr.get(g))&&e0(n,o);var j=v=c.createElement("link");Zt(j),In(j,"link",n),j._p=new Promise(function(H,ne){j.onload=H,j.onerror=ne}),j.addEventListener("load",function(){T.loading|=1}),j.addEventListener("error",function(){T.loading|=2}),T.loading|=4,vf(v,i,c)}v={type:"stylesheet",instance:v,count:1,state:T},f.set(g,v)}}}function VR(n,i){li.X(n,i);var o=Cl;if(o&&n){var c=fs(o).hoistableScripts,f=Dl(n),g=c.get(f);g||(g=o.querySelector(ku(f)),g||(n=E({src:n,async:!0},i),(i=Vr.get(f))&&t0(n,i),g=o.createElement("script"),Zt(g),In(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(f,g))}}function OR(n,i){li.M(n,i);var o=Cl;if(o&&n){var c=fs(o).hoistableScripts,f=Dl(n),g=c.get(f);g||(g=o.querySelector(ku(f)),g||(n=E({src:n,async:!0,type:"module"},i),(i=Vr.get(f))&&t0(n,i),g=o.createElement("script"),Zt(g),In(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(f,g))}}function gw(n,i,o,c){var f=(f=de.current)?bf(f):null;if(!f)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=kl(o.href),o=fs(f).hoistableStyles,c=o.get(i),c||(c={type:"style",instance:null,count:0,state:null},o.set(i,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=kl(o.href);var g=fs(f).hoistableStyles,v=g.get(n);if(v||(f=f.ownerDocument||f,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(n,v),(g=f.querySelector(Cu(n)))&&!g._p&&(v.instance=g,v.state.loading=5),Vr.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Vr.set(n,o),g||MR(f,n,o,v.state))),i&&c===null)throw Error(r(528,""));return v}if(i&&c!==null)throw Error(r(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Dl(o),o=fs(f).hoistableScripts,c=o.get(i),c||(c={type:"script",instance:null,count:0,state:null},o.set(i,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function kl(n){return'href="'+Wn(n)+'"'}function Cu(n){return'link[rel="stylesheet"]['+n+"]"}function yw(n){return E({},n,{"data-precedence":n.precedence,precedence:null})}function MR(n,i,o,c){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?c.loading=1:(i=n.createElement("link"),c.preload=i,i.addEventListener("load",function(){return c.loading|=1}),i.addEventListener("error",function(){return c.loading|=2}),In(i,"link",o),Zt(i),n.head.appendChild(i))}function Dl(n){return'[src="'+Wn(n)+'"]'}function ku(n){return"script[async]"+n}function _w(n,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var c=n.querySelector('style[data-href~="'+Wn(o.href)+'"]');if(c)return i.instance=c,Zt(c),c;var f=E({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),Zt(c),In(c,"style",f),vf(c,o.precedence,n),i.instance=c;case"stylesheet":f=kl(o.href);var g=n.querySelector(Cu(f));if(g)return i.state.loading|=4,i.instance=g,Zt(g),g;c=yw(o),(f=Vr.get(f))&&e0(c,f),g=(n.ownerDocument||n).createElement("link"),Zt(g);var v=g;return v._p=new Promise(function(T,j){v.onload=T,v.onerror=j}),In(g,"link",c),i.state.loading|=4,vf(g,o.precedence,n),i.instance=g;case"script":return g=Dl(o.src),(f=n.querySelector(ku(g)))?(i.instance=f,Zt(f),f):(c=o,(f=Vr.get(g))&&(c=E({},o),t0(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),Zt(f),In(f,"link",c),n.head.appendChild(f),i.instance=f);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(c=i.instance,i.state.loading|=4,vf(c,o.precedence,n));return i.instance}function vf(n,i,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,g=f,v=0;v<c.length;v++){var T=c[v];if(T.dataset.precedence===i)g=T;else if(g!==f)break}g?g.parentNode.insertBefore(n,g.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(n,i.firstChild))}function e0(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function t0(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var xf=null;function bw(n,i,o){if(xf===null){var c=new Map,f=xf=new Map;f.set(o,c)}else f=xf,c=f.get(o),c||(c=new Map,f.set(o,c));if(c.has(n))return c;for(c.set(n,null),o=o.getElementsByTagName(n),f=0;f<o.length;f++){var g=o[f];if(!(g[ds]||g[Jt]||n==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var v=g.getAttribute(i)||"";v=n+v;var T=c.get(v);T?T.push(g):c.set(v,[g])}}return c}function vw(n,i,o){n=n.ownerDocument||n,n.head.insertBefore(o,i==="title"?n.querySelector("head > title"):null)}function LR(n,i,o){if(o===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(n=i.disabled,typeof i.precedence=="string"&&n==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function xw(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function UR(n,i,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var f=kl(c.href),g=i.querySelector(Cu(f));if(g){i=g._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=wf.bind(n),i.then(n,n)),o.state.loading|=4,o.instance=g,Zt(g);return}g=i.ownerDocument||i,c=yw(c),(f=Vr.get(f))&&e0(c,f),g=g.createElement("link"),Zt(g);var v=g;v._p=new Promise(function(T,j){v.onload=T,v.onerror=j}),In(g,"link",c),o.instance=g}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=wf.bind(n),i.addEventListener("load",o),i.addEventListener("error",o))}}var n0=0;function zR(n,i){return n.stylesheets&&n.count===0&&Tf(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var c=setTimeout(function(){if(n.stylesheets&&Tf(n,n.stylesheets),n.unsuspend){var g=n.unsuspend;n.unsuspend=null,g()}},6e4+i);0<n.imgBytes&&n0===0&&(n0=62500*vR());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Tf(n,n.stylesheets),n.unsuspend)){var g=n.unsuspend;n.unsuspend=null,g()}},(n.imgBytes>n0?50:800)+i);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(f)}}:null}function wf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Tf(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Ef=null;function Tf(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Ef=new Map,i.forEach(BR,n),Ef=null,wf.call(n))}function BR(n,i){if(!(i.state.loading&4)){var o=Ef.get(n);if(o)var c=o.get(null);else{o=new Map,Ef.set(n,o);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<f.length;g++){var v=f[g];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(o.set(v.dataset.precedence,v),c=v)}c&&o.set(null,c)}f=i.instance,v=f.getAttribute("data-precedence"),g=o.get(v)||c,g===c&&o.set(null,f),o.set(v,f),this.count++,c=wf.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),g?g.parentNode.insertBefore(f,g.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),i.state.loading|=4}}var Du={$$typeof:se,Provider:null,Consumer:null,_currentValue:Ee,_currentValue2:Ee,_threadCount:0};function qR(n,i,o,c,f,g,v,T,j){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cs(0),this.hiddenUpdates=cs(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=g,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=j,this.incompleteTransitions=new Map}function ww(n,i,o,c,f,g,v,T,j,H,ne,ie){return n=new qR(n,i,o,v,j,H,ne,ie,T),i=1,g===!0&&(i|=24),g=hr(3,null,null,i),n.current=g,g.stateNode=n,i=Vp(),i.refCount++,n.pooledCache=i,i.refCount++,g.memoizedState={element:c,isDehydrated:o,cache:i},Up(g),n}function Ew(n){return n?(n=cl,n):cl}function Tw(n,i,o,c,f,g){f=Ew(f),c.context===null?c.context=f:c.pendingContext=f,c=Mi(i),c.payload={element:o},g=g===void 0?null:g,g!==null&&(c.callback=g),o=Li(n,c,i),o!==null&&(nr(o,n,i),uu(o,n,i))}function Iw(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<i?o:i}}function r0(n,i){Iw(n,i),(n=n.alternate)&&Iw(n,i)}function Sw(n){if(n.tag===13||n.tag===31){var i=Wa(n,67108864);i!==null&&nr(i,n,67108864),r0(n,67108864)}}function Aw(n){if(n.tag===13||n.tag===31){var i=yr();i=La(i);var o=Wa(n,i);o!==null&&nr(o,n,i),r0(n,i)}}var If=!0;function FR(n,i,o,c){var f=K.T;K.T=null;var g=me.p;try{me.p=2,s0(n,i,o,c)}finally{me.p=g,K.T=f}}function HR(n,i,o,c){var f=K.T;K.T=null;var g=me.p;try{me.p=8,s0(n,i,o,c)}finally{me.p=g,K.T=f}}function s0(n,i,o,c){if(If){var f=i0(c);if(f===null)Hg(n,i,c,Sf,o),Rw(n,c);else if(QR(f,n,i,o,c))c.stopPropagation();else if(Rw(n,c),i&4&&-1<GR.indexOf(n)){for(;f!==null;){var g=Tr(f);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var v=os(g.pendingLanes);if(v!==0){var T=g;for(T.pendingLanes|=2,T.entangledLanes|=2;v;){var j=1<<31-He(v);T.entanglements[1]|=j,v&=~j}Ss(g),(ot&6)===0&&(lf=qe()+500,Su(0))}}break;case 31:case 13:T=Wa(g,2),T!==null&&nr(T,g,2),uf(),r0(g,2)}if(g=i0(c),g===null&&Hg(n,i,c,Sf,o),g===f)break;f=g}f!==null&&c.stopPropagation()}else Hg(n,i,c,null,o)}}function i0(n){return n=Ir(n),a0(n)}var Sf=null;function a0(n){if(Sf=null,n=hs(n),n!==null){var i=l(n);if(i===null)n=null;else{var o=i.tag;if(o===13){if(n=u(i),n!==null)return n;n=null}else if(o===31){if(n=p(i),n!==null)return n;n=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Sf=n,null}function Nw(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ue()){case Dt:return 2;case vn:return 8;case Wt:case Pa:return 32;case Fs:return 268435456;default:return 32}default:return 32}}var o0=!1,Yi=null,Wi=null,Xi=null,Pu=new Map,ju=new Map,Ji=[],GR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Rw(n,i){switch(n){case"focusin":case"focusout":Yi=null;break;case"dragenter":case"dragleave":Wi=null;break;case"mouseover":case"mouseout":Xi=null;break;case"pointerover":case"pointerout":Pu.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":ju.delete(i.pointerId)}}function Vu(n,i,o,c,f,g){return n===null||n.nativeEvent!==g?(n={blockedOn:i,domEventName:o,eventSystemFlags:c,nativeEvent:g,targetContainers:[f]},i!==null&&(i=Tr(i),i!==null&&Sw(i)),n):(n.eventSystemFlags|=c,i=n.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),n)}function QR(n,i,o,c,f){switch(i){case"focusin":return Yi=Vu(Yi,n,i,o,c,f),!0;case"dragenter":return Wi=Vu(Wi,n,i,o,c,f),!0;case"mouseover":return Xi=Vu(Xi,n,i,o,c,f),!0;case"pointerover":var g=f.pointerId;return Pu.set(g,Vu(Pu.get(g)||null,n,i,o,c,f)),!0;case"gotpointercapture":return g=f.pointerId,ju.set(g,Vu(ju.get(g)||null,n,i,o,c,f)),!0}return!1}function Cw(n){var i=hs(n.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=u(o),i!==null){n.blockedOn=i,qr(n.priority,function(){Aw(o)});return}}else if(i===31){if(i=p(o),i!==null){n.blockedOn=i,qr(n.priority,function(){Aw(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Af(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var o=i0(n.nativeEvent);if(o===null){o=n.nativeEvent;var c=new o.constructor(o.type,o);$c=c,o.target.dispatchEvent(c),$c=null}else return i=Tr(o),i!==null&&Sw(i),n.blockedOn=o,!1;i.shift()}return!0}function kw(n,i,o){Af(n)&&o.delete(i)}function KR(){o0=!1,Yi!==null&&Af(Yi)&&(Yi=null),Wi!==null&&Af(Wi)&&(Wi=null),Xi!==null&&Af(Xi)&&(Xi=null),Pu.forEach(kw),ju.forEach(kw)}function Nf(n,i){n.blockedOn===i&&(n.blockedOn=null,o0||(o0=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,KR)))}var Rf=null;function Dw(n){Rf!==n&&(Rf=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Rf===n&&(Rf=null);for(var i=0;i<n.length;i+=3){var o=n[i],c=n[i+1],f=n[i+2];if(typeof c!="function"){if(a0(c||o)===null)continue;break}var g=Tr(o);g!==null&&(n.splice(i,3),i-=3,ig(g,{pending:!0,data:f,method:o.method,action:c},c,f))}}))}function Pl(n){function i(j){return Nf(j,n)}Yi!==null&&Nf(Yi,n),Wi!==null&&Nf(Wi,n),Xi!==null&&Nf(Xi,n),Pu.forEach(i),ju.forEach(i);for(var o=0;o<Ji.length;o++){var c=Ji[o];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Ji.length&&(o=Ji[0],o.blockedOn===null);)Cw(o),o.blockedOn===null&&Ji.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var f=o[c],g=o[c+1],v=f[fn]||null;if(typeof g=="function")v||Dw(o);else if(v){var T=null;if(g&&g.hasAttribute("formAction")){if(f=g,v=g[fn]||null)T=v.formAction;else if(a0(f)!==null)continue}else T=v.action;typeof T=="function"?o[c+1]=T:(o.splice(c,3),c-=3),Dw(o)}}}function Pw(){function n(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(v){return f=v})},focusReset:"manual",scroll:"manual"})}function i(){f!==null&&(f(),f=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),f!==null&&(f(),f=null)}}}function l0(n){this._internalRoot=n}Cf.prototype.render=l0.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));var o=i.current,c=yr();Tw(o,c,n,i,null,null)},Cf.prototype.unmount=l0.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Tw(n.current,2,null,n,null,null),uf(),i[us]=null}};function Cf(n){this._internalRoot=n}Cf.prototype.unstable_scheduleHydration=function(n){if(n){var i=ch();n={blockedOn:null,target:n,priority:i};for(var o=0;o<Ji.length&&i!==0&&i<Ji[o].priority;o++);Ji.splice(o,0,n),o===0&&Cw(n)}};var jw=e.version;if(jw!=="19.2.3")throw Error(r(527,jw,"19.2.3"));me.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=m(i),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var $R={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:K,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kf.isDisabled&&kf.supportsFiber)try{Un=kf.inject($R),be=kf}catch{}}return Mu.createRoot=function(n,i){if(!a(n))throw Error(r(299));var o=!1,c="",f=Bv,g=qv,v=Fv;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onUncaughtError!==void 0&&(f=i.onUncaughtError),i.onCaughtError!==void 0&&(g=i.onCaughtError),i.onRecoverableError!==void 0&&(v=i.onRecoverableError)),i=ww(n,1,!1,null,null,o,c,null,f,g,v,Pw),n[us]=i.current,Fg(n),new l0(i)},Mu.hydrateRoot=function(n,i,o){if(!a(n))throw Error(r(299));var c=!1,f="",g=Bv,v=qv,T=Fv,j=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(T=o.onRecoverableError),o.formState!==void 0&&(j=o.formState)),i=ww(n,1,!0,i,o??null,c,f,j,g,v,T,Pw),i.context=Ew(null),o=i.current,c=yr(),c=La(c),f=Mi(c),f.callback=null,Li(o,f,c),o=c,i.current.lanes=o,Oa(i,o),Ss(i),n[us]=i.current,Fg(n),new Cf(i)},Mu.version="19.2.3",Mu}var Hw;function rC(){if(Hw)return d0.exports;Hw=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),d0.exports=nC(),d0.exports}var sC=rC();const iC=Ry(sC);const aC=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),oC=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),Gw=s=>{const e=oC(s);return e.charAt(0).toUpperCase()+e.slice(1)},rI=(...s)=>s.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),lC=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var cC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const uC=bt.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:l,iconNode:u,...p},y)=>bt.createElement("svg",{ref:y,...cC,width:e,height:e,stroke:s,strokeWidth:r?Number(t)*24/Number(e):t,className:rI("lucide",a),...!l&&!lC(p)&&{"aria-hidden":"true"},...p},[...u.map(([m,b])=>bt.createElement(m,b)),...Array.isArray(l)?l:[l]]));const zt=(s,e)=>{const t=bt.forwardRef(({className:r,...a},l)=>bt.createElement(uC,{ref:l,iconNode:e,className:rI(`lucide-${aC(Gw(s))}`,`lucide-${s}`,r),...a}));return t.displayName=Gw(s),t};const dC=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],hC=zt("archive",dC);const fC=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],sI=zt("box",fC);const mC=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],V0=zt("copy",mC);const pC=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],gC=zt("download",pC);const yC=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],O0=zt("eye",yC);const _C=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],M0=zt("file-text",_C);const bC=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Qw=zt("layers",bC);const vC=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],xC=zt("lock",vC);const wC=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],EC=zt("log-out",wC);const TC=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],IC=zt("monitor",TC);const SC=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],AC=zt("moon",SC);const NC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],aa=zt("plus",NC);const RC=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],zf=zt("printer",RC);const CC=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],L0=zt("refresh-cw",CC);const kC=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],DC=zt("save",kC);const PC=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],jC=zt("settings",PC);const VC=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],OC=zt("shield",VC);const MC=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],To=zt("square-pen",MC);const LC=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],UC=zt("sun",LC);const zC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Os=zt("trash-2",zC);const BC=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],qC=zt("user",BC);const FC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],nm=zt("x",FC),HC=()=>{};var Kw={};const iI=function(s){const e=[];let t=0;for(let r=0;r<s.length;r++){let a=s.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<s.length&&(s.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(s.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},GC=function(s){const e=[];let t=0,r=0;for(;t<s.length;){const a=s[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const l=s[t++];e[r++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=s[t++],u=s[t++],p=s[t++],y=((a&7)<<18|(l&63)<<12|(u&63)<<6|p&63)-65536;e[r++]=String.fromCharCode(55296+(y>>10)),e[r++]=String.fromCharCode(56320+(y&1023))}else{const l=s[t++],u=s[t++];e[r++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},aI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<s.length;a+=3){const l=s[a],u=a+1<s.length,p=u?s[a+1]:0,y=a+2<s.length,m=y?s[a+2]:0,b=l>>2,E=(l&3)<<4|p>>4;let I=(p&15)<<2|m>>6,S=m&63;y||(S=64,u||(I=64)),r.push(t[b],t[E],t[I],t[S])}return r.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(iI(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):GC(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<s.length;){const l=t[s.charAt(a++)],p=a<s.length?t[s.charAt(a)]:0;++a;const m=a<s.length?t[s.charAt(a)]:64;++a;const E=a<s.length?t[s.charAt(a)]:64;if(++a,l==null||p==null||m==null||E==null)throw new QC;const I=l<<2|p>>4;if(r.push(I),m!==64){const S=p<<4&240|m>>2;if(r.push(S),E!==64){const M=m<<6&192|E;r.push(M)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class QC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KC=function(s){const e=iI(s);return aI.encodeByteArray(e,!0)},rm=function(s){return KC(s).replace(/\./g,"")},ky=function(s){try{return aI.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function sm(s,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:s===void 0&&(s={});break;case Array:s=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!$C(t)||(s[t]=sm(s[t],e[t]));return s}function $C(s){return s!=="__proto__"}function Dy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const YC=()=>Dy().__FIREBASE_DEFAULTS__,WC=()=>{if(typeof process>"u"||typeof Kw>"u")return;const s=Kw.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},XC=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&ky(s[1]);return e&&JSON.parse(e)},Py=()=>{try{return HC()||YC()||WC()||XC()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},jy=()=>Py()?.config,JC=s=>Py()?.[`_${s}`];class ZC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function Ec(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function oI(s){return(await fetch(s,{credentials:"include"})).ok}function e2(s,e){if(s.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",a=s.iat||0,l=s.sub||s.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...s};return[rm(JSON.stringify(t)),rm(JSON.stringify(u)),""].join(".")}const nd={};function t2(){const s={prod:[],emulator:[]};for(const e of Object.keys(nd))nd[e]?s.emulator.push(e):s.prod.push(e);return s}function n2(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let $w=!1;function lI(s,e){if(typeof window>"u"||typeof document>"u"||!Ec(window.location.host)||nd[s]===e||nd[s]||$w)return;nd[s]=e;function t(I){return`__firebase__banner__${I}`}const r="__firebase__banner",l=t2().prod.length>0;function u(){const I=document.getElementById(r);I&&I.remove()}function p(I){I.style.display="flex",I.style.background="#7faaf0",I.style.position="fixed",I.style.bottom="5px",I.style.left="5px",I.style.padding=".5em",I.style.borderRadius="5px",I.style.alignItems="center"}function y(I,S){I.setAttribute("width","24"),I.setAttribute("id",S),I.setAttribute("height","24"),I.setAttribute("viewBox","0 0 24 24"),I.setAttribute("fill","none"),I.style.marginLeft="-6px"}function m(){const I=document.createElement("span");return I.style.cursor="pointer",I.style.marginLeft="16px",I.style.fontSize="24px",I.innerHTML=" &times;",I.onclick=()=>{$w=!0,u()},I}function b(I,S){I.setAttribute("id",S),I.innerText="Learn more",I.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",I.setAttribute("target","__blank"),I.style.paddingLeft="5px",I.style.textDecoration="underline"}function E(){const I=n2(r),S=t("text"),M=document.getElementById(S)||document.createElement("span"),z=t("learnmore"),ee=document.getElementById(z)||document.createElement("a"),Q=t("preprendIcon"),ae=document.getElementById(Q)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(I.created){const se=I.element;p(se),b(ee,z);const xe=m();y(ae,Q),se.append(ae,M,ee,xe),document.body.appendChild(se)}l?(M.innerText="Preview backend disconnected.",ae.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ae.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,M.innerText="Preview backend running in this workspace."),M.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}function jt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function r2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(jt())}function Rm(){const s=Py()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function s2(){return typeof window<"u"||cI()}function cI(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function i2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function uI(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function Vy(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dI(){const s=jt();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function hI(){return!Rm()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fI(){return!Rm()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function yd(){try{return typeof indexedDB=="object"}catch{return!1}}function a2(){return new Promise((s,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),s(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(t){e(t)}})}const o2="FirebaseError";class Hn extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=o2,Object.setPrototypeOf(this,Hn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qo.prototype.create)}}class qo{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?l2(l,r):"Error",p=`${this.serviceName}: ${u} (${a}).`;return new Hn(a,p,r)}}function l2(s,e){return s.replace(c2,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const c2=/\{\$([^}]+)}/g;function Yw(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function u2(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function pa(s,e){if(s===e)return!0;const t=Object.keys(s),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const l=s[a],u=e[a];if(Ww(l)&&Ww(u)){if(!pa(l,u))return!1}else if(l!==u)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function Ww(s){return s!==null&&typeof s=="object"}function Tc(s){const e=[];for(const[t,r]of Object.entries(s))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ql(s){const e={};return s.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,l]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function $u(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function mI(s,e){const t=new d2(s,e);return t.subscribe.bind(t)}class d2{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");h2(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=p0),a.error===void 0&&(a.error=p0),a.complete===void 0&&(a.complete=p0);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function h2(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function p0(){}function De(s){return s&&s._delegate?s._delegate:s}class Us{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const uo="[DEFAULT]";class f2{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new ZC;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(a){if(r)return null;throw a}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(p2(e))try{this.getOrInitializeService({instanceIdentifier:uo})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});r.resolve(l)}catch{}}}}clearInstance(e=uo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=uo){return this.instances.has(e)}getOptions(e=uo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[l,u]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(l);r===p&&u.resolve(a)}return a}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),a=this.onInitCallbacks.get(r)??new Set;a.add(e),this.onInitCallbacks.set(r,a);const l=this.instances.get(r);return l&&e(l,r),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:m2(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=uo){return this.component?this.component.multipleInstances?e:uo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function m2(s){return s===uo?void 0:s}function p2(s){return s.instantiationMode==="EAGER"}class pI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new f2(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Oy=[];var Ke;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(Ke||(Ke={}));const gI={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},g2=Ke.INFO,y2={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},_2=(s,e,...t)=>{if(e<s.logLevel)return;const r=new Date().toISOString(),a=y2[e];if(a)console[a](`[${r}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Cm{constructor(e){this.name=e,this._logLevel=g2,this._logHandler=_2,this._userLogHandler=null,Oy.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}function b2(s){Oy.forEach(e=>{e.setLogLevel(s)})}function v2(s,e){for(const t of Oy){let r=null;e&&e.level&&(r=gI[e.level]),s===null?t.userLogHandler=null:t.userLogHandler=(a,l,...u)=>{const p=u.map(y=>{if(y==null)return null;if(typeof y=="string")return y;if(typeof y=="number"||typeof y=="boolean")return y.toString();if(y instanceof Error)return y.message;try{return JSON.stringify(y)}catch{return null}}).filter(y=>y).join(" ");l>=(r??a.logLevel)&&s({level:Ke[l].toLowerCase(),message:p,args:u,type:a.name})}}}const x2=(s,e)=>e.some(t=>s instanceof t);let Xw,Jw;function w2(){return Xw||(Xw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function E2(){return Jw||(Jw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yI=new WeakMap,U0=new WeakMap,_I=new WeakMap,g0=new WeakMap,My=new WeakMap;function T2(s){const e=new Promise((t,r)=>{const a=()=>{s.removeEventListener("success",l),s.removeEventListener("error",u)},l=()=>{t(ua(s.result)),a()},u=()=>{r(s.error),a()};s.addEventListener("success",l),s.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&yI.set(t,s)}).catch(()=>{}),My.set(e,s),e}function I2(s){if(U0.has(s))return;const e=new Promise((t,r)=>{const a=()=>{s.removeEventListener("complete",l),s.removeEventListener("error",u),s.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{r(s.error||new DOMException("AbortError","AbortError")),a()};s.addEventListener("complete",l),s.addEventListener("error",u),s.addEventListener("abort",u)});U0.set(s,e)}let z0={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return U0.get(s);if(e==="objectStoreNames")return s.objectStoreNames||_I.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ua(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function S2(s){z0=s(z0)}function A2(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=s.call(y0(this),e,...t);return _I.set(r,e.sort?e.sort():[e]),ua(r)}:E2().includes(s)?function(...e){return s.apply(y0(this),e),ua(yI.get(this))}:function(...e){return ua(s.apply(y0(this),e))}}function N2(s){return typeof s=="function"?A2(s):(s instanceof IDBTransaction&&I2(s),x2(s,w2())?new Proxy(s,z0):s)}function ua(s){if(s instanceof IDBRequest)return T2(s);if(g0.has(s))return g0.get(s);const e=N2(s);return e!==s&&(g0.set(s,e),My.set(e,s)),e}const y0=s=>My.get(s);function R2(s,e,{blocked:t,upgrade:r,blocking:a,terminated:l}={}){const u=indexedDB.open(s,e),p=ua(u);return r&&u.addEventListener("upgradeneeded",y=>{r(ua(u.result),y.oldVersion,y.newVersion,ua(u.transaction),y)}),t&&u.addEventListener("blocked",y=>t(y.oldVersion,y.newVersion,y)),p.then(y=>{l&&y.addEventListener("close",()=>l()),a&&y.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),p}const C2=["get","getKey","getAll","getAllKeys","count"],k2=["put","add","delete","clear"],_0=new Map;function Zw(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(_0.get(e))return _0.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=k2.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||C2.includes(t)))return;const l=async function(u,...p){const y=this.transaction(u,a?"readwrite":"readonly");let m=y.store;return r&&(m=m.index(p.shift())),(await Promise.all([m[t](...p),a&&y.done]))[0]};return _0.set(e,l),l}S2(s=>({...s,get:(e,t,r)=>Zw(e,t)||s.get(e,t,r),has:(e,t)=>!!Zw(e,t)||s.has(e,t)}));class D2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(P2(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function P2(s){return s.getComponent()?.type==="VERSION"}const im="@firebase/app",B0="0.14.7";const hi=new Cm("@firebase/app"),j2="@firebase/app-compat",V2="@firebase/analytics-compat",O2="@firebase/analytics",M2="@firebase/app-check-compat",L2="@firebase/app-check",U2="@firebase/auth",z2="@firebase/auth-compat",B2="@firebase/database",q2="@firebase/data-connect",F2="@firebase/database-compat",H2="@firebase/functions",G2="@firebase/functions-compat",Q2="@firebase/installations",K2="@firebase/installations-compat",$2="@firebase/messaging",Y2="@firebase/messaging-compat",W2="@firebase/performance",X2="@firebase/performance-compat",J2="@firebase/remote-config",Z2="@firebase/remote-config-compat",ek="@firebase/storage",tk="@firebase/storage-compat",nk="@firebase/firestore",rk="@firebase/ai",sk="@firebase/firestore-compat",ik="firebase",ak="12.8.0";const ga="[DEFAULT]",ok={[im]:"fire-core",[j2]:"fire-core-compat",[O2]:"fire-analytics",[V2]:"fire-analytics-compat",[L2]:"fire-app-check",[M2]:"fire-app-check-compat",[U2]:"fire-auth",[z2]:"fire-auth-compat",[B2]:"fire-rtdb",[q2]:"fire-data-connect",[F2]:"fire-rtdb-compat",[H2]:"fire-fn",[G2]:"fire-fn-compat",[Q2]:"fire-iid",[K2]:"fire-iid-compat",[$2]:"fire-fcm",[Y2]:"fire-fcm-compat",[W2]:"fire-perf",[X2]:"fire-perf-compat",[J2]:"fire-rc",[Z2]:"fire-rc-compat",[ek]:"fire-gcs",[tk]:"fire-gcs-compat",[nk]:"fire-fst",[sk]:"fire-fst-compat",[rk]:"fire-vertex","fire-js":"fire-js",[ik]:"fire-js-all"};const ya=new Map,ec=new Map,tc=new Map;function _d(s,e){try{s.container.addComponent(e)}catch(t){hi.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function bI(s,e){s.container.addOrOverwriteComponent(e)}function _a(s){const e=s.name;if(tc.has(e))return hi.debug(`There were multiple attempts to register component ${e}.`),!1;tc.set(e,s);for(const t of ya.values())_d(t,s);for(const t of ec.values())_d(t,s);return!0}function vI(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function lk(s,e,t=ga){vI(s,e).clearInstance(t)}function Ly(s){return s.options!==void 0}function xI(s){return Ly(s)?!1:"authIdToken"in s||"appCheckToken"in s||"releaseOnDeref"in s||"automaticDataCollectionEnabled"in s}function Rt(s){return s==null?!1:s.settings!==void 0}function ck(){tc.clear()}const uk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xr=new qo("app","Firebase",uk);let wI=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Us("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xr.create("app-deleted",{appName:this._name})}};function eE(s,e){const t=ky(s.split(".")[1]);if(t===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(t).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const a=JSON.parse(t).exp*1e3,l=new Date().getTime();a-l<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class dk extends wI{constructor(e,t,r,a){const l=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!0,u={name:r,automaticDataCollectionEnabled:l};if(e.apiKey!==void 0)super(e,u,a);else{const p=e;super(p.options,u,a)}this._serverConfig={automaticDataCollectionEnabled:l,...t},this._serverConfig.authIdToken&&eE(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&eE(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,es(im,B0,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){zy(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw xr.create("server-app-deleted")}}const Sa=ak;function Uy(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const r={name:ga,automaticDataCollectionEnabled:!0,...e},a=r.name;if(typeof a!="string"||!a)throw xr.create("bad-app-name",{appName:String(a)});if(t||(t=jy()),!t)throw xr.create("no-options");const l=ya.get(a);if(l){if(pa(t,l.options)&&pa(r,l.config))return l;throw xr.create("duplicate-app",{appName:a})}const u=new pI(a);for(const y of tc.values())u.addComponent(y);const p=new wI(t,r,u);return ya.set(a,p),p}function hk(s,e={}){if(s2()&&!cI())throw xr.create("invalid-server-app-environment");let t,r=e||{};if(s&&(Ly(s)?t=s.options:xI(s)?r=s:t=s),r.automaticDataCollectionEnabled===void 0&&(r.automaticDataCollectionEnabled=!0),t||(t=jy()),!t)throw xr.create("no-options");const a={...r,...t};a.releaseOnDeref!==void 0&&delete a.releaseOnDeref;const l=b=>[...b].reduce((E,I)=>Math.imul(31,E)+I.charCodeAt(0)|0,0);if(r.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw xr.create("finalization-registry-not-supported",{});const u=""+l(JSON.stringify(a)),p=ec.get(u);if(p)return p.incRefCount(r.releaseOnDeref),p;const y=new pI(u);for(const b of tc.values())y.addComponent(b);const m=new dk(t,r,u,y);return ec.set(u,m),m}function fk(s=ga){const e=ya.get(s);if(!e&&s===ga&&jy())return Uy();if(!e)throw xr.create("no-app",{appName:s});return e}function mk(){return Array.from(ya.values())}async function zy(s){let e=!1;const t=s.name;ya.has(t)?(e=!0,ya.delete(t)):ec.has(t)&&s.decRefCount()<=0&&(ec.delete(t),e=!0),e&&(await Promise.all(s.container.getProviders().map(r=>r.delete())),s.isDeleted=!0)}function es(s,e,t){let r=ok[s]??s;t&&(r+=`-${t}`);const a=r.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${r}" with version "${e}":`];a&&u.push(`library name "${r}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hi.warn(u.join(" "));return}_a(new Us(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function EI(s,e){if(s!==null&&typeof s!="function")throw xr.create("invalid-log-argument");v2(s,e)}function TI(s){b2(s)}const pk="firebase-heartbeat-database",gk=1,bd="firebase-heartbeat-store";let b0=null;function II(){return b0||(b0=R2(pk,gk,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(bd)}catch(t){console.warn(t)}}}}).catch(s=>{throw xr.create("idb-open",{originalErrorMessage:s.message})})),b0}async function yk(s){try{const t=(await II()).transaction(bd),r=await t.objectStore(bd).get(SI(s));return await t.done,r}catch(e){if(e instanceof Hn)hi.warn(e.message);else{const t=xr.create("idb-get",{originalErrorMessage:e?.message});hi.warn(t.message)}}}async function tE(s,e){try{const r=(await II()).transaction(bd,"readwrite");await r.objectStore(bd).put(e,SI(s)),await r.done}catch(t){if(t instanceof Hn)hi.warn(t.message);else{const r=xr.create("idb-set",{originalErrorMessage:t?.message});hi.warn(r.message)}}}function SI(s){return`${s.name}!${s.options.appId}`}const _k=1024,bk=30;class vk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new wk(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=nE();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(a=>a.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>bk){const a=Ek(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){hi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=nE(),{heartbeatsToSend:t,unsentEntries:r}=xk(this._heartbeatsCache.heartbeats),a=rm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return hi.warn(e),""}}}function nE(){return new Date().toISOString().substring(0,10)}function xk(s,e=_k){const t=[];let r=s.slice();for(const a of s){const l=t.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),rE(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),rE(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class wk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return yd()?a2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await yk(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return tE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return tE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function rE(s){return rm(JSON.stringify({version:2,heartbeats:s})).length}function Ek(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let r=1;r<s.length;r++)s[r].date<t&&(t=s[r].date,e=r);return e}function Tk(s){_a(new Us("platform-logger",e=>new D2(e),"PRIVATE")),_a(new Us("heartbeat",e=>new vk(e),"PRIVATE")),es(im,B0,s),es(im,B0,"esm2020"),es("fire-js","")}Tk("");const Ik=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Hn,SDK_VERSION:Sa,_DEFAULT_ENTRY_NAME:ga,_addComponent:_d,_addOrOverwriteComponent:bI,_apps:ya,_clearComponents:ck,_components:tc,_getProvider:vI,_isFirebaseApp:Ly,_isFirebaseServerApp:Rt,_isFirebaseServerAppSettings:xI,_registerComponent:_a,_removeServiceInstance:lk,_serverApps:ec,deleteApp:zy,getApp:fk,getApps:mk,initializeApp:Uy,initializeServerApp:hk,onLog:EI,registerVersion:es,setLogLevel:TI},Symbol.toStringTag,{value:"Module"}));class Sk{constructor(e,t){this._delegate=e,this.firebase=t,_d(e,new Us("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),zy(this._delegate)))}_getService(e,t=ga){this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&r.getComponent()?.instantiationMode==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=ga){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){_d(this._delegate,e)}_addOrOverwriteComponent(e){bI(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Ak={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},sE=new qo("app-compat","Firebase",Ak);function Nk(s){const e={},t={__esModule:!0,initializeApp:l,app:a,registerVersion:es,setLogLevel:TI,onLog:EI,apps:null,SDK_VERSION:Sa,INTERNAL:{registerComponent:p,removeApp:r,useAsService:y,modularAPIs:Ik}};t.default=t,Object.defineProperty(t,"apps",{get:u});function r(m){delete e[m]}function a(m){if(m=m||ga,!Yw(e,m))throw sE.create("no-app",{appName:m});return e[m]}a.App=s;function l(m,b={}){const E=Uy(m,b);if(Yw(e,E.name))return e[E.name];const I=new s(E,t);return e[E.name]=I,I}function u(){return Object.keys(e).map(m=>e[m])}function p(m){const b=m.name,E=b.replace("-compat","");if(_a(m)&&m.type==="PUBLIC"){const I=(S=a())=>{if(typeof S[E]!="function")throw sE.create("invalid-app-argument",{appName:b});return S[E]()};m.serviceProps!==void 0&&sm(I,m.serviceProps),t[E]=I,s.prototype[E]=function(...S){return this._getService.bind(this,b).apply(this,m.multipleInstances?S:[])}}return m.type==="PUBLIC"?t[E]:null}function y(m,b){return b==="serverAuth"?null:b}return t}function AI(){const s=Nk(Sk);s.INTERNAL={...s.INTERNAL,createFirebaseNamespace:AI,extendNamespace:e,createSubscribe:mI,ErrorFactory:qo,deepExtend:sm};function e(t){sm(s,t)}return s}const Rk=AI();const iE=new Cm("@firebase/app-compat"),Ck="@firebase/app-compat",kk="0.5.7";function Dk(s){es(Ck,kk,s)}try{const s=Dy();if(s.firebase!==void 0){iE.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=s.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&iE.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const ts=Rk;Dk();var Pk="firebase",jk="12.8.0";ts.registerVersion(Pk,jk,"app-compat");const Lu={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",TWITTER:"twitter.com"},jl={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function Vk(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements.","invalid-hosting-link-domain":"The provided Hosting link domain is not configured in Firebase Hosting or is not owned by the current project. This cannot be a default Hosting domain (`web.app` or `firebaseapp.com`)."}}function NI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Ok=Vk,Mk=NI,RI=new qo("auth","Firebase",NI());const am=new Cm("@firebase/auth");function Lk(s,...e){am.logLevel<=Ke.WARN&&am.warn(`Auth (${Sa}): ${s}`,...e)}function Bf(s,...e){am.logLevel<=Ke.ERROR&&am.error(`Auth (${Sa}): ${s}`,...e)}function Rn(s,...e){throw qy(s,...e)}function dn(s,...e){return qy(s,...e)}function By(s,e,t){const r={...Mk(),[e]:t};return new qo("auth","Firebase",r).create(e,{appName:s.name})}function _n(s){return By(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Ic(s,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Rn(s,"argument-error"),By(s,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function qy(s,...e){if(typeof s!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=s.name),s._errorFactory.create(t,...r)}return RI.create(s,...e)}function fe(s,e,...t){if(!s)throw qy(e,...t)}function Ps(s){const e="INTERNAL ASSERTION FAILED: "+s;throw Bf(e),new Error(e)}function is(s,e){s||Ps(e)}function vd(){return typeof self<"u"&&self.location?.href||""}function Fy(){return aE()==="http:"||aE()==="https:"}function aE(){return typeof self<"u"&&self.location?.protocol||null}function Uk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Fy()||uI()||"connection"in navigator)?navigator.onLine:!0}function zk(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}class zd{constructor(e,t){this.shortDelay=e,this.longDelay=t,is(t>e,"Short delay should be less than long delay!"),this.isMobile=r2()||Vy()}get(){return Uk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Hy(s,e){is(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class CI{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ps("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ps("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ps("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Bk={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const qk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Fk=new zd(3e4,6e4);function Bt(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function qt(s,e,t,r,a={}){return kI(s,a,async()=>{let l={},u={};r&&(e==="GET"?u=r:l={body:JSON.stringify(r)});const p=Tc({key:s.config.apiKey,...u}).slice(1),y=await s._getAdditionalHeaders();y["Content-Type"]="application/json",s.languageCode&&(y["X-Firebase-Locale"]=s.languageCode);const m={method:e,headers:y,...l};return i2()||(m.referrerPolicy="no-referrer"),s.emulatorConfig&&Ec(s.emulatorConfig.host)&&(m.credentials="include"),CI.fetch()(await DI(s,s.config.apiHost,t,p),m)})}async function kI(s,e,t){s._canInitEmulator=!1;const r={...Bk,...e};try{const a=new Gk(s),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw Yu(s,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const p=l.ok?u.errorMessage:u.error.message,[y,m]=p.split(" : ");if(y==="FEDERATED_USER_ID_ALREADY_LINKED")throw Yu(s,"credential-already-in-use",u);if(y==="EMAIL_EXISTS")throw Yu(s,"email-already-in-use",u);if(y==="USER_DISABLED")throw Yu(s,"user-disabled",u);const b=r[y]||y.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw By(s,b,m);Rn(s,b)}}catch(a){if(a instanceof Hn)throw a;Rn(s,"network-request-failed",{message:String(a)})}}async function gi(s,e,t,r,a={}){const l=await qt(s,e,t,r,a);return"mfaPendingCredential"in l&&Rn(s,"multi-factor-auth-required",{_serverResponse:l}),l}async function DI(s,e,t,r){const a=`${e}${t}?${r}`,l=s,u=l.config.emulator?Hy(s.config,a):`${s.config.apiScheme}://${a}`;return qk.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function Hk(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Gk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(dn(this.auth,"network-request-failed")),Fk.get())})}}function Yu(s,e,t){const r={appName:s.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=dn(s,e,r);return a.customData._tokenResponse=t,a}function oE(s){return s!==void 0&&s.getResponse!==void 0}function lE(s){return s!==void 0&&s.enterprise!==void 0}class PI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Hk(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Qk(s){return(await qt(s,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function jI(s,e){return qt(s,"GET","/v2/recaptchaConfig",Bt(s,e))}async function Kk(s,e){return qt(s,"POST","/v1/accounts:delete",e)}async function $k(s,e){return qt(s,"POST","/v1/accounts:update",e)}async function om(s,e){return qt(s,"POST","/v1/accounts:lookup",e)}function rd(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Yk(s,e=!1){const t=De(s),r=await t.getIdToken(e),a=km(r);fe(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:r,authTime:rd(v0(a.auth_time)),issuedAtTime:rd(v0(a.iat)),expirationTime:rd(v0(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function v0(s){return Number(s)*1e3}function km(s){const[e,t,r]=s.split(".");if(e===void 0||t===void 0||r===void 0)return Bf("JWT malformed, contained fewer than 3 sections"),null;try{const a=ky(t);return a?JSON.parse(a):(Bf("Failed to decode base64 JWT payload"),null)}catch(a){return Bf("Caught error parsing JWT payload as JSON",a?.toString()),null}}function cE(s){const e=km(s);return fe(e,"internal-error"),fe(typeof e.exp<"u","internal-error"),fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function fi(s,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Hn&&Wk(r)&&s.auth.currentUser===s&&await s.auth.signOut(),r}}function Wk({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}class Xk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class q0{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=rd(this.lastLoginAt),this.creationTime=rd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function xd(s){const e=s.auth,t=await s.getIdToken(),r=await fi(s,om(e,{idToken:t}));fe(r?.users.length,e,"internal-error");const a=r.users[0];s._notifyReloadListener(a);const l=a.providerUserInfo?.length?VI(a.providerUserInfo):[],u=Zk(s.providerData,l),p=s.isAnonymous,y=!(s.email&&a.passwordHash)&&!u?.length,m=p?y:!1,b={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new q0(a.createdAt,a.lastLoginAt),isAnonymous:m};Object.assign(s,b)}async function Jk(s){const e=De(s);await xd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Zk(s,e){return[...s.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function VI(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function eD(s,e){const t=await kI(s,{},async()=>{const r=Tc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=s.config,u=await DI(s,a,"/v1/token",`key=${l}`),p=await s._getAdditionalHeaders();p["Content-Type"]="application/x-www-form-urlencoded";const y={method:"POST",headers:p,body:r};return s.emulatorConfig&&Ec(s.emulatorConfig.host)&&(y.credentials="include"),CI.fetch()(u,y)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function tD(s,e){return qt(s,"POST","/v2/accounts:revokeToken",Bt(s,e))}class Kl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fe(e.idToken,"internal-error"),fe(typeof e.idToken<"u","internal-error"),fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):cE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){fe(e.length!==0,"internal-error");const t=cE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:l}=await eD(e,t);this.updateTokensAndExpiration(r,a,Number(l))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:l}=t,u=new Kl;return r&&(fe(typeof r=="string","internal-error",{appName:e}),u.refreshToken=r),a&&(fe(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(fe(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Kl,this.toJSON())}_performRefresh(){return Ps("not implemented")}}function ea(s,e){fe(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Zr{constructor({uid:e,auth:t,stsTokenManager:r,...a}){this.providerId="firebase",this.proactiveRefresh=new Xk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new q0(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await fi(this,this.stsTokenManager.getToken(this.auth,e));return fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Yk(this,e)}reload(){return Jk(this)}_assign(e){this!==e&&(fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Zr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await xd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Rt(this.auth.app))return Promise.reject(_n(this.auth));const e=await this.getIdToken();return await fi(this,Kk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,a=t.email??void 0,l=t.phoneNumber??void 0,u=t.photoURL??void 0,p=t.tenantId??void 0,y=t._redirectEventId??void 0,m=t.createdAt??void 0,b=t.lastLoginAt??void 0,{uid:E,emailVerified:I,isAnonymous:S,providerData:M,stsTokenManager:z}=t;fe(E&&z,e,"internal-error");const ee=Kl.fromJSON(this.name,z);fe(typeof E=="string",e,"internal-error"),ea(r,e.name),ea(a,e.name),fe(typeof I=="boolean",e,"internal-error"),fe(typeof S=="boolean",e,"internal-error"),ea(l,e.name),ea(u,e.name),ea(p,e.name),ea(y,e.name),ea(m,e.name),ea(b,e.name);const Q=new Zr({uid:E,auth:e,email:a,emailVerified:I,displayName:r,isAnonymous:S,photoURL:u,phoneNumber:l,tenantId:p,stsTokenManager:ee,createdAt:m,lastLoginAt:b});return M&&Array.isArray(M)&&(Q.providerData=M.map(ae=>({...ae}))),y&&(Q._redirectEventId=y),Q}static async _fromIdTokenResponse(e,t,r=!1){const a=new Kl;a.updateFromServerResponse(t);const l=new Zr({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await xd(l),l}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];fe(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?VI(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,p=new Kl;p.updateFromIdToken(r);const y=new Zr({uid:a.localId,auth:e,stsTokenManager:p,isAnonymous:u}),m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new q0(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(y,m),y}}const uE=new Map;function vr(s){is(s instanceof Function,"Expected a class definition");let e=uE.get(s);return e?(is(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,uE.set(s,e),e)}class OI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}OI.type="NONE";const nc=OI;function Io(s,e,t){return`firebase:${s}:${e}:${t}`}class $l{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:l}=this.auth;this.fullUserKey=Io(this.userKey,a.apiKey,l),this.fullPersistenceKey=Io("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await om(this.auth,{idToken:e}).catch(()=>{});return t?Zr._fromGetAccountInfoResponse(this.auth,t,e):null}return Zr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new $l(vr(nc),e,r);const a=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let l=a[0]||vr(nc);const u=Io(r,e.config.apiKey,e.name);let p=null;for(const m of t)try{const b=await m._get(u);if(b){let E;if(typeof b=="string"){const I=await om(e,{idToken:b}).catch(()=>{});if(!I)break;E=await Zr._fromGetAccountInfoResponse(e,I,b)}else E=Zr._fromJSON(e,b);m!==l&&(p=E),l=m;break}}catch{}const y=a.filter(m=>m._shouldAllowMigration);return!l._shouldAllowMigration||!y.length?new $l(l,e,r):(l=y[0],p&&await l._set(u,p.toJSON()),await Promise.all(t.map(async m=>{if(m!==l)try{await m._remove(u)}catch{}})),new $l(l,e,r))}}function dE(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(zI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(MI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(BI(e))return"Blackberry";if(qI(e))return"Webos";if(LI(e))return"Safari";if((e.includes("chrome/")||UI(e))&&!e.includes("edge/"))return"Chrome";if(Bd(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=s.match(t);if(r?.length===2)return r[1]}return"Other"}function MI(s=jt()){return/firefox\//i.test(s)}function LI(s=jt()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function UI(s=jt()){return/crios\//i.test(s)}function zI(s=jt()){return/iemobile/i.test(s)}function Bd(s=jt()){return/android/i.test(s)}function BI(s=jt()){return/blackberry/i.test(s)}function qI(s=jt()){return/webos/i.test(s)}function qd(s=jt()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function nD(s=jt()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(s)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(s)}function rD(s=jt()){return qd(s)&&!!window.navigator?.standalone}function sD(){return dI()&&document.documentMode===10}function FI(s=jt()){return qd(s)||Bd(s)||qI(s)||BI(s)||/windows phone/i.test(s)||zI(s)}function HI(s,e=[]){let t;switch(s){case"Browser":t=dE(jt());break;case"Worker":t=`${dE(jt())}-${s}`;break;default:t=s}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Sa}/${r}`}class iD{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=l=>new Promise((u,p)=>{try{const y=e(l);u(y)}catch(y){p(y)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function aD(s,e={}){return qt(s,"GET","/v2/passwordPolicy",Bt(s,e))}const oD=6;class lD{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??oD,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class cD{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hE(this),this.idTokenSubscription=new hE(this),this.beforeStateQueue=new iD(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=RI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=vr(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await $l.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await om(this,{idToken:e}),r=await Zr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Rt(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=r?._redirectEventId,p=await this.tryRedirectSignIn(e);(!l||l===u)&&p?.user&&(r=p.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(l){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await xd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Rt(this.app))return Promise.reject(_n(this));const t=e?De(e):null;return t&&fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Rt(this.app)?Promise.reject(_n(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Rt(this.app)?Promise.reject(_n(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(vr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aD(this),t=new lD(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new qo("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await tD(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&vr(e)||this._popupRedirectResolver;fe(t,this,"argument-error"),this.redirectPersistenceManager=await $l.create(this,[vr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const p=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(p,this,"internal-error"),p.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const y=e.addObserver(t,r,a);return()=>{u=!0,y()}}else{const y=e.addObserver(t);return()=>{u=!0,y()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=HI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Rt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&Lk(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Vt(s){return De(s)}class hE{constructor(e){this.auth=e,this.observer=null,this.addObserver=mI(t=>this.observer=t)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Fd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function uD(s){Fd=s}function Gy(s){return Fd.loadJS(s)}function dD(){return Fd.recaptchaV2Script}function hD(){return Fd.recaptchaEnterpriseScript}function fD(){return Fd.gapiScript}function GI(s){return`__${s}${Math.floor(Math.random()*1e6)}`}const mD=500,pD=6e4,Df=1e12;class gD{constructor(e){this.auth=e,this.counter=Df,this._widgets=new Map}render(e,t){const r=this.counter;return this._widgets.set(r,new bD(e,this.auth.name,t||{})),this.counter++,r}reset(e){const t=e||Df;this._widgets.get(t)?.delete(),this._widgets.delete(t)}getResponse(e){const t=e||Df;return this._widgets.get(t)?.getResponse()||""}async execute(e){const t=e||Df;return this._widgets.get(t)?.execute(),""}}class yD{constructor(){this.enterprise=new _D}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class _D{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class bD{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const a=typeof e=="string"?document.getElementById(e):e;fe(a,"argument-error",{appName:t}),this.container=a,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=vD(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},pD)},mD))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function vD(s){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<s;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}const xD="recaptcha-enterprise",sd="NO_RECAPTCHA";class QI{constructor(e){this.type=xD,this.auth=Vt(e)}async verify(e="verify",t=!1){async function r(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,p)=>{jI(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(y=>{if(y.recaptchaKey===void 0)p(new Error("recaptcha Enterprise site key undefined"));else{const m=new PI(y);return l.tenantId==null?l._agentRecaptchaConfig=m:l._tenantRecaptchaConfigs[l.tenantId]=m,u(m.siteKey)}}).catch(y=>{p(y)})})}function a(l,u,p){const y=window.grecaptcha;lE(y)?y.enterprise.ready(()=>{y.enterprise.execute(l,{action:e}).then(m=>{u(m)}).catch(()=>{u(sd)})}):p(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new yD().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{r(this.auth).then(p=>{if(!t&&lE(window.grecaptcha))a(p,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let y=hD();y.length!==0&&(y+=p),Gy(y).then(()=>{a(p,l,u)}).catch(m=>{u(m)})}}).catch(p=>{u(p)})})}}async function Uu(s,e,t,r=!1,a=!1){const l=new QI(s);let u;if(a)u=sd;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const p={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in p){const y=p.phoneEnrollmentInfo.phoneNumber,m=p.phoneEnrollmentInfo.recaptchaToken;Object.assign(p,{phoneEnrollmentInfo:{phoneNumber:y,recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in p){const y=p.phoneSignInInfo.recaptchaToken;Object.assign(p,{phoneSignInInfo:{recaptchaToken:y,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return p}return r?Object.assign(p,{captchaResp:u}):Object.assign(p,{captchaResponse:u}),Object.assign(p,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(p,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),p}async function da(s,e,t,r,a){if(a==="EMAIL_PASSWORD_PROVIDER")if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await Uu(s,e,t,t==="getOobCode");return r(s,l)}else return r(s,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await Uu(s,e,t,t==="getOobCode");return r(s,u)}else return Promise.reject(l)});else if(a==="PHONE_PROVIDER")if(s._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const l=await Uu(s,e,t);return r(s,l).catch(async u=>{if(s._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(u.code==="auth/missing-recaptcha-token"||u.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);const p=await Uu(s,e,t,!1,!0);return r(s,p)}return Promise.reject(u)})}else{const l=await Uu(s,e,t,!1,!0);return r(s,l)}else return Promise.reject(a+" provider is not supported.")}async function wD(s){const e=Vt(s),t=await jI(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new PI(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new QI(e).verify()}function ED(s,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(vr);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(r,e?.popupRedirectResolver)}function TD(s,e,t){const r=Vt(s);fe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!!t?.disableWarnings,l=KI(e),{host:u,port:p}=ID(e),y=p===null?"":`:${p}`,m={url:`${l}//${u}${y}/`},b=Object.freeze({host:u,port:p,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!r._canInitEmulator){fe(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),fe(pa(m,r.config.emulator)&&pa(b,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=b,r.settings.appVerificationDisabledForTesting=!0,Ec(u)?(oI(`${l}//${u}${y}`),lI("Auth",!0)):a||SD()}function KI(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function ID(s){const e=KI(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const l=a[1];return{host:l,port:fE(r.substr(l.length+1))}}else{const[l,u]=r.split(":");return{host:l,port:fE(u)}}}function fE(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function SD(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}class Sc{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ps("not implemented")}_getIdTokenResponse(e){return Ps("not implemented")}_linkToIdToken(e,t){return Ps("not implemented")}_getReauthenticationResolver(e){return Ps("not implemented")}}async function $I(s,e){return qt(s,"POST","/v1/accounts:resetPassword",Bt(s,e))}async function AD(s,e){return qt(s,"POST","/v1/accounts:update",e)}async function ND(s,e){return qt(s,"POST","/v1/accounts:signUp",e)}async function RD(s,e){return qt(s,"POST","/v1/accounts:update",Bt(s,e))}async function CD(s,e){return gi(s,"POST","/v1/accounts:signInWithPassword",Bt(s,e))}async function Dm(s,e){return qt(s,"POST","/v1/accounts:sendOobCode",Bt(s,e))}async function kD(s,e){return Dm(s,e)}async function DD(s,e){return Dm(s,e)}async function PD(s,e){return Dm(s,e)}async function jD(s,e){return Dm(s,e)}async function VD(s,e){return gi(s,"POST","/v1/accounts:signInWithEmailLink",Bt(s,e))}async function OD(s,e){return gi(s,"POST","/v1/accounts:signInWithEmailLink",Bt(s,e))}class wd extends Sc{constructor(e,t,r,a=null){super("password",r),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new wd(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new wd(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return da(e,t,"signInWithPassword",CD,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return VD(e,{email:this._email,oobCode:this._password});default:Rn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return da(e,r,"signUpPassword",ND,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return OD(e,{idToken:t,email:this._email,oobCode:this._password});default:Rn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function di(s,e){return gi(s,"POST","/v1/accounts:signInWithIdp",Bt(s,e))}const MD="http://localhost";class zs extends Sc{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new zs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Rn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,...l}=t;if(!r||!a)return null;const u=new zs(r,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return di(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,di(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,di(e,t)}buildRequest(){const e={requestUri:MD,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Tc(t)}return e}}async function mE(s,e){return qt(s,"POST","/v1/accounts:sendVerificationCode",Bt(s,e))}async function LD(s,e){return gi(s,"POST","/v1/accounts:signInWithPhoneNumber",Bt(s,e))}async function UD(s,e){const t=await gi(s,"POST","/v1/accounts:signInWithPhoneNumber",Bt(s,e));if(t.temporaryProof)throw Yu(s,"account-exists-with-different-credential",t);return t}const zD={USER_NOT_FOUND:"user-not-found"};async function BD(s,e){const t={...e,operation:"REAUTH"};return gi(s,"POST","/v1/accounts:signInWithPhoneNumber",Bt(s,t),zD)}class So extends Sc{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new So({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new So({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return LD(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return UD(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return BD(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:a}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:a}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:a,temporaryProof:l}=e;return!r&&!t&&!a&&!l?null:new So({verificationId:t,verificationCode:r,phoneNumber:a,temporaryProof:l})}}function qD(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function FD(s){const e=Ql($u(s)).link,t=e?Ql($u(e)).deep_link_id:null,r=Ql($u(s)).deep_link_id;return(r?Ql($u(r)).link:null)||r||t||e||s}class Pm{constructor(e){const t=Ql($u(e)),r=t.apiKey??null,a=t.oobCode??null,l=qD(t.mode??null);fe(r&&a&&l,"argument-error"),this.apiKey=r,this.operation=l,this.code=a,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=FD(e);try{return new Pm(t)}catch{return null}}}class Aa{constructor(){this.providerId=Aa.PROVIDER_ID}static credential(e,t){return wd._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Pm.parseLink(t);return fe(r,"argument-error"),wd._fromEmailAndCode(e,r.code,r.tenantId)}}Aa.PROVIDER_ID="password";Aa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Aa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class yi{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ac extends yi{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Yl extends Ac{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return fe("providerId"in t&&"signInMethod"in t,"argument-error"),zs._fromParams(t)}credential(e){return this._credential({...e,nonce:e.rawNonce})}_credential(e){return fe(e.idToken||e.accessToken,"argument-error"),zs._fromParams({...e,providerId:this.providerId,signInMethod:this.providerId})}static credentialFromResult(e){return Yl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Yl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:a,pendingToken:l,nonce:u,providerId:p}=e;if(!r&&!a&&!t&&!l||!p)return null;try{return new Yl(p)._credential({idToken:t,accessToken:r,nonce:u,pendingToken:l})}catch{return null}}}class Rs extends Ac{constructor(){super("facebook.com")}static credential(e){return zs._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rs.credential(e.oauthAccessToken)}catch{return null}}}Rs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Rs.PROVIDER_ID="facebook.com";class Cs extends Ac{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return zs._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Cs.credential(t,r)}catch{return null}}}Cs.GOOGLE_SIGN_IN_METHOD="google.com";Cs.PROVIDER_ID="google.com";class ks extends Ac{constructor(){super("github.com")}static credential(e){return zs._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ks.credential(e.oauthAccessToken)}catch{return null}}}ks.GITHUB_SIGN_IN_METHOD="github.com";ks.PROVIDER_ID="github.com";const HD="http://localhost";class rc extends Sc{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){const t=this.buildRequest();return di(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,di(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,di(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a,pendingToken:l}=t;return!r||!a||!l||r!==a?null:new rc(r,l)}static _create(e,t){return new rc(e,t)}buildRequest(){return{requestUri:HD,returnSecureToken:!0,pendingToken:this.pendingToken}}}const GD="saml.";class lm extends yi{constructor(e){fe(e.startsWith(GD),"argument-error"),super(e)}static credentialFromResult(e){return lm.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return lm.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=rc.fromJSON(e);return fe(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return rc._create(r,t)}catch{return null}}}class Ds extends Ac{constructor(){super("twitter.com")}static credential(e,t){return zs._fromParams({providerId:Ds.PROVIDER_ID,signInMethod:Ds.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ds.credentialFromTaggedObject(e)}static credentialFromError(e){return Ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ds.credential(t,r)}catch{return null}}}Ds.TWITTER_SIGN_IN_METHOD="twitter.com";Ds.PROVIDER_ID="twitter.com";async function YI(s,e){return gi(s,"POST","/v1/accounts:signUp",Bt(s,e))}class Lr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const l=await Zr._fromIdTokenResponse(e,r,a),u=pE(r);return new Lr({user:l,providerId:u,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=pE(r);return new Lr({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function pE(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}async function QD(s){if(Rt(s.app))return Promise.reject(_n(s));const e=Vt(s);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Lr({user:e.currentUser,providerId:null,operationType:"signIn"});const t=await YI(e,{returnSecureToken:!0}),r=await Lr._fromIdTokenResponse(e,"signIn",t,!0);return await e._updateCurrentUser(r.user),r}class cm extends Hn{constructor(e,t,r,a){super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,cm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new cm(e,t,r,a)}}function WI(s,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?cm._fromErrorAndOperation(s,l,e,r):l})}function XI(s){return new Set(s.map(({providerId:e})=>e).filter(e=>!!e))}async function KD(s,e){const t=De(s);await jm(!0,t,e);const{providerUserInfo:r}=await $k(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=XI(r||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function Qy(s,e,t=!1){const r=await fi(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Lr._forOperation(s,"link",r)}async function jm(s,e,t){await xd(e);const r=XI(e.providerData),a=s===!1?"provider-already-linked":"no-such-provider";fe(r.has(t)===s,e.auth,a)}async function JI(s,e,t=!1){const{auth:r}=s;if(Rt(r.app))return Promise.reject(_n(r));const a="reauthenticate";try{const l=await fi(s,WI(r,a,e,s),t);fe(l.idToken,r,"internal-error");const u=km(l.idToken);fe(u,r,"internal-error");const{sub:p}=u;return fe(s.uid===p,r,"user-mismatch"),Lr._forOperation(s,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Rn(r,"user-mismatch"),l}}async function ZI(s,e,t=!1){if(Rt(s.app))return Promise.reject(_n(s));const r="signIn",a=await WI(s,r,e),l=await Lr._fromIdTokenResponse(s,r,a);return t||await s._updateCurrentUser(l.user),l}async function Vm(s,e){return ZI(Vt(s),e)}async function eS(s,e){const t=De(s);return await jm(!1,t,e.providerId),Qy(t,e)}async function tS(s,e){return JI(De(s),e)}async function $D(s,e){return gi(s,"POST","/v1/accounts:signInWithCustomToken",Bt(s,e))}async function YD(s,e){if(Rt(s.app))return Promise.reject(_n(s));const t=Vt(s),r=await $D(t,{token:e,returnSecureToken:!0}),a=await Lr._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(a.user),a}class Hd{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Ky._fromServerResponse(e,t):"totpInfo"in t?$y._fromServerResponse(e,t):Rn(e,"internal-error")}}class Ky extends Hd{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Ky(t)}}class $y extends Hd{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new $y(t)}}function Om(s,e,t){fe(t.url?.length>0,s,"invalid-continue-uri"),fe(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,s,"invalid-dynamic-link-domain"),fe(typeof t.linkDomain>"u"||t.linkDomain.length>0,s,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(fe(t.iOS.bundleId.length>0,s,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(fe(t.android.packageName.length>0,s,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function Yy(s){const e=Vt(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function WD(s,e,t){const r=Vt(s),a={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};t&&Om(r,a,t),await da(r,a,"getOobCode",DD,"EMAIL_PASSWORD_PROVIDER")}async function XD(s,e,t){await $I(De(s),{oobCode:e,newPassword:t}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Yy(s),r})}async function JD(s,e){await RD(De(s),{oobCode:e})}async function nS(s,e){const t=De(s),r=await $I(t,{oobCode:e}),a=r.requestType;switch(fe(a,t,"internal-error"),a){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":fe(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":fe(r.mfaInfo,t,"internal-error");default:fe(r.email,t,"internal-error")}let l=null;return r.mfaInfo&&(l=Hd._fromServerResponse(Vt(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:l},operation:a}}async function ZD(s,e){const{data:t}=await nS(De(s),e);return t.email}async function eP(s,e,t){if(Rt(s.app))return Promise.reject(_n(s));const r=Vt(s),u=await da(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",YI,"EMAIL_PASSWORD_PROVIDER").catch(y=>{throw y.code==="auth/password-does-not-meet-requirements"&&Yy(s),y}),p=await Lr._fromIdTokenResponse(r,"signIn",u);return await r._updateCurrentUser(p.user),p}function tP(s,e,t){return Rt(s.app)?Promise.reject(_n(s)):Vm(De(s),Aa.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Yy(s),r})}async function nP(s,e,t){const r=Vt(s),a={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function l(u,p){fe(p.handleCodeInApp,r,"argument-error"),p&&Om(r,u,p)}l(a,t),await da(r,a,"getOobCode",PD,"EMAIL_PASSWORD_PROVIDER")}function rP(s,e){return Pm.parseLink(e)?.operation==="EMAIL_SIGNIN"}async function sP(s,e,t){if(Rt(s.app))return Promise.reject(_n(s));const r=De(s),a=Aa.credentialWithLink(e,t||vd());return fe(a._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Vm(r,a)}async function iP(s,e){return qt(s,"POST","/v1/accounts:createAuthUri",Bt(s,e))}async function aP(s,e){const t=Fy()?vd():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:a}=await iP(De(s),r);return a||[]}async function oP(s,e){const t=De(s),a={requestType:"VERIFY_EMAIL",idToken:await s.getIdToken()};e&&Om(t.auth,a,e);const{email:l}=await kD(t.auth,a);l!==s.email&&await s.reload()}async function lP(s,e,t){const r=De(s),l={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await s.getIdToken(),newEmail:e};t&&Om(r.auth,l,t);const{email:u}=await jD(r.auth,l);u!==s.email&&await s.reload()}async function cP(s,e){return qt(s,"POST","/v1/accounts:update",e)}async function uP(s,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=De(s),l={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await fi(r,cP(r.auth,l));r.displayName=u.displayName||null,r.photoURL=u.photoUrl||null;const p=r.providerData.find(({providerId:y})=>y==="password");p&&(p.displayName=r.displayName,p.photoURL=r.photoURL),await r._updateTokensIfNecessary(u)}function dP(s,e){const t=De(s);return Rt(t.auth.app)?Promise.reject(_n(t.auth)):rS(t,e,null)}function hP(s,e){return rS(De(s),null,e)}async function rS(s,e,t){const{auth:r}=s,l={idToken:await s.getIdToken(),returnSecureToken:!0};e&&(l.email=e),t&&(l.password=t);const u=await fi(s,AD(r,l));await s._updateTokensIfNecessary(u,!0)}function fP(s){if(!s)return null;const{providerId:e}=s,t=s.rawUserInfo?JSON.parse(s.rawUserInfo):{},r=s.isNewUser||s.kind==="identitytoolkit#SignupNewUserResponse";if(!e&&s?.idToken){const a=km(s.idToken)?.firebase?.sign_in_provider;if(a){const l=a!=="anonymous"&&a!=="custom"?a:null;return new Wl(r,l)}}if(!e)return null;switch(e){case"facebook.com":return new mP(r,t);case"github.com":return new pP(r,t);case"google.com":return new gP(r,t);case"twitter.com":return new yP(r,t,s.screenName||null);case"custom":case"anonymous":return new Wl(r,null);default:return new Wl(r,e,t)}}class Wl{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}}class sS extends Wl{constructor(e,t,r,a){super(e,t,r),this.username=a}}class mP extends Wl{constructor(e,t){super(e,"facebook.com",t)}}class pP extends sS{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}}class gP extends Wl{constructor(e,t){super(e,"google.com",t)}}class yP extends sS{constructor(e,t,r){super(e,"twitter.com",t,r)}}function _P(s){const{user:e,_tokenResponse:t}=s;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:fP(t)}class bo{constructor(e,t,r){this.type=e,this.credential=t,this.user=r}static _fromIdtoken(e,t){return new bo("enroll",e,t)}static _fromMfaPendingCredential(e){return new bo("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){if(e?.multiFactorSession){if(e.multiFactorSession?.pendingCredential)return bo._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(e.multiFactorSession?.idToken)return bo._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Wy{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){const r=Vt(e),a=t.customData._serverResponse,l=(a.mfaInfo||[]).map(p=>Hd._fromServerResponse(r,p));fe(a.mfaPendingCredential,r,"internal-error");const u=bo._fromMfaPendingCredential(a.mfaPendingCredential);return new Wy(u,l,async p=>{const y=await p._process(r,u);delete a.mfaInfo,delete a.mfaPendingCredential;const m={...a,idToken:y.idToken,refreshToken:y.refreshToken};switch(t.operationType){case"signIn":const b=await Lr._fromIdTokenResponse(r,t.operationType,m);return await r._updateCurrentUser(b.user),b;case"reauthenticate":return fe(t.user,r,"internal-error"),Lr._forOperation(t.user,t.operationType,m);default:Rn(r,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function bP(s,e){const t=De(s),r=e;return fe(e.customData.operationType,t,"argument-error"),fe(r.customData._serverResponse?.mfaPendingCredential,t,"argument-error"),Wy._fromError(t,r)}function gE(s,e){return qt(s,"POST","/v2/accounts/mfaEnrollment:start",Bt(s,e))}function vP(s,e){return qt(s,"POST","/v2/accounts/mfaEnrollment:finalize",Bt(s,e))}function xP(s,e){return qt(s,"POST","/v2/accounts/mfaEnrollment:withdraw",Bt(s,e))}class Xy{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Hd._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new Xy(e)}async getSession(){return bo._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const r=e,a=await this.getSession(),l=await fi(this.user,r._process(this.user.auth,a,t));return await this.user._updateTokensIfNecessary(l),this.user.reload()}async unenroll(e){const t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const a=await fi(this.user,xP(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:l})=>l!==t),await this.user._updateTokensIfNecessary(a),await this.user.reload()}catch(a){throw a}}}const x0=new WeakMap;function wP(s){const e=De(s);return x0.has(e)||x0.set(e,Xy._fromUser(e)),x0.get(e)}const um="__sak";class iS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(um,"1"),this.storage.removeItem(um),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const EP=1e3,TP=10;class aS extends iS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=FI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,p,y)=>{this.notifyListeners(u,y)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(r);!t&&this.localCache[r]===u||this.notifyListeners(r,u)},l=this.storage.getItem(r);sD()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,TP):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},EP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}aS.type="LOCAL";const Jy=aS;class oS extends iS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}oS.type="SESSION";const No=oS;function IP(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Mm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new Mm(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:l}=t.data,u=this.handlersMap[a];if(!u?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const p=Array.from(u).map(async m=>m(t.origin,l)),y=await IP(p);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:y})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Mm.receivers=[];function Gd(s="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return s+t}class SP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((p,y)=>{const m=Gd("",20);a.port1.start();const b=setTimeout(()=>{y(new Error("unsupported_event"))},r);u={messageChannel:a,onMessage(E){const I=E;if(I.data.eventId===m)switch(I.data.status){case"ack":clearTimeout(b),l=setTimeout(()=>{y(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),p(I.data.response);break;default:clearTimeout(b),clearTimeout(l),y(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function on(){return window}function AP(s){on().location.href=s}function Zy(){return typeof on().WorkerGlobalScope<"u"&&typeof on().importScripts=="function"}async function NP(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function RP(){return navigator?.serviceWorker?.controller||null}function CP(){return Zy()?self:null}const lS="firebaseLocalStorageDb",kP=1,dm="firebaseLocalStorage",cS="fbase_key";class Qd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Lm(s,e){return s.transaction([dm],e?"readwrite":"readonly").objectStore(dm)}function DP(){const s=indexedDB.deleteDatabase(lS);return new Qd(s).toPromise()}function F0(){const s=indexedDB.open(lS,kP);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const r=s.result;try{r.createObjectStore(dm,{keyPath:cS})}catch(a){t(a)}}),s.addEventListener("success",async()=>{const r=s.result;r.objectStoreNames.contains(dm)?e(r):(r.close(),await DP(),e(await F0()))})})}async function yE(s,e,t){const r=Lm(s,!0).put({[cS]:e,value:t});return new Qd(r).toPromise()}async function PP(s,e){const t=Lm(s,!1).get(e),r=await new Qd(t).toPromise();return r===void 0?null:r.value}function _E(s,e){const t=Lm(s,!0).delete(e);return new Qd(t).toPromise()}const jP=800,VP=3;class uS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await F0(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>VP)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Zy()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Mm._getInstance(CP()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await NP(),!this.activeServiceWorker)return;this.sender=new SP(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||RP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await F0();return await yE(e,um,"1"),await _E(e,um),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>yE(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>PP(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_E(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Lm(a,!1).getAll();return new Qd(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}uS.type="LOCAL";const Ed=uS;function bE(s,e){return qt(s,"POST","/v2/accounts/mfaSignIn:start",Bt(s,e))}function OP(s,e){return qt(s,"POST","/v2/accounts/mfaSignIn:finalize",Bt(s,e))}const w0=GI("rcb"),MP=new zd(3e4,6e4);class LP{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!on().grecaptcha?.render}load(e,t=""){return fe(UP(t),e,"argument-error"),this.shouldResolveImmediately(t)&&oE(on().grecaptcha)?Promise.resolve(on().grecaptcha):new Promise((r,a)=>{const l=on().setTimeout(()=>{a(dn(e,"network-request-failed"))},MP.get());on()[w0]=()=>{on().clearTimeout(l),delete on()[w0];const p=on().grecaptcha;if(!p||!oE(p)){a(dn(e,"internal-error"));return}const y=p.render;p.render=(m,b)=>{const E=y(m,b);return this.counter++,E},this.hostLanguage=t,r(p)};const u=`${dD()}?${Tc({onload:w0,render:"explicit",hl:t})}`;Gy(u).catch(()=>{clearTimeout(l),a(dn(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!on().grecaptcha?.render&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function UP(s){return s.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(s)}class zP{async load(e){return new gD(e)}clearedOneInstance(){}}const id="recaptcha",BP={theme:"light",type:"image"};let qP=class{constructor(e,t,r={...BP}){this.parameters=r,this.type=id,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Vt(e),this.isInvisible=this.parameters.size==="invisible",fe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const a=typeof t=="string"?document.getElementById(t):t;fe(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new zP:new LP,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(a=>{const l=u=>{u&&(this.tokenChangeListeners.delete(l),a(u))};this.tokenChangeListeners.add(l),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){fe(!this.parameters.sitekey,this.auth,"argument-error"),fe(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),fe(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){const r=on()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){fe(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){fe(Fy()&&!Zy(),this.auth,"internal-error"),await FP(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await Qk(this.auth);fe(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return fe(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function FP(){let s=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}s=()=>e(),window.addEventListener("load",s)}).catch(e=>{throw s&&window.removeEventListener("load",s),e})}class e_{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=So._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function HP(s,e,t){if(Rt(s.app))return Promise.reject(_n(s));const r=Vt(s),a=await Um(r,e,De(t));return new e_(a,l=>Vm(r,l))}async function GP(s,e,t){const r=De(s);await jm(!1,r,"phone");const a=await Um(r.auth,e,De(t));return new e_(a,l=>eS(r,l))}async function QP(s,e,t){const r=De(s);if(Rt(r.auth.app))return Promise.reject(_n(r.auth));const a=await Um(r.auth,e,De(t));return new e_(a,l=>tS(r,l))}async function Um(s,e,t){if(!s._getRecaptchaConfig())try{await wD(s)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(typeof e=="string"?r={phoneNumber:e}:r=e,"session"in r){const a=r.session;if("phoneNumber"in r){fe(a.type==="enroll",s,"internal-error");const l={idToken:a.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await da(s,l,"mfaSmsEnrollment",async(m,b)=>{if(b.phoneEnrollmentInfo.captchaResponse===sd){fe(t?.type===id,m,"argument-error");const E=await E0(m,b,t);return gE(m,E)}return gE(m,b)},"PHONE_PROVIDER").catch(m=>Promise.reject(m))).phoneSessionInfo.sessionInfo}else{fe(a.type==="signin",s,"internal-error");const l=r.multiFactorHint?.uid||r.multiFactorUid;fe(l,s,"missing-multi-factor-info");const u={mfaPendingCredential:a.credential,mfaEnrollmentId:l,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await da(s,u,"mfaSmsSignIn",async(b,E)=>{if(E.phoneSignInInfo.captchaResponse===sd){fe(t?.type===id,b,"argument-error");const I=await E0(b,E,t);return bE(b,I)}return bE(b,E)},"PHONE_PROVIDER").catch(b=>Promise.reject(b))).phoneResponseInfo.sessionInfo}}else{const a={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await da(s,a,"sendVerificationCode",async(y,m)=>{if(m.captchaResponse===sd){fe(t?.type===id,y,"argument-error");const b=await E0(y,m,t);return mE(y,b)}return mE(y,m)},"PHONE_PROVIDER").catch(y=>Promise.reject(y))).sessionInfo}}finally{t?._reset()}}async function KP(s,e){const t=De(s);if(Rt(t.auth.app))return Promise.reject(_n(t.auth));await Qy(t,e)}async function E0(s,e,t){fe(t.type===id,s,"argument-error");const r=await t.verify();fe(typeof r=="string",s,"argument-error");const a={...e};if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.captchaResponse,p=a.phoneEnrollmentInfo.clientType,y=a.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:r,captchaResponse:u,clientType:p,recaptchaVersion:y}}),a}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.captchaResponse,u=a.phoneSignInInfo.clientType,p=a.phoneSignInInfo.recaptchaVersion;return Object.assign(a,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:l,clientType:u,recaptchaVersion:p}}),a}else return Object.assign(a,{recaptchaToken:r}),a}let Ro=class qf{constructor(e){this.providerId=qf.PROVIDER_ID,this.auth=Vt(e)}verifyPhoneNumber(e,t){return Um(this.auth,e,De(t))}static credential(e,t){return So._fromVerification(e,t)}static credentialFromResult(e){const t=e;return qf.credentialFromTaggedObject(t)}static credentialFromError(e){return qf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:r}=e;return t&&r?So._fromTokenResponse(t,r):null}};Ro.PROVIDER_ID="phone";Ro.PHONE_SIGN_IN_METHOD="phone";function Fo(s,e){return e?vr(e):(fe(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}class t_ extends Sc{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return di(e,this._buildIdpRequest())}_linkToIdToken(e,t){return di(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return di(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $P(s){return ZI(s.auth,new t_(s),s.bypassAuthState)}function YP(s){const{auth:e,user:t}=s;return fe(t,e,"internal-error"),JI(t,new t_(s),s.bypassAuthState)}async function WP(s){const{auth:e,user:t}=s;return fe(t,e,"internal-error"),Qy(t,new t_(s),s.bypassAuthState)}class dS{constructor(e,t,r,a,l=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:l,error:u,type:p}=e;if(u){this.reject(u);return}const y={auth:this.auth,requestUri:t,sessionId:r,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(p)(y))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $P;case"linkViaPopup":case"linkViaRedirect":return WP;case"reauthViaPopup":case"reauthViaRedirect":return YP;default:Rn(this.auth,"internal-error")}}resolve(e){is(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){is(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const XP=new zd(2e3,1e4);async function JP(s,e,t){if(Rt(s.app))return Promise.reject(dn(s,"operation-not-supported-in-this-environment"));const r=Vt(s);Ic(s,e,yi);const a=Fo(r,t);return new ci(r,"signInViaPopup",e,a).executeNotNull()}async function ZP(s,e,t){const r=De(s);if(Rt(r.auth.app))return Promise.reject(dn(r.auth,"operation-not-supported-in-this-environment"));Ic(r.auth,e,yi);const a=Fo(r.auth,t);return new ci(r.auth,"reauthViaPopup",e,a,r).executeNotNull()}async function ej(s,e,t){const r=De(s);Ic(r.auth,e,yi);const a=Fo(r.auth,t);return new ci(r.auth,"linkViaPopup",e,a,r).executeNotNull()}class ci extends dS{constructor(e,t,r,a,l){super(e,t,a,l),this.provider=r,this.authWindow=null,this.pollId=null,ci.currentPopupAction&&ci.currentPopupAction.cancel(),ci.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fe(e,this.auth,"internal-error"),e}async onExecution(){is(this.filter.length===1,"Popup operations only handle one event");const e=Gd();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(dn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(dn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ci.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(dn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,XP.get())};e()}}ci.currentPopupAction=null;const tj="pendingRedirect",ad=new Map;class nj extends dS{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=ad.get(this.auth._key());if(!e){try{const r=await rj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ad.set(this.auth._key(),e)}return this.bypassAuthState||ad.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function rj(s,e){const t=fS(e),r=hS(s);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}async function n_(s,e){return hS(s)._set(fS(e),"true")}function sj(){ad.clear()}function r_(s,e){ad.set(s._key(),e)}function hS(s){return vr(s._redirectPersistence)}function fS(s){return Io(tj,s.config.apiKey,s.name)}function ij(s,e,t){return aj(s,e,t)}async function aj(s,e,t){if(Rt(s.app))return Promise.reject(_n(s));const r=Vt(s);Ic(s,e,yi),await r._initializationPromise;const a=Fo(r,t);return await n_(a,r),a._openRedirect(r,e,"signInViaRedirect")}function oj(s,e,t){return lj(s,e,t)}async function lj(s,e,t){const r=De(s);if(Ic(r.auth,e,yi),Rt(r.auth.app))return Promise.reject(_n(r.auth));await r.auth._initializationPromise;const a=Fo(r.auth,t);await n_(a,r.auth);const l=await mS(r);return a._openRedirect(r.auth,e,"reauthViaRedirect",l)}function cj(s,e,t){return uj(s,e,t)}async function uj(s,e,t){const r=De(s);Ic(r.auth,e,yi),await r.auth._initializationPromise;const a=Fo(r.auth,t);await jm(!1,r,e.providerId),await n_(a,r.auth);const l=await mS(r);return a._openRedirect(r.auth,e,"linkViaRedirect",l)}async function dj(s,e){return await Vt(s)._initializationPromise,zm(s,e,!1)}async function zm(s,e,t=!1){if(Rt(s.app))return Promise.reject(_n(s));const r=Vt(s),a=Fo(r,e),u=await new nj(r,a,t).execute();return u&&!t&&(delete u.user._redirectEventId,await r._persistUserIfCurrent(u.user),await r._setRedirectUser(null,e)),u}async function mS(s){const e=Gd(`${s.uid}:::`);return s._redirectEventId=e,await s.auth._setRedirectUser(s),await s.auth._persistUserIfCurrent(s),e}const hj=600*1e3;class pS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!fj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!gS(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(dn(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=hj&&this.cachedEventUids.clear(),this.cachedEventUids.has(vE(e))}saveEventToCache(e){this.cachedEventUids.add(vE(e)),this.lastProcessedEventTime=Date.now()}}function vE(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function gS({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function fj(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return gS(s);default:return!1}}async function yS(s,e={}){return qt(s,"GET","/v1/projects",e)}const mj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pj=/^https?/;async function gj(s){if(s.config.emulator)return;const{authorizedDomains:e}=await yS(s);for(const t of e)try{if(yj(t))return}catch{}Rn(s,"unauthorized-domain")}function yj(s){const e=vd(),{protocol:t,hostname:r}=new URL(e);if(s.startsWith("chrome-extension://")){const u=new URL(s);return u.hostname===""&&r===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===r}if(!pj.test(t))return!1;if(mj.test(s))return r===s;const a=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const _j=new zd(3e4,6e4);function xE(){const s=on().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function bj(s){return new Promise((e,t)=>{function r(){xE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{xE(),t(dn(s,"network-request-failed"))},timeout:_j.get()})}if(on().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(on().gapi?.load)r();else{const a=GI("iframefcb");return on()[a]=()=>{gapi.load?r():t(dn(s,"network-request-failed"))},Gy(`${fD()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Ff=null,e})}let Ff=null;function vj(s){return Ff=Ff||bj(s),Ff}const xj=new zd(5e3,15e3),wj="__/auth/iframe",Ej="emulator/auth/iframe",Tj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ij=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Sj(s){const e=s.config;fe(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?Hy(e,Ej):`https://${s.config.authDomain}/${wj}`,r={apiKey:e.apiKey,appName:s.name,v:Sa},a=Ij.get(s.config.apiHost);a&&(r.eid=a);const l=s._getFrameworks();return l.length&&(r.fw=l.join(",")),`${t}?${Tc(r).slice(1)}`}async function Aj(s){const e=await vj(s),t=on().gapi;return fe(t,s,"internal-error"),e.open({where:document.body,url:Sj(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Tj,dontclear:!0},r=>new Promise(async(a,l)=>{await r.restyle({setHideOnLeave:!1});const u=dn(s,"network-request-failed"),p=on().setTimeout(()=>{l(u)},xj.get());function y(){on().clearTimeout(p),a(r)}r.ping(y).then(y,()=>{l(u)})}))}const Nj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Rj=500,Cj=600,kj="_blank",Dj="http://localhost";class wE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Pj(s,e,t,r=Rj,a=Cj){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-r)/2,0).toString();let p="";const y={...Nj,width:r.toString(),height:a.toString(),top:l,left:u},m=jt().toLowerCase();t&&(p=UI(m)?kj:t),MI(m)&&(e=e||Dj,y.scrollbars="yes");const b=Object.entries(y).reduce((I,[S,M])=>`${I}${S}=${M},`,"");if(rD(m)&&p!=="_self")return jj(e||"",p),new wE(null);const E=window.open(e||"",p,b);fe(E,s,"popup-blocked");try{E.focus()}catch{}return new wE(E)}function jj(s,e){const t=document.createElement("a");t.href=s,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const Vj="__/auth/handler",Oj="emulator/auth/handler",Mj=encodeURIComponent("fac");async function H0(s,e,t,r,a,l){fe(s.config.authDomain,s,"auth-domain-config-required"),fe(s.config.apiKey,s,"invalid-api-key");const u={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:r,v:Sa,eventId:a};if(e instanceof yi){e.setDefaultLanguage(s.languageCode),u.providerId=e.providerId||"",u2(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[b,E]of Object.entries(l||{}))u[b]=E}if(e instanceof Ac){const b=e.getScopes().filter(E=>E!=="");b.length>0&&(u.scopes=b.join(","))}s.tenantId&&(u.tid=s.tenantId);const p=u;for(const b of Object.keys(p))p[b]===void 0&&delete p[b];const y=await s._getAppCheckToken(),m=y?`#${Mj}=${encodeURIComponent(y)}`:"";return`${Lj(s)}?${Tc(p).slice(1)}${m}`}function Lj({config:s}){return s.emulator?Hy(s,Oj):`https://${s.authDomain}/${Vj}`}const T0="webStorageSupport";class Uj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=No,this._completeRedirectFn=zm,this._overrideRedirectResult=r_}async _openPopup(e,t,r,a){is(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await H0(e,t,r,vd(),a);return Pj(e,l,Gd())}async _openRedirect(e,t,r,a){await this._originValidation(e);const l=await H0(e,t,r,vd(),a);return AP(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(is(l,"If manager is not set, promise should be"),l)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Aj(e),r=new pS(e);return t.register("authEvent",a=>(fe(a?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(T0,{type:T0},a=>{const l=a?.[0]?.[T0];l!==void 0&&t(!!l),Rn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=gj(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return FI()||LI()||qd()}}const zj=Uj;class Bj{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return Ps("unexpected MultiFactorSessionType")}}}class s_ extends Bj{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new s_(e)}_finalizeEnroll(e,t,r){return vP(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return OP(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class _S{constructor(){}static assertion(e){return s_._fromCredential(e)}}_S.FACTOR_ID="phone";var EE="@firebase/auth",TE="1.12.0";class qj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Fj(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Hj(s){_a(new Us("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:p}=r.options;fe(u&&!u.includes(":"),"invalid-api-key",{appName:r.name});const y={apiKey:u,authDomain:p,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:HI(s)},m=new cD(r,a,l,y);return ED(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),_a(new Us("auth-internal",e=>{const t=Vt(e.getProvider("auth").getImmediate());return(r=>new qj(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),es(EE,TE,Fj(s)),es(EE,TE,"esm2020")}const Gj=300;JC("authIdTokenMaxAge");function Qj(){return document.getElementsByTagName("head")?.[0]??document}uD({loadJS(s){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",s),r.onload=e,r.onerror=a=>{const l=dn("internal-error");l.customData=a,t(l)},r.type="text/javascript",r.charset="UTF-8",Qj().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Hj("Browser");function Co(){return window}const Kj=2e3;async function $j(s,e,t){const{BuildInfo:r}=Co();is(e.sessionId,"AuthEvent did not contain a session ID");const a=await Zj(e.sessionId),l={};return qd()?l.ibi=r.packageName:Bd()?l.apn=r.packageName:Rn(s,"operation-not-supported-in-this-environment"),r.displayName&&(l.appDisplayName=r.displayName),l.sessionId=a,H0(s,t,e.type,void 0,e.eventId??void 0,l)}async function Yj(s){const{BuildInfo:e}=Co(),t={};qd()?t.iosBundleId=e.packageName:Bd()?t.androidPackageName=e.packageName:Rn(s,"operation-not-supported-in-this-environment"),await yS(s,t)}function Wj(s){const{cordova:e}=Co();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let a=null;r?e.plugins.browsertab.openUrl(s):a=e.InAppBrowser.open(s,nD()?"_blank":"_system","location=yes"),t(a)})})}async function Xj(s,e,t){const{cordova:r}=Co();let a=()=>{};try{await new Promise((l,u)=>{let p=null;function y(){l();const E=r.plugins.browsertab?.close;typeof E=="function"&&E(),typeof t?.close=="function"&&t.close()}function m(){p||(p=window.setTimeout(()=>{u(dn(s,"redirect-cancelled-by-user"))},Kj))}function b(){document?.visibilityState==="visible"&&m()}e.addPassiveListener(y),document.addEventListener("resume",m,!1),Bd()&&document.addEventListener("visibilitychange",b,!1),a=()=>{e.removePassiveListener(y),document.removeEventListener("resume",m,!1),document.removeEventListener("visibilitychange",b,!1),p&&window.clearTimeout(p)}})}finally{a()}}function Jj(s){const e=Co();fe(typeof e?.universalLinks?.subscribe=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),fe(typeof e?.BuildInfo?.packageName<"u",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),fe(typeof e?.cordova?.plugins?.browsertab?.openUrl=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),fe(typeof e?.cordova?.plugins?.browsertab?.isAvailable=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),fe(typeof e?.cordova?.InAppBrowser?.open=="function",s,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function Zj(s){const e=eV(s),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(a=>a.toString(16).padStart(2,"0")).join("")}function eV(s){if(is(/[0-9a-zA-Z]+/.test(s),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(s);const e=new ArrayBuffer(s.length),t=new Uint8Array(e);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t}const tV=20;class nV extends pS{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInitialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function rV(s,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:aV(),postBody:null,tenantId:s.tenantId,error:dn(s,"no-auth-event")}}function sV(s,e){return G0()._set(Q0(s),e)}async function IE(s){const e=await G0()._get(Q0(s));return e&&await G0()._remove(Q0(s)),e}function iV(s,e){const t=lV(e);if(t.includes("/__/auth/callback")){const r=Hf(t),l=(r.firebaseError?oV(decodeURIComponent(r.firebaseError)):null)?.code?.split("auth/")?.[1],u=l?dn(l):null;return u?{type:s.type,eventId:s.eventId,tenantId:s.tenantId,error:u,urlResponse:null,sessionId:null,postBody:null}:{type:s.type,eventId:s.eventId,tenantId:s.tenantId,sessionId:s.sessionId,urlResponse:t,postBody:null}}return null}function aV(){const s=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<tV;t++){const r=Math.floor(Math.random()*e.length);s.push(e.charAt(r))}return s.join("")}function G0(){return vr(Jy)}function Q0(s){return Io("authEvent",s.config.apiKey,s.name)}function oV(s){try{return JSON.parse(s)}catch{return null}}function lV(s){const e=Hf(s),t=e.link?decodeURIComponent(e.link):void 0,r=Hf(t).link,a=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Hf(a).link||a||r||t||s}function Hf(s){if(!s?.includes("?"))return{};const[e,...t]=s.split("?");return Ql(t.join("?"))}const cV=500;class uV{constructor(){this._redirectPersistence=No,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=zm,this._overrideRedirectResult=r_}async _initialize(e){const t=e._key();let r=this.eventManagers.get(t);return r||(r=new nV(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Rn(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,a){Jj(e);const l=await this._initialize(e);await l.initialized(),l.resetRedirect(),sj(),await this._originValidation(e);const u=rV(e,r,a);await sV(e,u);const p=await $j(e,u,t),y=await Wj(p);return Xj(e,l,y)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Yj(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:r,handleOpenURL:a,BuildInfo:l}=Co(),u=setTimeout(async()=>{await IE(e),t.onEvent(SE())},cV),p=async b=>{clearTimeout(u);const E=await IE(e);let I=null;E&&b?.url&&(I=iV(E,b.url)),t.onEvent(I||SE())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,p);const y=a,m=`${l.packageName.toLowerCase()}://`;Co().handleOpenURL=async b=>{if(b.toLowerCase().startsWith(m)&&p({url:b}),typeof y=="function")try{y(b)}catch(E){console.error(E)}}}}const dV=uV;function SE(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:dn("no-auth-event")}}function hV(s,e){Vt(s)._logFramework(e)}var fV="@firebase/auth-compat",mV="0.6.2";const pV=1e3;function od(){return self?.location?.protocol||null}function gV(){return od()==="http:"||od()==="https:"}function bS(s=jt()){return!!((od()==="file:"||od()==="ionic:"||od()==="capacitor:")&&s.toLowerCase().match(/iphone|ipad|ipod|android/))}function yV(){return Vy()||Rm()}function _V(){return dI()&&document?.documentMode===11}function bV(s=jt()){return/Edge\/\d+/.test(s)}function vV(s=jt()){return _V()||bV(s)}function vS(){try{const s=self.localStorage,e=Gd();if(s)return s.setItem(e,"1"),s.removeItem(e),vV()?yd():!0}catch{return i_()&&yd()}return!1}function i_(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function I0(){return(gV()||uI()||bS())&&!yV()&&vS()&&!i_()}function xS(){return bS()&&typeof document<"u"}async function xV(){return xS()?new Promise(s=>{const e=setTimeout(()=>{s(!1)},pV);document.addEventListener("deviceready",()=>{clearTimeout(e),s(!0)})}):!1}function wV(){return typeof window<"u"?window:null}const br={LOCAL:"local",NONE:"none",SESSION:"session"},zu=fe,wS="persistence";function EV(s,e){if(zu(Object.values(br).includes(e),s,"invalid-persistence-type"),Vy()){zu(e!==br.SESSION,s,"unsupported-persistence-type");return}if(Rm()){zu(e===br.NONE,s,"unsupported-persistence-type");return}if(i_()){zu(e===br.NONE||e===br.LOCAL&&yd(),s,"unsupported-persistence-type");return}zu(e===br.NONE||vS(),s,"unsupported-persistence-type")}async function K0(s){await s._initializationPromise;const e=ES(),t=Io(wS,s.config.apiKey,s.name);e&&e.setItem(t,s._getPersistenceType())}function TV(s,e){const t=ES();if(!t)return[];const r=Io(wS,s,e);switch(t.getItem(r)){case br.NONE:return[nc];case br.LOCAL:return[Ed,No];case br.SESSION:return[No];default:return[]}}function ES(){try{return wV()?.sessionStorage||null}catch{return null}}const IV=fe;class oa{constructor(){this.browserResolver=vr(zj),this.cordovaResolver=vr(dV),this.underlyingResolver=null,this._redirectPersistence=No,this._completeRedirectFn=zm,this._overrideRedirectResult=r_}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,a)}async _openRedirect(e,t,r,a){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,a)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return xS()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return IV(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await xV();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function TS(s){return s.unwrap()}function SV(s){return s.wrapped()}function AV(s){return IS(s)}function NV(s,e){const t=e.customData?._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){const r=e;r.resolver=new RV(s,bP(s,e))}else if(t){const r=IS(e),a=e;r&&(a.credential=r,a.tenantId=t.tenantId||void 0,a.email=t.email||void 0,a.phoneNumber=t.phoneNumber||void 0)}}function IS(s){const{_tokenResponse:e}=s instanceof Hn?s.customData:s;if(!e)return null;if(!(s instanceof Hn)&&"temporaryProof"in e&&"phoneNumber"in e)return Ro.credentialFromResult(s);const t=e.providerId;if(!t||t===Lu.PASSWORD)return null;let r;switch(t){case Lu.GOOGLE:r=Cs;break;case Lu.FACEBOOK:r=Rs;break;case Lu.GITHUB:r=ks;break;case Lu.TWITTER:r=Ds;break;default:const{oauthIdToken:a,oauthAccessToken:l,oauthTokenSecret:u,pendingToken:p,nonce:y}=e;return!l&&!u&&!a&&!p?null:p?t.startsWith("saml.")?rc._create(t,p):zs._fromParams({providerId:t,signInMethod:t,pendingToken:p,idToken:a,accessToken:l}):new Yl(t).credential({idToken:a,accessToken:l,rawNonce:y})}return s instanceof Hn?r.credentialFromError(s):r.credentialFromResult(s)}function rr(s,e){return e.catch(t=>{throw t instanceof Hn&&NV(s,t),t}).then(t=>{const r=t.operationType,a=t.user;return{operationType:r,credential:AV(t),additionalUserInfo:_P(t),user:Bm.getOrCreate(a)}})}async function $0(s,e){const t=await e;return{verificationId:t.verificationId,confirm:r=>rr(s,t.confirm(r))}}class RV{constructor(e,t){this.resolver=t,this.auth=SV(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return rr(TS(this.auth),this.resolver.resolveSignIn(e))}}let Bm=class Wu{constructor(e){this._delegate=e,this.multiFactor=wP(e)}static getOrCreate(e){return Wu.USER_MAP.has(e)||Wu.USER_MAP.set(e,new Wu(e)),Wu.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return rr(this.auth,eS(this._delegate,e))}async linkWithPhoneNumber(e,t){return $0(this.auth,GP(this._delegate,e,t))}async linkWithPopup(e){return rr(this.auth,ej(this._delegate,e,oa))}async linkWithRedirect(e){return await K0(Vt(this.auth)),cj(this._delegate,e,oa)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return rr(this.auth,tS(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return $0(this.auth,QP(this._delegate,e,t))}reauthenticateWithPopup(e){return rr(this.auth,ZP(this._delegate,e,oa))}async reauthenticateWithRedirect(e){return await K0(Vt(this.auth)),oj(this._delegate,e,oa)}sendEmailVerification(e){return oP(this._delegate,e)}async unlink(e){return await KD(this._delegate,e),this}updateEmail(e){return dP(this._delegate,e)}updatePassword(e){return hP(this._delegate,e)}updatePhoneNumber(e){return KP(this._delegate,e)}updateProfile(e){return uP(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return lP(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Bm.USER_MAP=new WeakMap;const Bu=fe;class Y0{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Bu(r,"invalid-api-key",{appName:e.name}),Bu(r,"invalid-api-key",{appName:e.name});const a=typeof window<"u"?oa:void 0;this._delegate=t.initialize({options:{persistence:CV(r,e.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(Ok),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Bm.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){TD(this._delegate,e,t)}applyActionCode(e){return JD(this._delegate,e)}checkActionCode(e){return nS(this._delegate,e)}confirmPasswordReset(e,t){return XD(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return rr(this._delegate,eP(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return aP(this._delegate,e)}isSignInWithEmailLink(e){return rP(this._delegate,e)}async getRedirectResult(){Bu(I0(),this._delegate,"operation-not-supported-in-this-environment");const e=await dj(this._delegate,oa);return e?rr(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){hV(this._delegate,e)}onAuthStateChanged(e,t,r){const{next:a,error:l,complete:u}=AE(e,t,r);return this._delegate.onAuthStateChanged(a,l,u)}onIdTokenChanged(e,t,r){const{next:a,error:l,complete:u}=AE(e,t,r);return this._delegate.onIdTokenChanged(a,l,u)}sendSignInLinkToEmail(e,t){return nP(this._delegate,e,t)}sendPasswordResetEmail(e,t){return WD(this._delegate,e,t||void 0)}async setPersistence(e){EV(this._delegate,e);let t;switch(e){case br.SESSION:t=No;break;case br.LOCAL:t=await vr(Ed)._isAvailable()?Ed:Jy;break;case br.NONE:t=nc;break;default:return Rn("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return rr(this._delegate,QD(this._delegate))}signInWithCredential(e){return rr(this._delegate,Vm(this._delegate,e))}signInWithCustomToken(e){return rr(this._delegate,YD(this._delegate,e))}signInWithEmailAndPassword(e,t){return rr(this._delegate,tP(this._delegate,e,t))}signInWithEmailLink(e,t){return rr(this._delegate,sP(this._delegate,e,t))}signInWithPhoneNumber(e,t){return $0(this._delegate,HP(this._delegate,e,t))}async signInWithPopup(e){return Bu(I0(),this._delegate,"operation-not-supported-in-this-environment"),rr(this._delegate,JP(this._delegate,e,oa))}async signInWithRedirect(e){return Bu(I0(),this._delegate,"operation-not-supported-in-this-environment"),await K0(this._delegate),ij(this._delegate,e,oa)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return ZD(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Y0.Persistence=br;function AE(s,e,t){let r=s;typeof s!="function"&&({next:r,error:e,complete:t}=s);const a=r;return{next:u=>a(u&&Bm.getOrCreate(u)),error:e,complete:t}}function CV(s,e){const t=TV(s,e);if(typeof self<"u"&&!t.includes(Ed)&&t.push(Ed),typeof window<"u")for(const r of[Jy,No])t.includes(r)||t.push(r);return t.includes(nc)||t.push(nc),t}class a_{static credential(e,t){return Ro.credential(e,t)}constructor(){this.providerId="phone",this._delegate=new Ro(TS(ts.auth()))}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}a_.PHONE_SIGN_IN_METHOD=Ro.PHONE_SIGN_IN_METHOD;a_.PROVIDER_ID=Ro.PROVIDER_ID;const kV=fe;class DV{constructor(e,t,r=ts.app()){kV(r.options?.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new qP(r.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}const PV="auth-compat";function jV(s){s.INTERNAL.registerComponent(new Us(PV,e=>{const t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Y0(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:jl.EMAIL_SIGNIN,PASSWORD_RESET:jl.PASSWORD_RESET,RECOVER_EMAIL:jl.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:jl.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:jl.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:jl.VERIFY_EMAIL}},EmailAuthProvider:Aa,FacebookAuthProvider:Rs,GithubAuthProvider:ks,GoogleAuthProvider:Cs,OAuthProvider:Yl,SAMLAuthProvider:lm,PhoneAuthProvider:a_,PhoneMultiFactorGenerator:_S,RecaptchaVerifier:DV,TwitterAuthProvider:Ds,Auth:Y0,AuthCredential:Sc,Error:Hn}).setInstantiationMode("LAZY").setMultipleInstances(!1)),s.registerVersion(fV,mV)}jV(ts);var NE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ha,SS;(function(){var s;function e(k,x){function R(){}R.prototype=x.prototype,k.F=x.prototype,k.prototype=new R,k.prototype.constructor=k,k.D=function(D,C,P){for(var N=Array(arguments.length-2),we=2;we<arguments.length;we++)N[we-2]=arguments[we];return x.prototype[C].apply(D,N)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(k,x,R){R||(R=0);const D=Array(16);if(typeof x=="string")for(var C=0;C<16;++C)D[C]=x.charCodeAt(R++)|x.charCodeAt(R++)<<8|x.charCodeAt(R++)<<16|x.charCodeAt(R++)<<24;else for(C=0;C<16;++C)D[C]=x[R++]|x[R++]<<8|x[R++]<<16|x[R++]<<24;x=k.g[0],R=k.g[1],C=k.g[2];let P=k.g[3],N;N=x+(P^R&(C^P))+D[0]+3614090360&4294967295,x=R+(N<<7&4294967295|N>>>25),N=P+(C^x&(R^C))+D[1]+3905402710&4294967295,P=x+(N<<12&4294967295|N>>>20),N=C+(R^P&(x^R))+D[2]+606105819&4294967295,C=P+(N<<17&4294967295|N>>>15),N=R+(x^C&(P^x))+D[3]+3250441966&4294967295,R=C+(N<<22&4294967295|N>>>10),N=x+(P^R&(C^P))+D[4]+4118548399&4294967295,x=R+(N<<7&4294967295|N>>>25),N=P+(C^x&(R^C))+D[5]+1200080426&4294967295,P=x+(N<<12&4294967295|N>>>20),N=C+(R^P&(x^R))+D[6]+2821735955&4294967295,C=P+(N<<17&4294967295|N>>>15),N=R+(x^C&(P^x))+D[7]+4249261313&4294967295,R=C+(N<<22&4294967295|N>>>10),N=x+(P^R&(C^P))+D[8]+1770035416&4294967295,x=R+(N<<7&4294967295|N>>>25),N=P+(C^x&(R^C))+D[9]+2336552879&4294967295,P=x+(N<<12&4294967295|N>>>20),N=C+(R^P&(x^R))+D[10]+4294925233&4294967295,C=P+(N<<17&4294967295|N>>>15),N=R+(x^C&(P^x))+D[11]+2304563134&4294967295,R=C+(N<<22&4294967295|N>>>10),N=x+(P^R&(C^P))+D[12]+1804603682&4294967295,x=R+(N<<7&4294967295|N>>>25),N=P+(C^x&(R^C))+D[13]+4254626195&4294967295,P=x+(N<<12&4294967295|N>>>20),N=C+(R^P&(x^R))+D[14]+2792965006&4294967295,C=P+(N<<17&4294967295|N>>>15),N=R+(x^C&(P^x))+D[15]+1236535329&4294967295,R=C+(N<<22&4294967295|N>>>10),N=x+(C^P&(R^C))+D[1]+4129170786&4294967295,x=R+(N<<5&4294967295|N>>>27),N=P+(R^C&(x^R))+D[6]+3225465664&4294967295,P=x+(N<<9&4294967295|N>>>23),N=C+(x^R&(P^x))+D[11]+643717713&4294967295,C=P+(N<<14&4294967295|N>>>18),N=R+(P^x&(C^P))+D[0]+3921069994&4294967295,R=C+(N<<20&4294967295|N>>>12),N=x+(C^P&(R^C))+D[5]+3593408605&4294967295,x=R+(N<<5&4294967295|N>>>27),N=P+(R^C&(x^R))+D[10]+38016083&4294967295,P=x+(N<<9&4294967295|N>>>23),N=C+(x^R&(P^x))+D[15]+3634488961&4294967295,C=P+(N<<14&4294967295|N>>>18),N=R+(P^x&(C^P))+D[4]+3889429448&4294967295,R=C+(N<<20&4294967295|N>>>12),N=x+(C^P&(R^C))+D[9]+568446438&4294967295,x=R+(N<<5&4294967295|N>>>27),N=P+(R^C&(x^R))+D[14]+3275163606&4294967295,P=x+(N<<9&4294967295|N>>>23),N=C+(x^R&(P^x))+D[3]+4107603335&4294967295,C=P+(N<<14&4294967295|N>>>18),N=R+(P^x&(C^P))+D[8]+1163531501&4294967295,R=C+(N<<20&4294967295|N>>>12),N=x+(C^P&(R^C))+D[13]+2850285829&4294967295,x=R+(N<<5&4294967295|N>>>27),N=P+(R^C&(x^R))+D[2]+4243563512&4294967295,P=x+(N<<9&4294967295|N>>>23),N=C+(x^R&(P^x))+D[7]+1735328473&4294967295,C=P+(N<<14&4294967295|N>>>18),N=R+(P^x&(C^P))+D[12]+2368359562&4294967295,R=C+(N<<20&4294967295|N>>>12),N=x+(R^C^P)+D[5]+4294588738&4294967295,x=R+(N<<4&4294967295|N>>>28),N=P+(x^R^C)+D[8]+2272392833&4294967295,P=x+(N<<11&4294967295|N>>>21),N=C+(P^x^R)+D[11]+1839030562&4294967295,C=P+(N<<16&4294967295|N>>>16),N=R+(C^P^x)+D[14]+4259657740&4294967295,R=C+(N<<23&4294967295|N>>>9),N=x+(R^C^P)+D[1]+2763975236&4294967295,x=R+(N<<4&4294967295|N>>>28),N=P+(x^R^C)+D[4]+1272893353&4294967295,P=x+(N<<11&4294967295|N>>>21),N=C+(P^x^R)+D[7]+4139469664&4294967295,C=P+(N<<16&4294967295|N>>>16),N=R+(C^P^x)+D[10]+3200236656&4294967295,R=C+(N<<23&4294967295|N>>>9),N=x+(R^C^P)+D[13]+681279174&4294967295,x=R+(N<<4&4294967295|N>>>28),N=P+(x^R^C)+D[0]+3936430074&4294967295,P=x+(N<<11&4294967295|N>>>21),N=C+(P^x^R)+D[3]+3572445317&4294967295,C=P+(N<<16&4294967295|N>>>16),N=R+(C^P^x)+D[6]+76029189&4294967295,R=C+(N<<23&4294967295|N>>>9),N=x+(R^C^P)+D[9]+3654602809&4294967295,x=R+(N<<4&4294967295|N>>>28),N=P+(x^R^C)+D[12]+3873151461&4294967295,P=x+(N<<11&4294967295|N>>>21),N=C+(P^x^R)+D[15]+530742520&4294967295,C=P+(N<<16&4294967295|N>>>16),N=R+(C^P^x)+D[2]+3299628645&4294967295,R=C+(N<<23&4294967295|N>>>9),N=x+(C^(R|~P))+D[0]+4096336452&4294967295,x=R+(N<<6&4294967295|N>>>26),N=P+(R^(x|~C))+D[7]+1126891415&4294967295,P=x+(N<<10&4294967295|N>>>22),N=C+(x^(P|~R))+D[14]+2878612391&4294967295,C=P+(N<<15&4294967295|N>>>17),N=R+(P^(C|~x))+D[5]+4237533241&4294967295,R=C+(N<<21&4294967295|N>>>11),N=x+(C^(R|~P))+D[12]+1700485571&4294967295,x=R+(N<<6&4294967295|N>>>26),N=P+(R^(x|~C))+D[3]+2399980690&4294967295,P=x+(N<<10&4294967295|N>>>22),N=C+(x^(P|~R))+D[10]+4293915773&4294967295,C=P+(N<<15&4294967295|N>>>17),N=R+(P^(C|~x))+D[1]+2240044497&4294967295,R=C+(N<<21&4294967295|N>>>11),N=x+(C^(R|~P))+D[8]+1873313359&4294967295,x=R+(N<<6&4294967295|N>>>26),N=P+(R^(x|~C))+D[15]+4264355552&4294967295,P=x+(N<<10&4294967295|N>>>22),N=C+(x^(P|~R))+D[6]+2734768916&4294967295,C=P+(N<<15&4294967295|N>>>17),N=R+(P^(C|~x))+D[13]+1309151649&4294967295,R=C+(N<<21&4294967295|N>>>11),N=x+(C^(R|~P))+D[4]+4149444226&4294967295,x=R+(N<<6&4294967295|N>>>26),N=P+(R^(x|~C))+D[11]+3174756917&4294967295,P=x+(N<<10&4294967295|N>>>22),N=C+(x^(P|~R))+D[2]+718787259&4294967295,C=P+(N<<15&4294967295|N>>>17),N=R+(P^(C|~x))+D[9]+3951481745&4294967295,k.g[0]=k.g[0]+x&4294967295,k.g[1]=k.g[1]+(C+(N<<21&4294967295|N>>>11))&4294967295,k.g[2]=k.g[2]+C&4294967295,k.g[3]=k.g[3]+P&4294967295}r.prototype.v=function(k,x){x===void 0&&(x=k.length);const R=x-this.blockSize,D=this.C;let C=this.h,P=0;for(;P<x;){if(C==0)for(;P<=R;)a(this,k,P),P+=this.blockSize;if(typeof k=="string"){for(;P<x;)if(D[C++]=k.charCodeAt(P++),C==this.blockSize){a(this,D),C=0;break}}else for(;P<x;)if(D[C++]=k[P++],C==this.blockSize){a(this,D),C=0;break}}this.h=C,this.o+=x},r.prototype.A=function(){var k=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);k[0]=128;for(var x=1;x<k.length-8;++x)k[x]=0;x=this.o*8;for(var R=k.length-8;R<k.length;++R)k[R]=x&255,x/=256;for(this.v(k),k=Array(16),x=0,R=0;R<4;++R)for(let D=0;D<32;D+=8)k[x++]=this.g[R]>>>D&255;return k};function l(k,x){var R=p;return Object.prototype.hasOwnProperty.call(R,k)?R[k]:R[k]=x(k)}function u(k,x){this.h=x;const R=[];let D=!0;for(let C=k.length-1;C>=0;C--){const P=k[C]|0;D&&P==x||(R[C]=P,D=!1)}this.g=R}var p={};function y(k){return-128<=k&&k<128?l(k,function(x){return new u([x|0],x<0?-1:0)}):new u([k|0],k<0?-1:0)}function m(k){if(isNaN(k)||!isFinite(k))return E;if(k<0)return ee(m(-k));const x=[];let R=1;for(let D=0;k>=R;D++)x[D]=k/R|0,R*=4294967296;return new u(x,0)}function b(k,x){if(k.length==0)throw Error("number format error: empty string");if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(k.charAt(0)=="-")return ee(b(k.substring(1),x));if(k.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=m(Math.pow(x,8));let D=E;for(let P=0;P<k.length;P+=8){var C=Math.min(8,k.length-P);const N=parseInt(k.substring(P,P+C),x);C<8?(C=m(Math.pow(x,C)),D=D.j(C).add(m(N))):(D=D.j(R),D=D.add(m(N)))}return D}var E=y(0),I=y(1),S=y(16777216);s=u.prototype,s.m=function(){if(z(this))return-ee(this).m();let k=0,x=1;for(let R=0;R<this.g.length;R++){const D=this.i(R);k+=(D>=0?D:4294967296+D)*x,x*=4294967296}return k},s.toString=function(k){if(k=k||10,k<2||36<k)throw Error("radix out of range: "+k);if(M(this))return"0";if(z(this))return"-"+ee(this).toString(k);const x=m(Math.pow(k,6));var R=this;let D="";for(;;){const C=xe(R,x).g;R=Q(R,C.j(x));let P=((R.g.length>0?R.g[0]:R.h)>>>0).toString(k);if(R=C,M(R))return P+D;for(;P.length<6;)P="0"+P;D=P+D}},s.i=function(k){return k<0?0:k<this.g.length?this.g[k]:this.h};function M(k){if(k.h!=0)return!1;for(let x=0;x<k.g.length;x++)if(k.g[x]!=0)return!1;return!0}function z(k){return k.h==-1}s.l=function(k){return k=Q(this,k),z(k)?-1:M(k)?0:1};function ee(k){const x=k.g.length,R=[];for(let D=0;D<x;D++)R[D]=~k.g[D];return new u(R,~k.h).add(I)}s.abs=function(){return z(this)?ee(this):this},s.add=function(k){const x=Math.max(this.g.length,k.g.length),R=[];let D=0;for(let C=0;C<=x;C++){let P=D+(this.i(C)&65535)+(k.i(C)&65535),N=(P>>>16)+(this.i(C)>>>16)+(k.i(C)>>>16);D=N>>>16,P&=65535,N&=65535,R[C]=N<<16|P}return new u(R,R[R.length-1]&-2147483648?-1:0)};function Q(k,x){return k.add(ee(x))}s.j=function(k){if(M(this)||M(k))return E;if(z(this))return z(k)?ee(this).j(ee(k)):ee(ee(this).j(k));if(z(k))return ee(this.j(ee(k)));if(this.l(S)<0&&k.l(S)<0)return m(this.m()*k.m());const x=this.g.length+k.g.length,R=[];for(var D=0;D<2*x;D++)R[D]=0;for(D=0;D<this.g.length;D++)for(let C=0;C<k.g.length;C++){const P=this.i(D)>>>16,N=this.i(D)&65535,we=k.i(C)>>>16,Ye=k.i(C)&65535;R[2*D+2*C]+=N*Ye,ae(R,2*D+2*C),R[2*D+2*C+1]+=P*Ye,ae(R,2*D+2*C+1),R[2*D+2*C+1]+=N*we,ae(R,2*D+2*C+1),R[2*D+2*C+2]+=P*we,ae(R,2*D+2*C+2)}for(k=0;k<x;k++)R[k]=R[2*k+1]<<16|R[2*k];for(k=x;k<2*x;k++)R[k]=0;return new u(R,0)};function ae(k,x){for(;(k[x]&65535)!=k[x];)k[x+1]+=k[x]>>>16,k[x]&=65535,x++}function se(k,x){this.g=k,this.h=x}function xe(k,x){if(M(x))throw Error("division by zero");if(M(k))return new se(E,E);if(z(k))return x=xe(ee(k),x),new se(ee(x.g),ee(x.h));if(z(x))return x=xe(k,ee(x)),new se(ee(x.g),x.h);if(k.g.length>30){if(z(k)||z(x))throw Error("slowDivide_ only works with positive integers.");for(var R=I,D=x;D.l(k)<=0;)R=oe(R),D=oe(D);var C=Z(R,1),P=Z(D,1);for(D=Z(D,2),R=Z(R,2);!M(D);){var N=P.add(D);N.l(k)<=0&&(C=C.add(R),P=N),D=Z(D,1),R=Z(R,1)}return x=Q(k,C.j(x)),new se(C,x)}for(C=E;k.l(x)>=0;){for(R=Math.max(1,Math.floor(k.m()/x.m())),D=Math.ceil(Math.log(R)/Math.LN2),D=D<=48?1:Math.pow(2,D-48),P=m(R),N=P.j(x);z(N)||N.l(k)>0;)R-=D,P=m(R),N=P.j(x);M(P)&&(P=I),C=C.add(P),k=Q(k,N)}return new se(C,k)}s.B=function(k){return xe(this,k).h},s.and=function(k){const x=Math.max(this.g.length,k.g.length),R=[];for(let D=0;D<x;D++)R[D]=this.i(D)&k.i(D);return new u(R,this.h&k.h)},s.or=function(k){const x=Math.max(this.g.length,k.g.length),R=[];for(let D=0;D<x;D++)R[D]=this.i(D)|k.i(D);return new u(R,this.h|k.h)},s.xor=function(k){const x=Math.max(this.g.length,k.g.length),R=[];for(let D=0;D<x;D++)R[D]=this.i(D)^k.i(D);return new u(R,this.h^k.h)};function oe(k){const x=k.g.length+1,R=[];for(let D=0;D<x;D++)R[D]=k.i(D)<<1|k.i(D-1)>>>31;return new u(R,k.h)}function Z(k,x){const R=x>>5;x%=32;const D=k.g.length-R,C=[];for(let P=0;P<D;P++)C[P]=x>0?k.i(P+R)>>>x|k.i(P+R+1)<<32-x:k.i(P+R);return new u(C,k.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,SS=r,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=m,u.fromString=b,ha=u}).apply(typeof NE<"u"?NE:typeof self<"u"?self:typeof window<"u"?window:{});var Pf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var AS,Xu,NS,Gf,W0,RS,CS,kS;(function(){var s,e=Object.defineProperty;function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pf=="object"&&Pf];for(var _=0;_<h.length;++_){var w=h[_];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=t(this);function a(h,_){if(_)e:{var w=r;h=h.split(".");for(var A=0;A<h.length-1;A++){var q=h[A];if(!(q in w))break e;w=w[q]}h=h[h.length-1],A=w[h],_=_(A),_!=A&&_!=null&&e(w,h,{configurable:!0,writable:!0,value:_})}}a("Symbol.dispose",function(h){return h||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(h){return h||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(h){return h||function(_){var w=[],A;for(A in _)Object.prototype.hasOwnProperty.call(_,A)&&w.push([A,_[A]]);return w}});var l=l||{},u=this||self;function p(h){var _=typeof h;return _=="object"&&h!=null||_=="function"}function y(h,_,w){return h.call.apply(h.bind,arguments)}function m(h,_,w){return m=y,m.apply(null,arguments)}function b(h,_){var w=Array.prototype.slice.call(arguments,1);return function(){var A=w.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function E(h,_){function w(){}w.prototype=_.prototype,h.Z=_.prototype,h.prototype=new w,h.prototype.constructor=h,h.Ob=function(A,q,X){for(var ge=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)ge[Ue-2]=arguments[Ue];return _.prototype[q].apply(A,ge)}}var I=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?h=>h&&AsyncContext.Snapshot.wrap(h):h=>h;function S(h){const _=h.length;if(_>0){const w=Array(_);for(let A=0;A<_;A++)w[A]=h[A];return w}return[]}function M(h,_){for(let A=1;A<arguments.length;A++){const q=arguments[A];var w=typeof q;if(w=w!="object"?w:q?Array.isArray(q)?"array":w:"null",w=="array"||w=="object"&&typeof q.length=="number"){w=h.length||0;const X=q.length||0;h.length=w+X;for(let ge=0;ge<X;ge++)h[w+ge]=q[ge]}else h.push(q)}}class z{constructor(_,w){this.i=_,this.j=w,this.h=0,this.g=null}get(){let _;return this.h>0?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function ee(h){u.setTimeout(()=>{throw h},0)}function Q(){var h=k;let _=null;return h.g&&(_=h.g,h.g=h.g.next,h.g||(h.h=null),_.next=null),_}class ae{constructor(){this.h=this.g=null}add(_,w){const A=se.get();A.set(_,w),this.h?this.h.next=A:this.g=A,this.h=A}}var se=new z(()=>new xe,h=>h.reset());class xe{constructor(){this.next=this.g=this.h=null}set(_,w){this.h=_,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,Z=!1,k=new ae,x=()=>{const h=Promise.resolve(void 0);oe=()=>{h.then(R)}};function R(){for(var h;h=Q();){try{h.h.call(h.g)}catch(w){ee(w)}var _=se;_.j(h),_.h<100&&(_.h++,h.next=_.g,_.g=h)}Z=!1}function D(){this.u=this.u,this.C=this.C}D.prototype.u=!1,D.prototype.dispose=function(){this.u||(this.u=!0,this.N())},D.prototype[Symbol.dispose]=function(){this.dispose()},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function C(h,_){this.type=h,this.g=this.target=_,this.defaultPrevented=!1}C.prototype.h=function(){this.defaultPrevented=!0};var P=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var h=!1,_=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};u.addEventListener("test",w,_),u.removeEventListener("test",w,_)}catch{}return h})();function N(h){return/^[\s\xa0]*$/.test(h)}function we(h,_){C.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h&&this.init(h,_)}E(we,C),we.prototype.init=function(h,_){const w=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;this.target=h.target||h.srcElement,this.g=_,_=h.relatedTarget,_||(w=="mouseover"?_=h.fromElement:w=="mouseout"&&(_=h.toElement)),this.relatedTarget=_,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=h.pointerType,this.state=h.state,this.i=h,h.defaultPrevented&&we.Z.h.call(this)},we.prototype.h=function(){we.Z.h.call(this);const h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Ye="closure_listenable_"+(Math.random()*1e6|0),K=0;function me(h,_,w,A,q){this.listener=h,this.proxy=null,this.src=_,this.type=w,this.capture=!!A,this.ha=q,this.key=++K,this.da=this.fa=!1}function Ee(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Me(h,_,w){for(const A in h)_.call(w,h[A],A,h)}function ke(h,_){for(const w in h)_.call(void 0,h[w],w,h)}function V(h){const _={};for(const w in h)_[w]=h[w];return _}const te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(h,_){let w,A;for(let q=1;q<arguments.length;q++){A=arguments[q];for(w in A)h[w]=A[w];for(let X=0;X<te.length;X++)w=te[X],Object.prototype.hasOwnProperty.call(A,w)&&(h[w]=A[w])}}function G(h){this.src=h,this.g={},this.h=0}G.prototype.add=function(h,_,w,A,q){const X=h.toString();h=this.g[X],h||(h=this.g[X]=[],this.h++);const ge=de(h,_,A,q);return ge>-1?(_=h[ge],w||(_.fa=!1)):(_=new me(_,this.src,X,!!A,q),_.fa=w,h.push(_)),_};function le(h,_){const w=_.type;if(w in h.g){var A=h.g[w],q=Array.prototype.indexOf.call(A,_,void 0),X;(X=q>=0)&&Array.prototype.splice.call(A,q,1),X&&(Ee(_),h.g[w].length==0&&(delete h.g[w],h.h--))}}function de(h,_,w,A){for(let q=0;q<h.length;++q){const X=h[q];if(!X.da&&X.listener==_&&X.capture==!!w&&X.ha==A)return q}return-1}var pe="closure_lm_"+(Math.random()*1e6|0),Re={};function nt(h,_,w,A,q){if(Array.isArray(_)){for(let X=0;X<_.length;X++)nt(h,_[X],w,A,q);return null}return w=Yn(w),h&&h[Ye]?h.J(_,w,p(A)?!!A.capture:!1,q):lr(h,_,w,!1,A,q)}function lr(h,_,w,A,q,X){if(!_)throw Error("Invalid event type");const ge=p(q)?!!q.capture:!!q;let Ue=Cn(h);if(Ue||(h[pe]=Ue=new G(h)),w=Ue.add(_,w,A,ge,X),w.proxy)return w;if(A=Ft(),w.proxy=A,A.src=h,A.listener=w,h.addEventListener)P||(q=ge),q===void 0&&(q=!1),h.addEventListener(_.toString(),A,q);else if(h.attachEvent)h.attachEvent(cn(_.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Ft(){function h(w){return _.call(h.src,h.listener,w)}const _=Kn;return h}function bn(h,_,w,A,q){if(Array.isArray(_))for(var X=0;X<_.length;X++)bn(h,_[X],w,A,q);else A=p(A)?!!A.capture:!!A,w=Yn(w),h&&h[Ye]?(h=h.i,X=String(_).toString(),X in h.g&&(_=h.g[X],w=de(_,w,A,q),w>-1&&(Ee(_[w]),Array.prototype.splice.call(_,w,1),_.length==0&&(delete h.g[X],h.h--)))):h&&(h=Cn(h))&&(_=h.g[_.toString()],h=-1,_&&(h=de(_,w,A,q)),(w=h>-1?_[h]:null)&&Er(w))}function Er(h){if(typeof h!="number"&&h&&!h.da){var _=h.src;if(_&&_[Ye])le(_.i,h);else{var w=h.type,A=h.proxy;_.removeEventListener?_.removeEventListener(w,A,h.capture):_.detachEvent?_.detachEvent(cn(w),A):_.addListener&&_.removeListener&&_.removeListener(A),(w=Cn(_))?(le(w,h),w.h==0&&(w.src=null,_[pe]=null)):Ee(h)}}}function cn(h){return h in Re?Re[h]:Re[h]="on"+h}function Kn(h,_){if(h.da)h=!0;else{_=new we(_,this);const w=h.listener,A=h.ha||h.src;h.fa&&Er(h),h=w.call(A,_)}return h}function Cn(h){return h=h[pe],h instanceof G?h:null}var $n="__closure_events_fn_"+(Math.random()*1e9>>>0);function Yn(h){return typeof h=="function"?h:(h[$n]||(h[$n]=function(_){return h.handleEvent(_)}),h[$n])}function We(){D.call(this),this.i=new G(this),this.M=this,this.G=null}E(We,D),We.prototype[Ye]=!0,We.prototype.removeEventListener=function(h,_,w,A){bn(this,h,_,w,A)};function wt(h,_){var w,A=h.G;if(A)for(w=[];A;A=A.G)w.push(A);if(h=h.M,A=_.type||_,typeof _=="string")_=new C(_,h);else if(_ instanceof C)_.target=_.target||h;else{var q=_;_=new C(A,h),B(_,q)}q=!0;let X,ge;if(w)for(ge=w.length-1;ge>=0;ge--)X=_.g=w[ge],q=kn(X,A,!0,_)&&q;if(X=_.g=h,q=kn(X,A,!0,_)&&q,q=kn(X,A,!1,_)&&q,w)for(ge=0;ge<w.length;ge++)X=_.g=w[ge],q=kn(X,A,!1,_)&&q}We.prototype.N=function(){if(We.Z.N.call(this),this.i){var h=this.i;for(const _ in h.g){const w=h.g[_];for(let A=0;A<w.length;A++)Ee(w[A]);delete h.g[_],h.h--}}this.G=null},We.prototype.J=function(h,_,w,A){return this.i.add(String(h),_,!1,w,A)},We.prototype.K=function(h,_,w,A){return this.i.add(String(h),_,!0,w,A)};function kn(h,_,w,A){if(_=h.i.g[String(_)],!_)return!0;_=_.concat();let q=!0;for(let X=0;X<_.length;++X){const ge=_[X];if(ge&&!ge.da&&ge.capture==w){const Ue=ge.listener,Ht=ge.ha||ge.src;ge.fa&&le(h.i,ge),q=Ue.call(Ht,A)!==!1&&q}}return q&&!A.defaultPrevented}function Y(h,_){if(typeof h!="function")if(h&&typeof h.handleEvent=="function")h=m(h.handleEvent,h);else throw Error("Invalid listener argument");return Number(_)>2147483647?-1:u.setTimeout(h,_||0)}function Se(h){h.g=Y(()=>{h.g=null,h.i&&(h.i=!1,Se(h))},h.l);const _=h.h;h.h=null,h.m.apply(null,_)}class qe extends D{constructor(_,w){super(),this.m=_,this.l=w,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Se(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ue(h){D.call(this),this.h=h,this.g={}}E(ue,D);var Dt=[];function vn(h){Me(h.g,function(_,w){this.g.hasOwnProperty(w)&&Er(_)},h),h.g={}}ue.prototype.N=function(){ue.Z.N.call(this),vn(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wt=u.JSON.stringify,Pa=u.JSON.parse,Fs=class{stringify(h){return u.JSON.stringify(h,void 0)}parse(h){return u.JSON.parse(h,void 0)}};function Oc(){}function Ur(){}var Un={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function be(){C.call(this,"d")}E(be,C);function je(){C.call(this,"c")}E(je,C);var He={},zr=null;function wi(){return zr=zr||new We}He.Ia="serverreachability";function ja(h){C.call(this,He.Ia,h)}E(ja,C);function as(h){const _=wi();wt(_,new ja(_))}He.STAT_EVENT="statevent";function Va(h,_){C.call(this,He.STAT_EVENT,h),this.stat=_}E(Va,C);function Xt(h){const _=wi();wt(_,new Va(_,h))}He.Ja="timingevent";function os(h,_){C.call(this,He.Ja,h),this.size=_}E(os,C);function ls(h,_){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){h()},_)}function Br(){this.g=!0}Br.prototype.ua=function(){this.g=!1};function fp(h,_,w,A,q,X){h.info(function(){if(h.g)if(X){var ge="",Ue=X.split("&");for(let at=0;at<Ue.length;at++){var Ht=Ue[at].split("=");if(Ht.length>1){const St=Ht[0];Ht=Ht[1];const Ar=St.split("_");ge=Ar.length>=2&&Ar[1]=="type"?ge+(St+"="+Ht+"&"):ge+(St+"=redacted&")}}}else ge=null;else ge=X;return"XMLHTTP REQ ("+A+") [attempt "+q+"]: "+_+`
`+w+`
`+ge})}function lh(h,_,w,A,q,X,ge){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+q+"]: "+_+`
`+w+`
`+X+" "+ge})}function cs(h,_,w,A){h.info(function(){return"XMLHTTP TEXT ("+_+"): "+mp(h,w)+(A?" "+A:"")})}function Oa(h,_){h.info(function(){return"TIMEOUT: "+_})}Br.prototype.info=function(){};function mp(h,_){if(!h.g)return _;if(!_)return null;try{const X=JSON.parse(_);if(X){for(h=0;h<X.length;h++)if(Array.isArray(X[h])){var w=X[h];if(!(w.length<2)){var A=w[1];if(Array.isArray(A)&&!(A.length<1)){var q=A[0];if(q!="noop"&&q!="stop"&&q!="close")for(let ge=1;ge<A.length;ge++)A[ge]=""}}}}return Wt(X)}catch{return _}}var Ma={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Mc={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Lc;function La(){}E(La,Oc),La.prototype.g=function(){return new XMLHttpRequest},Lc=new La;function Hs(h){return encodeURIComponent(String(h))}function ch(h){var _=1;h=h.split(":");const w=[];for(;_>0&&h.length;)w.push(h.shift()),_--;return h.length&&w.push(h.join(":")),w}function qr(h,_,w,A){this.j=h,this.i=_,this.l=w,this.S=A||1,this.V=new ue(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Fr}function Fr(){this.i=null,this.g="",this.h=!1}var Jt={},fn={};function us(h,_,w){h.M=1,h.A=Ua(en(_)),h.u=w,h.R=!0,$o(h,null)}function $o(h,_){h.F=Date.now(),ds(h),h.B=en(h.A);var w=h.B,A=h.S;Array.isArray(A)||(A=[String(A)]),Jo(w.i,"t",A),h.C=0,w=h.j.L,h.h=new Fr,h.g=Th(h.j,w?_:null,!h.u),h.P>0&&(h.O=new qe(m(h.Y,h,h.g),h.P)),_=h.V,w=h.g,A=h.ba;var q="readystatechange";Array.isArray(q)||(q&&(Dt[0]=q.toString()),q=Dt);for(let X=0;X<q.length;X++){const ge=nt(w,q[X],A||_.handleEvent,!1,_.h||_);if(!ge)break;_.g[ge.key]=ge}_=h.J?V(h.J):{},h.u?(h.v||(h.v="POST"),_["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.B,h.v,h.u,_)):(h.v="GET",h.g.ea(h.B,h.v,null,_)),as(),fp(h.i,h.v,h.B,h.l,h.S,h.u)}qr.prototype.ba=function(h){h=h.target;const _=this.O;_&&Qr(h)==3?_.j():this.Y(h)},qr.prototype.Y=function(h){try{if(h==this.g)e:{const Ue=Qr(this.g),Ht=this.g.ya(),at=this.g.ca();if(!(Ue<3)&&(Ue!=3||this.g&&(this.h.h||this.g.la()||xn(this.g)))){this.K||Ue!=4||Ht==7||(Ht==8||at<=0?as(3):as(2)),hs(this);var _=this.g.ca();this.X=_;var w=pp(this);if(this.o=_==200,lh(this.i,this.v,this.B,this.l,this.S,Ue,_),this.o){if(this.U&&!this.L){t:{if(this.g){var A,q=this.g;if((A=q.g?q.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(A)){var X=A;break t}}X=null}if(h=X)cs(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,fs(this,h);else{this.o=!1,this.m=3,Xt(12),cr(this),Tr(this);break e}}if(this.R){h=!0;let St;for(;!this.K&&this.C<w.length;)if(St=dh(this,w),St==fn){Ue==4&&(this.m=4,Xt(14),h=!1),cs(this.i,this.l,null,"[Incomplete Response]");break}else if(St==Jt){this.m=4,Xt(15),cs(this.i,this.l,w,"[Invalid Chunk]"),h=!1;break}else cs(this.i,this.l,St,null),fs(this,St);if(uh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ue!=4||w.length!=0||this.h.h||(this.m=1,Xt(16),h=!1),this.o=this.o&&h,!h)cs(this.i,this.l,w,"[Invalid Chunked Response]"),cr(this),Tr(this);else if(w.length>0&&!this.W){this.W=!0;var ge=this.j;ge.g==this&&ge.aa&&!ge.P&&(ge.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Zc(ge),ge.P=!0,Xt(11))}}else cs(this.i,this.l,w,null),fs(this,w);Ue==4&&cr(this),this.o&&!this.K&&(Ue==4?vh(this.j,this):(this.o=!1,ds(this)))}else Qs(this.g),_==400&&w.indexOf("Unknown SID")>0?(this.m=3,Xt(12)):(this.m=0,Xt(13)),cr(this),Tr(this)}}}catch{}};function pp(h){if(!uh(h))return h.g.la();const _=xn(h.g);if(_==="")return"";let w="";const A=_.length,q=Qr(h.g)==4;if(!h.h.i){if(typeof TextDecoder>"u")return cr(h),Tr(h),"";h.h.i=new u.TextDecoder}for(let X=0;X<A;X++)h.h.h=!0,w+=h.h.i.decode(_[X],{stream:!(q&&X==A-1)});return _.length=0,h.h.g+=w,h.C=0,h.h.g}function uh(h){return h.g?h.v=="GET"&&h.M!=2&&h.j.Aa:!1}function dh(h,_){var w=h.C,A=_.indexOf(`
`,w);return A==-1?fn:(w=Number(_.substring(w,A)),isNaN(w)?Jt:(A+=1,A+w>_.length?fn:(_=_.slice(A,A+w),h.C=A+w,_)))}qr.prototype.cancel=function(){this.K=!0,cr(this)};function ds(h){h.T=Date.now()+h.H,Yo(h,h.H)}function Yo(h,_){if(h.D!=null)throw Error("WatchDog timer not null");h.D=ls(m(h.aa,h),_)}function hs(h){h.D&&(u.clearTimeout(h.D),h.D=null)}qr.prototype.aa=function(){this.D=null;const h=Date.now();h-this.T>=0?(Oa(this.i,this.B),this.M!=2&&(as(),Xt(17)),cr(this),this.m=2,Tr(this)):Yo(this,this.T-h)};function Tr(h){h.j.I==0||h.K||vh(h.j,h)}function cr(h){hs(h);var _=h.O;_&&typeof _.dispose=="function"&&_.dispose(),h.O=null,vn(h.V),h.g&&(_=h.g,h.g=null,_.abort(),_.dispose())}function fs(h,_){try{var w=h.j;if(w.I!=0&&(w.g==h||ps(w.h,h))){if(!h.L&&ps(w.h,h)&&w.I==3){try{var A=w.Ba.g.parse(_)}catch{A=null}if(Array.isArray(A)&&A.length==3){var q=A;if(q[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<h.F)rl(w),Ci(w);else break e;Qa(w),Xt(18)}}else w.xa=q[1],0<w.xa-w.K&&q[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=ls(m(w.Va,w),6e3));ms(w.h)<=1&&w.ta&&(w.ta=void 0)}else xs(w,11)}else if((h.L||w.g==h)&&rl(w),!N(_))for(q=w.Ba.g.parse(_),_=0;_<q.length;_++){let at=q[_];const St=at[0];if(!(St<=w.K))if(w.K=St,at=at[1],w.I==2)if(at[0]=="c"){w.M=at[1],w.ba=at[2];const Ar=at[3];Ar!=null&&(w.ka=Ar,w.j.info("VER="+w.ka));const ws=at[4];ws!=null&&(w.za=ws,w.j.info("SVER="+w.za));const Kr=at[5];Kr!=null&&typeof Kr=="number"&&Kr>0&&(A=1.5*Kr,w.O=A,w.j.info("backChannelRequestTimeoutMs_="+A)),A=w;const $r=h.g;if($r){const Ka=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ka){var X=A.h;X.g||Ka.indexOf("spdy")==-1&&Ka.indexOf("quic")==-1&&Ka.indexOf("h2")==-1||(X.j=X.l,X.g=new Set,X.h&&(Bc(X,X.h),X.h=null))}if(A.G){const sl=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;sl&&(A.wa=sl,ct(A.J,A.G,sl))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-h.F,w.j.info("Handshake RTT: "+w.T+"ms")),A=w;var ge=h;if(A.na=Eh(A,A.L?A.ba:null,A.W),ge.L){qc(A.h,ge);var Ue=ge,Ht=A.O;Ht&&(Ue.H=Ht),Ue.D&&(hs(Ue),ds(Ue)),A.g=ge}else _h(A);w.i.length>0&&vs(w)}else at[0]!="stop"&&at[0]!="close"||xs(w,7);else w.I==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?xs(w,7):Xc(w):at[0]!="noop"&&w.l&&w.l.qa(at),w.A=0)}}as(4)}catch{}}var Zt=class{constructor(h,_){this.g=h,this.map=_}};function Uc(h){this.l=h||10,u.PerformanceNavigationTiming?(h=u.performance.getEntriesByType("navigation"),h=h.length>0&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function zc(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function ms(h){return h.h?1:h.g?h.g.size:0}function ps(h,_){return h.h?h.h==_:h.g?h.g.has(_):!1}function Bc(h,_){h.g?h.g.add(_):h.h=_}function qc(h,_){h.h&&h.h==_?h.h=null:h.g&&h.g.has(_)&&h.g.delete(_)}Uc.prototype.cancel=function(){if(this.i=Fc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Fc(h){if(h.h!=null)return h.i.concat(h.h.G);if(h.g!=null&&h.g.size!==0){let _=h.i;for(const w of h.g.values())_=_.concat(w.G);return _}return S(h.i)}var hh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wo(h,_){if(h){h=h.split("&");for(let w=0;w<h.length;w++){const A=h[w].indexOf("=");let q,X=null;A>=0?(q=h[w].substring(0,A),X=h[w].substring(A+1)):q=h[w],_(q,X?decodeURIComponent(X.replace(/\+/g," ")):"")}}}function ur(h){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let _;h instanceof ur?(this.l=h.l,mn(this,h.j),this.o=h.o,this.g=h.g,Ei(this,h.u),this.h=h.h,Hc(this,gh(h.i)),this.m=h.m):h&&(_=String(h).match(hh))?(this.l=!1,mn(this,_[1]||"",!0),this.o=gs(_[2]||""),this.g=gs(_[3]||"",!0),Ei(this,_[4]),this.h=gs(_[5]||"",!0),Hc(this,_[6]||"",!0),this.m=gs(_[7]||"")):(this.l=!1,this.i=new Ii(null,this.l))}ur.prototype.toString=function(){const h=[];var _=this.j;_&&h.push(za(_,Xo,!0),":");var w=this.g;return(w||_=="file")&&(h.push("//"),(_=this.o)&&h.push(za(_,Xo,!0),"@"),h.push(Hs(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&h.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(za(w,w.charAt(0)=="/"?Gc:fh,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",za(w,mh)),h.join("")},ur.prototype.resolve=function(h){const _=en(this);let w=!!h.j;w?mn(_,h.j):w=!!h.o,w?_.o=h.o:w=!!h.g,w?_.g=h.g:w=h.u!=null;var A=h.h;if(w)Ei(_,h.u);else if(w=!!h.h){if(A.charAt(0)!="/")if(this.g&&!this.h)A="/"+A;else{var q=_.h.lastIndexOf("/");q!=-1&&(A=_.h.slice(0,q+1)+A)}if(q=A,q==".."||q==".")A="";else if(q.indexOf("./")!=-1||q.indexOf("/.")!=-1){A=q.lastIndexOf("/",0)==0,q=q.split("/");const X=[];for(let ge=0;ge<q.length;){const Ue=q[ge++];Ue=="."?A&&ge==q.length&&X.push(""):Ue==".."?((X.length>1||X.length==1&&X[0]!="")&&X.pop(),A&&ge==q.length&&X.push("")):(X.push(Ue),A=!0)}A=X.join("/")}else A=q}return w?_.h=A:w=h.i.toString()!=="",w?Hc(_,gh(h.i)):w=!!h.m,w&&(_.m=h.m),_};function en(h){return new ur(h)}function mn(h,_,w){h.j=w?gs(_,!0):_,h.j&&(h.j=h.j.replace(/:$/,""))}function Ei(h,_){if(_){if(_=Number(_),isNaN(_)||_<0)throw Error("Bad port number "+_);h.u=_}else h.u=null}function Hc(h,_,w){_ instanceof Ii?(h.i=_,Zo(h.i,h.l)):(w||(_=za(_,Ti)),h.i=new Ii(_,h.l))}function ct(h,_,w){h.i.set(_,w)}function Ua(h){return ct(h,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),h}function gs(h,_){return h?_?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function za(h,_,w){return typeof h=="string"?(h=encodeURI(h).replace(_,Wn),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Wn(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Xo=/[#\/\?@]/g,fh=/[#\?:]/g,Gc=/[#\?]/g,Ti=/[#\?@]/g,mh=/#/g;function Ii(h,_){this.h=this.g=null,this.i=h||null,this.j=!!_}function Xn(h){h.g||(h.g=new Map,h.h=0,h.i&&Wo(h.i,function(_,w){h.add(decodeURIComponent(_.replace(/\+/g," ")),w)}))}s=Ii.prototype,s.add=function(h,_){Xn(this),this.i=null,h=Si(this,h);let w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(_),this.h+=1,this};function ph(h,_){Xn(h),_=Si(h,_),h.g.has(_)&&(h.i=null,h.h-=h.g.get(_).length,h.g.delete(_))}function Qc(h,_){return Xn(h),_=Si(h,_),h.g.has(_)}s.forEach=function(h,_){Xn(this),this.g.forEach(function(w,A){w.forEach(function(q){h.call(_,q,A,this)},this)},this)};function Kc(h,_){Xn(h);let w=[];if(typeof _=="string")Qc(h,_)&&(w=w.concat(h.g.get(Si(h,_))));else for(h=Array.from(h.g.values()),_=0;_<h.length;_++)w=w.concat(h[_]);return w}s.set=function(h,_){return Xn(this),this.i=null,h=Si(this,h),Qc(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[_]),this.h+=1,this},s.get=function(h,_){return h?(h=Kc(this,h),h.length>0?String(h[0]):_):_};function Jo(h,_,w){ph(h,_),w.length>0&&(h.i=null,h.g.set(Si(h,_),S(w)),h.h+=w.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],_=Array.from(this.g.keys());for(let A=0;A<_.length;A++){var w=_[A];const q=Hs(w);w=Kc(this,w);for(let X=0;X<w.length;X++){let ge=q;w[X]!==""&&(ge+="="+Hs(w[X])),h.push(ge)}}return this.i=h.join("&")};function gh(h){const _=new Ii;return _.i=h.i,h.g&&(_.g=new Map(h.g),_.h=h.h),_}function Si(h,_){return _=String(_),h.j&&(_=_.toLowerCase()),_}function Zo(h,_){_&&!h.j&&(Xn(h),h.i=null,h.g.forEach(function(w,A){const q=A.toLowerCase();A!=q&&(ph(this,A),Jo(this,q,w))},h)),h.j=_}function Hr(h,_){const w=new Br;if(u.Image){const A=new Image;A.onload=b(Ir,w,"TestLoadImage: loaded",!0,_,A),A.onerror=b(Ir,w,"TestLoadImage: error",!1,_,A),A.onabort=b(Ir,w,"TestLoadImage: abort",!1,_,A),A.ontimeout=b(Ir,w,"TestLoadImage: timeout",!1,_,A),u.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else _(!1)}function $c(h,_){const w=new Br,A=new AbortController,q=setTimeout(()=>{A.abort(),Ir(w,"TestPingServer: timeout",!1,_)},1e4);fetch(h,{signal:A.signal}).then(X=>{clearTimeout(q),X.ok?Ir(w,"TestPingServer: ok",!0,_):Ir(w,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(q),Ir(w,"TestPingServer: error",!1,_)})}function Ir(h,_,w,A,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),A(w)}catch{}}function Ai(){this.g=new Fs}function ys(h){this.i=h.Sb||null,this.h=h.ab||!1}E(ys,Oc),ys.prototype.g=function(){return new Ba(this.i,this.h)};function Ba(h,_){We.call(this),this.H=h,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(Ba,We),s=Ba.prototype,s.open=function(h,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=h,this.D=_,this.readyState=1,Gr(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const _={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};h&&(_.body=h),(this.H||u).fetch(new Request(this.D,_)).then(this.Pa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ni(this)),this.readyState=0},s.Pa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Gr(this)),this.g&&(this.readyState=3,Gr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;el(this)}else h.text().then(this.Oa.bind(this),this.ga.bind(this))};function el(h){h.j.read().then(h.Ma.bind(h)).catch(h.ga.bind(h))}s.Ma=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var _=h.value?h.value:new Uint8Array(0);(_=this.B.decode(_,{stream:!h.done}))&&(this.response=this.responseText+=_)}h.done?Ni(this):Gr(this),this.readyState==3&&el(this)}},s.Oa=function(h){this.g&&(this.response=this.responseText=h,Ni(this))},s.Na=function(h){this.g&&(this.response=h,Ni(this))},s.ga=function(){this.g&&Ni(this)};function Ni(h){h.readyState=4,h.l=null,h.j=null,h.B=null,Gr(h)}s.setRequestHeader=function(h,_){this.A.append(h,_)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],_=this.h.entries();for(var w=_.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=_.next();return h.join(`\r
`)};function Gr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ba.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Sr(h){let _="";return Me(h,function(w,A){_+=A,_+=":",_+=w,_+=`\r
`}),_}function qa(h,_,w){e:{for(A in w){var A=!1;break e}A=!0}A||(w=Sr(w),typeof h=="string"?w!=null&&Hs(w):ct(h,_,w))}function mt(h){We.call(this),this.headers=new Map,this.L=h||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(mt,We);var _s=/^https?$/i,Yc=["POST","PUT"];s=mt.prototype,s.Fa=function(h){this.H=h},s.ea=function(h,_,w,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);_=_?_.toUpperCase():"GET",this.D=h,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Lc.g(),this.g.onreadystatechange=I(m(this.Ca,this));try{this.B=!0,this.g.open(_,String(h),!0),this.B=!1}catch(X){Fa(this,X);return}if(h=w||"",w=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var q in A)w.set(q,A[q]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const X of A.keys())w.set(X,A.get(X));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(w.keys()).find(X=>X.toLowerCase()=="content-type"),q=u.FormData&&h instanceof u.FormData,!(Array.prototype.indexOf.call(Yc,_,void 0)>=0)||A||q||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[X,ge]of w)this.g.setRequestHeader(X,ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(h),this.v=!1}catch(X){Fa(this,X)}};function Fa(h,_){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=_,h.o=5,Wc(h),Gs(h)}function Wc(h){h.A||(h.A=!0,wt(h,"complete"),wt(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=h||7,wt(this,"complete"),wt(this,"abort"),Gs(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gs(this,!0)),mt.Z.N.call(this)},s.Ca=function(){this.u||(this.B||this.v||this.j?Ha(this):this.Xa())},s.Xa=function(){Ha(this)};function Ha(h){if(h.h&&typeof l<"u"){if(h.v&&Qr(h)==4)setTimeout(h.Ca.bind(h),0);else if(wt(h,"readystatechange"),Qr(h)==4){h.h=!1;try{const X=h.ca();e:switch(X){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var w;if(!(w=_)){var A;if(A=X===0){let ge=String(h.D).match(hh)[1]||null;!ge&&u.self&&u.self.location&&(ge=u.self.location.protocol.slice(0,-1)),A=!_s.test(ge?ge.toLowerCase():"")}w=A}if(w)wt(h,"complete"),wt(h,"success");else{h.o=6;try{var q=Qr(h)>2?h.g.statusText:""}catch{q=""}h.l=q+" ["+h.ca()+"]",Wc(h)}}finally{Gs(h)}}}}function Gs(h,_){if(h.g){h.m&&(clearTimeout(h.m),h.m=null);const w=h.g;h.g=null,_||wt(h,"ready");try{w.onreadystatechange=null}catch{}}}s.isActive=function(){return!!this.g};function Qr(h){return h.g?h.g.readyState:0}s.ca=function(){try{return Qr(this)>2?this.g.status:-1}catch{return-1}},s.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.La=function(h){if(this.g){var _=this.g.responseText;return h&&_.indexOf(h)==0&&(_=_.substring(h.length)),Pa(_)}};function xn(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.F){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Qs(h){const _={};h=(h.g&&Qr(h)>=2&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(N(h[A]))continue;var w=ch(h[A]);const q=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const X=_[q]||[];_[q]=X,X.push(w)}ke(_,function(A){return A.join(", ")})}s.ya=function(){return this.o},s.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function bs(h,_,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||_}function Ri(h){this.za=0,this.i=[],this.j=new Br,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=bs("failFast",!1,h),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=bs("baseRetryDelayMs",5e3,h),this.Za=bs("retryDelaySeedMs",1e4,h),this.Ta=bs("forwardChannelMaxRetries",2,h),this.va=bs("forwardChannelRequestTimeoutMs",2e4,h),this.ma=h&&h.xmlHttpFactory||void 0,this.Ua=h&&h.Rb||void 0,this.Aa=h&&h.useFetchStreams||!1,this.O=void 0,this.L=h&&h.supportsCrossDomainXhr||!1,this.M="",this.h=new Uc(h&&h.concurrentRequestLimit),this.Ba=new Ai,this.S=h&&h.fastHandshake||!1,this.R=h&&h.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=h&&h.Pb||!1,h&&h.ua&&this.j.ua(),h&&h.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&h&&h.detectBufferingProxy||!1,this.ia=void 0,h&&h.longPollingTimeout&&h.longPollingTimeout>0&&(this.ia=h.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}s=Ri.prototype,s.ka=8,s.I=1,s.connect=function(h,_,w,A){Xt(0),this.W=h,this.H=_||{},w&&A!==void 0&&(this.H.OSID=w,this.H.OAID=A),this.F=this.X,this.J=Eh(this,null,this.W),vs(this)};function Xc(h){if(tl(h),h.I==3){var _=h.V++,w=en(h.J);if(ct(w,"SID",h.M),ct(w,"RID",_),ct(w,"TYPE","terminate"),Ga(h,w),_=new qr(h,h.j,_),_.M=2,_.A=Ua(en(w)),w=!1,u.navigator&&u.navigator.sendBeacon)try{w=u.navigator.sendBeacon(_.A.toString(),"")}catch{}!w&&u.Image&&(new Image().src=_.A,w=!0),w||(_.g=Th(_.j,null),_.g.ea(_.A)),_.F=Date.now(),ds(_)}wh(h)}function Ci(h){h.g&&(Zc(h),h.g.cancel(),h.g=null)}function tl(h){Ci(h),h.v&&(u.clearTimeout(h.v),h.v=null),rl(h),h.h.cancel(),h.m&&(typeof h.m=="number"&&u.clearTimeout(h.m),h.m=null)}function vs(h){if(!zc(h.h)&&!h.m){h.m=!0;var _=h.Ea;oe||x(),Z||(oe(),Z=!0),k.add(_,h),h.D=0}}function nl(h,_){return ms(h.h)>=h.h.j-(h.m?1:0)?!1:h.m?(h.i=_.G.concat(h.i),!0):h.I==1||h.I==2||h.D>=(h.Sa?0:h.Ta)?!1:(h.m=ls(m(h.Ea,h,_),xh(h,h.D)),h.D++,!0)}s.Ea=function(h){if(this.m)if(this.m=null,this.I==1){if(!h){this.V=Math.floor(Math.random()*1e5),h=this.V++;const q=new qr(this,this.j,h);let X=this.o;if(this.U&&(X?(X=V(X),B(X,this.U)):X=this.U),this.u!==null||this.R||(q.J=X,X=null),this.S)e:{for(var _=0,w=0;w<this.i.length;w++){t:{var A=this.i[w];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(_+=A,_>4096){_=w;break e}if(_===4096||w===this.i.length-1){_=w+1;break e}}_=1e3}else _=1e3;_=yh(this,q,_),w=en(this.J),ct(w,"RID",h),ct(w,"CVER",22),this.G&&ct(w,"X-HTTP-Session-Id",this.G),Ga(this,w),X&&(this.R?_="headers="+Hs(Sr(X))+"&"+_:this.u&&qa(w,this.u,X)),Bc(this.h,q),this.Ra&&ct(w,"TYPE","init"),this.S?(ct(w,"$req",_),ct(w,"SID","null"),q.U=!0,us(q,w,null)):us(q,w,_),this.I=2}}else this.I==3&&(h?Jc(this,h):this.i.length==0||zc(this.h)||Jc(this))};function Jc(h,_){var w;_?w=_.l:w=h.V++;const A=en(h.J);ct(A,"SID",h.M),ct(A,"RID",w),ct(A,"AID",h.K),Ga(h,A),h.u&&h.o&&qa(A,h.u,h.o),w=new qr(h,h.j,w,h.D+1),h.u===null&&(w.J=h.o),_&&(h.i=_.G.concat(h.i)),_=yh(h,w,1e3),w.H=Math.round(h.va*.5)+Math.round(h.va*.5*Math.random()),Bc(h.h,w),us(w,A,_)}function Ga(h,_){h.H&&Me(h.H,function(w,A){ct(_,A,w)}),h.l&&Me({},function(w,A){ct(_,A,w)})}function yh(h,_,w){w=Math.min(h.i.length,w);const A=h.l?m(h.l.Ka,h.l,h):null;e:{var q=h.i;let Ue=-1;for(;;){const Ht=["count="+w];Ue==-1?w>0?(Ue=q[0].g,Ht.push("ofs="+Ue)):Ue=0:Ht.push("ofs="+Ue);let at=!0;for(let St=0;St<w;St++){var X=q[St].g;const Ar=q[St].map;if(X-=Ue,X<0)Ue=Math.max(0,q[St].g-100),at=!1;else try{X="req"+X+"_"||"";try{var ge=Ar instanceof Map?Ar:Object.entries(Ar);for(const[ws,Kr]of ge){let $r=Kr;p(Kr)&&($r=Wt(Kr)),Ht.push(X+ws+"="+encodeURIComponent($r))}}catch(ws){throw Ht.push(X+"type="+encodeURIComponent("_badmap")),ws}}catch{A&&A(Ar)}}if(at){ge=Ht.join("&");break e}}ge=void 0}return h=h.i.splice(0,w),_.G=h,ge}function _h(h){if(!h.g&&!h.v){h.Y=1;var _=h.Da;oe||x(),Z||(oe(),Z=!0),k.add(_,h),h.A=0}}function Qa(h){return h.g||h.v||h.A>=3?!1:(h.Y++,h.v=ls(m(h.Da,h),xh(h,h.A)),h.A++,!0)}s.Da=function(){if(this.v=null,bh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var h=4*this.T;this.j.info("BP detection timer enabled: "+h),this.B=ls(m(this.Wa,this),h)}},s.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Xt(10),Ci(this),bh(this))};function Zc(h){h.B!=null&&(u.clearTimeout(h.B),h.B=null)}function bh(h){h.g=new qr(h,h.j,"rpc",h.Y),h.u===null&&(h.g.J=h.o),h.g.P=0;var _=en(h.na);ct(_,"RID","rpc"),ct(_,"SID",h.M),ct(_,"AID",h.K),ct(_,"CI",h.F?"0":"1"),!h.F&&h.ia&&ct(_,"TO",h.ia),ct(_,"TYPE","xmlhttp"),Ga(h,_),h.u&&h.o&&qa(_,h.u,h.o),h.O&&(h.g.H=h.O);var w=h.g;h=h.ba,w.M=1,w.A=Ua(en(_)),w.u=null,w.R=!0,$o(w,h)}s.Va=function(){this.C!=null&&(this.C=null,Ci(this),Qa(this),Xt(19))};function rl(h){h.C!=null&&(u.clearTimeout(h.C),h.C=null)}function vh(h,_){var w=null;if(h.g==_){rl(h),Zc(h),h.g=null;var A=2}else if(ps(h.h,_))w=_.G,qc(h.h,_),A=1;else return;if(h.I!=0){if(_.o)if(A==1){w=_.u?_.u.length:0,_=Date.now()-_.F;var q=h.D;A=wi(),wt(A,new os(A,w)),vs(h)}else _h(h);else if(q=_.m,q==3||q==0&&_.X>0||!(A==1&&nl(h,_)||A==2&&Qa(h)))switch(w&&w.length>0&&(_=h.h,_.i=_.i.concat(w)),q){case 1:xs(h,5);break;case 4:xs(h,10);break;case 3:xs(h,6);break;default:xs(h,2)}}}function xh(h,_){let w=h.Qa+Math.floor(Math.random()*h.Za);return h.isActive()||(w*=2),w*_}function xs(h,_){if(h.j.info("Error code "+_),_==2){var w=m(h.bb,h),A=h.Ua;const q=!A;A=new ur(A||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||mn(A,"https"),Ua(A),q?Hr(A.toString(),w):$c(A.toString(),w)}else Xt(2);h.I=0,h.l&&h.l.pa(_),wh(h),tl(h)}s.bb=function(h){h?(this.j.info("Successfully pinged google.com"),Xt(2)):(this.j.info("Failed to ping google.com"),Xt(1))};function wh(h){if(h.I=0,h.ja=[],h.l){const _=Fc(h.h);(_.length!=0||h.i.length!=0)&&(M(h.ja,_),M(h.ja,h.i),h.h.i.length=0,S(h.i),h.i.length=0),h.l.oa()}}function Eh(h,_,w){var A=w instanceof ur?en(w):new ur(w);if(A.g!="")_&&(A.g=_+"."+A.g),Ei(A,A.u);else{var q=u.location;A=q.protocol,_=_?_+"."+q.hostname:q.hostname,q=+q.port;const X=new ur(null);A&&mn(X,A),_&&(X.g=_),q&&Ei(X,q),w&&(X.h=w),A=X}return w=h.G,_=h.wa,w&&_&&ct(A,w,_),ct(A,"VER",h.ka),Ga(h,A),A}function Th(h,_,w){if(_&&!h.L)throw Error("Can't create secondary domain capable XhrIo object.");return _=h.Aa&&!h.ma?new mt(new ys({ab:w})):new mt(h.ma),_.Fa(h.L),_}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ih(){}s=Ih.prototype,s.ra=function(){},s.qa=function(){},s.pa=function(){},s.oa=function(){},s.isActive=function(){return!0},s.Ka=function(){};function ki(){}ki.prototype.g=function(h,_){return new zn(h,_)};function zn(h,_){We.call(this),this.g=new Ri(_),this.l=h,this.h=_&&_.messageUrlParams||null,h=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(h?h["X-WebChannel-Content-Type"]=_.messageContentType:h={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.sa&&(h?h["X-WebChannel-Client-Profile"]=_.sa:h={"X-WebChannel-Client-Profile":_.sa}),this.g.U=h,(h=_&&_.Qb)&&!N(h)&&(this.g.u=h),this.A=_&&_.supportsCrossDomainXhr||!1,this.v=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!N(_)&&(this.g.G=_,h=this.h,h!==null&&_ in h&&(h=this.h,_ in h&&delete h[_])),this.j=new Ks(this)}E(zn,We),zn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},zn.prototype.close=function(){Xc(this.g)},zn.prototype.o=function(h){var _=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.v&&(w={},w.__data__=Wt(h),h=w);_.i.push(new Zt(_.Ya++,h)),_.I==3&&vs(_)},zn.prototype.N=function(){this.g.l=null,delete this.j,Xc(this.g),delete this.g,zn.Z.N.call(this)};function Sh(h){be.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var _=h.__sm__;if(_){e:{for(const w in _){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,_=_!==null&&h in _?_[h]:void 0),this.data=_}else this.data=h}E(Sh,be);function Ah(){je.call(this),this.status=1}E(Ah,je);function Ks(h){this.g=h}E(Ks,Ih),Ks.prototype.ra=function(){wt(this.g,"a")},Ks.prototype.qa=function(h){wt(this.g,new Sh(h))},Ks.prototype.pa=function(h){wt(this.g,new Ah)},Ks.prototype.oa=function(){wt(this.g,"b")},ki.prototype.createWebChannel=ki.prototype.g,zn.prototype.send=zn.prototype.o,zn.prototype.open=zn.prototype.m,zn.prototype.close=zn.prototype.close,kS=function(){return new ki},CS=function(){return wi()},RS=He,W0={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ma.NO_ERROR=0,Ma.TIMEOUT=8,Ma.HTTP_ERROR=6,Gf=Ma,Mc.COMPLETE="complete",NS=Mc,Ur.EventType=Un,Un.OPEN="a",Un.CLOSE="b",Un.ERROR="c",Un.MESSAGE="d",We.prototype.listen=We.prototype.J,Xu=Ur,mt.prototype.listenOnce=mt.prototype.K,mt.prototype.getLastError=mt.prototype.Ha,mt.prototype.getLastErrorCode=mt.prototype.ya,mt.prototype.getStatus=mt.prototype.ca,mt.prototype.getResponseJson=mt.prototype.La,mt.prototype.getResponseText=mt.prototype.la,mt.prototype.send=mt.prototype.ea,mt.prototype.setWithCredentials=mt.prototype.Fa,AS=mt}).apply(typeof Pf<"u"?Pf:typeof self<"u"?self:typeof window<"u"?window:{});class yn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");let Nc="12.8.0";function VV(s){Nc=s}const ba=new Cm("@firebase/firestore");function Bl(){return ba.logLevel}function OV(s){ba.setLogLevel(s)}function he(s,...e){if(ba.logLevel<=Ke.DEBUG){const t=e.map(o_);ba.debug(`Firestore (${Nc}): ${s}`,...t)}}function Kt(s,...e){if(ba.logLevel<=Ke.ERROR){const t=e.map(o_);ba.error(`Firestore (${Nc}): ${s}`,...t)}}function Bs(s,...e){if(ba.logLevel<=Ke.WARN){const t=e.map(o_);ba.warn(`Firestore (${Nc}): ${s}`,...t)}}function o_(s){if(typeof s=="string")return s;try{return(function(t){return JSON.stringify(t)})(s)}catch{return s}}function ve(s,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,DS(s,r,t)}function DS(s,e,t){let r=`FIRESTORE (${Nc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Kt(r),new Error(r)}function Ie(s,e,t,r){let a="Unexpected state";typeof t=="string"?a=t:r=t,s||DS(e,a,r)}function MV(s,e){s||ve(57014,e)}function _e(s,e){return s}const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ce extends Hn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Nn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class PS{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class LV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(yn.UNAUTHENTICATED)))}shutdown(){}}class UV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class zV{constructor(e){this.t=e,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ie(this.o===void 0,42304);let r=this.i;const a=y=>this.i!==r?(r=this.i,t(y)):Promise.resolve();let l=new Nn;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Nn,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const y=l;e.enqueueRetryable((async()=>{await y.promise,await a(this.currentUser)}))},p=y=>{he("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=y,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((y=>p(y))),setTimeout((()=>{if(!this.auth){const y=this.t.getImmediate({optional:!0});y?p(y):(he("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Nn)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(he("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ie(typeof r.accessToken=="string",31837,{l:r}),new PS(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ie(e===null||typeof e=="string",2055,{h:e}),new yn(e)}}class BV{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class qV{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new BV(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(yn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class RE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class FV{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Rt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ie(this.o===void 0,3512);const r=l=>{l.error!=null&&he("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,he("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>r(l)))};const a=l=>{he("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):he("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new RE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ie(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new RE(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function HV(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<s;r++)t[r]=Math.floor(256*Math.random());return t}class l_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=HV(40);for(let l=0;l<a.length;++l)r.length<20&&a[l]<t&&(r+=e.charAt(a[l]%62))}return r}}function Ve(s,e){return s<e?-1:s>e?1:0}function X0(s,e){const t=Math.min(s.length,e.length);for(let r=0;r<t;r++){const a=s.charAt(r),l=e.charAt(r);if(a!==l)return S0(a)===S0(l)?Ve(a,l):S0(a)?1:-1}return Ve(s.length,e.length)}const GV=55296,QV=57343;function S0(s){const e=s.charCodeAt(0);return e>=GV&&e<=QV}function sc(s,e,t){return s.length===e.length&&s.every(((r,a)=>t(r,e[a])))}function jS(s){return s+"\0"}const CE="__name__";class As{constructor(e,t,r){t===void 0?t=0:t>e.length&&ve(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ve(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return As.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof As?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const l=As.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return Ve(e.length,t.length)}static compareSegments(e,t){const r=As.isNumericId(e),a=As.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?As.extractNumericId(e).compare(As.extractNumericId(t)):X0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ha.fromString(e.substring(4,e.length-2))}}class $e extends As{construct(e,t,r){return new $e(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ce(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((a=>a.length>0)))}return new $e(t)}static emptyPath(){return new $e([])}}const KV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ct extends As{construct(e,t,r){return new Ct(e,t,r)}static isValidIdentifier(e){return KV.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ct.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===CE}static keyField(){return new Ct([CE])}static fromServerFormat(e){const t=[];let r="",a=0;const l=()=>{if(r.length===0)throw new ce(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let u=!1;for(;a<e.length;){const p=e[a];if(p==="\\"){if(a+1===e.length)throw new ce(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const y=e[a+1];if(y!=="\\"&&y!=="."&&y!=="`")throw new ce(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=y,a+=2}else p==="`"?(u=!u,a++):p!=="."||u?(r+=p,a++):(l(),a++)}if(l(),u)throw new ce(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ct(t)}static emptyPath(){return new Ct([])}}class ye{constructor(e){this.path=e}static fromPath(e){return new ye($e.fromString(e))}static fromName(e){return new ye($e.fromString(e).popFirst(5))}static empty(){return new ye($e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$e.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return $e.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ye(new $e(e.slice()))}}function c_(s,e,t){if(!t)throw new ce(W.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function VS(s,e,t,r){if(e===!0&&r===!0)throw new ce(W.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function kE(s){if(!ye.isDocumentKey(s))throw new ce(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function DE(s){if(ye.isDocumentKey(s))throw new ce(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function OS(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function qm(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":ve(12329,{type:typeof s})}function it(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new ce(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=qm(s);throw new ce(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}function MS(s,e){if(e<=0)throw new ce(W.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${e}.`)}function ln(s,e){const t={typeString:s};return e&&(t.value=e),t}function Kd(s,e){if(!OS(s))throw new ce(W.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const a=e[r].typeString,l="value"in e[r]?{value:e[r].value}:void 0;if(!(r in s)){t=`JSON missing required field: '${r}'`;break}const u=s[r];if(a&&typeof u!==a){t=`JSON field '${r}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${r}' field to equal '${l.value}'`;break}}if(t)throw new ce(W.INVALID_ARGUMENT,t);return!0}const PE=-62135596800,jE=1e6;class lt{static now(){return lt.fromMillis(Date.now())}static fromDate(e){return lt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*jE);return new lt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ce(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ce(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<PE)throw new ce(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ce(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jE}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:lt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Kd(e,lt._jsonSchema))return new lt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-PE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}lt._jsonSchemaVersion="firestore/timestamp/1.0",lt._jsonSchema={type:ln("string",lt._jsonSchemaVersion),seconds:ln("number"),nanoseconds:ln("number")};class Ne{static fromTimestamp(e){return new Ne(e)}static min(){return new Ne(new lt(0,0))}static max(){return new Ne(new lt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const ic=-1;class hm{constructor(e,t,r,a){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=a}}function J0(s){return s.fields.find((e=>e.kind===2))}function ho(s){return s.fields.filter((e=>e.kind!==2))}hm.UNKNOWN_ID=-1;class Qf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Td{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Td(0,wr.min())}}function LS(s,e){const t=s.toTimestamp().seconds,r=s.toTimestamp().nanoseconds+1,a=Ne.fromTimestamp(r===1e9?new lt(t+1,0):new lt(t,r));return new wr(a,ye.empty(),e)}function US(s){return new wr(s.readTime,s.key,ic)}class wr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new wr(Ne.min(),ye.empty(),ic)}static max(){return new wr(Ne.max(),ye.empty(),ic)}}function u_(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=ye.comparator(s.documentKey,e.documentKey),t!==0?t:Ve(s.largestBatchId,e.largestBatchId))}const zS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class BS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Na(s){if(s.code!==W.FAILED_PRECONDITION||s.message!==zS)throw s;he("LocalStore","Unexpectedly lost primary lease")}class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ve(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new U(((r,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(r,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(r,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof U?t:U.resolve(t)}catch(t){return U.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):U.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):U.reject(t)}static resolve(e){return new U(((t,r)=>{t(e)}))}static reject(e){return new U(((t,r)=>{r(e)}))}static waitFor(e){return new U(((t,r)=>{let a=0,l=0,u=!1;e.forEach((p=>{++a,p.next((()=>{++l,u&&l===a&&t()}),(y=>r(y)))})),u=!0,l===a&&t()}))}static or(e){let t=U.resolve(!1);for(const r of e)t=t.next((a=>a?U.resolve(a):r()));return t}static forEach(e,t){const r=[];return e.forEach(((a,l)=>{r.push(t.call(this,a,l))})),this.waitFor(r)}static mapArray(e,t){return new U(((r,a)=>{const l=e.length,u=new Array(l);let p=0;for(let y=0;y<l;y++){const m=y;t(e[m]).next((b=>{u[m]=b,++p,p===l&&r(u)}),(b=>a(b)))}}))}static doWhile(e,t){return new U(((r,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):r()};l()}))}}const _r="SimpleDb";class Fm{static open(e,t,r,a){try{return new Fm(t,e.transaction(a,r))}catch(l){throw new ld(t,l)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Nn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ld(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const a=d_(r.target.error);this.S.reject(new ld(e,a))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(he(_r,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new YV(t)}}class Ms{static delete(e){return he(_r,"Removing database:",e),mo(Dy().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!yd())return!1;if(Ms.F())return!0;const e=jt(),t=Ms.M(e),r=0<t&&t<10,a=qS(e),l=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||l)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,Ms.M(jt())===12.2&&Kt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(he(_r,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=l=>{const u=l.target.result;t(u)},a.onblocked=()=>{r(new ld(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const u=l.target.error;u.name==="VersionError"?r(new ce(W.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?r(new ce(W.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):r(new ld(e,u))},a.onupgradeneeded=l=>{he(_r,'Database "'+this.name+'" requires upgrade from version:',l.oldVersion);const u=l.target.result;this.N.k(u,a.transaction,l.oldVersion,this.version).next((()=>{he(_r,"Database upgrade to version "+this.version+" complete")}))}}))),this.K&&(this.db.onversionchange=t=>this.K(t)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,a){const l=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.L(e);const p=Fm.open(this.db,e,l?"readonly":"readwrite",r),y=a(p).next((m=>(p.C(),m))).catch((m=>(p.abort(m),U.reject(m)))).toPromise();return y.catch((()=>{})),await p.D,y}catch(p){const y=p,m=y.name!=="FirebaseError"&&u<3;if(he(_r,"Transaction failed with error:",y.message,"Retrying:",m),this.close(),!m)return Promise.reject(y)}}}close(){this.db&&this.db.close(),this.db=void 0}}function qS(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class $V{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return mo(this.U.delete())}}class ld extends ce{constructor(e,t){super(W.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ra(s){return s.name==="IndexedDbTransactionError"}class YV{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(he(_r,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(he(_r,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),mo(r)}add(e){return he(_r,"ADD",this.store.name,e,e),mo(this.store.add(e))}get(e){return mo(this.store.get(e)).next((t=>(t===void 0&&(t=null),he(_r,"GET",this.store.name,e,t),t)))}delete(e){return he(_r,"DELETE",this.store.name,e),mo(this.store.delete(e))}count(){return he(_r,"COUNT",this.store.name),mo(this.store.count())}H(e,t){const r=this.options(e,t),a=r.index?this.store.index(r.index):this.store;if(typeof a.getAll=="function"){const l=a.getAll(r.range);return new U(((u,p)=>{l.onerror=y=>{p(y.target.error)},l.onsuccess=y=>{u(y.target.result)}}))}{const l=this.cursor(r),u=[];return this.J(l,((p,y)=>{u.push(y)})).next((()=>u))}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new U(((a,l)=>{r.onerror=u=>{l(u.target.error)},r.onsuccess=u=>{a(u.target.result)}}))}X(e,t){he(_r,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Y=!1;const a=this.cursor(r);return this.J(a,((l,u,p)=>p.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);const a=this.cursor(r);return this.J(a,t)}te(e){const t=this.cursor({});return new U(((r,a)=>{t.onerror=l=>{const u=d_(l.target.error);a(u)},t.onsuccess=l=>{const u=l.target.result;u?e(u.primaryKey,u.value).next((p=>{p?u.continue():r()})):r()}}))}J(e,t){const r=[];return new U(((a,l)=>{e.onerror=u=>{l(u.target.error)},e.onsuccess=u=>{const p=u.target.result;if(!p)return void a();const y=new $V(p),m=t(p.primaryKey,p.value,y);if(m instanceof U){const b=m.catch((E=>(y.done(),U.reject(E))));r.push(b)}y.isDone?a():y.G===null?p.continue():p.continue(y.G)}})).next((()=>U.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function mo(s){return new U(((e,t)=>{s.onsuccess=r=>{const a=r.target.result;e(a)},s.onerror=r=>{const a=d_(r.target.error);t(a)}}))}let VE=!1;function d_(s){const e=Ms.M(jt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(t)>=0){const r=new ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return VE||(VE=!0,setTimeout((()=>{throw r}),0)),r}}return s}const cd="IndexBackfiller";class WV{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){he(cd,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();he(cd,`Documents written: ${t}`)}catch(t){Ra(t)?he(cd,"Ignoring IndexedDB error during index backfill: ",t):await Na(t)}await this.re(6e4)}))}}class XV{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const r=new Set;let a=t,l=!0;return U.doWhile((()=>l===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((u=>{if(u!==null&&!r.has(u))return he(cd,`Processing collection: ${u}`),this.oe(e,u,a).next((p=>{a-=p,r.add(u)}));l=!1})))).next((()=>t-a))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,r).next((l=>{const u=l.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next((()=>this._e(a,l))).next((p=>(he(cd,`Updating offset: ${p}`),this.localStore.indexManager.updateCollectionGroup(e,t,p)))).next((()=>u.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((a,l)=>{const u=US(l);u_(u,r)>0&&(r=u)})),new wr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class sr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}sr.ce=-1;const fa=-1;function $d(s){return s==null}function Id(s){return s===0&&1/s==-1/0}function FS(s){return typeof s=="number"&&Number.isInteger(s)&&!Id(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}const fm="";function Mn(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=OE(e)),e=JV(s.get(t),e);return OE(e)}function JV(s,e){let t=e;const r=s.length;for(let a=0;a<r;a++){const l=s.charAt(a);switch(l){case"\0":t+="";break;case fm:t+="";break;default:t+=l}}return t}function OE(s){return s+fm+""}function js(s){const e=s.length;if(Ie(e>=2,64408,{path:s}),e===2)return Ie(s.charAt(0)===fm&&s.charAt(1)==="",56145,{path:s}),$e.emptyPath();const t=e-2,r=[];let a="";for(let l=0;l<e;){const u=s.indexOf(fm,l);switch((u<0||u>t)&&ve(50515,{path:s}),s.charAt(u+1)){case"":const p=s.substring(l,u);let y;a.length===0?y=p:(a+=p,y=a,a=""),r.push(y);break;case"":a+=s.substring(l,u),a+="\0";break;case"":a+=s.substring(l,u+1);break;default:ve(61167,{path:s})}l=u+2}return new $e(r)}const fo="remoteDocuments",Yd="owner",Vl="owner",Sd="mutationQueues",ZV="userId",Jr="mutations",ME="batchId",vo="userMutationsIndex",LE=["userId","batchId"];function Kf(s,e){return[s,Mn(e)]}function HS(s,e,t){return[s,Mn(e),t]}const eO={},ac="documentMutations",mm="remoteDocumentsV14",tO=["prefixPath","collectionGroup","readTime","documentId"],$f="documentKeyIndex",nO=["prefixPath","collectionGroup","documentId"],GS="collectionGroupIndex",rO=["collectionGroup","readTime","prefixPath","documentId"],Ad="remoteDocumentGlobal",Z0="remoteDocumentGlobalKey",oc="targets",QS="queryTargetsIndex",sO=["canonicalId","targetId"],lc="targetDocuments",iO=["targetId","path"],h_="documentTargetsIndex",aO=["path","targetId"],pm="targetGlobalKey",Ao="targetGlobal",Nd="collectionParents",oO=["collectionId","parent"],cc="clientMetadata",lO="clientId",Hm="bundles",cO="bundleId",Gm="namedQueries",uO="name",f_="indexConfiguration",dO="indexId",ey="collectionGroupIndex",hO="collectionGroup",ud="indexState",fO=["indexId","uid"],KS="sequenceNumberIndex",mO=["uid","sequenceNumber"],dd="indexEntries",pO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],$S="documentKeyIndex",gO=["indexId","uid","orderedDocumentKey"],Qm="documentOverlays",yO=["userId","collectionPath","documentId"],ty="collectionPathOverlayIndex",_O=["userId","collectionPath","largestBatchId"],YS="collectionGroupOverlayIndex",bO=["userId","collectionGroup","largestBatchId"],m_="globals",vO="name",WS=[Sd,Jr,ac,fo,oc,Yd,Ao,lc,cc,Ad,Nd,Hm,Gm],xO=[...WS,Qm],XS=[Sd,Jr,ac,mm,oc,Yd,Ao,lc,cc,Ad,Nd,Hm,Gm,Qm],JS=XS,p_=[...JS,f_,ud,dd],wO=p_,ZS=[...p_,m_],EO=ZS;class ny extends BS{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function hn(s,e){const t=_e(s);return Ms.O(t.le,e)}function UE(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Ca(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function eA(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}class xt{constructor(e,t){this.comparator=e,this.root=t||Sn.EMPTY}insert(e,t){return new xt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Sn.BLACK,null,null))}remove(e){return new xt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new jf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new jf(this.root,e,this.comparator,!1)}getReverseIterator(){return new jf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new jf(this.root,e,this.comparator,!0)}}class jf{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Sn{constructor(e,t,r,a,l){this.key=e,this.value=t,this.color=r??Sn.RED,this.left=a??Sn.EMPTY,this.right=l??Sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,l){return new Sn(e??this.key,t??this.value,r??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const l=r(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,r),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Sn.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ve(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ve(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ve(27949);return e+(this.isRed()?0:1)}}Sn.EMPTY=null,Sn.RED=!0,Sn.BLACK=!1;Sn.EMPTY=new class{constructor(){this.size=0}get key(){throw ve(57766)}get value(){throw ve(16141)}get color(){throw ve(16727)}get left(){throw ve(29726)}get right(){throw ve(36894)}copy(e,t,r,a,l){return this}insert(e,t,r){return new Sn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ft{constructor(e){this.comparator=e,this.data=new xt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new zE(this.data.getIterator())}getIteratorFrom(e){return new zE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof ft)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new ft(this.comparator);return t.data=e,t}}class zE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ol(s){return s.hasNext()?s.getNext():void 0}class ir{constructor(e){this.fields=e,e.sort(Ct.comparator)}static empty(){return new ir([])}unionWith(e){let t=new ft(Ct.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ir(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return sc(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class tA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function TO(){return typeof atob<"u"}class Ut{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new tA("Invalid base64 string: "+l):l}})(e);return new Ut(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new Ut(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ut.EMPTY_BYTE_STRING=new Ut("");const IO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mi(s){if(Ie(!!s,39018),typeof s=="string"){let e=0;const t=IO.exec(s);if(Ie(!!t,46558,{timestamp:s}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(s);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Nt(s.seconds),nanos:Nt(s.nanos)}}function Nt(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function pi(s){return typeof s=="string"?Ut.fromBase64String(s):Ut.fromUint8Array(s)}const nA="server_timestamp",rA="__type__",sA="__previous_value__",iA="__local_write_time__";function Km(s){return(s?.mapValue?.fields||{})[rA]?.stringValue===nA}function $m(s){const e=s.mapValue.fields[sA];return Km(e)?$m(e):e}function Rd(s){const e=mi(s.mapValue.fields[iA].timestampValue);return new lt(e.seconds,e.nanos)}class SO{constructor(e,t,r,a,l,u,p,y,m,b,E){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=p,this.longPollingOptions=y,this.useFetchStreams=m,this.isUsingEmulator=b,this.apiKey=E}}const ry="(default)";class va{constructor(e,t){this.projectId=e,this.database=t||ry}static empty(){return new va("","")}get isDefaultDatabase(){return this.database===ry}isEqual(e){return e instanceof va&&e.projectId===this.projectId&&e.database===this.database}}function AO(s,e){if(!Object.prototype.hasOwnProperty.apply(s.options,["projectId"]))throw new ce(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new va(s.options.projectId,e)}const g_="__type__",aA="__max__",la={mapValue:{fields:{__type__:{stringValue:aA}}}},y_="__vector__",uc="value",Yf={nullValue:"NULL_VALUE"};function xa(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Km(s)?4:oA(s)?9007199254740991:Ym(s)?10:11:ve(28295,{value:s})}function qs(s,e){if(s===e)return!0;const t=xa(s);if(t!==xa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Rd(s).isEqual(Rd(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=mi(a.timestampValue),p=mi(l.timestampValue);return u.seconds===p.seconds&&u.nanos===p.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(a,l){return pi(a.bytesValue).isEqual(pi(l.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(a,l){return Nt(a.geoPointValue.latitude)===Nt(l.geoPointValue.latitude)&&Nt(a.geoPointValue.longitude)===Nt(l.geoPointValue.longitude)})(s,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Nt(a.integerValue)===Nt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Nt(a.doubleValue),p=Nt(l.doubleValue);return u===p?Id(u)===Id(p):isNaN(u)&&isNaN(p)}return!1})(s,e);case 9:return sc(s.arrayValue.values||[],e.arrayValue.values||[],qs);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},p=l.mapValue.fields||{};if(UE(u)!==UE(p))return!1;for(const y in u)if(u.hasOwnProperty(y)&&(p[y]===void 0||!qs(u[y],p[y])))return!1;return!0})(s,e);default:return ve(52216,{left:s})}}function Cd(s,e){return(s.values||[]).find((t=>qs(t,e)))!==void 0}function wa(s,e){if(s===e)return 0;const t=xa(s),r=xa(e);if(t!==r)return Ve(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ve(s.booleanValue,e.booleanValue);case 2:return(function(l,u){const p=Nt(l.integerValue||l.doubleValue),y=Nt(u.integerValue||u.doubleValue);return p<y?-1:p>y?1:p===y?0:isNaN(p)?isNaN(y)?0:-1:1})(s,e);case 3:return BE(s.timestampValue,e.timestampValue);case 4:return BE(Rd(s),Rd(e));case 5:return X0(s.stringValue,e.stringValue);case 6:return(function(l,u){const p=pi(l),y=pi(u);return p.compareTo(y)})(s.bytesValue,e.bytesValue);case 7:return(function(l,u){const p=l.split("/"),y=u.split("/");for(let m=0;m<p.length&&m<y.length;m++){const b=Ve(p[m],y[m]);if(b!==0)return b}return Ve(p.length,y.length)})(s.referenceValue,e.referenceValue);case 8:return(function(l,u){const p=Ve(Nt(l.latitude),Nt(u.latitude));return p!==0?p:Ve(Nt(l.longitude),Nt(u.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return qE(s.arrayValue,e.arrayValue);case 10:return(function(l,u){const p=l.fields||{},y=u.fields||{},m=p[uc]?.arrayValue,b=y[uc]?.arrayValue,E=Ve(m?.values?.length||0,b?.values?.length||0);return E!==0?E:qE(m,b)})(s.mapValue,e.mapValue);case 11:return(function(l,u){if(l===la.mapValue&&u===la.mapValue)return 0;if(l===la.mapValue)return 1;if(u===la.mapValue)return-1;const p=l.fields||{},y=Object.keys(p),m=u.fields||{},b=Object.keys(m);y.sort(),b.sort();for(let E=0;E<y.length&&E<b.length;++E){const I=X0(y[E],b[E]);if(I!==0)return I;const S=wa(p[y[E]],m[b[E]]);if(S!==0)return S}return Ve(y.length,b.length)})(s.mapValue,e.mapValue);default:throw ve(23264,{he:t})}}function BE(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return Ve(s,e);const t=mi(s),r=mi(e),a=Ve(t.seconds,r.seconds);return a!==0?a:Ve(t.nanos,r.nanos)}function qE(s,e){const t=s.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const l=wa(t[a],r[a]);if(l)return l}return Ve(t.length,r.length)}function dc(s){return sy(s)}function sy(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const r=mi(t);return`time(${r.seconds},${r.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return pi(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return ye.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let r="[",a=!0;for(const l of t.values||[])a?a=!1:r+=",",r+=sy(l);return r+"]"})(s.arrayValue):"mapValue"in s?(function(t){const r=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const u of r)l?l=!1:a+=",",a+=`${u}:${sy(t.fields[u])}`;return a+"}"})(s.mapValue):ve(61005,{value:s})}function Wf(s){switch(xa(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$m(s);return e?16+Wf(e):16;case 5:return 2*s.stringValue.length;case 6:return pi(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((a,l)=>a+Wf(l)),0)})(s.arrayValue);case 10:case 11:return(function(r){let a=0;return Ca(r.fields,((l,u)=>{a+=l.length+Wf(u)})),a})(s.mapValue);default:throw ve(13486,{value:s})}}function ko(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function iy(s){return!!s&&"integerValue"in s}function kd(s){return!!s&&"arrayValue"in s}function FE(s){return!!s&&"nullValue"in s}function HE(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Xf(s){return!!s&&"mapValue"in s}function Ym(s){return(s?.mapValue?.fields||{})[g_]?.stringValue===y_}function hd(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Ca(s.mapValue.fields,((t,r)=>e.mapValue.fields[t]=hd(r))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hd(s.arrayValue.values[t]);return e}return{...s}}function oA(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===aA}const lA={mapValue:{fields:{[g_]:{stringValue:y_},[uc]:{arrayValue:{}}}}};function NO(s){return"nullValue"in s?Yf:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?ko(va.empty(),ye.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?Ym(s)?lA:{mapValue:{}}:ve(35942,{value:s})}function RO(s){return"nullValue"in s?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?ko(va.empty(),ye.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?lA:"mapValue"in s?Ym(s)?{mapValue:{}}:la:ve(61959,{value:s})}function GE(s,e){const t=wa(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?-1:!s.inclusive&&e.inclusive?1:0}function QE(s,e){const t=wa(s.value,e.value);return t!==0?t:s.inclusive&&!e.inclusive?1:!s.inclusive&&e.inclusive?-1:0}class An{constructor(e){this.value=e}static empty(){return new An({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Xf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hd(t)}setAll(e){let t=Ct.emptyPath(),r={},a=[];e.forEach(((u,p)=>{if(!t.isImmediateParentOf(p)){const y=this.getFieldsMap(t);this.applyChanges(y,r,a),r={},a=[],t=p.popLast()}u?r[p.lastSegment()]=hd(u):a.push(p.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,r,a)}delete(e){const t=this.field(e.popLast());Xf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];Xf(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){Ca(t,((a,l)=>e[a]=l));for(const a of r)delete e[a]}clone(){return new An(hd(this.value))}}function cA(s){const e=[];return Ca(s.fields,((t,r)=>{const a=new Ct([t]);if(Xf(r)){const l=cA(r.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new ir(e)}class It{constructor(e,t,r,a,l,u,p){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=l,this.data=u,this.documentState=p}static newInvalidDocument(e){return new It(e,0,Ne.min(),Ne.min(),Ne.min(),An.empty(),0)}static newFoundDocument(e,t,r,a){return new It(e,1,t,Ne.min(),r,a,0)}static newNoDocument(e,t){return new It(e,2,t,Ne.min(),Ne.min(),An.empty(),0)}static newUnknownDocument(e,t){return new It(e,3,t,Ne.min(),Ne.min(),An.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=An.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=An.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof It&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new It(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ea{constructor(e,t){this.position=e,this.inclusive=t}}function KE(s,e,t){let r=0;for(let a=0;a<s.position.length;a++){const l=e[a],u=s.position[a];if(l.field.isKeyField()?r=ye.comparator(ye.fromName(u.referenceValue),t.key):r=wa(u,t.data.field(l.field)),l.dir==="desc"&&(r*=-1),r!==0)break}return r}function $E(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!qs(s.position[t],e.position[t]))return!1;return!0}class Dd{constructor(e,t="asc"){this.field=e,this.dir=t}}function CO(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}class uA{}class Ze extends uA{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new kO(e,t,r):t==="array-contains"?new jO(e,r):t==="in"?new gA(e,r):t==="not-in"?new VO(e,r):t==="array-contains-any"?new OO(e,r):new Ze(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new DO(e,r):new PO(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(wa(t,this.value)):t!==null&&xa(this.value)===xa(t)&&this.matchesComparison(wa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ve(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ht extends uA{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ht(e,t)}matches(e){return hc(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function hc(s){return s.op==="and"}function ay(s){return s.op==="or"}function __(s){return dA(s)&&hc(s)}function dA(s){for(const e of s.filters)if(e instanceof ht)return!1;return!0}function oy(s){if(s instanceof Ze)return s.field.canonicalString()+s.op.toString()+dc(s.value);if(__(s))return s.filters.map((e=>oy(e))).join(",");{const e=s.filters.map((t=>oy(t))).join(",");return`${s.op}(${e})`}}function hA(s,e){return s instanceof Ze?(function(r,a){return a instanceof Ze&&r.op===a.op&&r.field.isEqual(a.field)&&qs(r.value,a.value)})(s,e):s instanceof ht?(function(r,a){return a instanceof ht&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((l,u,p)=>l&&hA(u,a.filters[p])),!0):!1})(s,e):void ve(19439)}function fA(s,e){const t=s.filters.concat(e);return ht.create(t,s.op)}function mA(s){return s instanceof Ze?(function(t){return`${t.field.canonicalString()} ${t.op} ${dc(t.value)}`})(s):s instanceof ht?(function(t){return t.op.toString()+" {"+t.getFilters().map(mA).join(" ,")+"}"})(s):"Filter"}class kO extends Ze{constructor(e,t,r){super(e,t,r),this.key=ye.fromName(r.referenceValue)}matches(e){const t=ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class DO extends Ze{constructor(e,t){super(e,"in",t),this.keys=pA("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class PO extends Ze{constructor(e,t){super(e,"not-in",t),this.keys=pA("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function pA(s,e){return(e.arrayValue?.values||[]).map((t=>ye.fromName(t.referenceValue)))}class jO extends Ze{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return kd(t)&&Cd(t.arrayValue,this.value)}}class gA extends Ze{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Cd(this.value.arrayValue,t)}}class VO extends Ze{constructor(e,t){super(e,"not-in",t)}matches(e){if(Cd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Cd(this.value.arrayValue,t)}}class OO extends Ze{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!kd(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Cd(this.value.arrayValue,r)))}}class MO{constructor(e,t=null,r=[],a=[],l=null,u=null,p=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=l,this.startAt=u,this.endAt=p,this.Te=null}}function ly(s,e=null,t=[],r=[],a=null,l=null,u=null){return new MO(s,e,t,r,a,l,u)}function Do(s){const e=_e(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>oy(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(l){return l.field.canonicalString()+l.dir})(r))).join(","),$d(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>dc(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>dc(r))).join(",")),e.Te=t}return e.Te}function Wd(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!CO(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!hA(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!$E(s.startAt,e.startAt)&&$E(s.endAt,e.endAt)}function gm(s){return ye.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function ym(s,e){return s.filters.filter((t=>t instanceof Ze&&t.field.isEqual(e)))}function YE(s,e,t){let r=Yf,a=!0;for(const l of ym(s,e)){let u=Yf,p=!0;switch(l.op){case"<":case"<=":u=NO(l.value);break;case"==":case"in":case">=":u=l.value;break;case">":u=l.value,p=!1;break;case"!=":case"not-in":u=Yf}GE({value:r,inclusive:a},{value:u,inclusive:p})<0&&(r=u,a=p)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const u=t.position[l];GE({value:r,inclusive:a},{value:u,inclusive:t.inclusive})<0&&(r=u,a=t.inclusive);break}}return{value:r,inclusive:a}}function WE(s,e,t){let r=la,a=!0;for(const l of ym(s,e)){let u=la,p=!0;switch(l.op){case">=":case">":u=RO(l.value),p=!1;break;case"==":case"in":case"<=":u=l.value;break;case"<":u=l.value,p=!1;break;case"!=":case"not-in":u=la}QE({value:r,inclusive:a},{value:u,inclusive:p})>0&&(r=u,a=p)}if(t!==null){for(let l=0;l<s.orderBy.length;++l)if(s.orderBy[l].field.isEqual(e)){const u=t.position[l];QE({value:r,inclusive:a},{value:u,inclusive:t.inclusive})>0&&(r=u,a=t.inclusive);break}}return{value:r,inclusive:a}}class _i{constructor(e,t=null,r=[],a=[],l=null,u="F",p=null,y=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=l,this.limitType=u,this.startAt=p,this.endAt=y,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function yA(s,e,t,r,a,l,u,p){return new _i(s,e,t,r,a,l,u,p)}function Rc(s){return new _i(s)}function XE(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function LO(s){return ye.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}function b_(s){return s.collectionGroup!==null}function Xl(s){const e=_e(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let p=new ft(Ct.comparator);return u.filters.forEach((y=>{y.getFlattenedFilters().forEach((m=>{m.isInequality()&&(p=p.add(m.field))}))})),p})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Dd(l,r))})),t.has(Ct.keyField().canonicalString())||e.Ie.push(new Dd(Ct.keyField(),r))}return e.Ie}function Gn(s){const e=_e(s);return e.Ee||(e.Ee=UO(e,Xl(s))),e.Ee}function UO(s,e){if(s.limitType==="F")return ly(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Dd(a.field,l)}));const t=s.endAt?new Ea(s.endAt.position,s.endAt.inclusive):null,r=s.startAt?new Ea(s.startAt.position,s.startAt.inclusive):null;return ly(s.path,s.collectionGroup,e,s.filters,s.limit,t,r)}}function cy(s,e){const t=s.filters.concat([e]);return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function zO(s,e){const t=s.explicitOrderBy.concat([e]);return new _i(s.path,s.collectionGroup,t,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}function _m(s,e,t){return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function BO(s,e){return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,e,s.endAt)}function qO(s,e){return new _i(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,e)}function Xd(s,e){return Wd(Gn(s),Gn(e))&&s.limitType===e.limitType}function _A(s){return`${Do(Gn(s))}|lt:${s.limitType}`}function ql(s){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((a=>mA(a))).join(", ")}]`),$d(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((a=>dc(a))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((a=>dc(a))).join(",")),`Target(${r})`})(Gn(s))}; limitType=${s.limitType})`}function Jd(s,e){return e.isFoundDocument()&&(function(r,a){const l=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(l):ye.isDocumentKey(r.path)?r.path.isEqual(l):r.path.isImmediateParentOf(l)})(s,e)&&(function(r,a){for(const l of Xl(r))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(s,e)&&(function(r,a){for(const l of r.filters)if(!l.matches(a))return!1;return!0})(s,e)&&(function(r,a){return!(r.startAt&&!(function(u,p,y){const m=KE(u,p,y);return u.inclusive?m<=0:m<0})(r.startAt,Xl(r),a)||r.endAt&&!(function(u,p,y){const m=KE(u,p,y);return u.inclusive?m>=0:m>0})(r.endAt,Xl(r),a))})(s,e)}function bA(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function vA(s){return(e,t)=>{let r=!1;for(const a of Xl(s)){const l=FO(a,e,t);if(l!==0)return l;r=r||a.field.isKeyField()}return 0}}function FO(s,e,t){const r=s.field.isKeyField()?ye.comparator(e.key,t.key):(function(l,u,p){const y=u.data.field(l),m=p.data.field(l);return y!==null&&m!==null?wa(y,m):ve(42886)})(s.field,e,t);switch(s.dir){case"asc":return r;case"desc":return-1*r;default:return ve(19790,{direction:s.dir})}}class bi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,l]of r)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ca(this.inner,((t,r)=>{for(const[a,l]of r)e(a,l)}))}isEmpty(){return eA(this.inner)}size(){return this.innerSize}}const HO=new xt(ye.comparator);function ar(){return HO}const xA=new xt(ye.comparator);function Ju(...s){let e=xA;for(const t of s)e=e.insert(t.key,t);return e}function wA(s){let e=xA;return s.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Vs(){return fd()}function EA(){return fd()}function fd(){return new bi((s=>s.toString()),((s,e)=>s.isEqual(e)))}const GO=new xt(ye.comparator),QO=new ft(ye.comparator);function Be(...s){let e=QO;for(const t of s)e=e.add(t);return e}const KO=new ft(Ve);function v_(){return KO}function x_(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Id(e)?"-0":e}}function TA(s){return{integerValue:""+s}}function IA(s,e){return FS(e)?TA(e):x_(s,e)}class Wm{constructor(){this._=void 0}}function $O(s,e,t){return s instanceof fc?(function(a,l){const u={fields:{[rA]:{stringValue:nA},[iA]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Km(l)&&(l=$m(l)),l&&(u.fields[sA]=l),{mapValue:u}})(t,e):s instanceof Po?AA(s,e):s instanceof jo?NA(s,e):(function(a,l){const u=SA(a,l),p=JE(u)+JE(a.Ae);return iy(u)&&iy(a.Ae)?TA(p):x_(a.serializer,p)})(s,e)}function YO(s,e,t){return s instanceof Po?AA(s,e):s instanceof jo?NA(s,e):t}function SA(s,e){return s instanceof mc?(function(r){return iy(r)||(function(l){return!!l&&"doubleValue"in l})(r)})(e)?e:{integerValue:0}:null}class fc extends Wm{}class Po extends Wm{constructor(e){super(),this.elements=e}}function AA(s,e){const t=RA(e);for(const r of s.elements)t.some((a=>qs(a,r)))||t.push(r);return{arrayValue:{values:t}}}class jo extends Wm{constructor(e){super(),this.elements=e}}function NA(s,e){let t=RA(e);for(const r of s.elements)t=t.filter((a=>!qs(a,r)));return{arrayValue:{values:t}}}class mc extends Wm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function JE(s){return Nt(s.integerValue||s.doubleValue)}function RA(s){return kd(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class Zd{constructor(e,t){this.field=e,this.transform=t}}function WO(s,e){return s.field.isEqual(e.field)&&(function(r,a){return r instanceof Po&&a instanceof Po||r instanceof jo&&a instanceof jo?sc(r.elements,a.elements,qs):r instanceof mc&&a instanceof mc?qs(r.Ae,a.Ae):r instanceof fc&&a instanceof fc})(s.transform,e.transform)}class XO{constructor(e,t){this.version=e,this.transformResults=t}}class kt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new kt}static exists(e){return new kt(void 0,e)}static updateTime(e){return new kt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jf(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class Xm{}function CA(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new kc(s.key,kt.none()):new Cc(s.key,s.data,kt.none());{const t=s.data,r=An.empty();let a=new ft(Ct.comparator);for(let l of e.fields)if(!a.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?r.delete(l):r.set(l,u),a=a.add(l)}return new vi(s.key,r,new ir(a.toArray()),kt.none())}}function JO(s,e,t){s instanceof Cc?(function(a,l,u){const p=a.value.clone(),y=eT(a.fieldTransforms,l,u.transformResults);p.setAll(y),l.convertToFoundDocument(u.version,p).setHasCommittedMutations()})(s,e,t):s instanceof vi?(function(a,l,u){if(!Jf(a.precondition,l))return void l.convertToUnknownDocument(u.version);const p=eT(a.fieldTransforms,l,u.transformResults),y=l.data;y.setAll(kA(a)),y.setAll(p),l.convertToFoundDocument(u.version,y).setHasCommittedMutations()})(s,e,t):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function md(s,e,t,r){return s instanceof Cc?(function(l,u,p,y){if(!Jf(l.precondition,u))return p;const m=l.value.clone(),b=tT(l.fieldTransforms,y,u);return m.setAll(b),u.convertToFoundDocument(u.version,m).setHasLocalMutations(),null})(s,e,t,r):s instanceof vi?(function(l,u,p,y){if(!Jf(l.precondition,u))return p;const m=tT(l.fieldTransforms,y,u),b=u.data;return b.setAll(kA(l)),b.setAll(m),u.convertToFoundDocument(u.version,b).setHasLocalMutations(),p===null?null:p.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(s,e,t,r):(function(l,u,p){return Jf(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):p})(s,e,t)}function ZO(s,e){let t=null;for(const r of s.fieldTransforms){const a=e.data.field(r.field),l=SA(r.transform,a||null);l!=null&&(t===null&&(t=An.empty()),t.set(r.field,l))}return t||null}function ZE(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&sc(r,a,((l,u)=>WO(l,u)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Cc extends Xm{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class vi extends Xm{constructor(e,t,r,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function kA(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=s.data.field(t);e.set(t,r)}})),e}function eT(s,e,t){const r=new Map;Ie(s.length===t.length,32656,{Ve:t.length,de:s.length});for(let a=0;a<t.length;a++){const l=s[a],u=l.transform,p=e.data.field(l.field);r.set(l.field,YO(u,p,t[a]))}return r}function tT(s,e,t){const r=new Map;for(const a of s){const l=a.transform,u=t.data.field(a.field);r.set(a.field,$O(l,u,e))}return r}class kc extends Xm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class w_ extends Xm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class E_{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&JO(l,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=md(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=md(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=EA();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let p=this.applyToLocalView(u,l.mutatedFields);p=t.has(a.key)?null:p;const y=CA(u,p);y!==null&&r.set(a.key,y),u.isValidDocument()||u.convertToNoDocument(Ne.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Be())}isEqual(e){return this.batchId===e.batchId&&sc(this.mutations,e.mutations,((t,r)=>ZE(t,r)))&&sc(this.baseMutations,e.baseMutations,((t,r)=>ZE(t,r)))}}class T_{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){Ie(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let a=(function(){return GO})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,r[u].version);return new T_(e,t,r,a)}}class I_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class eM{constructor(e,t){this.count=e,this.unchangedNames=t}}var an,tt;function DA(s){switch(s){case W.OK:return ve(64938);case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0;default:return ve(15467,{code:s})}}function PA(s){if(s===void 0)return Kt("GRPC error has no .code"),W.UNKNOWN;switch(s){case an.OK:return W.OK;case an.CANCELLED:return W.CANCELLED;case an.UNKNOWN:return W.UNKNOWN;case an.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case an.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case an.INTERNAL:return W.INTERNAL;case an.UNAVAILABLE:return W.UNAVAILABLE;case an.UNAUTHENTICATED:return W.UNAUTHENTICATED;case an.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case an.NOT_FOUND:return W.NOT_FOUND;case an.ALREADY_EXISTS:return W.ALREADY_EXISTS;case an.PERMISSION_DENIED:return W.PERMISSION_DENIED;case an.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case an.ABORTED:return W.ABORTED;case an.OUT_OF_RANGE:return W.OUT_OF_RANGE;case an.UNIMPLEMENTED:return W.UNIMPLEMENTED;case an.DATA_LOSS:return W.DATA_LOSS;default:return ve(39323,{code:s})}}(tt=an||(an={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";function jA(){return new TextEncoder}const tM=new ha([4294967295,4294967295],0);function nT(s){const e=jA().encode(s),t=new SS;return t.update(e),new Uint8Array(t.digest())}function rT(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ha([t,r],0),new ha([a,l],0)]}class S_{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Zu(`Invalid padding: ${t}`);if(r<0)throw new Zu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Zu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Zu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ha.fromNumber(this.ge)}ye(e,t,r){let a=e.add(t.multiply(ha.fromNumber(r)));return a.compare(tM)===1&&(a=new ha([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=nT(e),[r,a]=rT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(r,a,l);if(!this.we(u))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new S_(l,a,t);return r.forEach((p=>u.insert(p))),u}insert(e){if(this.ge===0)return;const t=nT(e),[r,a]=rT(t);for(let l=0;l<this.hashCount;l++){const u=this.ye(r,a,l);this.be(u)}}be(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Zu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class eh{constructor(e,t,r,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,th.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new eh(Ne.min(),a,new xt(Ve),ar(),Be())}}class th{constructor(e,t,r,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new th(r,t,Be(),Be(),Be())}}class Zf{constructor(e,t,r,a){this.Se=e,this.removedTargetIds=t,this.key=r,this.De=a}}class VA{constructor(e,t){this.targetId=e,this.Ce=t}}class OA{constructor(e,t,r=Ut.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class sT{constructor(){this.ve=0,this.Fe=iT(),this.Me=Ut.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Be(),t=Be(),r=Be();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:ve(38017,{changeType:l})}})),new th(this.Me,this.xe,e,t,r)}Ke(){this.Oe=!1,this.Fe=iT()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Ie(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class nM{constructor(e){this.Ge=e,this.ze=new Map,this.je=ar(),this.He=Vf(),this.Je=Vf(),this.Ze=new xt(Ve)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:ve(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,a)=>{this.rt(a)&&t(a)}))}st(e){const t=e.targetId,r=e.Ce.count,a=this.ot(t);if(a){const l=a.target;if(gm(l))if(r===0){const u=new ye(l.path);this.et(t,u,It.newNoDocument(u,Ne.min()))}else Ie(r===1,20013,{expectedCount:r});else{const u=this._t(t);if(u!==r){const p=this.ut(e),y=p?this.ct(p,e,u):1;if(y!==0){this.it(t);const m=y===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:l=0}=t;let u,p;try{u=pi(r).toUint8Array()}catch(y){if(y instanceof tA)return Bs("Decoding the base64 bloom filter in existence filter failed ("+y.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw y}try{p=new S_(u,a,l)}catch(y){return Bs(y instanceof Zu?"BloomFilter error: ":"Applying bloom filter failed: ",y),null}return p.ge===0?null:p}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let a=0;return r.forEach((l=>{const u=this.Ge.ht(),p=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(p)||(this.et(t,l,null),a++)})),a}Tt(e){const t=new Map;this.ze.forEach(((l,u)=>{const p=this.ot(u);if(p){if(l.current&&gm(p.target)){const y=new ye(p.target.path);this.It(y).has(u)||this.Et(u,y)||this.et(u,y,It.newNoDocument(y,e))}l.Be&&(t.set(u,l.ke()),l.Ke())}}));let r=Be();this.Je.forEach(((l,u)=>{let p=!0;u.forEachWhile((y=>{const m=this.ot(y);return!m||m.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(r=r.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new eh(e,t,this.Ze,this.je,r);return this.je=ar(),this.He=Vf(),this.Je=Vf(),this.Ze=new xt(Ve),a}Ye(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,r),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.qe(t,1):a.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new sT,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new ft(Ve),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new ft(Ve),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||he("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new sT),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Vf(){return new xt(ye.comparator)}function iT(){return new xt(ye.comparator)}const rM={asc:"ASCENDING",desc:"DESCENDING"},sM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},iM={and:"AND",or:"OR"};class aM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function uy(s,e){return s.useProto3Json||$d(e)?e:{value:e}}function pc(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function MA(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function oM(s,e){return pc(s,e.toTimestamp())}function $t(s){return Ie(!!s,49232),Ne.fromTimestamp((function(t){const r=mi(t);return new lt(r.seconds,r.nanos)})(s))}function A_(s,e){return dy(s,e).canonicalString()}function dy(s,e){const t=(function(a){return new $e(["projects",a.projectId,"databases",a.database])})(s).child("documents");return e===void 0?t:t.child(e)}function LA(s){const e=$e.fromString(s);return Ie($A(e),10190,{key:e.toString()}),e}function Pd(s,e){return A_(s.databaseId,e.path)}function Ls(s,e){const t=LA(e);if(t.get(1)!==s.databaseId.projectId)throw new ce(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new ce(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new ye(BA(t))}function UA(s,e){return A_(s.databaseId,e)}function zA(s){const e=LA(s);return e.length===4?$e.emptyPath():BA(e)}function hy(s){return new $e(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function BA(s){return Ie(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function aT(s,e,t){return{name:Pd(s,e),fields:t.value.mapValue.fields}}function qA(s,e,t){const r=Ls(s,e.name),a=$t(e.updateTime),l=e.createTime?$t(e.createTime):Ne.min(),u=new An({mapValue:{fields:e.fields}}),p=It.newFoundDocument(r,a,l,u);return t&&p.setHasCommittedMutations(),t?p.setHasCommittedMutations():p}function lM(s,e){return"found"in e?(function(r,a){Ie(!!a.found,43571),a.found.name,a.found.updateTime;const l=Ls(r,a.found.name),u=$t(a.found.updateTime),p=a.found.createTime?$t(a.found.createTime):Ne.min(),y=new An({mapValue:{fields:a.found.fields}});return It.newFoundDocument(l,u,p,y)})(s,e):"missing"in e?(function(r,a){Ie(!!a.missing,3894),Ie(!!a.readTime,22933);const l=Ls(r,a.missing),u=$t(a.readTime);return It.newNoDocument(l,u)})(s,e):ve(7234,{result:e})}function cM(s,e){let t;if("targetChange"in e){e.targetChange;const r=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:ve(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(m,b){return m.useProto3Json?(Ie(b===void 0||typeof b=="string",58123),Ut.fromBase64String(b||"")):(Ie(b===void 0||b instanceof Buffer||b instanceof Uint8Array,16193),Ut.fromUint8Array(b||new Uint8Array))})(s,e.targetChange.resumeToken),u=e.targetChange.cause,p=u&&(function(m){const b=m.code===void 0?W.UNKNOWN:PA(m.code);return new ce(b,m.message||"")})(u);t=new OA(r,a,l,p||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=Ls(s,r.document.name),l=$t(r.document.updateTime),u=r.document.createTime?$t(r.document.createTime):Ne.min(),p=new An({mapValue:{fields:r.document.fields}}),y=It.newFoundDocument(a,l,u,p),m=r.targetIds||[],b=r.removedTargetIds||[];t=new Zf(m,b,y.key,y)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=Ls(s,r.document),l=r.readTime?$t(r.readTime):Ne.min(),u=It.newNoDocument(a,l),p=r.removedTargetIds||[];t=new Zf([],p,u.key,u)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=Ls(s,r.document),l=r.removedTargetIds||[];t=new Zf([],l,a,null)}else{if(!("filter"in e))return ve(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:l}=r,u=new eM(a,l),p=r.targetId;t=new VA(p,u)}}return t}function jd(s,e){let t;if(e instanceof Cc)t={update:aT(s,e.key,e.value)};else if(e instanceof kc)t={delete:Pd(s,e.key)};else if(e instanceof vi)t={update:aT(s,e.key,e.data),updateMask:pM(e.fieldMask)};else{if(!(e instanceof w_))return ve(16599,{dt:e.type});t={verify:Pd(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(l,u){const p=u.transform;if(p instanceof fc)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(p instanceof Po)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:p.elements}};if(p instanceof jo)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:p.elements}};if(p instanceof mc)return{fieldPath:u.field.canonicalString(),increment:p.Ae};throw ve(20930,{transform:u.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:oM(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:ve(27497)})(s,e.precondition)),t}function fy(s,e){const t=e.currentDocument?(function(l){return l.updateTime!==void 0?kt.updateTime($t(l.updateTime)):l.exists!==void 0?kt.exists(l.exists):kt.none()})(e.currentDocument):kt.none(),r=e.updateTransforms?e.updateTransforms.map((a=>(function(u,p){let y=null;if("setToServerValue"in p)Ie(p.setToServerValue==="REQUEST_TIME",16630,{proto:p}),y=new fc;else if("appendMissingElements"in p){const b=p.appendMissingElements.values||[];y=new Po(b)}else if("removeAllFromArray"in p){const b=p.removeAllFromArray.values||[];y=new jo(b)}else"increment"in p?y=new mc(u,p.increment):ve(16584,{proto:p});const m=Ct.fromServerFormat(p.fieldPath);return new Zd(m,y)})(s,a))):[];if(e.update){e.update.name;const a=Ls(s,e.update.name),l=new An({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=(function(y){const m=y.fieldPaths||[];return new ir(m.map((b=>Ct.fromServerFormat(b))))})(e.updateMask);return new vi(a,l,u,t,r)}return new Cc(a,l,t,r)}if(e.delete){const a=Ls(s,e.delete);return new kc(a,t)}if(e.verify){const a=Ls(s,e.verify);return new w_(a,t)}return ve(1463,{proto:e})}function uM(s,e){return s&&s.length>0?(Ie(e!==void 0,14353),s.map((t=>(function(a,l){let u=a.updateTime?$t(a.updateTime):$t(l);return u.isEqual(Ne.min())&&(u=$t(l)),new XO(u,a.transformResults||[])})(t,e)))):[]}function FA(s,e){return{documents:[UA(s,e.path)]}}function HA(s,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=UA(s,a);const l=(function(m){if(m.length!==0)return KA(ht.create(m,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(m){if(m.length!==0)return m.map((b=>(function(I){return{field:Fl(I.field),direction:hM(I.dir)}})(b)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const p=uy(s,e.limit);return p!==null&&(t.structuredQuery.limit=p),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{ft:t,parent:a}}function GA(s){let e=zA(s.parent);const t=s.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){Ie(r===1,65062);const b=t.from[0];b.allDescendants?a=b.collectionId:e=e.child(b.collectionId)}let l=[];t.where&&(l=(function(E){const I=QA(E);return I instanceof ht&&__(I)?I.getFilters():[I]})(t.where));let u=[];t.orderBy&&(u=(function(E){return E.map((I=>(function(M){return new Dd(Hl(M.field),(function(ee){switch(ee){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(M.direction))})(I)))})(t.orderBy));let p=null;t.limit&&(p=(function(E){let I;return I=typeof E=="object"?E.value:E,$d(I)?null:I})(t.limit));let y=null;t.startAt&&(y=(function(E){const I=!!E.before,S=E.values||[];return new Ea(S,I)})(t.startAt));let m=null;return t.endAt&&(m=(function(E){const I=!E.before,S=E.values||[];return new Ea(S,I)})(t.endAt)),yA(e,a,u,l,p,"F",y,m)}function dM(s,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ve(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function QA(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Hl(t.unaryFilter.field);return Ze.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=Hl(t.unaryFilter.field);return Ze.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Hl(t.unaryFilter.field);return Ze.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Hl(t.unaryFilter.field);return Ze.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ve(61313);default:return ve(60726)}})(s):s.fieldFilter!==void 0?(function(t){return Ze.create(Hl(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ve(58110);default:return ve(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return ht.create(t.compositeFilter.filters.map((r=>QA(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ve(1026)}})(t.compositeFilter.op))})(s):ve(30097,{filter:s})}function hM(s){return rM[s]}function fM(s){return sM[s]}function mM(s){return iM[s]}function Fl(s){return{fieldPath:s.canonicalString()}}function Hl(s){return Ct.fromServerFormat(s.fieldPath)}function KA(s){return s instanceof Ze?(function(t){if(t.op==="=="){if(HE(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NAN"}};if(FE(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(HE(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NOT_NAN"}};if(FE(t.value))return{unaryFilter:{field:Fl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fl(t.field),op:fM(t.op),value:t.value}}})(s):s instanceof ht?(function(t){const r=t.getFilters().map((a=>KA(a)));return r.length===1?r[0]:{compositeFilter:{op:mM(t.op),filters:r}}})(s):ve(54877,{filter:s})}function pM(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function $A(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}function YA(s){return!!s&&typeof s._toProto=="function"&&s._protoValueType==="ProtoValue"}class ui{constructor(e,t,r,a,l=Ne.min(),u=Ne.min(),p=Ut.EMPTY_BYTE_STRING,y=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=p,this.expectedCount=y}withSequenceNumber(e){return new ui(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ui(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ui(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ui(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class WA{constructor(e){this.yt=e}}function gM(s,e){let t;if(e.document)t=qA(s.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ye.fromSegments(e.noDocument.path),a=Oo(e.noDocument.readTime);t=It.newNoDocument(r,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ve(56709);{const r=ye.fromSegments(e.unknownDocument.path),a=Oo(e.unknownDocument.version);t=It.newUnknownDocument(r,a)}}return e.readTime&&t.setReadTime((function(a){const l=new lt(a[0],a[1]);return Ne.fromTimestamp(l)})(e.readTime)),t}function oT(s,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:bm(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(l,u){return{name:Pd(l,u.key),fields:u.data.value.mapValue.fields,updateTime:pc(l,u.version.toTimestamp()),createTime:pc(l,u.createTime.toTimestamp())}})(s.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Vo(e.version)};else{if(!e.isUnknownDocument())return ve(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Vo(e.version)}}return r}function bm(s){const e=s.toTimestamp();return[e.seconds,e.nanoseconds]}function Vo(s){const e=s.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Oo(s){const e=new lt(s.seconds,s.nanoseconds);return Ne.fromTimestamp(e)}function po(s,e){const t=(e.baseMutations||[]).map((l=>fy(s.yt,l)));for(let l=0;l<e.mutations.length-1;++l){const u=e.mutations[l];if(l+1<e.mutations.length&&e.mutations[l+1].transform!==void 0){const p=e.mutations[l+1];u.updateTransforms=p.transform.fieldTransforms,e.mutations.splice(l+1,1),++l}}const r=e.mutations.map((l=>fy(s.yt,l))),a=lt.fromMillis(e.localWriteTimeMs);return new E_(e.batchId,a,t,r)}function ed(s){const e=Oo(s.readTime),t=s.lastLimboFreeSnapshotVersion!==void 0?Oo(s.lastLimboFreeSnapshotVersion):Ne.min();let r;return r=(function(l){return l.documents!==void 0})(s.query)?(function(l){const u=l.documents.length;return Ie(u===1,1966,{count:u}),Gn(Rc(zA(l.documents[0])))})(s.query):(function(l){return Gn(GA(l))})(s.query),new ui(r,s.targetId,"TargetPurposeListen",s.lastListenSequenceNumber,e,t,Ut.fromBase64String(s.resumeToken))}function XA(s,e){const t=Vo(e.snapshotVersion),r=Vo(e.lastLimboFreeSnapshotVersion);let a;a=gm(e.target)?FA(s.yt,e.target):HA(s.yt,e.target).ft;const l=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Do(e.target),readTime:t,resumeToken:l,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:a}}function N_(s){const e=GA({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?_m(e,e.limit,"L"):e}function A0(s,e){return new I_(e.largestBatchId,fy(s.yt,e.overlayMutation))}function lT(s,e){const t=e.path.lastSegment();return[s,Mn(e.path.popLast()),t]}function cT(s,e,t,r){return{indexId:s,uid:e,sequenceNumber:t,readTime:Vo(r.readTime),documentKey:Mn(r.documentKey.path),largestBatchId:r.largestBatchId}}class yM{getBundleMetadata(e,t){return uT(e).get(t).next((r=>{if(r)return(function(l){return{id:l.bundleId,createTime:Oo(l.createTime),version:l.version}})(r)}))}saveBundleMetadata(e,t){return uT(e).put((function(a){return{bundleId:a.id,createTime:Vo($t(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return dT(e).get(t).next((r=>{if(r)return(function(l){return{name:l.name,query:N_(l.bundledQuery),readTime:Oo(l.readTime)}})(r)}))}saveNamedQuery(e,t){return dT(e).put((function(a){return{name:a.name,readTime:Vo($t(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function uT(s){return hn(s,Hm)}function dT(s){return hn(s,Gm)}class Jm{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new Jm(e,r)}getOverlay(e,t){return qu(e).get(lT(this.userId,t)).next((r=>r?A0(this.serializer,r):null))}getOverlays(e,t){const r=Vs();return U.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&r.set(a,l)})))).next((()=>r))}saveOverlays(e,t,r){const a=[];return r.forEach(((l,u)=>{const p=new I_(t,u);a.push(this.bt(e,p))})),U.waitFor(a)}removeOverlaysForBatchId(e,t,r){const a=new Set;t.forEach((u=>a.add(Mn(u.getCollectionPath()))));const l=[];return a.forEach((u=>{const p=IDBKeyRange.bound([this.userId,u,r],[this.userId,u,r+1],!1,!0);l.push(qu(e).X(ty,p))})),U.waitFor(l)}getOverlaysForCollection(e,t,r){const a=Vs(),l=Mn(t),u=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,Number.POSITIVE_INFINITY],!0);return qu(e).H(ty,u).next((p=>{for(const y of p){const m=A0(this.serializer,y);a.set(m.getKey(),m)}return a}))}getOverlaysForCollectionGroup(e,t,r,a){const l=Vs();let u;const p=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return qu(e).ee({index:YS,range:p},((y,m,b)=>{const E=A0(this.serializer,m);l.size()<a||E.largestBatchId===u?(l.set(E.getKey(),E),u=E.largestBatchId):b.done()})).next((()=>l))}bt(e,t){return qu(e).put((function(a,l,u){const[p,y,m]=lT(l,u.mutation.key);return{userId:l,collectionPath:y,documentId:m,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:jd(a.yt,u.mutation)}})(this.serializer,this.userId,t))}}function qu(s){return hn(s,Qm)}class _M{St(e){return hn(e,m_)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const r=t?.value;return r?Ut.fromUint8Array(r):Ut.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}class go{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Nt(e.integerValue));else if("doubleValue"in e){const r=Nt(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Id(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=mi(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(pi(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?oA(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Ym(e)?this.kt(e.mapValue,t):(this.Kt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Nt(t)):ve(19022,{Ut:e})}Ot(e,t){this.Ft(t,25),this.$t(e,t)}$t(e,t){t.xt(e)}Kt(e,t){const r=e.fields||{};this.Ft(t,55);for(const a of Object.keys(r))this.Ot(a,t),this.Ct(r[a],t)}kt(e,t){const r=e.fields||{};this.Ft(t,53);const a=uc,l=r[a].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Nt(l)),this.Ot(a,t),this.Ct(r[a],t)}qt(e,t){const r=e.values||[];this.Ft(t,50);for(const a of r)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),ye.fromName(e).path.forEach((r=>{this.Ft(t,60),this.$t(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}go.Wt=new go;const Ml=255;function bM(s){if(s===0)return 8;let e=0;return s>>4||(e+=4,s<<=4),s>>6||(e+=2,s<<=2),s>>7||(e+=1),e}function hT(s){const e=64-(function(r){let a=0;for(let l=0;l<8;++l){const u=bM(255&r[l]);if(a+=u,u!==8)break}return a})(s);return Math.ceil(e/8)}class vM{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ht(r.value),r=t.next();this.Jt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const a=t.codePointAt(0);this.Gt(240|a>>>18),this.Gt(128|63&a>>>12),this.Gt(128|63&a>>>6),this.Gt(128|63&a)}}this.zt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const a=t.codePointAt(0);this.Ht(240|a>>>18),this.Ht(128|63&a>>>12),this.Ht(128|63&a>>>6),this.Ht(128|63&a)}}this.Jt()}Yt(e){const t=this.en(e),r=hT(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),r=hT(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(Ml),this.sn(255)}_n(){this.an(Ml),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(l){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,l,!1),new Uint8Array(u.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let a=1;a<t.length;++a)t[a]^=r?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ml?(this.sn(Ml),this.sn(0)):this.sn(t)}Ht(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ml?(this.an(Ml),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const a=new Uint8Array(r);a.set(this.buffer),this.buffer=a}}class xM{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class wM{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Fu{constructor(){this.cn=new vM,this.ascending=new xM(this.cn),this.descending=new wM(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}class yo{constructor(e,t,r,a){this.hn=e,this.Pn=t,this.Tn=r,this.In=a}En(){const e=this.In.length,t=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.In,0),t!==e?r.set([0],this.In.length):++r[r.length-1],new yo(this.hn,this.Pn,this.Tn,r)}Rn(e,t,r){return{indexId:this.hn,uid:e,arrayValue:em(this.Tn),directionalValue:em(this.In),orderedDocumentKey:em(t),documentKey:r.path.toArray()}}An(e,t,r){const a=this.Rn(e,t,r);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function ta(s,e){let t=s.hn-e.hn;return t!==0?t:(t=fT(s.Tn,e.Tn),t!==0?t:(t=fT(s.In,e.In),t!==0?t:ye.comparator(s.Pn,e.Pn)))}function fT(s,e){for(let t=0;t<s.length&&t<e.length;++t){const r=s[t]-e[t];if(r!==0)return r}return s.length-e.length}function em(s){return fI()?(function(t){let r="";for(let a=0;a<t.length;a++)r+=String.fromCharCode(t[a]);return r})(s):s}function mT(s){return typeof s!="string"?s:(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(s)}class pT{constructor(e){this.Vn=new ft(((t,r)=>Ct.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(Ie(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const t=J0(e);if(t!==void 0&&!this.pn(t))return!1;const r=ho(e);let a=new Set,l=0,u=0;for(;l<r.length&&this.pn(r[l]);++l)a=a.add(r[l].fieldPath.canonicalString());if(l===r.length)return!0;if(this.Vn.size>0){const p=this.Vn.getIterator().getNext();if(!a.has(p.field.canonicalString())){const y=r[l];if(!this.yn(p,y)||!this.wn(this.dn[u++],y))return!1}++l}for(;l<r.length;++l){const p=r[l];if(u>=this.dn.length||!this.wn(this.dn[u++],p))return!1}return!0}bn(){if(this.fn)return null;let e=new ft(Ct.comparator);const t=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Qf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Qf(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Qf(r.field,r.dir==="asc"?0:1)));return new hm(hm.UNKNOWN_ID,this.collectionId,t,Td.empty())}pn(e){for(const t of this.mn)if(this.yn(t,e))return!0;return!1}yn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}wn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function JA(s){if(Ie(s instanceof Ze||s instanceof ht,20012),s instanceof Ze){if(s instanceof gA){const t=s.value.arrayValue?.values?.map((r=>Ze.create(s.field,"==",r)))||[];return ht.create(t,"or")}return s}const e=s.filters.map((t=>JA(t)));return ht.create(e,s.op)}function EM(s){if(s.getFilters().length===0)return[];const e=gy(JA(s));return Ie(ZA(e),7391),my(e)||py(e)?[e]:e.getFilters()}function my(s){return s instanceof Ze}function py(s){return s instanceof ht&&__(s)}function ZA(s){return my(s)||py(s)||(function(t){if(t instanceof ht&&ay(t)){for(const r of t.getFilters())if(!my(r)&&!py(r))return!1;return!0}return!1})(s)}function gy(s){if(Ie(s instanceof Ze||s instanceof ht,34018),s instanceof Ze)return s;if(s.filters.length===1)return gy(s.filters[0]);const e=s.filters.map((r=>gy(r)));let t=ht.create(e,s.op);return t=vm(t),ZA(t)?t:(Ie(t instanceof ht,64498),Ie(hc(t),40251),Ie(t.filters.length>1,57927),t.filters.reduce(((r,a)=>R_(r,a))))}function R_(s,e){let t;return Ie(s instanceof Ze||s instanceof ht,38388),Ie(e instanceof Ze||e instanceof ht,25473),t=s instanceof Ze?e instanceof Ze?(function(a,l){return ht.create([a,l],"and")})(s,e):gT(s,e):e instanceof Ze?gT(e,s):(function(a,l){if(Ie(a.filters.length>0&&l.filters.length>0,48005),hc(a)&&hc(l))return fA(a,l.getFilters());const u=ay(a)?a:l,p=ay(a)?l:a,y=u.filters.map((m=>R_(m,p)));return ht.create(y,"or")})(s,e),vm(t)}function gT(s,e){if(hc(e))return fA(e,s.getFilters());{const t=e.filters.map((r=>R_(s,r)));return ht.create(t,"or")}}function vm(s){if(Ie(s instanceof Ze||s instanceof ht,11850),s instanceof Ze)return s;const e=s.getFilters();if(e.length===1)return vm(e[0]);if(dA(s))return s;const t=e.map((a=>vm(a))),r=[];return t.forEach((a=>{a instanceof Ze?r.push(a):a instanceof ht&&(a.op===s.op?r.push(...a.filters):r.push(a))})),r.length===1?r[0]:ht.create(r,s.op)}class TM{constructor(){this.Sn=new C_}addToCollectionParentIndex(e,t){return this.Sn.add(t),U.resolve()}getCollectionParents(e,t){return U.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return U.resolve()}deleteFieldIndex(e,t){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,t){return U.resolve()}getDocumentsMatchingTarget(e,t){return U.resolve(null)}getIndexType(e,t){return U.resolve(0)}getFieldIndexes(e,t){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,t){return U.resolve(wr.min())}getMinOffsetFromCollectionGroup(e,t){return U.resolve(wr.min())}updateCollectionGroup(e,t,r){return U.resolve()}updateIndexEntries(e,t){return U.resolve()}}class C_{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new ft($e.comparator),l=!a.has(r);return this.index[t]=a.add(r),l}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new ft($e.comparator)).toArray()}}const yT="IndexedDbIndexManager",Of=new Uint8Array(0);class IM{constructor(e,t){this.databaseId=t,this.Dn=new C_,this.Cn=new bi((r=>Do(r)),((r,a)=>Wd(r,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Dn.has(t)){const r=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.Dn.add(t)}));const l={collectionId:r,parent:Mn(a)};return _T(e).put(l)}return U.resolve()}getCollectionParents(e,t){const r=[],a=IDBKeyRange.bound([t,""],[jS(t),""],!1,!0);return _T(e).H(a).next((l=>{for(const u of l){if(u.collectionId!==t)break;r.push(js(u.parent))}return r}))}addFieldIndex(e,t){const r=Hu(e),a=(function(p){return{indexId:p.indexId,collectionGroup:p.collectionGroup,fields:p.fields.map((y=>[y.fieldPath.canonicalString(),y.kind]))}})(t);delete a.indexId;const l=r.add(a);if(t.indexState){const u=Ul(e);return l.next((p=>{u.put(cT(p,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return l.next()}deleteFieldIndex(e,t){const r=Hu(e),a=Ul(e),l=Ll(e);return r.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>l.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Hu(e),r=Ll(e),a=Ul(e);return t.X().next((()=>r.X())).next((()=>a.X()))}createTargetIndexes(e,t){return U.forEach(this.vn(t),(r=>this.getIndexType(e,r).next((a=>{if(a===0||a===1){const l=new pT(r).bn();if(l!=null)return this.addFieldIndex(e,l)}}))))}getDocumentsMatchingTarget(e,t){const r=Ll(e);let a=!0;const l=new Map;return U.forEach(this.vn(t),(u=>this.Fn(e,u).next((p=>{a&&(a=!!p),l.set(u,p)})))).next((()=>{if(a){let u=Be();const p=[];return U.forEach(l,((y,m)=>{he(yT,`Using index ${(function(se){return`id=${se.indexId}|cg=${se.collectionGroup}|f=${se.fields.map((xe=>`${xe.fieldPath}:${xe.kind}`)).join(",")}`})(y)} to execute ${Do(t)}`);const b=(function(se,xe){const oe=J0(xe);if(oe===void 0)return null;for(const Z of ym(se,oe.fieldPath))switch(Z.op){case"array-contains-any":return Z.value.arrayValue.values||[];case"array-contains":return[Z.value]}return null})(m,y),E=(function(se,xe){const oe=new Map;for(const Z of ho(xe))for(const k of ym(se,Z.fieldPath))switch(k.op){case"==":case"in":oe.set(Z.fieldPath.canonicalString(),k.value);break;case"not-in":case"!=":return oe.set(Z.fieldPath.canonicalString(),k.value),Array.from(oe.values())}return null})(m,y),I=(function(se,xe){const oe=[];let Z=!0;for(const k of ho(xe)){const x=k.kind===0?YE(se,k.fieldPath,se.startAt):WE(se,k.fieldPath,se.startAt);oe.push(x.value),Z&&(Z=x.inclusive)}return new Ea(oe,Z)})(m,y),S=(function(se,xe){const oe=[];let Z=!0;for(const k of ho(xe)){const x=k.kind===0?WE(se,k.fieldPath,se.endAt):YE(se,k.fieldPath,se.endAt);oe.push(x.value),Z&&(Z=x.inclusive)}return new Ea(oe,Z)})(m,y),M=this.Mn(y,m,I),z=this.Mn(y,m,S),ee=this.xn(y,m,E),Q=this.On(y.indexId,b,M,I.inclusive,z,S.inclusive,ee);return U.forEach(Q,(ae=>r.Z(ae,t.limit).next((se=>{se.forEach((xe=>{const oe=ye.fromSegments(xe.documentKey);u.has(oe)||(u=u.add(oe),p.push(oe))}))}))))})).next((()=>p))}return U.resolve(null)}))}vn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=EM(ht.create(e.filters,"and")).map((r=>ly(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}On(e,t,r,a,l,u,p){const y=(t!=null?t.length:1)*Math.max(r.length,l.length),m=y/(t!=null?t.length:1),b=[];for(let E=0;E<y;++E){const I=t?this.Nn(t[E/m]):Of,S=this.Bn(e,I,r[E%m],a),M=this.Ln(e,I,l[E%m],u),z=p.map((ee=>this.Bn(e,I,ee,!0)));b.push(...this.createRange(S,M,z))}return b}Bn(e,t,r,a){const l=new yo(e,ye.empty(),t,r);return a?l:l.En()}Ln(e,t,r,a){const l=new yo(e,ye.empty(),t,r);return a?l.En():l}Fn(e,t){const r=new pT(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((l=>{let u=null;for(const p of l)r.gn(p)&&(!u||p.fields.length>u.fields.length)&&(u=p);return u}))}getIndexType(e,t){let r=2;const a=this.vn(t);return U.forEach(a,(l=>this.Fn(e,l).next((u=>{u?r!==0&&u.fields.length<(function(y){let m=new ft(Ct.comparator),b=!1;for(const E of y.filters)for(const I of E.getFlattenedFilters())I.field.isKeyField()||(I.op==="array-contains"||I.op==="array-contains-any"?b=!0:m=m.add(I.field));for(const E of y.orderBy)E.field.isKeyField()||(m=m.add(E.field));return m.size+(b?1:0)})(l)&&(r=1):r=0})))).next((()=>(function(u){return u.limit!==null})(t)&&a.length>1&&r===2?1:r))}kn(e,t){const r=new Fu;for(const a of ho(e)){const l=t.data.field(a.fieldPath);if(l==null)return null;const u=r.ln(a.kind);go.Wt.Dt(l,u)}return r.un()}Nn(e){const t=new Fu;return go.Wt.Dt(e,t.ln(0)),t.un()}Kn(e,t){const r=new Fu;return go.Wt.Dt(ko(this.databaseId,t),r.ln((function(l){const u=ho(l);return u.length===0?0:u[u.length-1].kind})(e))),r.un()}xn(e,t,r){if(r===null)return[];let a=[];a.push(new Fu);let l=0;for(const u of ho(e)){const p=r[l++];for(const y of a)if(this.qn(t,u.fieldPath)&&kd(p))a=this.Un(a,u,p);else{const m=y.ln(u.kind);go.Wt.Dt(p,m)}}return this.$n(a)}Mn(e,t,r){return this.xn(e,t,r.position)}$n(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Un(e,t,r){const a=[...e],l=[];for(const u of r.arrayValue.values||[])for(const p of a){const y=new Fu;y.seed(p.un()),go.Wt.Dt(u,y.ln(t.kind)),l.push(y)}return l}qn(e,t){return!!e.filters.find((r=>r instanceof Ze&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=Hu(e),a=Ul(e);return(t?r.H(ey,IDBKeyRange.bound(t,t)):r.H()).next((l=>{const u=[];return U.forEach(l,(p=>a.get([p.indexId,this.uid]).next((y=>{u.push((function(b,E){const I=E?new Td(E.sequenceNumber,new wr(Oo(E.readTime),new ye(js(E.documentKey)),E.largestBatchId)):Td.empty(),S=b.fields.map((([M,z])=>new Qf(Ct.fromServerFormat(M),z)));return new hm(b.indexId,b.collectionGroup,S,I)})(p,y))})))).next((()=>u))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,a)=>{const l=r.indexState.sequenceNumber-a.indexState.sequenceNumber;return l!==0?l:Ve(r.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const a=Hu(e),l=Ul(e);return this.Wn(e).next((u=>a.H(ey,IDBKeyRange.bound(t,t)).next((p=>U.forEach(p,(y=>l.put(cT(y.indexId,this.uid,u,r))))))))}updateIndexEntries(e,t){const r=new Map;return U.forEach(t,((a,l)=>{const u=r.get(a.collectionGroup);return(u?U.resolve(u):this.getFieldIndexes(e,a.collectionGroup)).next((p=>(r.set(a.collectionGroup,p),U.forEach(p,(y=>this.Qn(e,a,y).next((m=>{const b=this.Gn(l,y);return m.isEqual(b)?U.resolve():this.zn(e,l,y,m,b)})))))))}))}jn(e,t,r,a){return Ll(e).put(a.Rn(this.uid,this.Kn(r,t.key),t.key))}Hn(e,t,r,a){return Ll(e).delete(a.An(this.uid,this.Kn(r,t.key),t.key))}Qn(e,t,r){const a=Ll(e);let l=new ft(ta);return a.ee({index:$S,range:IDBKeyRange.only([r.indexId,this.uid,em(this.Kn(r,t))])},((u,p)=>{l=l.add(new yo(r.indexId,t,mT(p.arrayValue),mT(p.directionalValue)))})).next((()=>l))}Gn(e,t){let r=new ft(ta);const a=this.kn(t,e);if(a==null)return r;const l=J0(t);if(l!=null){const u=e.data.field(l.fieldPath);if(kd(u))for(const p of u.arrayValue.values||[])r=r.add(new yo(t.indexId,e.key,this.Nn(p),a))}else r=r.add(new yo(t.indexId,e.key,Of,a));return r}zn(e,t,r,a,l){he(yT,"Updating index entries for document '%s'",t.key);const u=[];return(function(y,m,b,E,I){const S=y.getIterator(),M=m.getIterator();let z=Ol(S),ee=Ol(M);for(;z||ee;){let Q=!1,ae=!1;if(z&&ee){const se=b(z,ee);se<0?ae=!0:se>0&&(Q=!0)}else z!=null?ae=!0:Q=!0;Q?(E(ee),ee=Ol(M)):ae?(I(z),z=Ol(S)):(z=Ol(S),ee=Ol(M))}})(a,l,ta,(p=>{u.push(this.jn(e,t,r,p))}),(p=>{u.push(this.Hn(e,t,r,p))})),U.waitFor(u)}Wn(e){let t=1;return Ul(e).ee({index:KS,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,a,l)=>{l.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((u,p)=>ta(u,p))).filter(((u,p,y)=>!p||ta(u,y[p-1])!==0));const a=[];a.push(e);for(const u of r){const p=ta(u,e),y=ta(u,t);if(p===0)a[0]=e.En();else if(p>0&&y<0)a.push(u),a.push(u.En());else if(y>0)break}a.push(t);const l=[];for(let u=0;u<a.length;u+=2){if(this.Jn(a[u],a[u+1]))return[];const p=a[u].An(this.uid,Of,ye.empty()),y=a[u+1].An(this.uid,Of,ye.empty());l.push(IDBKeyRange.bound(p,y))}return l}Jn(e,t){return ta(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(bT)}getMinOffset(e,t){return U.mapArray(this.vn(t),(r=>this.Fn(e,r).next((a=>a||ve(44426))))).next(bT)}}function _T(s){return hn(s,Nd)}function Ll(s){return hn(s,dd)}function Hu(s){return hn(s,f_)}function Ul(s){return hn(s,ud)}function bT(s){Ie(s.length!==0,28825);let e=s[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<s.length;r++){const a=s[r].indexState.offset;u_(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new wr(e.readTime,e.documentKey,t)}const vT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},e1=41943040;class jn{static withCacheSize(e){return new jn(e,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function t1(s,e,t){const r=s.store(Jr),a=s.store(ac),l=[],u=IDBKeyRange.only(t.batchId);let p=0;const y=r.ee({range:u},((b,E,I)=>(p++,I.delete())));l.push(y.next((()=>{Ie(p===1,47070,{batchId:t.batchId})})));const m=[];for(const b of t.mutations){const E=HS(e,b.key.path,t.batchId);l.push(a.delete(E)),m.push(b.key)}return U.waitFor(l).next((()=>m))}function xm(s){if(!s)return 0;let e;if(s.document)e=s.document;else if(s.unknownDocument)e=s.unknownDocument;else{if(!s.noDocument)throw ve(14731);e=s.noDocument}return JSON.stringify(e).length}jn.DEFAULT_COLLECTION_PERCENTILE=10,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,jn.DEFAULT=new jn(e1,jn.DEFAULT_COLLECTION_PERCENTILE,jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),jn.DISABLED=new jn(-1,0,0);class Zm{constructor(e,t,r,a){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=a,this.Zn={}}static wt(e,t,r,a){Ie(e.uid!=="",64387);const l=e.isAuthenticated()?e.uid:"";return new Zm(l,t,r,a)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return na(e).ee({index:vo,range:r},((a,l,u)=>{t=!1,u.done()})).next((()=>t))}addMutationBatch(e,t,r,a){const l=Gl(e),u=na(e);return u.add({}).next((p=>{Ie(typeof p=="number",49019);const y=new E_(p,t,r,a),m=(function(S,M,z){const ee=z.baseMutations.map((ae=>jd(S.yt,ae))),Q=z.mutations.map((ae=>jd(S.yt,ae)));return{userId:M,batchId:z.batchId,localWriteTimeMs:z.localWriteTime.toMillis(),baseMutations:ee,mutations:Q}})(this.serializer,this.userId,y),b=[];let E=new ft(((I,S)=>Ve(I.canonicalString(),S.canonicalString())));for(const I of a){const S=HS(this.userId,I.key.path,p);E=E.add(I.key.path.popLast()),b.push(u.put(m)),b.push(l.put(S,eO))}return E.forEach((I=>{b.push(this.indexManager.addToCollectionParentIndex(e,I))})),e.addOnCommittedListener((()=>{this.Zn[p]=y.keys()})),U.waitFor(b).next((()=>y))}))}lookupMutationBatch(e,t){return na(e).get(t).next((r=>r?(Ie(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),po(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?U.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const a=r.keys();return this.Zn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=IDBKeyRange.lowerBound([this.userId,r]);let l=null;return na(e).ee({index:vo,range:a},((u,p,y)=>{p.userId===this.userId&&(Ie(p.batchId>=r,47524,{Yn:r}),l=po(this.serializer,p)),y.done()})).next((()=>l))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=fa;return na(e).ee({index:vo,range:t,reverse:!0},((a,l,u)=>{r=l.batchId,u.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,fa],[this.userId,Number.POSITIVE_INFINITY]);return na(e).H(vo,t).next((r=>r.map((a=>po(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Kf(this.userId,t.path),a=IDBKeyRange.lowerBound(r),l=[];return Gl(e).ee({range:a},((u,p,y)=>{const[m,b,E]=u,I=js(b);if(m===this.userId&&t.path.isEqual(I))return na(e).get(E).next((S=>{if(!S)throw ve(61480,{er:u,batchId:E});Ie(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:E}),l.push(po(this.serializer,S))}));y.done()})).next((()=>l))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ft(Ve);const a=[];return t.forEach((l=>{const u=Kf(this.userId,l.path),p=IDBKeyRange.lowerBound(u),y=Gl(e).ee({range:p},((m,b,E)=>{const[I,S,M]=m,z=js(S);I===this.userId&&l.path.isEqual(z)?r=r.add(M):E.done()}));a.push(y)})),U.waitFor(a).next((()=>this.tr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1,l=Kf(this.userId,r),u=IDBKeyRange.lowerBound(l);let p=new ft(Ve);return Gl(e).ee({range:u},((y,m,b)=>{const[E,I,S]=y,M=js(I);E===this.userId&&r.isPrefixOf(M)?M.length===a&&(p=p.add(S)):b.done()})).next((()=>this.tr(e,p)))}tr(e,t){const r=[],a=[];return t.forEach((l=>{a.push(na(e).get(l).next((u=>{if(u===null)throw ve(35274,{batchId:l});Ie(u.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:u.userId,batchId:l}),r.push(po(this.serializer,u))})))})),U.waitFor(a).next((()=>r))}removeMutationBatch(e,t){return t1(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.nr(t.batchId)})),U.forEach(r,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return U.resolve();const r=IDBKeyRange.lowerBound((function(u){return[u]})(this.userId)),a=[];return Gl(e).ee({range:r},((l,u,p)=>{if(l[0]===this.userId){const y=js(l[1]);a.push(y)}else p.done()})).next((()=>{Ie(a.length===0,56720,{rr:a.map((l=>l.canonicalString()))})}))}))}containsKey(e,t){return n1(e,this.userId,t)}ir(e){return r1(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:fa,lastStreamToken:""}))}}function n1(s,e,t){const r=Kf(e,t.path),a=r[1],l=IDBKeyRange.lowerBound(r);let u=!1;return Gl(s).ee({range:l,Y:!0},((p,y,m)=>{const[b,E,I]=p;b===e&&E===a&&(u=!0),m.done()})).next((()=>u))}function na(s){return hn(s,Jr)}function Gl(s){return hn(s,ac)}function r1(s){return hn(s,Sd)}class Mo{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Mo(0)}static ar(){return new Mo(-1)}}class SM{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.ur(e).next((t=>{const r=new Mo(t.highestTargetId);return t.highestTargetId=r.next(),this.cr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.ur(e).next((t=>Ne.fromTimestamp(new lt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.ur(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.ur(e).next((a=>(a.highestListenSequenceNumber=t,r&&(a.lastRemoteSnapshotVersion=r.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.cr(e,a))))}addTargetData(e,t){return this.lr(e,t).next((()=>this.ur(e).next((r=>(r.targetCount+=1,this.hr(t,r),this.cr(e,r))))))}updateTargetData(e,t){return this.lr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>zl(e).delete(t.targetId))).next((()=>this.ur(e))).next((r=>(Ie(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r))))}removeTargets(e,t,r){let a=0;const l=[];return zl(e).ee(((u,p)=>{const y=ed(p);y.sequenceNumber<=t&&r.get(y.targetId)===null&&(a++,l.push(this.removeTargetData(e,y)))})).next((()=>U.waitFor(l))).next((()=>a))}forEachTarget(e,t){return zl(e).ee(((r,a)=>{const l=ed(a);t(l)}))}ur(e){return xT(e).get(pm).next((t=>(Ie(t!==null,2888),t)))}cr(e,t){return xT(e).put(pm,t)}lr(e,t){return zl(e).put(XA(this.serializer,t))}hr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next((t=>t.targetCount))}getTargetData(e,t){const r=Do(t),a=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let l=null;return zl(e).ee({range:a,index:QS},((u,p,y)=>{const m=ed(p);Wd(t,m.target)&&(l=m,y.done())})).next((()=>l))}addMatchingKeys(e,t,r){const a=[],l=ia(e);return t.forEach((u=>{const p=Mn(u.path);a.push(l.put({targetId:r,path:p})),a.push(this.referenceDelegate.addReference(e,r,u))})),U.waitFor(a)}removeMatchingKeys(e,t,r){const a=ia(e);return U.forEach(t,(l=>{const u=Mn(l.path);return U.waitFor([a.delete([r,u]),this.referenceDelegate.removeReference(e,r,l)])}))}removeMatchingKeysForTargetId(e,t){const r=ia(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(a)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),a=ia(e);let l=Be();return a.ee({range:r,Y:!0},((u,p,y)=>{const m=js(u[1]),b=new ye(m);l=l.add(b)})).next((()=>l))}containsKey(e,t){const r=Mn(t.path),a=IDBKeyRange.bound([r],[jS(r)],!1,!0);let l=0;return ia(e).ee({index:h_,Y:!0,range:a},(([u,p],y,m)=>{u!==0&&(l++,m.done())})).next((()=>l>0))}At(e,t){return zl(e).get(t).next((r=>r?ed(r):null))}}function zl(s){return hn(s,oc)}function xT(s){return hn(s,Ao)}function ia(s){return hn(s,lc)}const wT="LruGarbageCollector",AM=1048576;function ET([s,e],[t,r]){const a=Ve(s,t);return a===0?Ve(e,r):a}class NM{constructor(e){this.Pr=e,this.buffer=new ft(ET),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();ET(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class s1{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){he(wT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ra(t)?he(wT,"Ignoring IndexedDB error during garbage collection: ",t):await Na(t)}await this.Ar(3e5)}))}}class RM{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return U.resolve(sr.ce);const r=new NM(t);return this.Vr.forEachTarget(e,(a=>r.Er(a.sequenceNumber))).next((()=>this.Vr.mr(e,(a=>r.Er(a))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(he("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(vT)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(he("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),vT):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let r,a,l,u,p,y,m;const b=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(he("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),a=this.params.maximumSequenceNumbersToCollect):a=E,u=Date.now(),this.nthSequenceNumber(e,a)))).next((E=>(r=E,p=Date.now(),this.removeTargets(e,r,t)))).next((E=>(l=E,y=Date.now(),this.removeOrphanedDocuments(e,r)))).next((E=>(m=Date.now(),Bl()<=Ke.DEBUG&&he("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-b}ms
	Determined least recently used ${a} in `+(p-u)+`ms
	Removed ${l} targets in `+(y-p)+`ms
	Removed ${E} documents in `+(m-y)+`ms
Total Duration: ${m-b}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:E}))))}}function i1(s,e){return new RM(s,e)}class CM{constructor(e,t){this.db=e,this.garbageCollector=i1(this,t)}dr(e){const t=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}mr(e,t){return this.yr(e,((r,a)=>t(a)))}addReference(e,t,r){return Mf(e,r)}removeReference(e,t,r){return Mf(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Mf(e,t)}wr(e,t){return(function(a,l){let u=!1;return r1(a).te((p=>n1(a,p,l).next((y=>(y&&(u=!0),U.resolve(!y)))))).next((()=>u))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let l=0;return this.yr(e,((u,p)=>{if(p<=t){const y=this.wr(e,u).next((m=>{if(!m)return l++,r.getEntry(e,u).next((()=>(r.removeEntry(u,Ne.min()),ia(e).delete((function(E){return[0,Mn(E.path)]})(u)))))}));a.push(y)}})).next((()=>U.waitFor(a))).next((()=>r.apply(e))).next((()=>l))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Mf(e,t)}yr(e,t){const r=ia(e);let a,l=sr.ce;return r.ee({index:h_},(([u,p],{path:y,sequenceNumber:m})=>{u===0?(l!==sr.ce&&t(new ye(js(a)),l),l=m,a=y):l=sr.ce})).next((()=>{l!==sr.ce&&t(new ye(js(a)),l)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Mf(s,e){return ia(s).put((function(r,a){return{targetId:0,path:Mn(r.path),sequenceNumber:a}})(e,s.currentSequenceNumber))}class a1{constructor(){this.changes=new bi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,It.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?U.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class kM{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return co(e).put(r)}removeEntry(e,t,r){return co(e).delete((function(l,u){const p=l.path.toArray();return[p.slice(0,p.length-2),p[p.length-2],bm(u),p[p.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=It.newInvalidDocument(t);return co(e).ee({index:$f,range:IDBKeyRange.only(Gu(t))},((a,l)=>{r=this.Sr(t,l)})).next((()=>r))}Dr(e,t){let r={size:0,document:It.newInvalidDocument(t)};return co(e).ee({index:$f,range:IDBKeyRange.only(Gu(t))},((a,l)=>{r={document:this.Sr(t,l),size:xm(l)}})).next((()=>r))}getEntries(e,t){let r=ar();return this.Cr(e,t,((a,l)=>{const u=this.Sr(a,l);r=r.insert(a,u)})).next((()=>r))}vr(e,t){let r=ar(),a=new xt(ye.comparator);return this.Cr(e,t,((l,u)=>{const p=this.Sr(l,u);r=r.insert(l,p),a=a.insert(l,xm(u))})).next((()=>({documents:r,Fr:a})))}Cr(e,t,r){if(t.isEmpty())return U.resolve();let a=new ft(ST);t.forEach((y=>a=a.add(y)));const l=IDBKeyRange.bound(Gu(a.first()),Gu(a.last())),u=a.getIterator();let p=u.getNext();return co(e).ee({index:$f,range:l},((y,m,b)=>{const E=ye.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;p&&ST(p,E)<0;)r(p,null),p=u.getNext();p&&p.isEqual(E)&&(r(p,m),p=u.hasNext()?u.getNext():null),p?b.j(Gu(p)):b.done()})).next((()=>{for(;p;)r(p,null),p=u.hasNext()?u.getNext():null}))}getDocumentsMatchingQuery(e,t,r,a,l){const u=t.path,p=[u.popLast().toArray(),u.lastSegment(),bm(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],y=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return co(e).H(IDBKeyRange.bound(p,y,!0)).next((m=>{l?.incrementDocumentReadCount(m.length);let b=ar();for(const E of m){const I=this.Sr(ye.fromSegments(E.prefixPath.concat(E.collectionGroup,E.documentId)),E);I.isFoundDocument()&&(Jd(t,I)||a.has(I.key))&&(b=b.insert(I.key,I))}return b}))}getAllFromCollectionGroup(e,t,r,a){let l=ar();const u=IT(t,r),p=IT(t,wr.max());return co(e).ee({index:GS,range:IDBKeyRange.bound(u,p,!0)},((y,m,b)=>{const E=this.Sr(ye.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);l=l.insert(E.key,E),l.size===a&&b.done()})).next((()=>l))}newChangeBuffer(e){return new DM(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return TT(e).get(Z0).next((t=>(Ie(!!t,20021),t)))}br(e,t){return TT(e).put(Z0,t)}Sr(e,t){if(t){const r=gM(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ne.min())))return r}return It.newInvalidDocument(e)}}function o1(s){return new kM(s)}class DM extends a1{constructor(e,t){super(),this.Mr=e,this.trackRemovals=t,this.Or=new bi((r=>r.toString()),((r,a)=>r.isEqual(a)))}applyChanges(e){const t=[];let r=0,a=new ft(((l,u)=>Ve(l.canonicalString(),u.canonicalString())));return this.changes.forEach(((l,u)=>{const p=this.Or.get(l);if(t.push(this.Mr.removeEntry(e,l,p.readTime)),u.isValidDocument()){const y=oT(this.Mr.serializer,u);a=a.add(l.path.popLast());const m=xm(y);r+=m-p.size,t.push(this.Mr.addEntry(e,l,y))}else if(r-=p.size,this.trackRemovals){const y=oT(this.Mr.serializer,u.convertToNoDocument(Ne.min()));t.push(this.Mr.addEntry(e,l,y))}})),a.forEach((l=>{t.push(this.Mr.indexManager.addToCollectionParentIndex(e,l))})),t.push(this.Mr.updateMetadata(e,r)),U.waitFor(t)}getFromCache(e,t){return this.Mr.Dr(e,t).next((r=>(this.Or.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Mr.vr(e,t).next((({documents:r,Fr:a})=>(a.forEach(((l,u)=>{this.Or.set(l,{size:u,readTime:r.get(l).readTime})})),r)))}}function TT(s){return hn(s,Ad)}function co(s){return hn(s,mm)}function Gu(s){const e=s.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function IT(s,e){const t=e.documentKey.path.toArray();return[s,bm(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function ST(s,e){const t=s.path.toArray(),r=e.path.toArray();let a=0;for(let l=0;l<t.length-2&&l<r.length-2;++l)if(a=Ve(t[l],r[l]),a)return a;return a=Ve(t.length,r.length),a||(a=Ve(t[t.length-2],r[r.length-2]),a||Ve(t[t.length-1],r[r.length-1]))}class PM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class l1{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(r!==null&&md(r.mutation,a,ir.empty(),lt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Be()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Be()){const a=Vs();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,r).next((l=>{let u=Ju();return l.forEach(((p,y)=>{u=u.insert(p,y.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const r=Vs();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Be())))}populateOverlays(e,t,r){const a=[];return r.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,p)=>{t.set(u,p)}))}))}computeViews(e,t,r,a){let l=ar();const u=fd(),p=(function(){return fd()})();return t.forEach(((y,m)=>{const b=r.get(m.key);a.has(m.key)&&(b===void 0||b.mutation instanceof vi)?l=l.insert(m.key,m):b!==void 0?(u.set(m.key,b.mutation.getFieldMask()),md(b.mutation,m,b.mutation.getFieldMask(),lt.now())):u.set(m.key,ir.empty())})),this.recalculateAndSaveOverlays(e,l).next((y=>(y.forEach(((m,b)=>u.set(m,b))),t.forEach(((m,b)=>p.set(m,new PM(b,u.get(m)??null)))),p)))}recalculateAndSaveOverlays(e,t){const r=fd();let a=new xt(((u,p)=>u-p)),l=Be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const p of u)p.keys().forEach((y=>{const m=t.get(y);if(m===null)return;let b=r.get(y)||ir.empty();b=p.applyToLocalView(m,b),r.set(y,b);const E=(a.get(p.batchId)||Be()).add(y);a=a.insert(p.batchId,E)}))})).next((()=>{const u=[],p=a.getReverseIterator();for(;p.hasNext();){const y=p.getNext(),m=y.key,b=y.value,E=EA();b.forEach((I=>{if(!l.has(I)){const S=CA(t.get(I),r.get(I));S!==null&&E.set(I,S),l=l.add(I)}})),u.push(this.documentOverlayCache.saveOverlays(e,m,E))}return U.waitFor(u)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,a){return LO(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):b_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-l.size):U.resolve(Vs());let p=ic,y=l;return u.next((m=>U.forEach(m,((b,E)=>(p<E.largestBatchId&&(p=E.largestBatchId),l.get(b)?U.resolve():this.remoteDocumentCache.getEntry(e,b).next((I=>{y=y.insert(b,I)}))))).next((()=>this.populateOverlays(e,m,l))).next((()=>this.computeViews(e,y,m,Be()))).next((b=>({batchId:p,changes:wA(b)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ye(t)).next((r=>{let a=Ju();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const l=t.collectionGroup;let u=Ju();return this.indexManager.getCollectionParents(e,l).next((p=>U.forEach(p,(y=>{const m=(function(E,I){return new _i(I,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,y.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,r,a).next((b=>{b.forEach(((E,I)=>{u=u.insert(E,I)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,r,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,l,a)))).next((u=>{l.forEach(((y,m)=>{const b=m.getKey();u.get(b)===null&&(u=u.insert(b,It.newInvalidDocument(b)))}));let p=Ju();return u.forEach(((y,m)=>{const b=l.get(y);b!==void 0&&md(b.mutation,m,ir.empty(),lt.now()),Jd(t,m)&&(p=p.insert(y,m))})),p}))}}class jM{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return U.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:$t(a.createTime)}})(t)),U.resolve()}getNamedQuery(e,t){return U.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(a){return{name:a.name,query:N_(a.bundledQuery),readTime:$t(a.readTime)}})(t)),U.resolve()}}class VM{constructor(){this.overlays=new xt(ye.comparator),this.Lr=new Map}getOverlay(e,t){return U.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Vs();return U.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&r.set(a,l)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((a,l)=>{this.bt(e,t,l)})),U.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.Lr.get(r);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(r)),U.resolve()}getOverlaysForCollection(e,t,r){const a=Vs(),l=t.length+1,u=new ye(t.child("")),p=this.overlays.getIteratorFrom(u);for(;p.hasNext();){const y=p.getNext().value,m=y.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===l&&y.largestBatchId>r&&a.set(y.getKey(),y)}return U.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let l=new xt(((m,b)=>m-b));const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let b=l.get(m.largestBatchId);b===null&&(b=Vs(),l=l.insert(m.largestBatchId,b)),b.set(m.getKey(),m)}}const p=Vs(),y=l.getIterator();for(;y.hasNext()&&(y.getNext().value.forEach(((m,b)=>p.set(m,b))),!(p.size()>=a)););return U.resolve(p)}bt(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const u=this.Lr.get(a.largestBatchId).delete(r.key);this.Lr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new I_(t,r));let l=this.Lr.get(t);l===void 0&&(l=Be(),this.Lr.set(t,l)),this.Lr.set(t,l.add(r.key))}}class OM{constructor(){this.sessionToken=Ut.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,U.resolve()}}class k_{constructor(){this.kr=new ft(gn.Kr),this.qr=new ft(gn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const r=new gn(e,t);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new gn(e,t))}Qr(e,t){e.forEach((r=>this.removeReference(r,t)))}Gr(e){const t=new ye(new $e([])),r=new gn(t,e),a=new gn(t,e+1),l=[];return this.qr.forEachInRange([r,a],(u=>{this.Wr(u),l.push(u.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new ye(new $e([])),r=new gn(t,e),a=new gn(t,e+1);let l=Be();return this.qr.forEachInRange([r,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new gn(e,0),r=this.kr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class gn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return ye.comparator(e.key,t.key)||Ve(e.Hr,t.Hr)}static Ur(e,t){return Ve(e.Hr,t.Hr)||ye.comparator(e.key,t.key)}}class MM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new ft(gn.Kr)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new E_(l,t,r,a);this.mutationQueue.push(u);for(const p of a)this.Jr=this.Jr.add(new gn(p.key,l)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return U.resolve(u)}lookupMutationBatch(e,t){return U.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.Xr(r),l=a<0?0:a;return U.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?fa:this.Yn-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new gn(t,0),a=new gn(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([r,a],(u=>{const p=this.Zr(u.Hr);l.push(p)})),U.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new ft(Ve);return t.forEach((a=>{const l=new gn(a,0),u=new gn(a,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,u],(p=>{r=r.add(p.Hr)}))})),U.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let l=r;ye.isDocumentKey(l)||(l=l.child(""));const u=new gn(new ye(l),0);let p=new ft(Ve);return this.Jr.forEachWhile((y=>{const m=y.key.path;return!!r.isPrefixOf(m)&&(m.length===a&&(p=p.add(y.Hr)),!0)}),u),U.resolve(this.Yr(p))}Yr(e){const t=[];return e.forEach((r=>{const a=this.Zr(r);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Ie(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return U.forEach(t.mutations,(a=>{const l=new gn(a.key,t.batchId);return r=r.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,t){const r=new gn(t,0),a=this.Jr.firstAfterOrEqual(r);return U.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class LM{constructor(e){this.ti=e,this.docs=(function(){return new xt(ye.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),l=a?a.size:0,u=this.ti(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return U.resolve(r?r.document.mutableCopy():It.newInvalidDocument(t))}getEntries(e,t){let r=ar();return t.forEach((a=>{const l=this.docs.get(a);r=r.insert(a,l?l.document.mutableCopy():It.newInvalidDocument(a))})),U.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let l=ar();const u=t.path,p=new ye(u.child("__id-9223372036854775808__")),y=this.docs.getIteratorFrom(p);for(;y.hasNext();){const{key:m,value:{document:b}}=y.getNext();if(!u.isPrefixOf(m.path))break;m.path.length>u.length+1||u_(US(b),r)<=0||(a.has(b.key)||Jd(t,b))&&(l=l.insert(b.key,b.mutableCopy()))}return U.resolve(l)}getAllFromCollectionGroup(e,t,r,a){ve(9500)}ni(e,t){return U.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new UM(this)}getSize(e){return U.resolve(this.size)}}class UM extends a1{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?t.push(this.Mr.addEntry(e,a)):this.Mr.removeEntry(r)})),U.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}class zM{constructor(e){this.persistence=e,this.ri=new bi((t=>Do(t)),Wd),this.lastRemoteSnapshotVersion=Ne.min(),this.highestTargetId=0,this.ii=0,this.si=new k_,this.targetCount=0,this.oi=Mo._r()}forEachTarget(e,t){return this.ri.forEach(((r,a)=>t(a))),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.ii&&(this.ii=t),U.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new Mo(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,U.resolve()}updateTargetData(e,t){return this.lr(t),U.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,t,r){let a=0;const l=[];return this.ri.forEach(((u,p)=>{p.sequenceNumber<=t&&r.get(p.targetId)===null&&(this.ri.delete(u),l.push(this.removeMatchingKeysForTargetId(e,p.targetId)),a++)})),U.waitFor(l).next((()=>a))}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,t){const r=this.ri.get(t)||null;return U.resolve(r)}addMatchingKeys(e,t,r){return this.si.$r(t,r),U.resolve()}removeMatchingKeys(e,t,r){this.si.Qr(t,r);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),U.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),U.resolve()}getMatchingKeysForTargetId(e,t){const r=this.si.jr(t);return U.resolve(r)}containsKey(e,t){return U.resolve(this.si.containsKey(t))}}class D_{constructor(e,t){this._i={},this.overlays={},this.ai=new sr(0),this.ui=!1,this.ui=!0,this.ci=new OM,this.referenceDelegate=e(this),this.li=new zM(this),this.indexManager=new TM,this.remoteDocumentCache=(function(a){return new LM(a)})((r=>this.referenceDelegate.hi(r))),this.serializer=new WA(t),this.Pi=new jM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new VM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this._i[e.toKey()];return r||(r=new MM(t,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,r){he("MemoryPersistence","Starting transaction:",e);const a=new BM(this.ai.next());return this.referenceDelegate.Ti(),r(a).next((l=>this.referenceDelegate.Ii(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return U.or(Object.values(this._i).map((r=>()=>r.containsKey(e,t))))}}class BM extends BS{constructor(e){super(),this.currentSequenceNumber=e}}class ep{constructor(e){this.persistence=e,this.Ri=new k_,this.Ai=null}static Vi(e){return new ep(e)}get di(){if(this.Ai)return this.Ai;throw ve(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.di.delete(r.toString()),U.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.di.add(r.toString()),U.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),U.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((a=>this.di.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.di.add(l.toString())))})).next((()=>r.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.di,(r=>{const a=ye.fromPath(r);return this.mi(e,a).next((l=>{l||t.removeEntry(a,Ne.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((r=>{r?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return U.or([()=>U.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class wm{constructor(e,t){this.persistence=e,this.fi=new bi((r=>Mn(r.path)),((r,a)=>r.isEqual(a))),this.garbageCollector=i1(this,t)}static Vi(e,t){return new wm(e,t)}Ti(){}Ii(e){return U.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}pr(e){let t=0;return this.mr(e,(r=>{t++})).next((()=>t))}mr(e,t){return U.forEach(this.fi,((r,a)=>this.wr(e,r,a).next((l=>l?U.resolve():t(a)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ni(e,(u=>this.wr(e,u,t).next((p=>{p||(r++,l.removeEntry(u,Ne.min()))})))).next((()=>l.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),U.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),U.resolve()}removeReference(e,t,r){return this.fi.set(r,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),U.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wf(e.data.value)),t}wr(e,t,r){return U.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.fi.get(t);return U.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class qM{constructor(e){this.serializer=e}k(e,t,r,a){const l=new Fm("createOrUpgrade",t);r<1&&a>=1&&((function(y){y.createObjectStore(Yd)})(e),(function(y){y.createObjectStore(Sd,{keyPath:ZV}),y.createObjectStore(Jr,{keyPath:ME,autoIncrement:!0}).createIndex(vo,LE,{unique:!0}),y.createObjectStore(ac)})(e),AT(e),(function(y){y.createObjectStore(fo)})(e));let u=U.resolve();return r<3&&a>=3&&(r!==0&&((function(y){y.deleteObjectStore(lc),y.deleteObjectStore(oc),y.deleteObjectStore(Ao)})(e),AT(e)),u=u.next((()=>(function(y){const m=y.store(Ao),b={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ne.min().toTimestamp(),targetCount:0};return m.put(pm,b)})(l)))),r<4&&a>=4&&(r!==0&&(u=u.next((()=>(function(y,m){return m.store(Jr).H().next((E=>{y.deleteObjectStore(Jr),y.createObjectStore(Jr,{keyPath:ME,autoIncrement:!0}).createIndex(vo,LE,{unique:!0});const I=m.store(Jr),S=E.map((M=>I.put(M)));return U.waitFor(S)}))})(e,l)))),u=u.next((()=>{(function(y){y.createObjectStore(cc,{keyPath:lO})})(e)}))),r<5&&a>=5&&(u=u.next((()=>this.gi(l)))),r<6&&a>=6&&(u=u.next((()=>((function(y){y.createObjectStore(Ad)})(e),this.pi(l))))),r<7&&a>=7&&(u=u.next((()=>this.yi(l)))),r<8&&a>=8&&(u=u.next((()=>this.wi(e,l)))),r<9&&a>=9&&(u=u.next((()=>{(function(y){y.objectStoreNames.contains("remoteDocumentChanges")&&y.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&a>=10&&(u=u.next((()=>this.bi(l)))),r<11&&a>=11&&(u=u.next((()=>{(function(y){y.createObjectStore(Hm,{keyPath:cO})})(e),(function(y){y.createObjectStore(Gm,{keyPath:uO})})(e)}))),r<12&&a>=12&&(u=u.next((()=>{(function(y){const m=y.createObjectStore(Qm,{keyPath:yO});m.createIndex(ty,_O,{unique:!1}),m.createIndex(YS,bO,{unique:!1})})(e)}))),r<13&&a>=13&&(u=u.next((()=>(function(y){const m=y.createObjectStore(mm,{keyPath:tO});m.createIndex($f,nO),m.createIndex(GS,rO)})(e))).next((()=>this.Si(e,l))).next((()=>e.deleteObjectStore(fo)))),r<14&&a>=14&&(u=u.next((()=>this.Di(e,l)))),r<15&&a>=15&&(u=u.next((()=>(function(y){y.createObjectStore(f_,{keyPath:dO,autoIncrement:!0}).createIndex(ey,hO,{unique:!1}),y.createObjectStore(ud,{keyPath:fO}).createIndex(KS,mO,{unique:!1}),y.createObjectStore(dd,{keyPath:pO}).createIndex($S,gO,{unique:!1})})(e)))),r<16&&a>=16&&(u=u.next((()=>{t.objectStore(ud).clear()})).next((()=>{t.objectStore(dd).clear()}))),r<17&&a>=17&&(u=u.next((()=>{(function(y){y.createObjectStore(m_,{keyPath:vO})})(e)}))),r<18&&a>=18&&fI()&&(u=u.next((()=>{t.objectStore(ud).clear()})).next((()=>{t.objectStore(dd).clear()}))),u}pi(e){let t=0;return e.store(fo).ee(((r,a)=>{t+=xm(a)})).next((()=>{const r={byteSize:t};return e.store(Ad).put(Z0,r)}))}gi(e){const t=e.store(Sd),r=e.store(Jr);return t.H().next((a=>U.forEach(a,(l=>{const u=IDBKeyRange.bound([l.userId,fa],[l.userId,l.lastAcknowledgedBatchId]);return r.H(vo,u).next((p=>U.forEach(p,(y=>{Ie(y.userId===l.userId,18650,"Cannot process batch from unexpected user",{batchId:y.batchId});const m=po(this.serializer,y);return t1(e,l.userId,m).next((()=>{}))}))))}))))}yi(e){const t=e.store(lc),r=e.store(fo);return e.store(Ao).get(pm).next((a=>{const l=[];return r.ee(((u,p)=>{const y=new $e(u),m=(function(E){return[0,Mn(E)]})(y);l.push(t.get(m).next((b=>b?U.resolve():(E=>t.put({targetId:0,path:Mn(E),sequenceNumber:a.highestListenSequenceNumber}))(y))))})).next((()=>U.waitFor(l)))}))}wi(e,t){e.createObjectStore(Nd,{keyPath:oO});const r=t.store(Nd),a=new C_,l=u=>{if(a.add(u)){const p=u.lastSegment(),y=u.popLast();return r.put({collectionId:p,parent:Mn(y)})}};return t.store(fo).ee({Y:!0},((u,p)=>{const y=new $e(u);return l(y.popLast())})).next((()=>t.store(ac).ee({Y:!0},(([u,p,y],m)=>{const b=js(p);return l(b.popLast())}))))}bi(e){const t=e.store(oc);return t.ee(((r,a)=>{const l=ed(a),u=XA(this.serializer,l);return t.put(u)}))}Si(e,t){const r=t.store(fo),a=[];return r.ee(((l,u)=>{const p=t.store(mm),y=(function(E){return E.document?new ye($e.fromString(E.document.name).popFirst(5)):E.noDocument?ye.fromSegments(E.noDocument.path):E.unknownDocument?ye.fromSegments(E.unknownDocument.path):ve(36783)})(u).path.toArray(),m={prefixPath:y.slice(0,y.length-2),collectionGroup:y[y.length-2],documentId:y[y.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};a.push(p.put(m))})).next((()=>U.waitFor(a)))}Di(e,t){const r=t.store(Jr),a=o1(this.serializer),l=new D_(ep.Vi,this.serializer.yt);return r.H().next((u=>{const p=new Map;return u.forEach((y=>{let m=p.get(y.userId)??Be();po(this.serializer,y).keys().forEach((b=>m=m.add(b))),p.set(y.userId,m)})),U.forEach(p,((y,m)=>{const b=new yn(m),E=Jm.wt(this.serializer,b),I=l.getIndexManager(b),S=Zm.wt(b,this.serializer,I,l.referenceDelegate);return new l1(a,S,E,I).recalculateAndSaveOverlaysForDocumentKeys(new ny(t,sr.ce),y).next()}))}))}}function AT(s){s.createObjectStore(lc,{keyPath:iO}).createIndex(h_,aO,{unique:!0}),s.createObjectStore(oc,{keyPath:"targetId"}).createIndex(QS,sO,{unique:!0}),s.createObjectStore(Ao)}const ra="IndexedDbPersistence",N0=18e5,R0=5e3,C0="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",c1="main";class P_{constructor(e,t,r,a,l,u,p,y,m,b,E=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Ci=l,this.window=u,this.document=p,this.Fi=m,this.Mi=b,this.xi=E,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=I=>Promise.resolve(),!P_.v())throw new ce(W.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new CM(this,a),this.Ki=t+c1,this.serializer=new WA(y),this.qi=new Ms(this.Ki,this.xi,new qM(this.serializer)),this.ci=new _M,this.li=new SM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=o1(this.serializer),this.Pi=new yM,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,b===!1&&Kt(ra,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ce(W.FAILED_PRECONDITION,C0);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.li.getHighestSequenceNumber(e)))})).then((e=>{this.ai=new sr(e,this.Fi)})).then((()=>{this.ui=!0})).catch((e=>(this.qi&&this.qi.close(),Promise.reject(e))))}zi(e){return this.ki=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget((async()=>{this.started&&await this.$i()})))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Lf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.ji(e).next((t=>{t||(this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Ji(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(Ra(e))return he(ra,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return he(ra,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable((()=>this.ki(e))),this.isPrimary=e}))}ji(e){return Qu(e).get(Vl).next((t=>U.resolve(this.Xi(t))))}Yi(e){return Lf(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,N0)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=hn(t,cc);return r.H().next((a=>{const l=this.ns(a,N0),u=a.filter((p=>l.indexOf(p)===-1));return U.forEach(u,(p=>r.delete(p.clientId))).next((()=>u))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.rs(t.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.$i().then((()=>this.es())).then((()=>this.Gi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?U.resolve(!0):Qu(e).get(Vl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,R0)&&!this.ss(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new ce(W.FAILED_PRECONDITION,C0);return!1}}return!(!this.networkEnabled||!this.inForeground)||Lf(e).H().next((r=>this.ns(r,R0).find((a=>{if(this.clientId!==a.clientId){const l=!this.networkEnabled&&a.networkEnabled,u=!this.inForeground&&a.inForeground,p=this.networkEnabled===a.networkEnabled;if(l||u&&p)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&he(ra,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[Yd,cc],(e=>{const t=new ny(e,sr.ce);return this.Ji(t).next((()=>this.Yi(t)))})),this.qi.close(),this.ls()}ns(e,t){return e.filter((r=>this.ts(r.updateTimeMs,t)&&!this.ss(r.clientId)))}hs(){return this.runTransaction("getActiveClients","readonly",(e=>Lf(e).H().next((t=>this.ns(t,N0).map((r=>r.clientId))))))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,t){return Zm.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new IM(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Jm.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,t,r){he(ra,"Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",l=(function(y){return y===18?EO:y===17?ZS:y===16?wO:y===15?p_:y===14?JS:y===13?XS:y===12?xO:y===11?WS:void ve(60245)})(this.xi);let u;return this.qi.runTransaction(e,a,l,(p=>(u=new ny(p,this.ai?this.ai.next():sr.ce),t==="readwrite-primary"?this.ji(u).next((y=>!!y||this.Hi(u))).next((y=>{if(!y)throw Kt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable((()=>this.ki(!1))),new ce(W.FAILED_PRECONDITION,zS);return r(u)})).next((y=>this.Zi(u).next((()=>y)))):this.Ps(u).next((()=>r(u)))))).then((p=>(u.raiseOnCommittedEvent(),p)))}Ps(e){return Qu(e).get(Vl).next((t=>{if(t!==null&&this.ts(t.leaseTimestampMs,R0)&&!this.ss(t.ownerId)&&!this.Xi(t)&&!(this.Mi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ce(W.FAILED_PRECONDITION,C0)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Qu(e).put(Vl,t)}static v(){return Ms.v()}Ji(e){const t=Qu(e);return t.get(Vl).next((r=>this.Xi(r)?(he(ra,"Releasing primary lease."),t.delete(Vl)):U.resolve()))}ts(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Kt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.$i())))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){typeof this.window?.addEventListener=="function"&&(this.Oi=()=>{this._s();const e=/(?:Version|Mobile)\/1[456]/;hI()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){try{const t=this.Ui?.getItem(this.rs(e))!==null;return he(ra,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Kt(ra,"Failed to get zombied client id.",t),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){Kt("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Qu(s){return hn(s,Yd)}function Lf(s){return hn(s,cc)}function j_(s,e){let t=s.projectId;return s.isDefaultDatabase||(t+="."+s.database),"firestore/"+e+"/"+t+"/"}class V_{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Ts=r,this.Is=a}static Es(e,t){let r=Be(),a=Be();for(const l of t.docChanges)switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new V_(e,t.fromCache,r,a)}}class FM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class u1{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return hI()?8:qS(jt())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,a){const l={result:null};return this.gs(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ps(e,t,a,r).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new FM;return this.ys(e,t,u).next((p=>{if(l.result=p,this.As)return this.ws(e,t,u,p.size)}))})).next((()=>l.result))}ws(e,t,r,a){return r.documentReadCount<this.Vs?(Bl()<=Ke.DEBUG&&he("QueryEngine","SDK will not create cache indexes for query:",ql(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),U.resolve()):(Bl()<=Ke.DEBUG&&he("QueryEngine","Query:",ql(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.ds*a?(Bl()<=Ke.DEBUG&&he("QueryEngine","The SDK decides to create cache indexes for query:",ql(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gn(t))):U.resolve())}gs(e,t){if(XE(t))return U.resolve(null);let r=Gn(t);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=_m(t,null,"F"),r=Gn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((l=>{const u=Be(...l);return this.fs.getDocuments(e,u).next((p=>this.indexManager.getMinOffset(e,r).next((y=>{const m=this.bs(t,p);return this.Ss(t,m,u,y.readTime)?this.gs(e,_m(t,null,"F")):this.Ds(e,m,t,y)}))))})))))}ps(e,t,r,a){return XE(t)||a.isEqual(Ne.min())?U.resolve(null):this.fs.getDocuments(e,r).next((l=>{const u=this.bs(t,l);return this.Ss(t,u,r,a)?U.resolve(null):(Bl()<=Ke.DEBUG&&he("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),ql(t)),this.Ds(e,u,t,LS(a,ic)).next((p=>p)))}))}bs(e,t){let r=new ft(vA(e));return t.forEach(((a,l)=>{Jd(e,l)&&(r=r.add(l))})),r}Ss(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ys(e,t,r){return Bl()<=Ke.DEBUG&&he("QueryEngine","Using full collection scan to execute query:",ql(t)),this.fs.getDocumentsMatchingQuery(e,t,wr.min(),r)}Ds(e,t,r,a){return this.fs.getDocumentsMatchingQuery(e,r,a).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}const O_="LocalStore",HM=3e8;class GM{constructor(e,t,r,a){this.persistence=e,this.Cs=t,this.serializer=a,this.vs=new xt(Ve),this.Fs=new bi((l=>Do(l)),Wd),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new l1(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function d1(s,e,t,r){return new GM(s,e,t,r)}async function h1(s,e){const t=_e(s);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next((l=>(a=l,t.Os(e),t.mutationQueue.getAllMutationBatches(r)))).next((l=>{const u=[],p=[];let y=Be();for(const m of a){u.push(m.batchId);for(const b of m.mutations)y=y.add(b.key)}for(const m of l){p.push(m.batchId);for(const b of m.mutations)y=y.add(b.key)}return t.localDocuments.getDocuments(r,y).next((m=>({Ns:m,removedBatchIds:u,addedBatchIds:p})))}))}))}function QM(s,e){const t=_e(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(p,y,m,b){const E=m.batch,I=E.keys();let S=U.resolve();return I.forEach((M=>{S=S.next((()=>b.getEntry(y,M))).next((z=>{const ee=m.docVersions.get(M);Ie(ee!==null,48541),z.version.compareTo(ee)<0&&(E.applyToRemoteDocument(z,m),z.isValidDocument()&&(z.setReadTime(m.commitVersion),b.addEntry(z)))}))})),S.next((()=>p.mutationQueue.removeMutationBatch(y,E)))})(t,r,e,l).next((()=>l.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(p){let y=Be();for(let m=0;m<p.mutationResults.length;++m)p.mutationResults[m].transformResults.length>0&&(y=y.add(p.batch.mutations[m].key));return y})(e)))).next((()=>t.localDocuments.getDocuments(r,a)))}))}function f1(s){const e=_e(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function KM(s,e){const t=_e(s),r=e.snapshotVersion;let a=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.xs.newChangeBuffer({trackRemovals:!0});a=t.vs;const p=[];e.targetChanges.forEach(((b,E)=>{const I=a.get(E);if(!I)return;p.push(t.li.removeMatchingKeys(l,b.removedDocuments,E).next((()=>t.li.addMatchingKeys(l,b.addedDocuments,E))));let S=I.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(E)!==null?S=S.withResumeToken(Ut.EMPTY_BYTE_STRING,Ne.min()).withLastLimboFreeSnapshotVersion(Ne.min()):b.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(b.resumeToken,r)),a=a.insert(E,S),(function(z,ee,Q){return z.resumeToken.approximateByteSize()===0||ee.snapshotVersion.toMicroseconds()-z.snapshotVersion.toMicroseconds()>=HM?!0:Q.addedDocuments.size+Q.modifiedDocuments.size+Q.removedDocuments.size>0})(I,S,b)&&p.push(t.li.updateTargetData(l,S))}));let y=ar(),m=Be();if(e.documentUpdates.forEach((b=>{e.resolvedLimboDocuments.has(b)&&p.push(t.persistence.referenceDelegate.updateLimboDocument(l,b))})),p.push(m1(l,u,e.documentUpdates).next((b=>{y=b.Bs,m=b.Ls}))),!r.isEqual(Ne.min())){const b=t.li.getLastRemoteSnapshotVersion(l).next((E=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,r)));p.push(b)}return U.waitFor(p).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,y,m))).next((()=>y))})).then((l=>(t.vs=a,l)))}function m1(s,e,t){let r=Be(),a=Be();return t.forEach((l=>r=r.add(l))),e.getEntries(s,r).next((l=>{let u=ar();return t.forEach(((p,y)=>{const m=l.get(p);y.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(p)),y.isNoDocument()&&y.version.isEqual(Ne.min())?(e.removeEntry(p,y.readTime),u=u.insert(p,y)):!m.isValidDocument()||y.version.compareTo(m.version)>0||y.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(y),u=u.insert(p,y)):he(O_,"Ignoring outdated watch update for ",p,". Current version:",m.version," Watch version:",y.version)})),{Bs:u,Ls:a}}))}function $M(s,e){const t=_e(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=fa),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function gc(s,e){const t=_e(s);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return t.li.getTargetData(r,e).next((l=>l?(a=l,U.resolve(a)):t.li.allocateTargetId(r).next((u=>(a=new ui(e,u,"TargetPurposeListen",r.currentSequenceNumber),t.li.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=t.vs.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.vs=t.vs.insert(r.targetId,r),t.Fs.set(e,r.targetId)),r}))}async function yc(s,e,t){const r=_e(s),a=r.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",l,(u=>r.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!Ra(u))throw u;he(O_,`Failed to update sequence numbers for target ${e}: ${u}`)}r.vs=r.vs.remove(e),r.Fs.delete(a.target)}function Em(s,e,t){const r=_e(s);let a=Ne.min(),l=Be();return r.persistence.runTransaction("Execute query","readwrite",(u=>(function(y,m,b){const E=_e(y),I=E.Fs.get(b);return I!==void 0?U.resolve(E.vs.get(I)):E.li.getTargetData(m,b)})(r,u,Gn(e)).next((p=>{if(p)return a=p.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(u,p.targetId).next((y=>{l=y}))})).next((()=>r.Cs.getDocumentsMatchingQuery(u,e,t?a:Ne.min(),t?l:Be()))).next((p=>(y1(r,bA(e),p),{documents:p,ks:l})))))}function p1(s,e){const t=_e(s),r=_e(t.li),a=t.vs.get(e);return a?Promise.resolve(a.target):t.persistence.runTransaction("Get target data","readonly",(l=>r.At(l,e).next((u=>u?u.target:null))))}function g1(s,e){const t=_e(s),r=t.Ms.get(e)||Ne.min();return t.persistence.runTransaction("Get new document changes","readonly",(a=>t.xs.getAllFromCollectionGroup(a,e,LS(r,ic),Number.MAX_SAFE_INTEGER))).then((a=>(y1(t,e,a),a)))}function y1(s,e,t){let r=s.Ms.get(e)||Ne.min();t.forEach(((a,l)=>{l.readTime.compareTo(r)>0&&(r=l.readTime)})),s.Ms.set(e,r)}async function YM(s,e,t,r){const a=_e(s);let l=Be(),u=ar();for(const m of t){const b=e.Ks(m.metadata.name);m.document&&(l=l.add(b));const E=e.qs(m);E.setReadTime(e.Us(m.metadata.readTime)),u=u.insert(b,E)}const p=a.xs.newChangeBuffer({trackRemovals:!0}),y=await gc(a,(function(b){return Gn(Rc($e.fromString(`__bundle__/docs/${b}`)))})(r));return a.persistence.runTransaction("Apply bundle documents","readwrite",(m=>m1(m,p,u).next((b=>(p.apply(m),b))).next((b=>a.li.removeMatchingKeysForTargetId(m,y.targetId).next((()=>a.li.addMatchingKeys(m,l,y.targetId))).next((()=>a.localDocuments.getLocalViewOfDocuments(m,b.Bs,b.Ls))).next((()=>b.Bs))))))}async function WM(s,e,t=Be()){const r=await gc(s,Gn(N_(e.bundledQuery))),a=_e(s);return a.persistence.runTransaction("Save named query","readwrite",(l=>{const u=$t(e.readTime);if(r.snapshotVersion.compareTo(u)>=0)return a.Pi.saveNamedQuery(l,e);const p=r.withResumeToken(Ut.EMPTY_BYTE_STRING,u);return a.vs=a.vs.insert(p.targetId,p),a.li.updateTargetData(l,p).next((()=>a.li.removeMatchingKeysForTargetId(l,r.targetId))).next((()=>a.li.addMatchingKeys(l,t,r.targetId))).next((()=>a.Pi.saveNamedQuery(l,e)))}))}const _1="firestore_clients";function NT(s,e){return`${_1}_${s}_${e}`}const b1="firestore_mutations";function RT(s,e,t){let r=`${b1}_${s}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const v1="firestore_targets";function k0(s,e){return`${v1}_${s}_${e}`}const Ns="SharedClientState";class Tm{constructor(e,t,r,a){this.user=e,this.batchId=t,this.state=r,this.error=a}static $s(e,t,r){const a=JSON.parse(r);let l,u=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return u&&a.error&&(u=typeof a.error.message=="string"&&typeof a.error.code=="string",u&&(l=new ce(a.error.code,a.error.message))),u?new Tm(e,t,a.state,l):(Kt(Ns,`Failed to parse mutation state for ID '${t}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pd{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static $s(e,t){const r=JSON.parse(t);let a,l=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return l&&r.error&&(l=typeof r.error.message=="string"&&typeof r.error.code=="string",l&&(a=new ce(r.error.code,r.error.message))),l?new pd(e,r.state,a):(Kt(Ns,`Failed to parse target state for ID '${e}': ${t}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Im{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const r=JSON.parse(t);let a=typeof r=="object"&&r.activeTargetIds instanceof Array,l=v_();for(let u=0;a&&u<r.activeTargetIds.length;++u)a=FS(r.activeTargetIds[u]),l=l.add(r.activeTargetIds[u]);return a?new Im(e,l):(Kt(Ns,`Failed to parse client data for instance '${e}': ${t}`),null)}}class M_{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new M_(t.clientId,t.onlineState):(Kt(Ns,`Failed to parse online state: ${e}`),null)}}class yy{constructor(){this.activeTargetIds=v_()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class D0{constructor(e,t,r,a,l){this.window=e,this.Ci=t,this.persistenceKey=r,this.zs=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new xt(Ve),this.started=!1,this.Zs=[];const u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=l,this.Xs=NT(this.persistenceKey,this.zs),this.Ys=(function(y){return`firestore_sequence_number_${y}`})(this.persistenceKey),this.Js=this.Js.insert(this.zs,new yy),this.eo=new RegExp(`^${_1}_${u}_([^_]*)$`),this.no=new RegExp(`^${b1}_${u}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${v1}_${u}_(\\d+)$`),this.io=(function(y){return`firestore_online_state_${y}`})(this.persistenceKey),this.so=(function(y){return`firestore_bundle_loaded_v2_${y}`})(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const a=this.getItem(NT(this.persistenceKey,r));if(a){const l=Im.$s(r,a);l&&(this.Js=this.Js.insert(l.clientId,l))}}this.oo();const t=this.storage.getItem(this.io);if(t){const r=this._o(t);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let t=!1;return this.Js.forEach(((r,a)=>{a.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,t,r){this.co(e,t,r),this.lo(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const a=this.storage.getItem(k0(this.persistenceKey,e));if(a){const l=pd.$s(e,a);l&&(r=l.state)}}return t&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(k0(this.persistenceKey,e))}updateQueryState(e,t,r){this.Po(e,t,r)}handleUserChange(e,t,r){t.forEach((a=>{this.lo(a)})),this.currentUser=e,r.forEach((a=>{this.addPendingMutation(a)}))}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return he(Ns,"READ",e,t),t}setItem(e,t){he(Ns,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){he(Ns,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const t=e;if(t.storageArea===this.storage){if(he(Ns,"EVENT",t.key,t.newValue),t.key===this.Xs)return void Kt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.eo.test(t.key)){if(t.newValue==null){const r=this.Eo(t.key);return this.Ro(r,null)}{const r=this.Ao(t.key,t.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(t.key)){if(t.newValue!==null){const r=this.Vo(t.key,t.newValue);if(r)return this.mo(r)}}else if(this.ro.test(t.key)){if(t.newValue!==null){const r=this.fo(t.key,t.newValue);if(r)return this.po(r)}}else if(t.key===this.io){if(t.newValue!==null){const r=this._o(t.newValue);if(r)return this.ao(r)}}else if(t.key===this.Ys){const r=(function(l){let u=sr.ce;if(l!=null)try{const p=JSON.parse(l);Ie(typeof p=="number",30636,{yo:l}),u=p}catch(p){Kt(Ns,"Failed to read sequence number from WebStorage",p)}return u})(t.newValue);r!==sr.ce&&this.sequenceNumberHandler(r)}else if(t.key===this.so){const r=this.wo(t.newValue);await Promise.all(r.map((a=>this.syncEngine.bo(a))))}}}else this.Zs.push(t)}))}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,t,r){const a=new Tm(this.currentUser,e,t,r),l=RT(this.persistenceKey,this.currentUser,e);this.setItem(l,a.Ws())}lo(e){const t=RT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}To(e){const t={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(t))}Po(e,t,r){const a=k0(this.persistenceKey,e),l=new pd(e,t,r);this.setItem(a,l.Ws())}Io(e){const t=JSON.stringify(Array.from(e));this.setItem(this.so,t)}Eo(e){const t=this.eo.exec(e);return t?t[1]:null}Ao(e,t){const r=this.Eo(e);return Im.$s(r,t)}Vo(e,t){const r=this.no.exec(e),a=Number(r[1]),l=r[2]!==void 0?r[2]:null;return Tm.$s(new yn(l),a,t)}fo(e,t){const r=this.ro.exec(e),a=Number(r[1]);return pd.$s(a,t)}_o(e){return M_.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);he(Ns,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,t){const r=t?this.Js.insert(e,t):this.Js.remove(e),a=this.uo(this.Js),l=this.uo(r),u=[],p=[];return l.forEach((y=>{a.has(y)||u.push(y)})),a.forEach((y=>{l.has(y)||p.push(y)})),this.syncEngine.Co(u,p).then((()=>{this.Js=r}))}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let t=v_();return e.forEach(((r,a)=>{t=t.unionWith(a.activeTargetIds)})),t}}class x1{constructor(){this.vo=new yy,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,r){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new yy,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class XM{Mo(e){}shutdown(){}}const CT="ConnectivityMonitor";class kT{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){he(CT,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){he(CT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Uf=null;function _y(){return Uf===null?Uf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Uf++,"0x"+Uf.toString(16)}const P0="RestConnection",JM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class ZM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${r}/databases/${a}`,this.$o=this.databaseId.database===ry?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Wo(e,t,r,a,l){const u=_y(),p=this.Qo(e,t.toUriEncodedString());he(P0,`Sending RPC '${e}' ${u}:`,p,r);const y={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(y,a,l);const{host:m}=new URL(p),b=Ec(m);return this.zo(e,p,y,r,b).then((E=>(he(P0,`Received RPC '${e}' ${u}: `,E),E)),(E=>{throw Bs(P0,`RPC '${e}' ${u} failed with error: `,E,"url: ",p,"request:",r),E}))}jo(e,t,r,a,l,u){return this.Wo(e,t,r,a,l)}Go(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Nc})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),r&&r.headers.forEach(((a,l)=>e[l]=a))}Qo(e,t){const r=JM[e];let a=`${this.qo}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(a=`${a}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),a}terminate(){}}class e4{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Pn="WebChannelConnection",Ku=(s,e,t)=>{s.listen(e,(r=>{try{t(r)}catch(a){setTimeout((()=>{throw a}),0)}}))};class Jl extends ZM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Jl.c_){const e=CS();Ku(e,RS.STAT_EVENT,(t=>{t.stat===W0.PROXY?he(Pn,"STAT_EVENT: detected buffering proxy"):t.stat===W0.NOPROXY&&he(Pn,"STAT_EVENT: detected no buffering proxy")})),Jl.c_=!0}}zo(e,t,r,a,l){const u=_y();return new Promise(((p,y)=>{const m=new AS;m.setWithCredentials(!0),m.listenOnce(NS.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Gf.NO_ERROR:const E=m.getResponseJson();he(Pn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(E)),p(E);break;case Gf.TIMEOUT:he(Pn,`RPC '${e}' ${u} timed out`),y(new ce(W.DEADLINE_EXCEEDED,"Request time out"));break;case Gf.HTTP_ERROR:const I=m.getStatus();if(he(Pn,`RPC '${e}' ${u} failed with status:`,I,"response text:",m.getResponseText()),I>0){let S=m.getResponseJson();Array.isArray(S)&&(S=S[0]);const M=S?.error;if(M&&M.status&&M.message){const z=(function(Q){const ae=Q.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(ae)>=0?ae:W.UNKNOWN})(M.status);y(new ce(z,M.message))}else y(new ce(W.UNKNOWN,"Server responded with status "+m.getStatus()))}else y(new ce(W.UNAVAILABLE,"Connection failed."));break;default:ve(9055,{l_:e,streamId:u,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{he(Pn,`RPC '${e}' ${u} completed.`)}}));const b=JSON.stringify(a);he(Pn,`RPC '${e}' ${u} sending request:`,a),m.send(t,"POST",b,r,15)}))}T_(e,t,r){const a=_y(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(p.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,t,r),p.encodeInitMessageHeaders=!0;const m=l.join("");he(Pn,`Creating RPC '${e}' stream ${a}: ${m}`,p);const b=u.createWebChannel(m,p);this.I_(b);let E=!1,I=!1;const S=new e4({Ho:M=>{I?he(Pn,`Not sending because RPC '${e}' stream ${a} is closed:`,M):(E||(he(Pn,`Opening RPC '${e}' stream ${a} transport.`),b.open(),E=!0),he(Pn,`RPC '${e}' stream ${a} sending:`,M),b.send(M))},Jo:()=>b.close()});return Ku(b,Xu.EventType.OPEN,(()=>{I||(he(Pn,`RPC '${e}' stream ${a} transport opened.`),S.i_())})),Ku(b,Xu.EventType.CLOSE,(()=>{I||(I=!0,he(Pn,`RPC '${e}' stream ${a} transport closed`),S.o_(),this.E_(b))})),Ku(b,Xu.EventType.ERROR,(M=>{I||(I=!0,Bs(Pn,`RPC '${e}' stream ${a} transport errored. Name:`,M.name,"Message:",M.message),S.o_(new ce(W.UNAVAILABLE,"The operation could not be completed")))})),Ku(b,Xu.EventType.MESSAGE,(M=>{if(!I){const z=M.data[0];Ie(!!z,16349);const ee=z,Q=ee?.error||ee[0]?.error;if(Q){he(Pn,`RPC '${e}' stream ${a} received error:`,Q);const ae=Q.status;let se=(function(Z){const k=an[Z];if(k!==void 0)return PA(k)})(ae),xe=Q.message;se===void 0&&(se=W.INTERNAL,xe="Unknown error status: "+ae+" with message "+Q.message),I=!0,S.o_(new ce(se,xe)),b.close()}else he(Pn,`RPC '${e}' stream ${a} received:`,z),S.__(z)}})),Jl.u_(),setTimeout((()=>{S.s_()}),0),S}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,r){super.Go(e,t,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return kS()}}function t4(s){return new Jl(s)}function w1(){return typeof window<"u"?window:null}function tm(){return typeof document<"u"?document:null}function nh(s){return new aM(s,!0)}Jl.c_=!1;class L_{constructor(e,t,r=1e3,a=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=r,this.A_=a,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-r);a>0&&he("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const DT="PersistentStream";class E1{constructor(e,t,r,a,l,u,p,y){this.Ci=e,this.b_=r,this.S_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=p,this.listener=y,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new L_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===W.RESOURCE_EXHAUSTED?(Kt(t.toString()),Kt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.D_===t&&this.G_(r,a)}),(r=>{e((()=>{const a=new ce(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(a)}))}))}G_(e,t){const r=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((a=>{r((()=>this.z_(a)))})),this.stream.onMessage((a=>{r((()=>++this.F_==1?this.H_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return he(DT,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(he(DT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class n4 extends E1{constructor(e,t,r,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,u),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=cM(this.serializer,e),r=(function(l){if(!("targetChange"in l))return Ne.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Ne.min():u.readTime?$t(u.readTime):Ne.min()})(e);return this.listener.J_(t,r)}Z_(e){const t={};t.database=hy(this.serializer),t.addTarget=(function(l,u){let p;const y=u.target;if(p=gm(y)?{documents:FA(l,y)}:{query:HA(l,y).ft},p.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){p.resumeToken=MA(l,u.resumeToken);const m=uy(l,u.expectedCount);m!==null&&(p.expectedCount=m)}else if(u.snapshotVersion.compareTo(Ne.min())>0){p.readTime=pc(l,u.snapshotVersion.toTimestamp());const m=uy(l,u.expectedCount);m!==null&&(p.expectedCount=m)}return p})(this.serializer,e);const r=dM(this.serializer,e);r&&(t.labels=r),this.K_(t)}X_(e){const t={};t.database=hy(this.serializer),t.removeTarget=e,this.K_(t)}}class r4 extends E1{constructor(e,t,r,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,u),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return Ie(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ie(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ie(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=uM(e.writeResults,e.commitTime),r=$t(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=hy(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>jd(this.serializer,r)))};this.K_(t)}}class s4{}class i4 extends s4{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new ce(W.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Wo(e,dy(t,r),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ce(W.UNKNOWN,l.toString())}))}jo(e,t,r,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,p])=>this.connection.jo(e,dy(t,r),a,u,p,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ce(W.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function a4(s,e,t,r){return new i4(s,e,t,r)}class o4{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Kt(t),this.aa=!1):he("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Lo="RemoteStore";class l4{constructor(e,t,r,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((u=>{r.enqueueAndForget((async()=>{ka(this)&&(he(Lo,"Restarting streams for network reachability change."),await(async function(y){const m=_e(y);m.Ea.add(4),await Dc(m),m.Va.set("Unknown"),m.Ea.delete(4),await rh(m)})(this))}))})),this.Va=new o4(r,a)}}async function rh(s){if(ka(s))for(const e of s.Ra)await e(!0)}async function Dc(s){for(const e of s.Ra)await e(!1)}function tp(s,e){const t=_e(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),B_(t)?z_(t):jc(t).O_()&&U_(t,e))}function _c(s,e){const t=_e(s),r=jc(t);t.Ia.delete(e),r.O_()&&T1(t,e),t.Ia.size===0&&(r.O_()?r.L_():ka(t)&&t.Va.set("Unknown"))}function U_(s,e){if(s.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ne.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}jc(s).Z_(e)}function T1(s,e){s.da.$e(e),jc(s).X_(e)}function z_(s){s.da=new nM({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),jc(s).start(),s.Va.ua()}function B_(s){return ka(s)&&!jc(s).x_()&&s.Ia.size>0}function ka(s){return _e(s).Ea.size===0}function I1(s){s.da=void 0}async function c4(s){s.Va.set("Online")}async function u4(s){s.Ia.forEach(((e,t)=>{U_(s,e)}))}async function d4(s,e){I1(s),B_(s)?(s.Va.ha(e),z_(s)):s.Va.set("Unknown")}async function h4(s,e,t){if(s.Va.set("Online"),e instanceof OA&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const p of l.targetIds)a.Ia.has(p)&&(await a.remoteSyncer.rejectListen(p,u),a.Ia.delete(p),a.da.removeTarget(p))})(s,e)}catch(r){he(Lo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Sm(s,r)}else if(e instanceof Zf?s.da.Xe(e):e instanceof VA?s.da.st(e):s.da.tt(e),!t.isEqual(Ne.min()))try{const r=await f1(s.localStore);t.compareTo(r)>=0&&await(function(l,u){const p=l.da.Tt(u);return p.targetChanges.forEach(((y,m)=>{if(y.resumeToken.approximateByteSize()>0){const b=l.Ia.get(m);b&&l.Ia.set(m,b.withResumeToken(y.resumeToken,u))}})),p.targetMismatches.forEach(((y,m)=>{const b=l.Ia.get(y);if(!b)return;l.Ia.set(y,b.withResumeToken(Ut.EMPTY_BYTE_STRING,b.snapshotVersion)),T1(l,y);const E=new ui(b.target,y,m,b.sequenceNumber);U_(l,E)})),l.remoteSyncer.applyRemoteEvent(p)})(s,t)}catch(r){he(Lo,"Failed to raise snapshot:",r),await Sm(s,r)}}async function Sm(s,e,t){if(!Ra(e))throw e;s.Ea.add(1),await Dc(s),s.Va.set("Offline"),t||(t=()=>f1(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{he(Lo,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await rh(s)}))}function S1(s,e){return e().catch((t=>Sm(s,t,e)))}async function Pc(s){const e=_e(s),t=Ta(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:fa;for(;f4(e);)try{const a=await $M(e.localStore,r);if(a===null){e.Ta.length===0&&t.L_();break}r=a.batchId,m4(e,a)}catch(a){await Sm(e,a)}A1(e)&&N1(e)}function f4(s){return ka(s)&&s.Ta.length<10}function m4(s,e){s.Ta.push(e);const t=Ta(s);t.O_()&&t.Y_&&t.ea(e.mutations)}function A1(s){return ka(s)&&!Ta(s).x_()&&s.Ta.length>0}function N1(s){Ta(s).start()}async function p4(s){Ta(s).ra()}async function g4(s){const e=Ta(s);for(const t of s.Ta)e.ea(t.mutations)}async function y4(s,e,t){const r=s.Ta.shift(),a=T_.from(r,e,t);await S1(s,(()=>s.remoteSyncer.applySuccessfulWrite(a))),await Pc(s)}async function _4(s,e){e&&Ta(s).Y_&&await(async function(r,a){if((function(u){return DA(u)&&u!==W.ABORTED})(a.code)){const l=r.Ta.shift();Ta(r).B_(),await S1(r,(()=>r.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Pc(r)}})(s,e),A1(s)&&N1(s)}async function PT(s,e){const t=_e(s);t.asyncQueue.verifyOperationInProgress(),he(Lo,"RemoteStore received new credentials");const r=ka(t);t.Ea.add(3),await Dc(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await rh(t)}async function by(s,e){const t=_e(s);e?(t.Ea.delete(2),await rh(t)):e||(t.Ea.add(2),await Dc(t),t.Va.set("Unknown"))}function jc(s){return s.ma||(s.ma=(function(t,r,a){const l=_e(t);return l.sa(),new n4(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:c4.bind(null,s),Yo:u4.bind(null,s),t_:d4.bind(null,s),J_:h4.bind(null,s)}),s.Ra.push((async e=>{e?(s.ma.B_(),B_(s)?z_(s):s.Va.set("Unknown")):(await s.ma.stop(),I1(s))}))),s.ma}function Ta(s){return s.fa||(s.fa=(function(t,r,a){const l=_e(t);return l.sa(),new r4(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(s.datastore,s.asyncQueue,{Zo:()=>Promise.resolve(),Yo:p4.bind(null,s),t_:_4.bind(null,s),ta:g4.bind(null,s),na:y4.bind(null,s)}),s.Ra.push((async e=>{e?(s.fa.B_(),await Pc(s)):(await s.fa.stop(),s.Ta.length>0&&(he(Lo,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}class q_{constructor(e,t,r,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=l,this.deferred=new Nn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,l){const u=Date.now()+r,p=new q_(e,t,u,a,l);return p.start(r),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ce(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Vc(s,e){if(Kt("AsyncQueue",`${e}: ${s}`),Ra(s))return new ce(W.UNAVAILABLE,`${e}: ${s}`);throw s}class Zl{static emptySet(e){return new Zl(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ye.comparator(t.key,r.key):(t,r)=>ye.comparator(t.key,r.key),this.keyedMap=Ju(),this.sortedSet=new xt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Zl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=r.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Zl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class jT{constructor(){this.ga=new xt(ye.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ve(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class bc{constructor(e,t,r,a,l,u,p,y,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=p,this.excludesMetadataChanges=y,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,a,l){const u=[];return t.forEach((p=>{u.push({type:0,doc:p})})),new bc(e,t,Zl.emptySet(t),u,r,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}class b4{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class v4{constructor(){this.queries=VT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const a=_e(t),l=a.queries;a.queries=VT(),l.forEach(((u,p)=>{for(const y of p.ba)y.onError(r)}))})(this,new ce(W.ABORTED,"Firestore shutting down"))}}function VT(){return new bi((s=>_A(s)),Xd)}async function F_(s,e){const t=_e(s);let r=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.Da()&&(r=2):(l=new b4,r=e.Da()?0:1);try{switch(r){case 0:l.wa=await t.onListen(a,!0);break;case 1:l.wa=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(u){const p=Vc(u,`Initialization of query '${ql(e.query)}' failed`);return void e.onError(p)}t.queries.set(a,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&G_(t)}async function H_(s,e){const t=_e(s),r=e.query;let a=3;const l=t.queries.get(r);if(l){const u=l.ba.indexOf(e);u>=0&&(l.ba.splice(u,1),l.ba.length===0?a=e.Da()?0:1:!l.Sa()&&e.Da()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function x4(s,e){const t=_e(s);let r=!1;for(const a of e){const l=a.query,u=t.queries.get(l);if(u){for(const p of u.ba)p.Fa(a)&&(r=!0);u.wa=a}}r&&G_(t)}function w4(s,e,t){const r=_e(s),a=r.queries.get(e);if(a)for(const l of a.ba)l.onError(t);r.queries.delete(e)}function G_(s){s.Ca.forEach((e=>{e.next()}))}var vy,OT;(OT=vy||(vy={})).Ma="default",OT.Cache="cache";class Q_{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new bc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=bc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==vy.Cache}}class E4{constructor(e,t){this.qa=e,this.byteLength=t}Ua(){return"metadata"in this.qa}}class MT{constructor(e){this.serializer=e}Ks(e){return Ls(this.serializer,e)}qs(e){return e.metadata.exists?qA(this.serializer,e.document,!1):It.newNoDocument(this.Ks(e.metadata.name),this.Us(e.metadata.readTime))}Us(e){return $t(e)}}class T4{constructor(e,t){this.$a=e,this.serializer=t,this.Wa=[],this.Qa=[],this.collectionGroups=new Set,this.progress=R1(e)}get queries(){return this.Wa}get documents(){return this.Qa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.qa.namedQuery)this.Wa.push(e.qa.namedQuery);else if(e.qa.documentMetadata){this.Qa.push({metadata:e.qa.documentMetadata}),e.qa.documentMetadata.exists||++t;const r=$e.fromString(e.qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.qa.document&&(this.Qa[this.Qa.length-1].document=e.qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,{...this.progress}):null}za(e){const t=new Map,r=new MT(this.serializer);for(const a of e)if(a.metadata.queries){const l=r.Ks(a.metadata.name);for(const u of a.metadata.queries){const p=(t.get(u)||Be()).add(l);t.set(u,p)}}return t}async ja(e){const t=await YM(e,new MT(this.serializer),this.Qa,this.$a.id),r=this.za(this.documents);for(const a of this.Wa)await WM(e,a,r.get(a.name));return this.progress.taskState="Success",{progress:this.progress,Ha:this.collectionGroups,Ja:t}}}function R1(s){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:s.totalDocuments,totalBytes:s.totalBytes}}class C1{constructor(e){this.key=e}}class k1{constructor(e){this.key=e}}class D1{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Be(),this.mutatedKeys=Be(),this.eu=vA(e),this.tu=new Zl(this.eu)}get nu(){return this.Za}ru(e,t){const r=t?t.iu:new jT,a=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,u=a,p=!1;const y=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((b,E)=>{const I=a.get(b),S=Jd(this.query,E)?E:null,M=!!I&&this.mutatedKeys.has(I.key),z=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let ee=!1;I&&S?I.data.isEqual(S.data)?M!==z&&(r.track({type:3,doc:S}),ee=!0):this.su(I,S)||(r.track({type:2,doc:S}),ee=!0,(y&&this.eu(S,y)>0||m&&this.eu(S,m)<0)&&(p=!0)):!I&&S?(r.track({type:0,doc:S}),ee=!0):I&&!S&&(r.track({type:1,doc:I}),ee=!0,(y||m)&&(p=!0)),ee&&(S?(u=u.add(S),l=z?l.add(b):l.delete(b)):(u=u.delete(b),l=l.delete(b)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const b=this.query.limitType==="F"?u.last():u.first();u=u.delete(b.key),l=l.delete(b.key),r.track({type:1,doc:b})}return{tu:u,iu:r,Ss:p,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((b,E)=>(function(S,M){const z=ee=>{switch(ee){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ve(20277,{Vt:ee})}};return z(S)-z(M)})(b.type,E.type)||this.eu(b.doc,E.doc))),this.ou(r),a=a??!1;const p=t&&!a?this._u():[],y=this.Ya.size===0&&this.current&&!a?1:0,m=y!==this.Xa;return this.Xa=y,u.length!==0||m?{snapshot:new bc(this.query,e.tu,l,u,e.mutatedKeys,y===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new jT,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=Be(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const t=[];return e.forEach((r=>{this.Ya.has(r)||t.push(new k1(r))})),this.Ya.forEach((r=>{e.has(r)||t.push(new C1(r))})),t}cu(e){this.Za=e.ks,this.Ya=Be();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return bc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Da="SyncEngine";class I4{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class S4{constructor(e){this.key=e,this.hu=!1}}class A4{constructor(e,t,r,a,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new bi((p=>_A(p)),Xd),this.Iu=new Map,this.Eu=new Set,this.Ru=new xt(ye.comparator),this.Au=new Map,this.Vu=new k_,this.du={},this.mu=new Map,this.fu=Mo.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function N4(s,e,t=!0){const r=np(s);let a;const l=r.Tu.get(e);return l?(r.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await P1(r,e,t,!0),a}async function R4(s,e){const t=np(s);await P1(t,e,!0,!1)}async function P1(s,e,t,r){const a=await gc(s.localStore,Gn(e)),l=a.targetId,u=s.sharedClientState.addLocalQueryTarget(l,t);let p;return r&&(p=await K_(s,e,l,u==="current",a.resumeToken)),s.isPrimaryClient&&t&&tp(s.remoteStore,a),p}async function K_(s,e,t,r,a){s.pu=(E,I,S)=>(async function(z,ee,Q,ae){let se=ee.view.ru(Q);se.Ss&&(se=await Em(z.localStore,ee.query,!1).then((({documents:k})=>ee.view.ru(k,se))));const xe=ae&&ae.targetChanges.get(ee.targetId),oe=ae&&ae.targetMismatches.get(ee.targetId)!=null,Z=ee.view.applyChanges(se,z.isPrimaryClient,xe,oe);return xy(z,ee.targetId,Z.au),Z.snapshot})(s,E,I,S);const l=await Em(s.localStore,e,!0),u=new D1(e,l.ks),p=u.ru(l.documents),y=th.createSynthesizedTargetChangeForCurrentChange(t,r&&s.onlineState!=="Offline",a),m=u.applyChanges(p,s.isPrimaryClient,y);xy(s,t,m.au);const b=new I4(e,t,u);return s.Tu.set(e,b),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),m.snapshot}async function C4(s,e,t){const r=_e(s),a=r.Tu.get(e),l=r.Iu.get(a.targetId);if(l.length>1)return r.Iu.set(a.targetId,l.filter((u=>!Xd(u,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await yc(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),t&&_c(r.remoteStore,a.targetId),vc(r,a.targetId)})).catch(Na)):(vc(r,a.targetId),await yc(r.localStore,a.targetId,!0))}async function k4(s,e){const t=_e(s),r=t.Tu.get(e),a=t.Iu.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),_c(t.remoteStore,r.targetId))}async function D4(s,e,t){const r=X_(s);try{const a=await(function(u,p){const y=_e(u),m=lt.now(),b=p.reduce(((S,M)=>S.add(M.key)),Be());let E,I;return y.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let M=ar(),z=Be();return y.xs.getEntries(S,b).next((ee=>{M=ee,M.forEach(((Q,ae)=>{ae.isValidDocument()||(z=z.add(Q))}))})).next((()=>y.localDocuments.getOverlayedDocuments(S,M))).next((ee=>{E=ee;const Q=[];for(const ae of p){const se=ZO(ae,E.get(ae.key).overlayedDocument);se!=null&&Q.push(new vi(ae.key,se,cA(se.value.mapValue),kt.exists(!0)))}return y.mutationQueue.addMutationBatch(S,m,Q,p)})).next((ee=>{I=ee;const Q=ee.applyToLocalDocumentSet(E,z);return y.documentOverlayCache.saveOverlays(S,ee.batchId,Q)}))})).then((()=>({batchId:I.batchId,changes:wA(E)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(u,p,y){let m=u.du[u.currentUser.toKey()];m||(m=new xt(Ve)),m=m.insert(p,y),u.du[u.currentUser.toKey()]=m})(r,a.batchId,t),await xi(r,a.changes),await Pc(r.remoteStore)}catch(a){const l=Vc(a,"Failed to persist write");t.reject(l)}}async function j1(s,e){const t=_e(s);try{const r=await KM(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=t.Au.get(l);u&&(Ie(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?Ie(u.hu,14607):a.removedDocuments.size>0&&(Ie(u.hu,42227),u.hu=!1))})),await xi(t,r,e)}catch(r){await Na(r)}}function LT(s,e,t){const r=_e(s);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Tu.forEach(((l,u)=>{const p=u.view.va(e);p.snapshot&&a.push(p.snapshot)})),(function(u,p){const y=_e(u);y.onlineState=p;let m=!1;y.queries.forEach(((b,E)=>{for(const I of E.ba)I.va(p)&&(m=!0)})),m&&G_(y)})(r.eventManager,e),a.length&&r.Pu.J_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function P4(s,e,t){const r=_e(s);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Au.get(e),l=a&&a.key;if(l){let u=new xt(ye.comparator);u=u.insert(l,It.newNoDocument(l,Ne.min()));const p=Be().add(l),y=new eh(Ne.min(),new Map,new xt(Ve),u,p);await j1(r,y),r.Ru=r.Ru.remove(l),r.Au.delete(e),W_(r)}else await yc(r.localStore,e,!1).then((()=>vc(r,e,t))).catch(Na)}async function j4(s,e){const t=_e(s),r=e.batch.batchId;try{const a=await QM(t.localStore,e);Y_(t,r,null),$_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await xi(t,a)}catch(a){await Na(a)}}async function V4(s,e,t){const r=_e(s);try{const a=await(function(u,p){const y=_e(u);return y.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let b;return y.mutationQueue.lookupMutationBatch(m,p).next((E=>(Ie(E!==null,37113),b=E.keys(),y.mutationQueue.removeMutationBatch(m,E)))).next((()=>y.mutationQueue.performConsistencyCheck(m))).next((()=>y.documentOverlayCache.removeOverlaysForBatchId(m,b,p))).next((()=>y.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,b))).next((()=>y.localDocuments.getDocuments(m,b)))}))})(r.localStore,e);Y_(r,e,t),$_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await xi(r,a)}catch(a){await Na(a)}}async function O4(s,e){const t=_e(s);ka(t.remoteStore)||he(Da,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(u){const p=_e(u);return p.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(y=>p.mutationQueue.getHighestUnacknowledgedBatchId(y)))})(t.localStore);if(r===fa)return void e.resolve();const a=t.mu.get(r)||[];a.push(e),t.mu.set(r,a)}catch(r){const a=Vc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(a)}}function $_(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function Y_(s,e,t){const r=_e(s);let a=r.du[r.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),r.du[r.currentUser.toKey()]=a}}function vc(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const r of s.Iu.get(e))s.Tu.delete(r),t&&s.Pu.yu(r,t);s.Iu.delete(e),s.isPrimaryClient&&s.Vu.Gr(e).forEach((r=>{s.Vu.containsKey(r)||V1(s,r)}))}function V1(s,e){s.Eu.delete(e.path.canonicalString());const t=s.Ru.get(e);t!==null&&(_c(s.remoteStore,t),s.Ru=s.Ru.remove(e),s.Au.delete(t),W_(s))}function xy(s,e,t){for(const r of t)r instanceof C1?(s.Vu.addReference(r.key,e),M4(s,r)):r instanceof k1?(he(Da,"Document no longer in limbo: "+r.key),s.Vu.removeReference(r.key,e),s.Vu.containsKey(r.key)||V1(s,r.key)):ve(19791,{wu:r})}function M4(s,e){const t=e.key,r=t.path.canonicalString();s.Ru.get(t)||s.Eu.has(r)||(he(Da,"New document in limbo: "+t),s.Eu.add(r),W_(s))}function W_(s){for(;s.Eu.size>0&&s.Ru.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new ye($e.fromString(e)),r=s.fu.next();s.Au.set(r,new S4(t)),s.Ru=s.Ru.insert(t,r),tp(s.remoteStore,new ui(Gn(Rc(t.path)),r,"TargetPurposeLimboResolution",sr.ce))}}async function xi(s,e,t){const r=_e(s),a=[],l=[],u=[];r.Tu.isEmpty()||(r.Tu.forEach(((p,y)=>{u.push(r.pu(y,e,t).then((m=>{if((m||t)&&r.isPrimaryClient){const b=m?!m.fromCache:t?.targetChanges.get(y.targetId)?.current;r.sharedClientState.updateQueryState(y.targetId,b?"current":"not-current")}if(m){a.push(m);const b=V_.Es(y.targetId,m);l.push(b)}})))})),await Promise.all(u),r.Pu.J_(a),await(async function(y,m){const b=_e(y);try{await b.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>U.forEach(m,(I=>U.forEach(I.Ts,(S=>b.persistence.referenceDelegate.addReference(E,I.targetId,S))).next((()=>U.forEach(I.Is,(S=>b.persistence.referenceDelegate.removeReference(E,I.targetId,S)))))))))}catch(E){if(!Ra(E))throw E;he(O_,"Failed to update sequence numbers: "+E)}for(const E of m){const I=E.targetId;if(!E.fromCache){const S=b.vs.get(I),M=S.snapshotVersion,z=S.withLastLimboFreeSnapshotVersion(M);b.vs=b.vs.insert(I,z)}}})(r.localStore,l))}async function L4(s,e){const t=_e(s);if(!t.currentUser.isEqual(e)){he(Da,"User change. New user:",e.toKey());const r=await h1(t.localStore,e);t.currentUser=e,(function(l,u){l.mu.forEach((p=>{p.forEach((y=>{y.reject(new ce(W.CANCELLED,u))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await xi(t,r.Ns)}}function U4(s,e){const t=_e(s),r=t.Au.get(e);if(r&&r.hu)return Be().add(r.key);{let a=Be();const l=t.Iu.get(e);if(!l)return a;for(const u of l){const p=t.Tu.get(u);a=a.unionWith(p.view.nu)}return a}}async function z4(s,e){const t=_e(s),r=await Em(t.localStore,e.query,!0),a=e.view.cu(r);return t.isPrimaryClient&&xy(t,e.targetId,a.au),a}async function B4(s,e){const t=_e(s);return g1(t.localStore,e).then((r=>xi(t,r)))}async function q4(s,e,t,r){const a=_e(s),l=await(function(p,y){const m=_e(p),b=_e(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",(E=>b.Xn(E,y).next((I=>I?m.localDocuments.getDocuments(E,I):U.resolve(null)))))})(a.localStore,e);l!==null?(t==="pending"?await Pc(a.remoteStore):t==="acknowledged"||t==="rejected"?(Y_(a,e,r||null),$_(a,e),(function(p,y){_e(_e(p).mutationQueue).nr(y)})(a.localStore,e)):ve(6720,"Unknown batchState",{bu:t}),await xi(a,l)):he(Da,"Cannot apply mutation batch with id: "+e)}async function F4(s,e){const t=_e(s);if(np(t),X_(t),e===!0&&t.gu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),a=await UT(t,r.toArray());t.gu=!0,await by(t.remoteStore,!0);for(const l of a)tp(t.remoteStore,l)}else if(e===!1&&t.gu!==!1){const r=[];let a=Promise.resolve();t.Iu.forEach(((l,u)=>{t.sharedClientState.isLocalQueryTarget(u)?r.push(u):a=a.then((()=>(vc(t,u),yc(t.localStore,u,!0)))),_c(t.remoteStore,u)})),await a,await UT(t,r),(function(u){const p=_e(u);p.Au.forEach(((y,m)=>{_c(p.remoteStore,m)})),p.Vu.zr(),p.Au=new Map,p.Ru=new xt(ye.comparator)})(t),t.gu=!1,await by(t.remoteStore,!1)}}async function UT(s,e,t){const r=_e(s),a=[],l=[];for(const u of e){let p;const y=r.Iu.get(u);if(y&&y.length!==0){p=await gc(r.localStore,Gn(y[0]));for(const m of y){const b=r.Tu.get(m),E=await z4(r,b);E.snapshot&&l.push(E.snapshot)}}else{const m=await p1(r.localStore,u);p=await gc(r.localStore,m),await K_(r,O1(m),u,!1,p.resumeToken)}a.push(p)}return r.Pu.J_(l),a}function O1(s){return yA(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function H4(s){return(function(t){return _e(_e(t).persistence).hs()})(_e(s).localStore)}async function G4(s,e,t,r){const a=_e(s);if(a.gu)return void he(Da,"Ignoring unexpected query state notification.");const l=a.Iu.get(e);if(l&&l.length>0)switch(t){case"current":case"not-current":{const u=await g1(a.localStore,bA(l[0])),p=eh.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ut.EMPTY_BYTE_STRING);await xi(a,u,p);break}case"rejected":await yc(a.localStore,e,!0),vc(a,e,r);break;default:ve(64155,t)}}async function Q4(s,e,t){const r=np(s);if(r.gu){for(const a of e){if(r.Iu.has(a)&&r.sharedClientState.isActiveQueryTarget(a)){he(Da,"Adding an already active target "+a);continue}const l=await p1(r.localStore,a),u=await gc(r.localStore,l);await K_(r,O1(l),u.targetId,!1,u.resumeToken),tp(r.remoteStore,u)}for(const a of t)r.Iu.has(a)&&await yc(r.localStore,a,!1).then((()=>{_c(r.remoteStore,a),vc(r,a)})).catch(Na)}}function np(s){const e=_e(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=j1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=U4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=P4.bind(null,e),e.Pu.J_=x4.bind(null,e.eventManager),e.Pu.yu=w4.bind(null,e.eventManager),e}function X_(s){const e=_e(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=j4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=V4.bind(null,e),e}function K4(s,e,t){const r=_e(s);(async function(l,u,p){try{const y=await u.getMetadata();if(await(function(S,M){const z=_e(S),ee=$t(M.createTime);return z.persistence.runTransaction("hasNewerBundle","readonly",(Q=>z.Pi.getBundleMetadata(Q,M.id))).then((Q=>!!Q&&Q.createTime.compareTo(ee)>=0))})(l.localStore,y))return await u.close(),p._completeWith((function(S){return{taskState:"Success",documentsLoaded:S.totalDocuments,bytesLoaded:S.totalBytes,totalDocuments:S.totalDocuments,totalBytes:S.totalBytes}})(y)),Promise.resolve(new Set);p._updateProgress(R1(y));const m=new T4(y,u.serializer);let b=await u.Su();for(;b;){const I=await m.Ga(b);I&&p._updateProgress(I),b=await u.Su()}const E=await m.ja(l.localStore);return await xi(l,E.Ja,void 0),await(function(S,M){const z=_e(S);return z.persistence.runTransaction("Save bundle","readwrite",(ee=>z.Pi.saveBundleMetadata(ee,M)))})(l.localStore,y),p._completeWith(E.progress),Promise.resolve(E.Ha)}catch(y){return Bs(Da,`Loading bundle failed with ${y}`),p._failWith(y),Promise.resolve(new Set)}})(r,e,t).then((a=>{r.sharedClientState.notifyBundleLoaded(a)}))}class Vd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=nh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return d1(this.persistence,new u1,e.initialUser,this.serializer)}Cu(e){return new D_(ep.Vi,this.serializer)}Du(e){return new x1}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vd.provider={build:()=>new Vd};class $4 extends Vd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ie(this.persistence.referenceDelegate instanceof wm,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new s1(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new D_((r=>wm.Vi(r,t)),this.serializer)}}class M1 extends Vd{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await X_(this.xu.syncEngine),await Pc(this.xu.remoteStore),await this.persistence.zi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return d1(this.persistence,new u1,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new s1(r,e.asyncQueue,t)}Mu(e,t){const r=new XV(t,this.persistence);return new WV(e.asyncQueue,r)}Cu(e){const t=j_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?jn.withCacheSize(this.cacheSizeBytes):jn.DEFAULT;return new P_(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,w1(),tm(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new x1}}class Y4 extends M1{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof D0&&(this.sharedClientState.syncEngine={So:q4.bind(null,t),Do:G4.bind(null,t),Co:Q4.bind(null,t),hs:H4.bind(null,t),bo:B4.bind(null,t)},await this.sharedClientState.start()),await this.persistence.zi((async r=>{await F4(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Du(e){const t=w1();if(!D0.v(t))throw new ce(W.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=j_(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new D0(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Od{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>LT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=L4.bind(null,this.syncEngine),await by(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new v4})()}createDatastore(e){const t=nh(e.databaseInfo.databaseId),r=t4(e.databaseInfo);return a4(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,a,l,u,p){return new l4(r,a,l,u,p)})(this.localStore,this.datastore,e.asyncQueue,(t=>LT(this.syncEngine,t,0)),(function(){return kT.v()?new kT:new XM})())}createSyncEngine(e,t){return(function(a,l,u,p,y,m,b){const E=new A4(a,l,u,p,y,m);return b&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=_e(t);he(Lo,"RemoteStore shutting down."),r.Ea.add(5),await Dc(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Od.provider={build:()=>new Od};function zT(s,e=10240){let t=0;return{async read(){if(t<s.byteLength){const r={value:s.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class rp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Kt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class W4{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new Nn,this.buffer=new Uint8Array,this.Lu=(function(){return new TextDecoder("utf-8")})(),this.ku().then((r=>{r&&r.Ua()?this.metadata.resolve(r.qa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.qa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async Su(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.Ku();if(e===null)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.qu(`length string (${t}) is not valid number`);const a=await this.Uu(r);return new E4(JSON.parse(a),e.length+r)}$u(){return this.buffer.findIndex((e=>e===123))}async Ku(){for(;this.$u()<0&&!await this.Wu(););if(this.buffer.length===0)return null;const e=this.$u();e<0&&this.qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Uu(e){for(;this.buffer.length<e;)await this.Wu()&&this.qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}qu(e){throw this.Bu.cancel(),new Error(`Invalid bundle format: ${e}`)}async Wu(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}let X4=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ce(W.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(a,l){const u=_e(a),p={documents:l.map((E=>Pd(u.serializer,E)))},y=await u.jo("BatchGetDocuments",u.serializer.databaseId,$e.emptyPath(),p,l.length),m=new Map;y.forEach((E=>{const I=lM(u.serializer,E);m.set(I.key.toString(),I)}));const b=[];return l.forEach((E=>{const I=m.get(E.toString());Ie(!!I,55234,{key:E}),b.push(I)})),b})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new kc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const a=ye.fromPath(r);this.mutations.push(new w_(a,this.precondition(a)))})),await(async function(r,a){const l=_e(r),u={writes:a.map((p=>jd(l.serializer,p)))};await l.Wo("Commit",l.serializer.databaseId,$e.emptyPath(),u)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ve(50498,{Gu:e.constructor.name});t=Ne.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ce(W.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ne.min())?kt.exists(!1):kt.updateTime(t):kt.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ne.min()))throw new ce(W.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return kt.updateTime(t)}return kt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};class J4{constructor(e,t,r,a,l){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=a,this.deferred=l,this.zu=r.maxAttempts,this.M_=new L_(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_((async()=>{const e=new X4(this.datastore),t=this.Ju(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((a=>{this.Zu(a)}))))})).catch((r=>{this.Zu(r)}))}))}Ju(e){try{const t=this.updateFunction(e);return!$d(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Hu(),Promise.resolve())))):this.deferred.reject(e)}Xu(e){if(e?.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!DA(t)}return!1}}const Ia="FirestoreClient";class Z4{constructor(e,t,r,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this._databaseInfo=a,this.user=yn.UNAUTHENTICATED,this.clientId=l_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(r,(async u=>{he(Ia,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(r,(u=>(he(Ia,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Nn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Vc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function j0(s,e){s.asyncQueue.verifyOperationInProgress(),he(Ia,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let r=t.initialUser;s.setCredentialChangeListener((async a=>{r.isEqual(a)||(await h1(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function BT(s,e){s.asyncQueue.verifyOperationInProgress();const t=await J_(s);he(Ia,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((r=>PT(e.remoteStore,r))),s.setAppCheckTokenChangeListener(((r,a)=>PT(e.remoteStore,a))),s._onlineComponents=e}async function J_(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){he(Ia,"Using user provided OfflineComponentProvider");try{await j0(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===W.FAILED_PRECONDITION||a.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Bs("Error using user provided cache. Falling back to memory cache: "+t),await j0(s,new Vd)}}else he(Ia,"Using default OfflineComponentProvider"),await j0(s,new $4(void 0));return s._offlineComponents}async function sp(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(he(Ia,"Using user provided OnlineComponentProvider"),await BT(s,s._uninitializedComponentsProvider._online)):(he(Ia,"Using default OnlineComponentProvider"),await BT(s,new Od))),s._onlineComponents}function L1(s){return J_(s).then((e=>e.persistence))}function Z_(s){return J_(s).then((e=>e.localStore))}function U1(s){return sp(s).then((e=>e.remoteStore))}function eb(s){return sp(s).then((e=>e.syncEngine))}function e6(s){return sp(s).then((e=>e.datastore))}async function xc(s){const e=await sp(s),t=e.eventManager;return t.onListen=N4.bind(null,e.syncEngine),t.onUnlisten=C4.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=R4.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=k4.bind(null,e.syncEngine),t}function t6(s){return s.asyncQueue.enqueue((async()=>{const e=await L1(s),t=await U1(s);return e.setNetworkEnabled(!0),(function(a){const l=_e(a);return l.Ea.delete(0),rh(l)})(t)}))}function n6(s){return s.asyncQueue.enqueue((async()=>{const e=await L1(s),t=await U1(s);return e.setNetworkEnabled(!1),(async function(a){const l=_e(a);l.Ea.add(0),await Dc(l),l.Va.set("Offline")})(t)}))}function r6(s,e,t,r){const a=new rp(r),l=new Q_(e,a,t);return s.asyncQueue.enqueueAndForget((async()=>F_(await xc(s),l))),()=>{a.Nu(),s.asyncQueue.enqueueAndForget((async()=>H_(await xc(s),l)))}}function s6(s,e){const t=new Nn;return s.asyncQueue.enqueueAndForget((async()=>(async function(a,l,u){try{const p=await(function(m,b){const E=_e(m);return E.persistence.runTransaction("read document","readonly",(I=>E.localDocuments.getDocument(I,b)))})(a,l);p.isFoundDocument()?u.resolve(p):p.isNoDocument()?u.resolve(null):u.reject(new ce(W.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(p){const y=Vc(p,`Failed to get document '${l} from cache`);u.reject(y)}})(await Z_(s),e,t))),t.promise}function z1(s,e,t={}){const r=new Nn;return s.asyncQueue.enqueueAndForget((async()=>(function(l,u,p,y,m){const b=new rp({next:I=>{b.Nu(),u.enqueueAndForget((()=>H_(l,E)));const S=I.docs.has(p);!S&&I.fromCache?m.reject(new ce(W.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&I.fromCache&&y&&y.source==="server"?m.reject(new ce(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(I)},error:I=>m.reject(I)}),E=new Q_(Rc(p.path),b,{includeMetadataChanges:!0,Ka:!0});return F_(l,E)})(await xc(s),s.asyncQueue,e,t,r))),r.promise}function i6(s,e){const t=new Nn;return s.asyncQueue.enqueueAndForget((async()=>(async function(a,l,u){try{const p=await Em(a,l,!0),y=new D1(l,p.ks),m=y.ru(p.documents),b=y.applyChanges(m,!1);u.resolve(b.snapshot)}catch(p){const y=Vc(p,`Failed to execute query '${l} against cache`);u.reject(y)}})(await Z_(s),e,t))),t.promise}function B1(s,e,t={}){const r=new Nn;return s.asyncQueue.enqueueAndForget((async()=>(function(l,u,p,y,m){const b=new rp({next:I=>{b.Nu(),u.enqueueAndForget((()=>H_(l,E))),I.fromCache&&y.source==="server"?m.reject(new ce(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(I)},error:I=>m.reject(I)}),E=new Q_(p,b,{includeMetadataChanges:!0,Ka:!0});return F_(l,E)})(await xc(s),s.asyncQueue,e,t,r))),r.promise}function a6(s,e){const t=new Nn;return s.asyncQueue.enqueueAndForget((async()=>D4(await eb(s),e,t))),t.promise}function o6(s,e){const t=new rp(e);return s.asyncQueue.enqueueAndForget((async()=>(function(a,l){_e(a).Ca.add(l),l.next()})(await xc(s),t))),()=>{t.Nu(),s.asyncQueue.enqueueAndForget((async()=>(function(a,l){_e(a).Ca.delete(l)})(await xc(s),t)))}}function l6(s,e,t){const r=new Nn;return s.asyncQueue.enqueueAndForget((async()=>{const a=await e6(s);new J4(s.asyncQueue,a,t,e,r).ju()})),r.promise}function c6(s,e,t,r){const a=(function(u,p){let y;return y=typeof u=="string"?jA().encode(u):u,(function(b,E){return new W4(b,E)})((function(b,E){if(b instanceof Uint8Array)return zT(b,E);if(b instanceof ArrayBuffer)return zT(new Uint8Array(b),E);if(b instanceof ReadableStream)return b.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(y),p)})(t,nh(e));s.asyncQueue.enqueueAndForget((async()=>{K4(await eb(s),a,r)}))}function u6(s,e){return s.asyncQueue.enqueue((async()=>(function(r,a){const l=_e(r);return l.persistence.runTransaction("Get named query","readonly",(u=>l.Pi.getNamedQuery(u,a)))})(await Z_(s),e)))}function q1(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}const d6="ComponentProvider",qT=new Map;function h6(s,e,t,r,a){return new SO(s,e,t,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,q1(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,r)}const F1="firestore.googleapis.com",FT=!0;class HT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ce(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=F1,this.ssl=FT}else this.host=e.host,this.ssl=e.ssl??FT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=e1;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<AM)throw new ce(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}VS("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=q1(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ce(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ce(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ce(W.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class sh{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new HT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ce(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ce(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new HT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new LV;switch(r.type){case"firstParty":return new qV(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ce(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=qT.get(t);r&&(he(d6,"Removing Datastore"),qT.delete(t),r.terminate())})(this),Promise.resolve()}}function f6(s,e,t,r={}){s=it(s,sh);const a=Ec(e),l=s._getSettings(),u={...l,emulatorOptions:s._getEmulatorOptions()},p=`${e}:${t}`;a&&(oI(`https://${p}`),lI("Firestore",!0)),l.host!==F1&&l.host!==p&&Bs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const y={...l,host:p,ssl:a,emulatorOptions:r};if(!pa(y,u)&&(s._setSettings(y),r.mockUserToken)){let m,b;if(typeof r.mockUserToken=="string")m=r.mockUserToken,b=yn.MOCK_USER;else{m=e2(r.mockUserToken,s._app?.options.projectId);const E=r.mockUserToken.sub||r.mockUserToken.user_id;if(!E)throw new ce(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new yn(E)}s._authCredentials=new UV(new PS(m,b))}}let Qn=class H1{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new H1(this.firestore,e,this._query)}},vt=class td{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ma(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new td(this.firestore,e,this._key)}toJSON(){return{type:td._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Kd(t,td._jsonSchema))return new td(e,r||null,new ye($e.fromString(t.referencePath)))}};vt._jsonSchemaVersion="firestore/documentReference/1.0",vt._jsonSchema={type:ln("string",vt._jsonSchemaVersion),referencePath:ln("string")};let ma=class G1 extends Qn{constructor(e,t,r){super(e,t,Rc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vt(this.firestore,null,new ye(e))}withConverter(e){return new G1(this.firestore,e,this._path)}};function Q1(s,e,...t){if(s=De(s),c_("collection","path",e),s instanceof sh){const r=$e.fromString(e,...t);return DE(r),new ma(s,null,r)}{if(!(s instanceof vt||s instanceof ma))throw new ce(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child($e.fromString(e,...t));return DE(r),new ma(s.firestore,null,r)}}function m6(s,e){if(s=it(s,sh),c_("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ce(W.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Qn(s,null,(function(r){return new _i($e.emptyPath(),r)})(e))}function Am(s,e,...t){if(s=De(s),arguments.length===1&&(e=l_.newId()),c_("doc","path",e),s instanceof sh){const r=$e.fromString(e,...t);return kE(r),new vt(s,null,new ye(r))}{if(!(s instanceof vt||s instanceof ma))throw new ce(W.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child($e.fromString(e,...t));return kE(r),new vt(s.firestore,s instanceof ma?s.converter:null,new ye(r))}}function K1(s,e){return s=De(s),e=De(e),(s instanceof vt||s instanceof ma)&&(e instanceof vt||e instanceof ma)&&s.firestore===e.firestore&&s.path===e.path&&s.converter===e.converter}function $1(s,e){return s=De(s),e=De(e),s instanceof Qn&&e instanceof Qn&&s.firestore===e.firestore&&Xd(s._query,e._query)&&s.converter===e.converter}const GT="AsyncQueue";class QT{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new L_(this,"async_queue_retry"),this._c=()=>{const r=tm();r&&he(GT,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=tm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=tm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Nn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Ra(e))throw e;he(GT,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Kt("INTERNAL UNHANDLED ERROR: ",KT(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=q_.createAndSchedule(this,e,t,r,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&ve(47125,{Pc:KT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function KT(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class p6{constructor(){this._progressObserver={},this._taskCompletionResolver=new Nn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const g6=-1;let Yt=class extends sh{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new QT,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new QT(e),this._firestoreClient=void 0,await e}}};function Ln(s){if(s._terminated)throw new ce(W.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||Y1(s),s._firestoreClient}function Y1(s){const e=s._freezeSettings(),t=h6(s._databaseId,s._app?.options.appId||"",s._persistenceKey,s._app?.options.apiKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new Z4(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(s._componentsProvider))}function y6(s,e){Bs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=s._freezeSettings();return W1(s,Od.provider,{build:r=>new M1(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function _6(s){Bs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=s._freezeSettings();W1(s,Od.provider,{build:t=>new Y4(t,e.cacheSizeBytes)})}function W1(s,e,t){if((s=it(s,Yt))._firestoreClient||s._terminated)throw new ce(W.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(s._componentsProvider||s._getSettings().localCache)throw new ce(W.FAILED_PRECONDITION,"SDK cache is already specified.");s._componentsProvider={_online:e,_offline:t},Y1(s)}function b6(s){if(s._initialized&&!s._terminated)throw new ce(W.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Nn;return s._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!Ms.v())return Promise.resolve();const a=r+c1;await Ms.delete(a)})(j_(s._databaseId,s._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function v6(s){return(function(t){const r=new Nn;return t.asyncQueue.enqueueAndForget((async()=>O4(await eb(t),r))),r.promise})(Ln(s=it(s,Yt)))}function x6(s){return t6(Ln(s=it(s,Yt)))}function w6(s){return n6(Ln(s=it(s,Yt)))}function E6(s,e){const t=Ln(s=it(s,Yt)),r=new p6;return c6(t,s._databaseId,e,r),r}function T6(s,e){return u6(Ln(s=it(s,Yt)),e).then((t=>t?new Qn(s,null,t.query):null))}class Vn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vn(Ut.fromBase64String(e))}catch(t){throw new ce(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Vn(Ut.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Kd(e,Vn._jsonSchema))return Vn.fromBase64String(e.bytes)}}Vn._jsonSchemaVersion="firestore/bytes/1.0",Vn._jsonSchema={type:ln("string",Vn._jsonSchemaVersion),bytes:ln("string")};let Uo=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ce(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};let Ho=class{constructor(e){this._methodName=e}};class ns{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ce(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ce(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ns._jsonSchemaVersion}}static fromJSON(e){if(Kd(e,ns._jsonSchema))return new ns(e.latitude,e.longitude)}}ns._jsonSchemaVersion="firestore/geoPoint/1.0",ns._jsonSchema={type:ln("string",ns._jsonSchemaVersion),latitude:ln("number"),longitude:ln("number")};class rs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let l=0;l<r.length;++l)if(r[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:rs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Kd(e,rs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new rs(e.vectorValues);throw new ce(W.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}rs._jsonSchemaVersion="firestore/vectorValue/1.0",rs._jsonSchema={type:ln("string",rs._jsonSchemaVersion),vectorValues:ln("object")};const I6=/^__.*__$/;class S6{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new vi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Cc(e,this.data,t,this.fieldTransforms)}}class X1{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new vi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function J1(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ve(40011,{dataSource:s})}}class ip{constructor(e,t,r,a,l,u){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new ip({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){const t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Nm(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(J1(this.dataSource)&&I6.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class A6{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||nh(e)}createContext(e,t,r,a=!1){return new ip({dataSource:e,methodName:t,targetDoc:r,path:Ct.emptyPath(),arrayElement:!1,hasConverter:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Go(s){const e=s._freezeSettings(),t=nh(s._databaseId);return new A6(s._databaseId,!!e.ignoreUndefinedProperties,t)}function ap(s,e,t,r,a,l={}){const u=s.createContext(l.merge||l.mergeFields?2:0,e,t,a);ob("Data must be an object, but it was:",u,r);const p=tN(r,u);let y,m;if(l.merge)y=new ir(u.fieldMask),m=u.fieldTransforms;else if(l.mergeFields){const b=[];for(const E of l.mergeFields){const I=zo(e,E,t);if(!u.contains(I))throw new ce(W.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);sN(b,I)||b.push(I)}y=new ir(b),m=u.fieldTransforms.filter((E=>y.covers(E.field)))}else y=null,m=u.fieldTransforms;return new S6(new An(p),y,m)}class ih extends Ho{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ih}}function Z1(s,e,t){return new ip({dataSource:3,targetDoc:e.settings.targetDoc,methodName:s._methodName,arrayElement:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class tb extends Ho{_toFieldTransform(e){return new Zd(e.path,new fc)}isEqual(e){return e instanceof tb}}class nb extends Ho{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Z1(this,e,!0),r=this.Ac.map((l=>Qo(l,t))),a=new Po(r);return new Zd(e.path,a)}isEqual(e){return e instanceof nb&&pa(this.Ac,e.Ac)}}class rb extends Ho{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=Z1(this,e,!0),r=this.Ac.map((l=>Qo(l,t))),a=new jo(r);return new Zd(e.path,a)}isEqual(e){return e instanceof rb&&pa(this.Ac,e.Ac)}}class sb extends Ho{constructor(e,t){super(e),this.Vc=t}_toFieldTransform(e){const t=new mc(e.serializer,IA(e.serializer,this.Vc));return new Zd(e.path,t)}isEqual(e){return e instanceof sb&&this.Vc===e.Vc}}function ib(s,e,t,r){const a=s.createContext(1,e,t);ob("Data must be an object, but it was:",a,r);const l=[],u=An.empty();Ca(r,((y,m)=>{const b=rN(e,y,t);m=De(m);const E=a.childContextForFieldPath(b);if(m instanceof ih)l.push(b);else{const I=Qo(m,E);I!=null&&(l.push(b),u.set(b,I))}}));const p=new ir(l);return new X1(u,p,a.fieldTransforms)}function ab(s,e,t,r,a,l){const u=s.createContext(1,e,t),p=[zo(e,r,t)],y=[a];if(l.length%2!=0)throw new ce(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<l.length;I+=2)p.push(zo(e,l[I])),y.push(l[I+1]);const m=[],b=An.empty();for(let I=p.length-1;I>=0;--I)if(!sN(m,p[I])){const S=p[I];let M=y[I];M=De(M);const z=u.childContextForFieldPath(S);if(M instanceof ih)m.push(S);else{const ee=Qo(M,z);ee!=null&&(m.push(S),b.set(S,ee))}}const E=new ir(m);return new X1(b,E,u.fieldTransforms)}function eN(s,e,t,r=!1){return Qo(t,s.createContext(r?4:3,e))}function Qo(s,e){if(nN(s=De(s)))return ob("Unsupported field value:",e,s),tN(s,e);if(s instanceof Ho)return(function(r,a){if(!J1(a.dataSource))throw a.createError(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.createError(`${r._methodName}() is not currently supported inside arrays`);const l=r._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,a){const l=[];let u=0;for(const p of r){let y=Qo(p,a.childContextForArray(u));y==null&&(y={nullValue:"NULL_VALUE"}),l.push(y),u++}return{arrayValue:{values:l}}})(s,e)}return(function(r,a){if((r=De(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return IA(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const l=lt.fromDate(r);return{timestampValue:pc(a.serializer,l)}}if(r instanceof lt){const l=new lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:pc(a.serializer,l)}}if(r instanceof ns)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Vn)return{bytesValue:MA(a.serializer,r._byteString)};if(r instanceof vt){const l=a.databaseId,u=r.firestore._databaseId;if(!u.isEqual(l))throw a.createError(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:A_(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof rs)return(function(u,p){const y=u instanceof rs?u.toArray():u;return{mapValue:{fields:{[g_]:{stringValue:y_},[uc]:{arrayValue:{values:y.map((b=>{if(typeof b!="number")throw p.createError("VectorValues must only contain numeric values.");return x_(p.serializer,b)}))}}}}}})(r,a);if(YA(r))return r._toProto(a.serializer);throw a.createError(`Unsupported field value: ${qm(r)}`)})(s,e)}function tN(s,e){const t={};return eA(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ca(s,((r,a)=>{const l=Qo(a,e.childContextForField(r));l!=null&&(t[r]=l)})),{mapValue:{fields:t}}}function nN(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof lt||s instanceof ns||s instanceof Vn||s instanceof vt||s instanceof Ho||s instanceof rs||YA(s))}function ob(s,e,t){if(!nN(t)||!OS(t)){const r=qm(t);throw r==="an object"?e.createError(s+" a custom object"):e.createError(s+" "+r)}}function zo(s,e,t){if((e=De(e))instanceof Uo)return e._internalPath;if(typeof e=="string")return rN(s,e);throw Nm("Field path arguments must be of type string or ",s,!1,void 0,t)}const N6=new RegExp("[~\\*/\\[\\]]");function rN(s,e,t){if(e.search(N6)>=0)throw Nm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new Uo(...e.split("."))._internalPath}catch{throw Nm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Nm(s,e,t,r,a){const l=r&&!r.isEmpty(),u=a!==void 0;let p=`Function ${e}() called with invalid data`;t&&(p+=" (via `toFirestore()`)"),p+=". ";let y="";return(l||u)&&(y+=" (found",l&&(y+=` in field ${r}`),u&&(y+=` in document ${a}`),y+=")"),new ce(W.INVALID_ARGUMENT,p+s+y)}function sN(s,e){return s.some((t=>t.isEqual(e)))}class lb{convertValue(e,t="none"){switch(xa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(pi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ve(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ca(e,((a,l)=>{r[a]=this.convertValue(l,t)})),r}convertVectorValue(e){const t=e.fields?.[uc].arrayValue?.values?.map((r=>Nt(r.doubleValue)));return new rs(t)}convertGeoPoint(e){return new ns(Nt(e.latitude),Nt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=$m(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Rd(e));default:return null}}convertTimestamp(e){const t=mi(e);return new lt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=$e.fromString(e);Ie($A(r),9688,{name:e});const a=new va(r.get(1),r.get(3)),l=new ye(r.popFirst(5));return a.isEqual(t)||Kt(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}class Ko extends lb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vt(this.firestore,null,t)}}function R6(){return new ih("deleteField")}function C6(){return new tb("serverTimestamp")}function k6(...s){return new nb("arrayUnion",s)}function D6(...s){return new rb("arrayRemove",s)}function P6(s){return new sb("increment",s)}const $T="@firebase/firestore",YT="4.10.0";function wy(s){return(function(t,r){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of r)if(l in a&&typeof a[l]=="function")return!0;return!1})(s,["next","error","complete"])}class Md{constructor(e,t,r,a,l){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new vt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new j6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const t=this._document.data.field(zo("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class j6 extends Md{data(){return super.data()}}function iN(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new ce(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cb{}class ah extends cb{}function sa(s,e,...t){let r=[];e instanceof cb&&r.push(e),r=r.concat(t),(function(l){const u=l.filter((y=>y instanceof ub)).length,p=l.filter((y=>y instanceof op)).length;if(u>1||u>0&&p>0)throw new ce(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const a of r)s=a._apply(s);return s}class op extends ah{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new op(e,t,r)}_apply(e){const t=this._parse(e);return oN(e._query,t),new Qn(e.firestore,e.converter,cy(e._query,t))}_parse(e){const t=Go(e.firestore);return(function(l,u,p,y,m,b,E){let I;if(m.isKeyField()){if(b==="array-contains"||b==="array-contains-any")throw new ce(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${b}' queries on documentId().`);if(b==="in"||b==="not-in"){XT(E,b);const M=[];for(const z of E)M.push(WT(y,l,z));I={arrayValue:{values:M}}}else I=WT(y,l,E)}else b!=="in"&&b!=="not-in"&&b!=="array-contains-any"||XT(E,b),I=eN(p,u,E,b==="in"||b==="not-in");return Ze.create(m,b,I)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function V6(s,e,t){const r=e,a=zo("where",s);return op._create(a,r,t)}class ub extends cb{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ub(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let u=a;const p=l.getFlattenedFilters();for(const y of p)oN(u,y),u=cy(u,y)})(e._query,t),new Qn(e.firestore,e.converter,cy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class db extends ah{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new db(e,t)}_apply(e){const t=(function(a,l,u){if(a.startAt!==null)throw new ce(W.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new ce(W.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Dd(l,u)})(e._query,this._field,this._direction);return new Qn(e.firestore,e.converter,zO(e._query,t))}}function O6(s,e="asc"){const t=e,r=zo("orderBy",s);return db._create(r,t)}class lp extends ah{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new lp(e,t,r)}_apply(e){return new Qn(e.firestore,e.converter,_m(e._query,this._limit,this._limitType))}}function M6(s){return MS("limit",s),lp._create("limit",s,"F")}function L6(s){return MS("limitToLast",s),lp._create("limitToLast",s,"L")}class cp extends ah{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new cp(e,t,r)}_apply(e){const t=aN(e,this.type,this._docOrFields,this._inclusive);return new Qn(e.firestore,e.converter,BO(e._query,t))}}function U6(...s){return cp._create("startAt",s,!0)}function z6(...s){return cp._create("startAfter",s,!1)}class up extends ah{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new up(e,t,r)}_apply(e){const t=aN(e,this.type,this._docOrFields,this._inclusive);return new Qn(e.firestore,e.converter,qO(e._query,t))}}function B6(...s){return up._create("endBefore",s,!1)}function q6(...s){return up._create("endAt",s,!0)}function aN(s,e,t,r){if(t[0]=De(t[0]),t[0]instanceof Md)return(function(l,u,p,y,m){if(!y)throw new ce(W.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${p}().`);const b=[];for(const E of Xl(l))if(E.field.isKeyField())b.push(ko(u,y.key));else{const I=y.data.field(E.field);if(Km(I))throw new ce(W.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+E.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(I===null){const S=E.field.canonicalString();throw new ce(W.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}b.push(I)}return new Ea(b,m)})(s._query,s.firestore._databaseId,e,t[0]._document,r);{const a=Go(s.firestore);return(function(u,p,y,m,b,E){const I=u.explicitOrderBy;if(b.length>I.length)throw new ce(W.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const S=[];for(let M=0;M<b.length;M++){const z=b[M];if(I[M].field.isKeyField()){if(typeof z!="string")throw new ce(W.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof z}`);if(!b_(u)&&z.indexOf("/")!==-1)throw new ce(W.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${z}' contains a slash.`);const ee=u.path.child($e.fromString(z));if(!ye.isDocumentKey(ee))throw new ce(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${ee}' is not because it contains an odd number of segments.`);const Q=new ye(ee);S.push(ko(p,Q))}else{const ee=eN(y,m,z);S.push(ee)}}return new Ea(S,E)})(s._query,s.firestore._databaseId,a,e,t,r)}}function WT(s,e,t){if(typeof(t=De(t))=="string"){if(t==="")throw new ce(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!b_(e)&&t.indexOf("/")!==-1)throw new ce(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child($e.fromString(t));if(!ye.isDocumentKey(r))throw new ce(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ko(s,new ye(r))}if(t instanceof vt)return ko(s,t._key);throw new ce(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${qm(t)}.`)}function XT(s,e){if(!Array.isArray(s)||s.length===0)throw new ce(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function oN(s,e){const t=(function(a,l){for(const u of a)for(const p of u.getFlattenedFilters())if(l.indexOf(p.op)>=0)return p.op;return null})(s.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ce(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ce(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function dp(s,e,t){let r;return r=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,r}class F6 extends lb{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vt(this.firestore,null,t)}}class xo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let Mr=class lN extends Md{constructor(e,t,r,a,l,u){super(e,t,r,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new gd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(zo("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(W.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=lN._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Mr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Mr._jsonSchema={type:ln("string",Mr._jsonSchemaVersion),bundleSource:ln("string","DocumentSnapshot"),bundleName:ln("string"),bundle:ln("string")};let gd=class extends Mr{data(e={}){return super.data(e)}},ss=class cN{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new xo(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new gd(this._firestore,this._userDataWriter,r.key,r,new xo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ce(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((p=>{const y=new gd(a._firestore,a._userDataWriter,p.doc.key,p.doc,new xo(a._snapshot.mutatedKeys.has(p.doc.key),a._snapshot.fromCache),a.query.converter);return p.doc,{type:"added",doc:y,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((p=>l||p.type!==3)).map((p=>{const y=new gd(a._firestore,a._userDataWriter,p.doc.key,p.doc,new xo(a._snapshot.mutatedKeys.has(p.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,b=-1;return p.type!==0&&(m=u.indexOf(p.doc.key),u=u.delete(p.doc.key)),p.type!==1&&(u=u.add(p.doc),b=u.indexOf(p.doc.key)),{type:H6(p.type),doc:y,oldIndex:m,newIndex:b}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(W.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=cN._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=l_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),r.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function H6(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ve(61501,{type:s})}}function uN(s,e){return s instanceof Mr&&e instanceof Mr?s._firestore===e._firestore&&s._key.isEqual(e._key)&&(s._document===null?e._document===null:s._document.isEqual(e._document))&&s._converter===e._converter:s instanceof ss&&e instanceof ss&&s._firestore===e._firestore&&$1(s.query,e.query)&&s.metadata.isEqual(e.metadata)&&s._snapshot.isEqual(e._snapshot)}ss._jsonSchemaVersion="firestore/querySnapshot/1.0",ss._jsonSchema={type:ln("string",ss._jsonSchemaVersion),bundleSource:ln("string","QuerySnapshot"),bundleName:ln("string"),bundle:ln("string")};const G6={maxAttempts:5};let Q6=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Go(e)}set(e,t,r){this._verifyNotCommitted();const a=ca(e,this._firestore),l=dp(a.converter,t,r),u=ap(this._dataReader,"WriteBatch.set",a._key,l,a.converter!==null,r);return this._mutations.push(u.toMutation(a._key,kt.none())),this}update(e,t,r,...a){this._verifyNotCommitted();const l=ca(e,this._firestore);let u;return u=typeof(t=De(t))=="string"||t instanceof Uo?ab(this._dataReader,"WriteBatch.update",l._key,t,r,a):ib(this._dataReader,"WriteBatch.update",l._key,t),this._mutations.push(u.toMutation(l._key,kt.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ca(e,this._firestore);return this._mutations=this._mutations.concat(new kc(t._key,kt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ce(W.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ca(s,e){if((s=De(s)).firestore!==e)throw new ce(W.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}class K6{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Go(e)}get(e){const t=ca(e,this._firestore),r=new F6(this._firestore);return this._transaction.lookup([t._key]).then((a=>{if(!a||a.length!==1)return ve(24041);const l=a[0];if(l.isFoundDocument())return new Md(this._firestore,r,l.key,l,t.converter);if(l.isNoDocument())return new Md(this._firestore,r,t._key,null,t.converter);throw ve(18433,{doc:l})}))}set(e,t,r){const a=ca(e,this._firestore),l=dp(a.converter,t,r),u=ap(this._dataReader,"Transaction.set",a._key,l,a.converter!==null,r);return this._transaction.set(a._key,u),this}update(e,t,r,...a){const l=ca(e,this._firestore);let u;return u=typeof(t=De(t))=="string"||t instanceof Uo?ab(this._dataReader,"Transaction.update",l._key,t,r,a):ib(this._dataReader,"Transaction.update",l._key,t),this._transaction.update(l._key,u),this}delete(e){const t=ca(e,this._firestore);return this._transaction.delete(t._key),this}}let $6=class extends K6{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ca(e,this._firestore),r=new Ko(this._firestore);return super.get(e).then((a=>new Mr(this._firestore,r,t._key,a._document,new xo(!1,!1),t.converter)))}};function Y6(s,e,t){s=it(s,Yt);const r={...G6,...t};(function(u){if(u.maxAttempts<1)throw new ce(W.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const a=Ln(s);return l6(a,(l=>e(new $6(s,l))),r)}function W6(s){s=it(s,vt);const e=it(s.firestore,Yt),t=Ln(e);return z1(t,s._key).then((r=>hb(e,s,r)))}function X6(s){s=it(s,vt);const e=it(s.firestore,Yt),t=Ln(e),r=new Ko(e);return s6(t,s._key).then((a=>new Mr(e,r,s._key,a,new xo(a!==null&&a.hasLocalMutations,!0),s.converter)))}function J6(s){s=it(s,vt);const e=it(s.firestore,Yt),t=Ln(e);return z1(t,s._key,{source:"server"}).then((r=>hb(e,s,r)))}function Z6(s){s=it(s,Qn);const e=it(s.firestore,Yt),t=Ln(e),r=new Ko(e);return iN(s._query),B1(t,s._query).then((a=>new ss(e,r,s,a)))}function e3(s){s=it(s,Qn);const e=it(s.firestore,Yt),t=Ln(e),r=new Ko(e);return i6(t,s._query).then((a=>new ss(e,r,s,a)))}function t3(s){s=it(s,Qn);const e=it(s.firestore,Yt),t=Ln(e),r=new Ko(e);return B1(t,s._query,{source:"server"}).then((a=>new ss(e,r,s,a)))}function JT(s,e,t){s=it(s,vt);const r=it(s.firestore,Yt),a=dp(s.converter,e,t),l=Go(r);return oh(r,[ap(l,"setDoc",s._key,a,s.converter!==null,t).toMutation(s._key,kt.none())])}function ZT(s,e,t,...r){s=it(s,vt);const a=it(s.firestore,Yt),l=Go(a);let u;return u=typeof(e=De(e))=="string"||e instanceof Uo?ab(l,"updateDoc",s._key,e,t,r):ib(l,"updateDoc",s._key,e),oh(a,[u.toMutation(s._key,kt.exists(!0))])}function n3(s){return oh(it(s.firestore,Yt),[new kc(s._key,kt.none())])}function r3(s,e){const t=it(s.firestore,Yt),r=Am(s),a=dp(s.converter,e),l=Go(s.firestore);return oh(t,[ap(l,"addDoc",r._key,a,s.converter!==null,{}).toMutation(r._key,kt.exists(!1))]).then((()=>r))}function dN(s,...e){s=De(s);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||wy(e[r])||(t=e[r++]);const a={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(wy(e[r])){const m=e[r];e[r]=m.next?.bind(m),e[r+1]=m.error?.bind(m),e[r+2]=m.complete?.bind(m)}let l,u,p;if(s instanceof vt)u=it(s.firestore,Yt),p=Rc(s._key.path),l={next:m=>{e[r]&&e[r](hb(u,s,m))},error:e[r+1],complete:e[r+2]};else{const m=it(s,Qn);u=it(m.firestore,Yt),p=m._query;const b=new Ko(u);l={next:E=>{e[r]&&e[r](new ss(u,b,m,E))},error:e[r+1],complete:e[r+2]},iN(s._query)}const y=Ln(u);return r6(y,p,a,l)}function s3(s,e){s=it(s,Yt);const t=Ln(s),r=wy(e)?e:{next:e};return o6(t,r)}function oh(s,e){const t=Ln(s);return a6(t,e)}function hb(s,e,t){const r=t.docs.get(e._key),a=new Ko(s);return new Mr(s,a,e._key,r,new xo(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){VV(Sa),_a(new Us("firestore",((r,{instanceIdentifier:a,options:l})=>{const u=r.getProvider("app").getImmediate(),p=new Yt(new zV(r.getProvider("auth-internal")),new FV(u,r.getProvider("app-check-internal")),AO(u,a),u);return l={useFetchStreams:t,...l},p._setSettings(l),p}),"PUBLIC").setMultipleInstances(!0)),es($T,YT,e),es($T,YT,"esm2020")})();const i3="@firebase/firestore-compat",a3="0.4.4";function fb(s,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new ce("invalid-argument",`Invalid options passed to function ${s}(): You cannot specify both "merge" and "mergeFields".`);return e}function eI(){if(typeof Uint8Array>"u")throw new ce("unimplemented","Uint8Arrays are not available in this environment.")}function tI(){if(!TO())throw new ce("unimplemented","Blobs are unavailable in Firestore in this environment.")}let hN=class Ey{constructor(e){this._delegate=e}static fromBase64String(e){return tI(),new Ey(Vn.fromBase64String(e))}static fromUint8Array(e){return eI(),new Ey(Vn.fromUint8Array(e))}toBase64(){return tI(),this._delegate.toBase64()}toUint8Array(){return eI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Ty(s){return o3(s,["next","error","complete"])}function o3(s,e){if(typeof s!="object"||s===null)return!1;const t=s;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}class l3{enableIndexedDbPersistence(e,t){return y6(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return _6(e._delegate)}clearIndexedDbPersistence(e){return b6(e._delegate)}}class fN{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof va||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Bs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e={...t,...e},delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){f6(this._delegate,e,t,r)}enableNetwork(){return x6(this._delegate)}disableNetwork(){return w6(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,VS("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return v6(this._delegate)}onSnapshotsInSync(e){return s3(this._delegate,e)}get app(){if(!this._appCompat)throw new ce("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new wc(this,Q1(this._delegate,e))}catch(t){throw Fn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Or(this,Am(this._delegate,e))}catch(t){throw Fn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new qn(this,m6(this._delegate,e))}catch(t){throw Fn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Y6(this._delegate,t=>e(new mN(this,t)))}batch(){return Ln(this._delegate),new pN(new Q6(this._delegate,e=>oh(this._delegate,e)))}loadBundle(e){return E6(this._delegate,e)}namedQuery(e){return T6(this._delegate,e).then(t=>t?new qn(this,t):null)}}class hp extends lb{constructor(e){super(),this.firestore=e}convertBytes(e){return new hN(new Vn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Or.forKey(t,this.firestore,null)}}function c3(s){OV(s)}class mN{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new hp(e)}get(e){const t=wo(e);return this._delegate.get(t).then(r=>new Ld(this._firestore,new Mr(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const a=wo(e);return r?(fb("Transaction.set",r),this._delegate.set(a,t,r)):this._delegate.set(a,t),this}update(e,t,r,...a){const l=wo(e);return arguments.length===2?this._delegate.update(l,t):this._delegate.update(l,t,r,...a),this}delete(e){const t=wo(e);return this._delegate.delete(t),this}}class pN{constructor(e){this._delegate=e}set(e,t,r){const a=wo(e);return r?(fb("WriteBatch.set",r),this._delegate.set(a,t,r)):this._delegate.set(a,t),this}update(e,t,r,...a){const l=wo(e);return arguments.length===2?this._delegate.update(l,t):this._delegate.update(l,t,r,...a),this}delete(e){const t=wo(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Bo{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new gd(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ud(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Bo.INSTANCES;let a=r.get(e);a||(a=new WeakMap,r.set(e,a));let l=a.get(t);return l||(l=new Bo(e,new hp(e),t),a.set(t,l)),l}}Bo.INSTANCES=new WeakMap;class Or{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new hp(e)}static forPath(e,t,r){if(e.length%2!==0)throw new ce("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Or(t,new vt(t._delegate,r,new ye(e)))}static forKey(e,t,r){return new Or(t,new vt(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new wc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new wc(this.firestore,Q1(this._delegate,e))}catch(t){throw Fn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=De(e),e instanceof vt?K1(this._delegate,e):!1}set(e,t){t=fb("DocumentReference.set",t);try{return t?JT(this._delegate,e,t):JT(this._delegate,e)}catch(r){throw Fn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?ZT(this._delegate,e):ZT(this._delegate,e,t,...r)}catch(a){throw Fn(a,"updateDoc()","DocumentReference.update()")}}delete(){return n3(this._delegate)}onSnapshot(...e){const t=gN(e),r=yN(e,a=>new Ld(this.firestore,new Mr(this.firestore._delegate,this._userDataWriter,a._key,a._document,a.metadata,this._delegate.converter)));return dN(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=X6(this._delegate):e?.source==="server"?t=J6(this._delegate):t=W6(this._delegate),t.then(r=>new Ld(this.firestore,new Mr(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Or(this.firestore,e?this._delegate.withConverter(Bo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Fn(s,e,t){return s.message=s.message.replace(e,t),s}function gN(s){for(const e of s)if(typeof e=="object"&&!Ty(e))return e;return{}}function yN(s,e){let t;return Ty(s[0])?t=s[0]:Ty(s[1])?t=s[1]:typeof s[0]=="function"?t={next:s[0],error:s[1],complete:s[2]}:t={next:s[1],error:s[2],complete:s[3]},{next:r=>{t.next&&t.next(e(r))},error:t.error?.bind(t),complete:t.complete?.bind(t)}}class Ld{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Or(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return uN(this._delegate,e._delegate)}}class Ud extends Ld{data(e){const t=this._delegate.data(e);return this._delegate._converter||MV(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}}class qn{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new hp(e)}where(e,t,r){try{return new qn(this.firestore,sa(this._delegate,V6(e,t,r)))}catch(a){throw Fn(a,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new qn(this.firestore,sa(this._delegate,O6(e,t)))}catch(r){throw Fn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new qn(this.firestore,sa(this._delegate,M6(e)))}catch(t){throw Fn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new qn(this.firestore,sa(this._delegate,L6(e)))}catch(t){throw Fn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new qn(this.firestore,sa(this._delegate,U6(...e)))}catch(t){throw Fn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new qn(this.firestore,sa(this._delegate,z6(...e)))}catch(t){throw Fn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new qn(this.firestore,sa(this._delegate,B6(...e)))}catch(t){throw Fn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new qn(this.firestore,sa(this._delegate,q6(...e)))}catch(t){throw Fn(t,"endAt()","Query.endAt()")}}isEqual(e){return $1(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=e3(this._delegate):e?.source==="server"?t=t3(this._delegate):t=Z6(this._delegate),t.then(r=>new Iy(this.firestore,new ss(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=gN(e),r=yN(e,a=>new Iy(this.firestore,new ss(this.firestore._delegate,this._userDataWriter,this._delegate,a._snapshot)));return dN(this._delegate,t,r)}withConverter(e){return new qn(this.firestore,e?this._delegate.withConverter(Bo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class u3{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ud(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Iy{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new qn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Ud(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new u3(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Ud(this._firestore,r))})}isEqual(e){return uN(this._delegate,e._delegate)}}class wc extends qn{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Or(this.firestore,e):null}doc(e){try{return e===void 0?new Or(this.firestore,Am(this._delegate)):new Or(this.firestore,Am(this._delegate,e))}catch(t){throw Fn(t,"doc()","CollectionReference.doc()")}}add(e){return r3(this._delegate,e).then(t=>new Or(this.firestore,t))}isEqual(e){return K1(this._delegate,e._delegate)}withConverter(e){return new wc(this.firestore,e?this._delegate.withConverter(Bo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function wo(s){return it(s,vt)}class mb{constructor(...e){this._delegate=new Uo(...e)}static documentId(){return new mb(Ct.keyField().canonicalString())}isEqual(e){return e=De(e),e instanceof Uo?this._delegate._internalPath.isEqual(e._internalPath):!1}}class _o{static serverTimestamp(){const e=C6();return e._methodName="FieldValue.serverTimestamp",new _o(e)}static delete(){const e=R6();return e._methodName="FieldValue.delete",new _o(e)}static arrayUnion(...e){const t=k6(...e);return t._methodName="FieldValue.arrayUnion",new _o(t)}static arrayRemove(...e){const t=D6(...e);return t._methodName="FieldValue.arrayRemove",new _o(t)}static increment(e){const t=P6(e);return t._methodName="FieldValue.increment",new _o(t)}constructor(e){this._delegate=e}isEqual(e){return this._delegate.isEqual(e._delegate)}}const d3={Firestore:fN,GeoPoint:ns,Timestamp:lt,Blob:hN,Transaction:mN,WriteBatch:pN,DocumentReference:Or,DocumentSnapshot:Ld,Query:qn,QueryDocumentSnapshot:Ud,QuerySnapshot:Iy,CollectionReference:wc,FieldPath:mb,FieldValue:_o,setLogLevel:c3,CACHE_SIZE_UNLIMITED:g6};function h3(s,e){s.INTERNAL.registerComponent(new Us("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),a=t.getProvider("firestore").getImmediate();return e(r,a)},"PUBLIC").setServiceProps({...d3}))}function f3(s){h3(s,(e,t)=>new fN(e,t,new l3)),s.registerVersion(i3,a3)}f3(ts);const m3={apiKey:"AIzaSyDS5RsnYL49tertpcIUXPa3dppw_soU1FQ",authDomain:"led-react-6204e.firebaseapp.com",projectId:"led-react-6204e",storageBucket:"led-react-6204e.firebasestorage.app",messagingSenderId:"500086523818",appId:"1:500086523818:web:74b4a57f9c55730eee4dd3",measurementId:"G-B0D52YG6QQ"};let Sy;ts.apps.length?Sy=ts.app():Sy=ts.initializeApp(m3);const Ay=ts.auth(),On=ts.firestore(),p3=Sy,or="admire-signage-external",Le=(s,e="INR",t=!1)=>new Intl.NumberFormat(e==="INR"?"en-IN":"en-US",{style:"currency",currency:e,maximumFractionDigits:t?1:0,notation:t?"compact":"standard"}).format(s),Ny=()=>Math.random().toString(36).substr(2,9).toUpperCase(),Eo=(s,e,t,r)=>{if(!s||!e)return null;const{screenQty:a,targetWidth:l,targetHeight:u,unit:p,selectedIndoor:y,assemblyMode:m,selectedPitch:b,selectedModuleId:E,selectedCabinetId:I,selectedCardId:S,selectedSMPSId:M,selectedProcId:z,sizingMode:ee,readyId:Q,margin:ae,extras:se,overrides:xe,extraComponents:oe,pricingMode:Z,targetSellPrice:k,commercials:x,terms:R}=s,D=Number(a||1),C=be=>{if(!be)return 0;const je=Number(be.price||0),He=Number(be.carriage||0),zr=je+He;return be.currency==="USD"?zr*r:zr};let P,N,we,Ye,K,me=0;if(m==="assembled"){if(P=e.find(be=>be.id===E),N=e.find(be=>be.id===I),we=e.find(be=>be.id===S),Ye=e.find(be=>be.id===M),K=e.find(be=>be.id===z),!P||!N)return null}else{const be=e.find(je=>je.id===Q);if(K=e.find(je=>je.id===z),!be)return null;P=be,N=be}const Ee=p==="m"?l*1e3:l*304.8,Me=p==="m"?u*1e3:u*304.8,ke=Ee/N.width,V=Me/N.height;let te,B;ee==="up"?(te=Math.ceil(ke),B=Math.ceil(V)):ee==="down"?(te=Math.max(1,Math.floor(ke)),B=Math.max(1,Math.floor(V))):(te=Math.max(1,Math.round(ke)),B=Math.max(1,Math.round(V)));const G=te*N.width,le=B*N.height,de=te*B,pe=G*le/92903;let Re=[];if(m==="assembled"){const be=Math.floor(N.width/P.width)*Math.floor(N.height/P.height);me=de*be;let je=de,He=1;if(P.maxPower&&Ye&&Ye.amps&&Ye.voltage){const wi=N.width/1e3*(N.height/1e3)*Number(P.maxPower),ja=Number(Ye.amps)*Number(Ye.voltage);ja>0&&(He=Math.ceil(wi/ja),je=He*de)}Re=[{id:"modules",inventoryId:E,name:"Modules",spec:`${P.brand} ${P.model}`,qty:me,unit:C(P),total:me*C(P),type:"led"},{id:"cabinets",inventoryId:I,name:"Cabinets",spec:`${N.brand} ${N.model}`,qty:de,unit:C(N),total:de*C(N),type:"led"},{id:"cards",inventoryId:S,name:"Cards",spec:we?we.brand:"-",qty:de,unit:C(we),total:de*C(we),type:"led"},{id:"smps",inventoryId:M,name:"SMPS",spec:Ye?`${Ye.brand} (${He}/cab)`:"-",qty:je,unit:C(Ye),total:je*C(Ye),type:"led"}]}else Re=[{id:"ready",inventoryId:Q,name:"LED Panels (Ready)",spec:`${N.brand} ${N.model}`,qty:de,unit:C(N),total:de*C(N),type:"led"}],me=de;Re.push({id:"processor",inventoryId:z,name:"Processor",spec:K?K.brand:"Select Processor",qty:1,unit:K?C(K):0,total:K?C(K):0,type:"service"}),oe&&oe.length>0&&oe.forEach(be=>{const je=e.find(He=>He.id===be.componentId);if(je){const He=be.type==="cabinet"?be.qty*de:be.qty;Re.push({id:be.id,inventoryId:be.componentId,name:`Extra: ${je.type}`,spec:`${je.brand} ${je.model}`,qty:He,unit:C(je),total:He*C(je),type:je.type==="processor"?"service":"led"})}else Re.push({id:be.id,inventoryId:"",name:"Extra Component",spec:"Select Item...",qty:be.qty||1,unit:0,total:0,type:"led"})});const nt=Re.map(be=>{if(xe&&xe[be.id]){const je=xe[be.id],He=je.qty!==void 0&&je.qty!==""?Number(je.qty):be.qty,zr=je.rate!==void 0&&je.rate!==""?Number(je.rate):be.unit;return{...be,qty:He,unit:zr,total:He*zr,isOverridden:!0}}return be}),lr=nt.filter(be=>be.type==="led").reduce((be,je)=>be+je.total,0),Ft=nt.filter(be=>be.type!=="led").reduce((be,je)=>be+je.total,0),bn={};let Er=0,cn=0;Array.isArray(se)&&se.forEach(be=>{let je=0;const He=lr;be.type==="pct"?je=He*(Number(be.val)/100):je=Number(be.val),bn[be.id]=je,Er+=je});const Kn=x?.installation||{cost:0,costType:"abs"};let Cn=0;Kn.costType==="pct"?Cn=Ft*(Number(Kn.cost)/100):(Kn.unit||"sqft")==="sqft"?Cn=Number(Kn.cost)*pe:Cn=Number(Kn.cost),bn.install=Cn,cn+=Cn;const $n=x?.structure||{cost:0,costType:"abs"};let Yn=0;$n.costType==="pct"?Yn=Ft*(Number($n.cost)/100):($n.unit||"sqft")==="sqft"?Yn=Number($n.cost)*pe:Yn=Number($n.cost),bn.structure=Yn,cn+=Yn;const We=lr+Er,wt=Ft+cn,kn=We+wt,Y=kn*D,Se=x||{processor:{val:0},installation:{val:0},structure:{val:0}};let qe=0;if(Se.processor.unit==="unit"){const be=nt.find(He=>He.id==="processor"),je=be?be.qty:1;qe=Number(Se.processor.val)*je*D}else qe=Number(Se.processor.val)*D;let ue=0;Se.installation.unit==="sqft"?ue=Number(Se.installation.val)*pe*D:ue=Number(Se.installation.val)*D;let Dt=0;Se.structure.unit==="sqft"?Dt=Number(Se.structure.val)*pe*D:Dt=Number(Se.structure.val)*D;const vn=qe+ue+Dt;let Wt=0,Pa=ae;const Fs=Z||"margin";if(Fs==="margin")Wt=We*(1+ae/100);else{const be=Number(k||0);Fs==="screen"?Wt=be:Fs==="sqft"?Wt=be*pe:Fs==="sqm"&&(Wt=be*(pe/10.7639)),We>0?Pa=(Wt-We)/We*100:Pa=0}const Ur=Wt*D+vn,Un=Ur-Y;return{gridCols:te,gridRows:B,finalWidth:(G/1e3).toFixed(2),finalHeight:(le/1e3).toFixed(2),totalCabinets:de,moduleType:P,cabinetType:N,processor:K,breakdown:{qtyModules:me,ledOps:Er,serviceOps:cn},detailedItems:nt,calculatedExtras:bn,costLEDPerScreen:We,costServicesPerScreen:wt,costPerScreen:kn,totalProjectCost:Y,finalPrice:Ur,totalProjectSell:Ur,assemblyMode:m,screenQty:D,commercials:{sellProcTotal:qe,sellInstallTotal:ue,sellStructureTotal:Dt},terms:R||{price:"Ex-works Mumbai",deliveryWeeks:10,payment:[]},matrix:{cost:{sqft:kn/pe,unit:kn,total:Y},margin:{sqft:Un/D/pe,unit:Un/D,total:Un},sell:{sqft:Ur/D/pe,unit:Ur/D,total:Ur},led:{cost:We,sell:Wt,margin:Wt-We,marginPct:Pa},sqft:{perScreen:pe,total:pe*D}}}},Pt={COMPANY:{NAME:"ADMIRE SIGN & DISPLAY PVT. LTD.",ADDRESS_1:"102, Priya Industrial Estate 4, K.T. Industrial Estate",ADDRESS_2:"Kherpada, Waliv, Vasai East, Mumbai - 401208",EMAIL:"info@admiresign.com",WEB:"www.admiresign.com"},DEFAULTS:{EXCHANGE_RATE:90,GST_RATE:18,DELIVERY_WEEKS:10,PRICE_BASIS:"Ex-works Mumbai",PAYMENT_TERMS:[{name:"Advance with PO",percent:60},{name:"Before dispatch",percent:30},{name:"After installation",percent:10}]},TEXT:{WARRANTY:"Against any manufacturing defect. Offsite support for troubleshooting. Client can sign up for Admires excellent AMC services for on-site support. Serious fault will be attended to by our technical team within 48-72 hours upon receipt of written complaints with pictures/videos of the fault. 2% Extra spares includes Modules, Power Supply, Receiver Card (if there are over 100 cabinets), Flat cables, 5V connectors, Power and Data Cable. Any damage to the screen due to force majure, natural disasters, electricity surge, earthing, accident, etc is not covered under the warranty. Power supplies damage due to power fluctuation will not be covered under warranty. Power supply will be under the direct warranty of the OEM supplier. If the repair requires additional components then these will be charged extra. Brightness control meter, Video Processor & Timer can be supplied at extra cost. Maintenance team visit in six months during warranty period.",SCOPE_STRUCTURE:"Foundation & Structure. Structural stability certificate from a consultant. For wall mounted outdoor screen, Client to ensure strong and solid brick wall, RCC beams and column base. For front access indoor screen, Client to ensure a strong base. Indoor Structures cannot be mounted on ACP Sheets, Gypsum boards etc. Scaffolding, Aluminium composite panelling if required. Personnel for troubleshooting training during the screen installation. Helpers for loading, unloading and installing the display at site.",SCOPE_ELEC:"Electricity 3 phase electric power near the site, not more than 5m from the site, before the commencement of work. Electrical distribution board within 5m from the screen. Conduited electrical cable. 4mm 2 core armored cable or 4mm 3 core cables, 32 ampere MCB, 1 switch board with 2 sockets. Good quality Stabiliser and timers. 1 Certified electrical engineer for all connections from power Main to the unit. Ventilation machineries such as Air Conditioners or Fans.",SCOPE_NET:"CAT 6 or Optic Fiber Data cable and its terminations. Data points near the screen. Space with power sockets for Video wall Controllers. Data source/AV room within 80 meters of the screen. Connections to be availed through CAT 6 cables duly terminated with RJ45. If the length is farther then Fiber optic converter will be required. Fiber optic converters, if required, will be charged extra. In case the fiber optic converter is required, single mode Fiber optic cable is to be provided by client from source point to the display, terminated as per specs with Patch Chords from the splicing unit to connect to screen.",SCOPE_SOFT:"3rd party Software for Content upload on screen will be provided by the controller card supplier. Admire cannot provide regular updates and application stability.",SCOPE_PERM:"All permissions such as PTW, work permits & gate passes for workers, engineers and executives.",SCOPE_PC:"As per specification, to be arranged by client.",VALIDITY:"30 days."}},g3=({user:s,transactions:e=[],readOnly:t=!1})=>{const[r,a]=Lt.useState([]),[l,u]=Lt.useState(null),[p,y]=Lt.useState(!1),[m,b]=Lt.useState({type:"module",brand:"",model:"",vendor:"",pitch:"",width:"",height:"",price:"",carriage:"",currency:"INR",indoor:!0,brightness:"",refreshRate:"",ledType:"",lampMake:"",material:"",weight:"",avgPower:"",maxPower:"",contrast:"",viewAngleH:"",viewAngleV:"",ipFront:"",ipBack:"",ports:"",amps:"",voltage:""}),[E,I]=Lt.useState(!0),[S,M]=Lt.useState(!1),[z,ee]=Lt.useState(null);Lt.useEffect(()=>{if(!s||!On)return;const x=On.collection("artifacts").doc(or).collection("public").doc("data").collection("inventory").onSnapshot(R=>{const D=R.docs.map(C=>({id:C.id,...C.data()}));a(D),I(!1)},R=>console.error(R));return()=>x()},[s]);const Q=async()=>{if(m.type==="module"){if(!m.pitch||!m.brand||!m.model||!m.price||!m.width||!m.height||!m.weight||!m.avgPower||!m.maxPower||!m.brightness||!m.refreshRate||!m.contrast||!m.viewAngleH||!m.viewAngleV||!m.ipFront||!m.ipBack)return alert("Please fill all compulsory (*) fields.")}else if(m.type==="cabinet"){if(!m.brand||!m.material||!m.model||!m.price||!m.width||!m.height)return alert("Please fill all compulsory (*) fields.")}else if(m.type==="card"||m.type==="processor"){if(!m.brand||!m.model||!m.price||!m.vendor)return alert("Please fill all compulsory (*) fields.")}else if(m.type==="smps"){if(!m.brand||!m.model||!m.price||!m.vendor||!m.amps||!m.voltage)return alert("Please fill all compulsory (*) fields.")}else if(m.type==="ready"){if(!m.pitch||!m.brand||!m.model||!m.price||!m.material||!m.width||!m.height||!m.weight||!m.avgPower||!m.maxPower||!m.brightness||!m.refreshRate||!m.contrast||!m.viewAngleH||!m.viewAngleV||!m.ipFront||!m.ipBack)return alert("Please fill all compulsory (*) fields.")}else if(!m.brand||!m.model)return alert("Brand and Model are required");try{const x=On.collection("artifacts").doc(or).collection("public").doc("data").collection("inventory"),R={...m,width:Number(m.width),height:Number(m.height),price:Number(m.price),carriage:Number(m.carriage||0),pitch:Number(m.pitch),currency:m.currency||"INR",indoor:m.indoor==="true"||m.indoor===!0,material:m.material||"",weight:m.weight?Number(m.weight):0,avgPower:m.avgPower?Number(m.avgPower):0,maxPower:m.maxPower?Number(m.maxPower):0,brightness:m.brightness?parseInt(m.brightness):0,refreshRate:m.refreshRate?parseInt(m.refreshRate):0,viewAngleH:m.viewAngleH?parseInt(m.viewAngleH):0,viewAngleV:m.viewAngleV?parseInt(m.viewAngleV):0,ipFront:m.ipFront?parseInt(m.ipFront):0,ipBack:m.ipBack?parseInt(m.ipBack):0,ports:m.ports?parseInt(m.ports):0,amps:m.amps?Number(m.amps):0,voltage:m.voltage?Number(m.voltage):0,updatedAt:new Date};l?(await x.doc(l).update(R),u(null),y(!1)):(await x.add({...R,createdAt:new Date}),b({type:m.type,brand:"",model:"",vendor:"",pitch:"",width:"",height:"",price:"",carriage:"",currency:"INR",indoor:!0,brightness:"",refreshRate:"",ledType:"",lampMake:"",material:"",weight:"",avgPower:"",maxPower:"",contrast:"",viewAngleH:"",viewAngleV:"",ipFront:"",ipBack:"",ports:"",amps:""}),alert("Item Added!"))}catch(x){console.error(x)}},ae=x=>{b({...x,vendor:x.vendor||"",currency:x.currency||"INR",carriage:x.carriage||0}),u(x.id),y(!0),window.scrollTo({top:0,behavior:"smooth"})},se=()=>{u(null),y(!1),b({type:"module",brand:"",model:"",vendor:"",pitch:"",width:"",height:"",price:"",carriage:"",currency:"INR",indoor:!0,brightness:"",refreshRate:"",ledType:"",lampMake:"",material:"",weight:"",avgPower:"",maxPower:"",contrast:"",viewAngleH:"",viewAngleV:"",ipFront:"",ipBack:"",ports:"",amps:"",voltage:""})},xe=async x=>{confirm("Delete this item?")&&await On.collection("artifacts").doc(or).collection("public").doc("data").collection("inventory").doc(x).delete()},oe=x=>{ee(x),M(!0)},Z=x=>{const R=e.filter(C=>C.itemId===x),D={};return R.forEach(C=>{const P=C.batch||"Unbatched",N=C.type==="in"?Number(C.qty):-Number(C.qty);D[P]||(D[P]=0),D[P]+=N}),Object.entries(D).map(([C,P])=>({name:C,qty:P})).filter(C=>C.qty!==0).sort((C,P)=>P.qty-C.qty)},k=[...r].sort((x,R)=>{const D=(x.type||"").toLowerCase(),C=(R.type||"").toLowerCase();if(D<C)return-1;if(D>C)return 1;const P=(x.brand+" "+x.model).toLowerCase(),N=(R.brand+" "+R.model).toLowerCase();return P<N?-1:P>N?1:0});return d.jsxs("div",{className:"p-6 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-slate-800 dark:text-white",children:[d.jsx(sI,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"})," Components Management"]}),!p&&!t&&d.jsxs("button",{onClick:()=>y(!0),className:"bg-teal-600 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2 hover:bg-teal-700 transition-colors",children:[d.jsx(aa,{size:16})," Add New Component"]})]}),p&&d.jsxs("div",{className:`grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 p-6 rounded-lg transition-colors border shadow-sm ${l?"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-700":"bg-slate-50 dark:bg-slate-700/50 border-slate-200 dark:border-slate-600"}`,children:[d.jsxs("div",{className:"col-span-2 md:col-span-4 flex justify-between items-center mb-2 pb-2 border-b border-slate-200 dark:border-slate-600",children:[d.jsx("h3",{className:"text-sm font-bold uppercase text-slate-500 dark:text-slate-400",children:l?"Editing Item":"Add New Item"}),d.jsxs("button",{onClick:se,className:"text-xs text-slate-500 hover:text-red-500 flex items-center gap-1",children:[d.jsx(nm,{size:14})," Close"]})]}),d.jsxs("select",{className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.type,onChange:x=>b({...m,type:x.target.value}),children:[d.jsx("option",{value:"module",children:"Module"}),d.jsx("option",{value:"cabinet",children:"Cabinet"}),d.jsx("option",{value:"ready",children:"Ready Unit"}),d.jsx("option",{value:"card",children:"Receiving Card"}),d.jsx("option",{value:"smps",children:"SMPS"}),d.jsx("option",{value:"processor",children:"Processor"})]}),(m.type==="module"||m.type==="ready")&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"Pitch*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white border-teal-500 ring-1 ring-teal-500",value:m.pitch,onChange:x=>b({...m,pitch:x.target.value})}),d.jsxs("select",{className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white border-teal-500 ring-1 ring-teal-500",value:m.indoor,onChange:x=>b({...m,indoor:x.target.value}),children:[d.jsx("option",{value:"true",children:"Indoor"}),d.jsx("option",{value:"false",children:"Outdoor"})]})]}),d.jsx("input",{placeholder:m.type==="module"||m.type==="ready"||m.type==="cabinet"||m.type==="card"||m.type==="processor"||m.type==="smps"?"Brand*":"Brand",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.brand,onChange:x=>b({...m,brand:x.target.value})}),d.jsx("input",{placeholder:m.type==="module"||m.type==="ready"||m.type==="cabinet"||m.type==="card"||m.type==="processor"||m.type==="psu"?"Model/SKU*":"Model",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.model,onChange:x=>b({...m,model:x.target.value})}),d.jsxs("div",{className:"flex gap-2 items-center col-span-2 md:col-span-1",children:[d.jsxs("div",{className:"flex-1 min-w-[100px]",title:"Base Price",children:[d.jsx("input",{placeholder:"Base Rate*",type:"number",className:"p-2 w-full border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.price,onChange:x=>b({...m,price:x.target.value})}),d.jsx("div",{className:"text-[9px] text-slate-400 mt-0.5 ml-1",children:"BASE RATE*"})]}),d.jsx("span",{className:"text-slate-400 font-bold mb-3",children:"+"}),d.jsxs("div",{className:"flex-1 min-w-[80px]",title:"Carriage Inwards",children:[d.jsx("input",{placeholder:"Carriage",type:"number",className:"p-2 w-full border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.carriage,onChange:x=>b({...m,carriage:x.target.value})}),d.jsx("div",{className:"text-[9px] text-slate-400 mt-0.5 ml-1",children:"CARRIAGE"})]}),d.jsx("div",{className:"flex-none mb-3",children:d.jsxs("select",{className:"p-2 border rounded bg-slate-100 dark:bg-slate-600 dark:border-slate-600 dark:text-white",value:m.currency,onChange:x=>b({...m,currency:x.target.value}),children:[d.jsx("option",{value:"INR",children:"INR"}),d.jsx("option",{value:"USD",children:"USD"})]})})]}),m.type!=="cabinet"&&d.jsx("input",{placeholder:m.type==="card"||m.type==="processor"||m.type==="smps"?"Vendor*":"Vendor",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.vendor,onChange:x=>b({...m,vendor:x.target.value})}),(m.type==="card"||m.type==="processor")&&d.jsx("input",{placeholder:"Ports (Optional)",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.ports,onChange:x=>b({...m,ports:x.target.value})}),m.type==="smps"&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"Capacity (Amps)*",type:"number",step:"0.1",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.amps,onChange:x=>b({...m,amps:x.target.value})}),d.jsx("input",{placeholder:"Voltage (V)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.voltage,onChange:x=>b({...m,voltage:x.target.value})})]}),m.type==="module"&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"LED Type",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.ledType,onChange:x=>b({...m,ledType:x.target.value})}),d.jsx("input",{placeholder:"Lamp Make",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.lampMake,onChange:x=>b({...m,lampMake:x.target.value})}),d.jsx("input",{placeholder:"Width (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.width,onChange:x=>b({...m,width:x.target.value})}),d.jsx("input",{placeholder:"Height (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.height,onChange:x=>b({...m,height:x.target.value})}),d.jsx("input",{placeholder:"Weight/sqm (kg)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.weight,onChange:x=>b({...m,weight:x.target.value})}),d.jsx("input",{placeholder:"Avg Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.avgPower,onChange:x=>b({...m,avgPower:x.target.value})}),d.jsx("input",{placeholder:"Max Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.maxPower,onChange:x=>b({...m,maxPower:x.target.value})}),d.jsx("input",{placeholder:"Brightness (nits)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.brightness,onChange:x=>b({...m,brightness:x.target.value})}),d.jsx("input",{placeholder:"Refresh Rate*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.refreshRate,onChange:x=>b({...m,refreshRate:x.target.value})}),d.jsx("input",{placeholder:"Contrast* (e.g. 5000:1)",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.contrast,onChange:x=>b({...m,contrast:x.target.value})}),d.jsx("input",{placeholder:"Viewing Angle (H)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.viewAngleH,onChange:x=>b({...m,viewAngleH:x.target.value})}),d.jsx("input",{placeholder:"Viewing Angle (V)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.viewAngleV,onChange:x=>b({...m,viewAngleV:x.target.value})}),d.jsx("input",{placeholder:"IP Protection (Front)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.ipFront,onChange:x=>b({...m,ipFront:x.target.value})}),d.jsx("input",{placeholder:"IP Protection (Back)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.ipBack,onChange:x=>b({...m,ipBack:x.target.value})})]}),m.type==="cabinet"&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"Material*",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.material,onChange:x=>b({...m,material:x.target.value})}),d.jsxs("select",{className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.indoor,onChange:x=>b({...m,indoor:x.target.value}),children:[d.jsx("option",{value:"true",children:"Indoor"}),d.jsx("option",{value:"false",children:"Outdoor"})]}),d.jsx("input",{placeholder:"Width (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.width,onChange:x=>b({...m,width:x.target.value})}),d.jsx("input",{placeholder:"Height (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.height,onChange:x=>b({...m,height:x.target.value})}),d.jsx("input",{placeholder:"Weight (kg)",type:"number",step:"1",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.weight,onChange:x=>b({...m,weight:x.target.value})})]}),m.type==="ready"&&d.jsxs(d.Fragment,{children:[d.jsx("input",{placeholder:"Cabinet Material*",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.material,onChange:x=>b({...m,material:x.target.value})}),d.jsx("input",{placeholder:"LED Type",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.ledType,onChange:x=>b({...m,ledType:x.target.value})}),d.jsx("input",{placeholder:"Lamp Make",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.lampMake,onChange:x=>b({...m,lampMake:x.target.value})}),d.jsx("input",{placeholder:"Width (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.width,onChange:x=>b({...m,width:x.target.value})}),d.jsx("input",{placeholder:"Height (mm)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.height,onChange:x=>b({...m,height:x.target.value})}),d.jsx("input",{placeholder:"Weight/sqm (kg)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.weight,onChange:x=>b({...m,weight:x.target.value})}),d.jsx("input",{placeholder:"Avg Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.avgPower,onChange:x=>b({...m,avgPower:x.target.value})}),d.jsx("input",{placeholder:"Max Power/sqm (W)*",type:"number",step:"0.01",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.maxPower,onChange:x=>b({...m,maxPower:x.target.value})}),d.jsx("input",{placeholder:"Brightness (nits)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.brightness,onChange:x=>b({...m,brightness:x.target.value})}),d.jsx("input",{placeholder:"Refresh Rate*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.refreshRate,onChange:x=>b({...m,refreshRate:x.target.value})}),d.jsx("input",{placeholder:"Contrast* (e.g. 5000:1)",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.contrast,onChange:x=>b({...m,contrast:x.target.value})}),d.jsx("input",{placeholder:"Viewing Angle (H)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.viewAngleH,onChange:x=>b({...m,viewAngleH:x.target.value})}),d.jsx("input",{placeholder:"Viewing Angle (V)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.viewAngleV,onChange:x=>b({...m,viewAngleV:x.target.value})}),d.jsx("input",{placeholder:"IP Protection (Front)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.ipFront,onChange:x=>b({...m,ipFront:x.target.value})}),d.jsx("input",{placeholder:"IP Protection (Back)*",type:"number",className:"p-2 border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white",value:m.ipBack,onChange:x=>b({...m,ipBack:x.target.value})})]}),d.jsxs("button",{onClick:Q,className:`px-4 py-2 rounded text-white flex items-center justify-center gap-2 hover:opacity-90 transition ${l?"bg-amber-600":"bg-teal-600"} col-span-2 md:col-span-1`,children:[l?d.jsx(To,{size:16}):d.jsx(aa,{size:16}),l?"Update Item":"Add Item"]})]}),d.jsxs("div",{className:"mt-6",children:[d.jsx("div",{className:"md:hidden space-y-4",children:k.map(x=>{const R=e.filter(D=>D.itemId===x.id).reduce((D,C)=>D+(C.type==="in"?Number(C.qty):-Number(C.qty)),0);return d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm relative overflow-hidden",children:[d.jsx("div",{className:`absolute top-0 right-0 px-3 py-1 rounded-bl-lg text-[10px] font-bold uppercase tracking-wider ${x.type==="module"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-600 dark:bg-slate-700 dark:text-slate-300"}`,children:x.type}),d.jsxs("div",{className:"pr-16 mb-3",children:[d.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white text-lg",children:[x.brand," ",x.model]}),x.vendor&&d.jsx("div",{className:"text-xs text-teal-600 font-medium",children:x.vendor})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 text-xs text-slate-500 dark:text-slate-400 bg-slate-50 dark:bg-slate-700/50 p-3 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("span",{className:"block text-[10px] uppercase font-bold text-slate-400",children:"Specs"}),x.type==="module"?d.jsxs("span",{children:["P",x.pitch," ",x.indoor?"In":"Out","  ",x.width,"x",x.height]}):d.jsx("span",{children:x.width?`${x.width}x${x.height}`:"Standard"})]}),d.jsxs("div",{children:[d.jsx("span",{className:"block text-[10px] uppercase font-bold text-slate-400",children:"Stock"}),d.jsx("span",{className:`font-bold text-sm ${R<0?"text-red-500":"text-slate-700 dark:text-slate-200"}`,children:R})]}),d.jsxs("div",{className:"col-span-2 border-t border-slate-200 dark:border-slate-600 pt-2 mt-1",children:[d.jsx("span",{className:"block text-[10px] uppercase font-bold text-slate-400",children:"Landed Cost"}),d.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:Le((x.price||0)+(x.carriage||0),x.currency||"INR")})]})]}),d.jsxs("div",{className:"flex gap-2",children:[x.type==="module"&&d.jsxs("button",{onClick:()=>oe(x),className:"flex-1 py-2 bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400 rounded-lg text-xs font-bold flex justify-center items-center gap-2 hover:bg-purple-100 dark:hover:bg-purple-900/30 transition-colors",children:[d.jsx(Qw,{size:14})," Batches"]}),!t&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:()=>ae(x),className:"flex-1 py-2 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg text-xs font-bold flex justify-center items-center gap-2 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors",children:[d.jsx(To,{size:14})," Edit"]}),d.jsxs("button",{onClick:()=>xe(x.id),className:"flex-1 py-2 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg text-xs font-bold flex justify-center items-center gap-2 hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors",children:[d.jsx(Os,{size:14})," Delete"]})]})]})]},x.id)})}),d.jsx("div",{className:"hidden md:block overflow-x-auto rounded border border-slate-200 dark:border-slate-700",children:d.jsxs("table",{className:"w-full text-sm text-left",children:[d.jsx("thead",{className:"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 uppercase",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-3",children:"Type"}),d.jsx("th",{className:"px-4 py-3",children:"Component"}),d.jsx("th",{className:"px-4 py-3",children:"Specs"}),d.jsx("th",{className:"px-4 py-3 text-center",children:"Stock"}),d.jsx("th",{className:"px-4 py-3",children:"Landed Cost"}),d.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700 bg-white dark:bg-slate-800",children:k.map(x=>d.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-slate-700/50 ${l===x.id?"bg-amber-50 dark:bg-amber-900/20":""}`,children:[d.jsx("td",{className:"px-4 py-3 capitalize",children:d.jsx("span",{className:`px-2 py-1 rounded-full text-xs capitalize ${x.type==="module"?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":x.type==="cabinet"?"bg-teal-100 dark:bg-teal-900 text-teal-700 dark:text-teal-300":x.type==="card"?"bg-amber-100 dark:bg-amber-900 text-amber-700 dark:text-amber-300":x.type==="smps"?"bg-rose-100 dark:bg-rose-900 text-rose-700 dark:text-rose-300":x.type==="processor"?"bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300":x.type==="ready"?"bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:x.type==="smps"?"SMPS":x.type})}),d.jsxs("td",{className:"px-4 py-3 dark:text-slate-200",children:[d.jsxs("div",{className:"font-medium",children:[x.brand," ",x.model]}),x.vendor&&d.jsx("div",{className:"text-[10px] text-teal-600 dark:text-teal-400 mt-0.5",children:x.vendor})]}),d.jsxs("td",{className:"px-4 py-3 text-slate-500 dark:text-slate-400 text-xs",children:[x.type==="module"&&d.jsxs("div",{className:"flex flex-col",children:[d.jsxs("span",{children:["P",x.pitch," ",x.indoor?"Indoor":"Outdoor"]}),d.jsxs("span",{children:[x.width,"x",x.height,"mm"]})]}),x.type==="cabinet"&&d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{children:x.material}),d.jsxs("span",{children:[x.width,"x",x.height,"mm"]}),d.jsx("span",{children:x.indoor?"Indoor":"Outdoor"})]}),(x.type==="card"||x.type==="processor")&&d.jsx("span",{children:x.ports?`${x.ports} Ports`:""}),x.type==="smps"&&d.jsx("span",{children:x.amps?`${x.amps} Amps`:""}),x.type==="ready"&&d.jsxs("span",{children:[x.width,"x",x.height,"mm P",x.pitch]})]}),d.jsx("td",{className:"px-4 py-3 font-bold dark:text-slate-200 text-teal-600 text-center",children:e.filter(R=>R.itemId===x.id).reduce((R,D)=>R+(D.type==="in"?Number(D.qty):-Number(D.qty)),0)}),d.jsx("td",{className:"px-4 py-3 dark:text-slate-200",children:d.jsxs("div",{className:"flex flex-col",children:[d.jsx("span",{className:"font-semibold",children:Le((x.price||0)+(x.carriage||0),x.currency||"INR")}),x.carriage>0&&d.jsxs("span",{className:"text-[10px] text-slate-400",children:["Base: ",x.price," + Carr: ",x.carriage]})]})}),d.jsxs("td",{className:"px-4 py-3 flex gap-2 justify-end",children:[x.type==="module"&&d.jsx("button",{onClick:()=>oe(x),title:"Manage Batches",className:"text-purple-500 hover:text-purple-700 p-1 bg-purple-50 dark:bg-purple-900/30 rounded",children:d.jsx(Qw,{size:14})}),!t&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>ae(x),className:"text-blue-500 hover:text-blue-700 p-1 bg-blue-50 dark:bg-blue-900/30 rounded",children:d.jsx(To,{size:14})}),d.jsx("button",{onClick:()=>xe(x.id),className:"text-red-400 hover:text-red-600 p-1 bg-red-50 dark:bg-red-900/30 rounded",children:d.jsx(Os,{size:14})})]})]})]},x.id))})]})}),r.length===0&&!E&&d.jsx("div",{className:"text-center py-12 text-slate-400 bg-white dark:bg-slate-800",children:"No items found."})]}),S&&z&&d.jsx("div",{className:"fixed inset-0 z-50 bg-black/80 flex justify-center items-center p-4",children:d.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-xl shadow-2xl overflow-hidden",children:[d.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-slate-50 dark:bg-slate-800",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-slate-800 dark:text-white",children:"Batch Management"}),d.jsxs("p",{className:"text-xs text-slate-500",children:[z.brand," ",z.model]})]}),d.jsx("button",{onClick:()=>M(!1),className:"text-slate-400 hover:text-slate-600",children:d.jsx(nm,{size:20})})]}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"mb-4 text-xs text-slate-500 dark:text-slate-400 bg-blue-50 dark:bg-blue-900/20 p-3 rounded border border-blue-100 dark:border-blue-800",children:[" To add stock or new batches, please use the ",d.jsx("b",{children:"Stock Ledger"})," tab. This list shows current calculated balances."]}),d.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-100 dark:border-slate-800 overflow-hidden",children:[d.jsxs("div",{className:"grid grid-cols-2 bg-slate-100 dark:bg-slate-800 p-2 text-xs font-bold text-slate-500 uppercase",children:[d.jsx("div",{children:"Batch No"}),d.jsx("div",{className:"text-right",children:"Current Balance"})]}),d.jsxs("div",{className:"max-h-60 overflow-y-auto",children:[Z(z.id).length===0&&d.jsx("div",{className:"p-4 text-center text-xs text-slate-400",children:"No active batches found in ledger."}),Z(z.id).map((x,R)=>d.jsxs("div",{className:"grid grid-cols-2 p-2 border-b border-slate-100 dark:border-slate-700/50 last:border-0 text-sm items-center",children:[d.jsx("div",{className:"font-medium text-slate-700 dark:text-slate-200",children:x.name==="Unbatched"?d.jsx("span",{className:"italic text-slate-400",children:"Unbatched Stock"}):x.name}),d.jsx("div",{className:"text-right font-bold text-slate-900 dark:text-white",children:x.qty})]},R))]}),d.jsxs("div",{className:"p-3 bg-teal-50 dark:bg-teal-900/20 flex justify-between items-center border-t border-teal-100 dark:border-teal-800",children:[d.jsx("span",{className:"text-xs font-bold text-teal-800 dark:text-teal-400 uppercase",children:"Total in Batches"}),d.jsx("span",{className:"text-sm font-bold text-teal-700 dark:text-teal-300",children:Z(z.id).reduce((x,R)=>x+R.qty,0)})]})]})]})]})})]})},y3=({user:s,inventory:e=[],transactions:t=[],readOnly:r=!1})=>{const[a,l]=bt.useState({date:new Date().toISOString().split("T")[0],type:"in",itemId:"",qty:"",remarks:"",batch:""}),[u,p]=bt.useState(null),y=async()=>{if(!a.itemId||!a.qty)return alert("Select Item and Qty");try{const S=On.collection("artifacts").doc(or).collection("public").doc("data").collection("transactions");u?(await S.doc(u).update({...a,qty:Number(a.qty),updatedAt:new Date}),p(null)):await S.add({...a,qty:Number(a.qty),createdAt:new Date}),l({date:new Date().toISOString().split("T")[0],type:"in",itemId:"",qty:"",remarks:"",batch:""})}catch(S){console.error(S)}},m=S=>{l({...S,qty:S.qty}),p(S.id),window.scrollTo({top:0,behavior:"smooth"})},b=()=>{p(null),l({date:new Date().toISOString().split("T")[0],type:"in",itemId:"",qty:"",remarks:"",batch:""})},E=async S=>{confirm("Delete record?")&&await On.collection("artifacts").doc(or).collection("public").doc("data").collection("transactions").doc(S).delete()},I=[...t].sort((S,M)=>new Date(M.date)-new Date(S.date));return d.jsxs("div",{className:"p-4 md:p-6 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[d.jsx(hC,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"}),d.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:"Stock Ledger"})]}),!r&&d.jsxs("div",{className:`p-4 rounded-lg border mb-6 transition-colors ${u?"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-700":"bg-slate-50 dark:bg-slate-700/30 border-slate-200 dark:border-slate-700"}`,children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-xs font-bold uppercase text-slate-500 dark:text-slate-400",children:u?"Edit Transaction":"New Transaction"}),u&&d.jsxs("button",{onClick:b,className:"text-xs text-red-500 flex items-center gap-1",children:[d.jsx(nm,{size:14})," Cancel"]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Date & Action"}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"date",value:a.date,onChange:S=>l({...a,date:S.target.value}),className:"flex-1 p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"}),d.jsxs("div",{className:"flex rounded overflow-hidden border border-slate-200 dark:border-slate-600",children:[d.jsx("button",{onClick:()=>l({...a,type:"in"}),className:`flex-1 py-2 text-xs font-bold transition-colors flex items-center justify-center gap-1 ${a.type==="in"?"bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-400":"bg-white dark:bg-slate-700 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-600"}`,children:"+ STOCK IN"}),d.jsx("button",{onClick:()=>l({...a,type:"out"}),className:`flex-1 py-2 text-xs font-bold transition-colors flex items-center justify-center gap-1 ${a.type==="out"?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400":"bg-white dark:bg-slate-700 text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-600"}`,children:"- STOCK OUT"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Component"}),d.jsxs("select",{value:a.itemId,onChange:S=>l({...a,itemId:S.target.value}),className:"w-full p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select Item..."}),e.sort((S,M)=>(S.brand+" "+S.model).localeCompare(M.brand+" "+M.model)).map(S=>d.jsxs("option",{value:S.id,children:[S.brand," ",S.model," (",S.type,")"]},S.id))]}),e.find(S=>S.id===a.itemId)?.type==="module"&&d.jsx("input",{type:"text",placeholder:"Batch No. (e.g. BATCH-A)",value:a.batch||"",onChange:S=>l({...a,batch:S.target.value}),className:"w-full mt-2 p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white font-bold text-purple-600 border-purple-200 focus:border-purple-500 focus:ring-purple-500"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Quantity"}),d.jsx("input",{type:"number",placeholder:"Qty",value:a.qty,onChange:S=>l({...a,qty:S.target.value}),className:"w-full p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold uppercase text-slate-500 dark:text-slate-400 mb-1",children:"Location / Source"}),d.jsx("input",{type:"text",placeholder:"Source/Loc",value:a.remarks,onChange:S=>l({...a,remarks:S.target.value}),className:"w-full p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"})]})]}),d.jsx("button",{onClick:y,className:`w-full md:w-auto text-white px-6 py-2 rounded-lg font-bold text-sm transition-colors shadow-sm ${u?"bg-amber-600 hover:bg-amber-700":"bg-teal-600 hover:bg-teal-700"}`,children:u?"Update Transaction":"Add Transaction"})]}),d.jsxs("div",{className:"mt-8",children:[d.jsx("h3",{className:"text-sm font-bold uppercase text-slate-500 dark:text-slate-400 mb-4",children:"Transaction History"}),d.jsxs("div",{className:"md:hidden space-y-3",children:[I.map(S=>{const M=e.find(z=>z.id===S.itemId)||{};return d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-lg border border-slate-200 dark:border-slate-700 shadow-sm flex items-center justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[d.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold uppercase ${S.type==="in"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:S.type==="in"?"IN":"OUT"}),d.jsx("span",{className:"text-xs text-slate-400",children:new Date(S.date).toLocaleDateString()})]}),d.jsxs("div",{className:"font-bold text-slate-800 dark:text-white text-sm mb-0.5",children:[M.brand," ",M.model,S.batch&&d.jsx("span",{className:"ml-2 inline-block bg-purple-100 text-purple-700 dark:bg-purple-900/40 dark:text-purple-300 text-[10px] px-1.5 py-0.5 rounded border border-purple-200 dark:border-purple-800",children:S.batch})]}),d.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:S.remarks||"-"})]}),d.jsxs("div",{className:"text-right pl-4 border-l border-slate-100 dark:border-slate-700 ml-2",children:[d.jsxs("span",{className:`block text-lg font-bold ${S.type==="in"?"text-green-600":"text-red-500"}`,children:[S.type==="in"?"+":"-",S.qty]}),!r&&d.jsxs("div",{className:"flex gap-3 justify-end mt-1",children:[d.jsx("button",{onClick:()=>m(S),className:"text-[10px] text-blue-500 hover:text-blue-700 underline",children:"Edit"}),d.jsx("button",{onClick:()=>E(S.id),className:"text-[10px] text-red-400 hover:text-red-600 underline",children:"Delete"})]})]})]},S.id)}),I.length===0&&d.jsx("div",{className:"text-center py-8 text-slate-400 text-sm",children:"No transactions yet."})]}),d.jsxs("div",{className:"hidden md:block overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700",children:[d.jsxs("table",{className:"w-full text-sm text-left",children:[d.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700/50 text-slate-500 dark:text-slate-400 uppercase text-xs",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-3",children:"Date"}),d.jsx("th",{className:"px-4 py-3 text-center",children:"Type"}),d.jsx("th",{className:"px-4 py-3",children:"Component"}),d.jsx("th",{className:"px-4 py-3",children:"Specs"}),d.jsx("th",{className:"px-4 py-3 text-center",children:"Qty"}),d.jsx("th",{className:"px-4 py-3",children:"Loc/Source"}),d.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700 bg-white dark:bg-slate-800",children:I.map(S=>{const M=e.find(z=>z.id===S.itemId)||{};return d.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[d.jsx("td",{className:"px-4 py-3 whitespace-nowrap dark:text-slate-300",children:new Date(S.date).toLocaleDateString()}),d.jsx("td",{className:"px-4 py-3 text-center",children:d.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${S.type==="in"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:S.type.toUpperCase()})}),d.jsxs("td",{className:"px-4 py-3 font-medium dark:text-white",children:[M.brand," ",M.model,S.batch&&d.jsx("div",{className:"text-[10px] bg-purple-100 text-purple-700 dark:bg-purple-900/40 dark:text-purple-300 px-1.5 py-0.5 rounded w-fit mt-1 font-bold border border-purple-200 dark:border-purple-800",children:S.batch})]}),d.jsx("td",{className:"px-4 py-3 text-xs text-slate-500 dark:text-slate-400",children:M.type}),d.jsxs("td",{className:`px-4 py-3 text-center font-bold ${S.type==="in"?"text-green-600":"text-red-500"}`,children:[S.type==="in"?"+":"-",S.qty]}),d.jsx("td",{className:"px-4 py-3 text-slate-500 dark:text-slate-400 text-xs",children:S.remarks}),d.jsx("td",{className:"px-4 py-3 text-right",children:!r&&d.jsxs("div",{className:"flex justify-end gap-1",children:[d.jsx("button",{onClick:()=>m(S),className:"text-blue-400 hover:text-blue-600 p-1.5 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded",children:d.jsx(To,{size:14})}),d.jsx("button",{onClick:()=>E(S.id),className:"text-red-400 hover:text-red-600 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:d.jsx(Os,{size:14})})]})})]},S.id)})})]}),I.length===0&&d.jsx("div",{className:"text-center py-8 text-slate-400",children:"No transactions recorded."})]})]})]})};var _3=nI();const _N=Ry(_3),b3=({cols:s,rows:e,module:t,cabinet:r,unit:a})=>{if(!t||!r)return null;const l=r.width,u=r.height,p=l*s,y=u*e,m=b=>{const E=(b/1e3).toFixed(2)+"m",I=(b/304.8).toFixed(2)+"ft";return`${E} / ${I}`};return d.jsx("div",{className:"w-full flex flex-col bg-white rounded-lg border border-slate-200 overflow-hidden",children:d.jsx("div",{className:"w-full h-full min-h-[300px] p-10 flex items-center justify-center",children:d.jsxs("div",{className:"relative",style:{aspectRatio:`${p}/${y}`,width:"100%",maxHeight:"400px"},children:[d.jsxs("div",{className:"absolute -top-8 left-0 right-0 text-center text-xs font-bold text-slate-600 flex items-center justify-center gap-2",children:[d.jsx("div",{className:"h-[1px] flex-1 bg-slate-300"}),d.jsxs("span",{className:"bg-white px-1 whitespace-nowrap",children:[m(p)," (",s," Cabinets)"]}),d.jsx("div",{className:"h-[1px] flex-1 bg-slate-300"})]}),d.jsxs("div",{className:"absolute -left-8 top-0 bottom-0 text-center text-xs font-bold text-slate-600 flex flex-col items-center justify-center gap-2",style:{writingMode:"vertical-rl",transform:"rotate(180deg)"},children:[d.jsx("div",{className:"w-[1px] flex-1 bg-slate-300"}),d.jsxs("span",{className:"bg-white px-1 whitespace-nowrap",children:[m(y)," (",e," Cabinets)"]}),d.jsx("div",{className:"w-[1px] flex-1 bg-slate-300"})]}),d.jsx("div",{className:"w-full h-full grid bg-white border-2 border-slate-900 shadow-sm",style:{gridTemplateColumns:`repeat(${s}, 1fr)`,gridTemplateRows:`repeat(${e}, 1fr)`},children:Array.from({length:s*e}).map((b,E)=>d.jsx("div",{className:"border border-slate-300 relative"},E))})]})})})},bN=({data:s,allScreensData:e,currency:t="INR",exchangeRate:r,date:a})=>{const l=e&&e.calculations&&e.calculations.length>1,u=l?e.calculations:s?[s]:[];if(u.length===0)return null;const p=(l?e.clientName:s?.clientName)||"",y=(l?e.projectName:s?.projectName)||"",m=u[0].terms||{},b=l?e.totalProjectSell:s?.totalProjectSell,E=I=>d.jsxs("div",{className:`bg-white text-slate-800 font-sans text-xs ${I?"print-version-container p-0":"preview-version-container w-full h-full p-8"}`,children:[d.jsx("div",{className:"flex justify-between items-start mb-6 border-b-2 border-slate-800 pb-4",children:d.jsxs("div",{className:"flex gap-4 items-center",children:[d.jsx("img",{src:"/AdmireLED/logo.png",alt:"Company Logo",className:"h-16 w-auto object-contain"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-slate-900 uppercase tracking-wide",children:Pt.COMPANY.NAME}),d.jsxs("div",{className:"text-[10px] text-slate-600 mt-1 space-y-0.5",children:[d.jsx("p",{children:Pt.COMPANY.ADDRESS_1}),d.jsx("p",{children:Pt.COMPANY.ADDRESS_2}),d.jsxs("p",{children:["Email: ",Pt.COMPANY.EMAIL," | Web: ",Pt.COMPANY.WEB]})]})]})]})}),u.map((S,M)=>{const{finalWidth:z,finalHeight:ee,totalCabinets:Q,moduleType:ae={},cabinetType:se={},processor:xe,screenQty:oe,totalProjectSell:Z,gridCols:k,gridRows:x,commercials:R}=S,D=Number(z),C=Number(ee),P=D*C,N=P*10.7639,we=Number(ae.pitch||0),Ye=we>0?Math.round(D*1e3/we):0,K=we>0?Math.round(C*1e3/we):0,me=(ae.weight||0)*P,Ee=(se.weight||0)*Q,Me=me+Ee,ke=(ae.avgPower||0)*P,V=(ae.maxPower||0)*P,te=R||{sellProcTotal:0,sellInstallTotal:0,sellStructureTotal:0},B=Z/(oe||1),G=(te.sellProcTotal||0)/(oe||1),le=(te.sellInstallTotal||0)/(oe||1),de=(te.sellStructureTotal||0)/(oe||1),pe=B-G-le-de,Re=pe*.02,lr=[{name:"LED Panel",rate:pe-Re},{name:"Processor",rate:G},{name:"Installation",rate:le},{name:"Spares (2%)",rate:Re},{name:"Structure",rate:de}].filter(Ft=>Ft.rate>0);return d.jsxs("div",{className:"mb-10 pb-6 border-b-2 border-slate-100 break-inside-avoid print-break-avoid",children:[l&&d.jsx("div",{className:"mb-4 pb-2 border-b border-teal-500",children:d.jsxs("h2",{className:"text-lg font-bold text-teal-800 uppercase",children:["Configuration #",M+1]})}),d.jsxs("div",{className:"grid grid-cols-2 gap-6 mb-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2",children:"Project Details"}),d.jsxs("div",{className:"grid grid-cols-3 gap-y-1 text-[11px]",children:[d.jsx("span",{className:"font-semibold text-slate-500",children:"Client:"})," ",d.jsx("span",{className:"col-span-2 font-bold",children:p}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Project:"})," ",d.jsx("span",{className:"col-span-2 font-bold",children:y}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Screen Size:"}),d.jsxs("span",{className:"col-span-2",children:[D,"m x ",C,"m ",d.jsxs("span",{className:"text-slate-400",children:["/ ",(D*3.28084).toFixed(2),"ft x ",(C*3.28084).toFixed(2),"ft"]})]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Quantity:"})," ",d.jsxs("span",{className:"col-span-2",children:[oe," Nos"]})]}),d.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mt-4 mb-2",children:"Module & Cabinet"}),d.jsxs("div",{className:"grid grid-cols-3 gap-y-1 text-[11px]",children:[d.jsx("span",{className:"font-semibold text-slate-500",children:"Module:"})," ",d.jsxs("span",{className:"col-span-2",children:[ae.brand," P",ae.pitch]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Mod Size:"})," ",d.jsxs("span",{className:"col-span-2",children:[ae.width," x ",ae.height," mm"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Lamp:"})," ",d.jsx("span",{className:"col-span-2",children:ae.lampMake||"-"}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Cabinet:"})," ",d.jsx("span",{className:"col-span-2",children:se.material||"Standard"}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Cab Size:"})," ",d.jsxs("span",{className:"col-span-2",children:[se.width," x ",se.height," mm"]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2",children:"Screen Specifications"}),d.jsxs("div",{className:"grid grid-cols-3 gap-y-1 text-[11px]",children:[d.jsx("span",{className:"font-semibold text-slate-500",children:"Resolution:"})," ",d.jsxs("span",{className:"col-span-2",children:[Ye," x ",K," pixels"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Total Area:"})," ",d.jsxs("span",{className:"col-span-2",children:[N.toFixed(2)," Sq.ft / ",P.toFixed(2)," Sq.m"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Total Weight:"})," ",d.jsxs("span",{className:"col-span-2",children:[Me.toFixed(1)," kg"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Avg Power:"})," ",d.jsxs("span",{className:"col-span-2",children:[ke.toFixed(0)," Watts"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Max Power:"})," ",d.jsxs("span",{className:"col-span-2",children:[V.toFixed(0)," Watts"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Brightness:"})," ",d.jsxs("span",{className:"col-span-2",children:[ae.brightness," nits"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Refresh Rate:"})," ",d.jsxs("span",{className:"col-span-2",children:[ae.refreshRate," Hz"]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Controller:"})," ",d.jsx("span",{className:"col-span-2",children:xe?`${xe.brand} ${xe.model}`:"Standard"}),d.jsx("span",{className:"font-semibold text-slate-500",children:"Viewing:"})," ",d.jsxs("span",{className:"col-span-2",children:["H: ",ae.viewAngleH," / V: ",ae.viewAngleV,""]}),d.jsx("span",{className:"font-semibold text-slate-500",children:"IP Rating:"})," ",d.jsxs("span",{className:"col-span-2",children:["Front: IP",ae.ipFront," / Back: IP",ae.ipBack]})]})]})]}),d.jsxs("div",{className:"mb-2 break-inside-avoid print-break-avoid",children:[d.jsxs("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2 pb-1",children:["Commercial Proposal ",l?`(Config #${M+1})`:""]}),d.jsxs("table",{className:"w-full border-collapse border border-slate-300 text-[11px]",children:[d.jsx("thead",{className:"bg-slate-800 text-white",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-2 border border-slate-600 text-left w-12",children:"#"}),d.jsx("th",{className:"p-2 border border-slate-600 text-left",children:"Item Description"}),d.jsx("th",{className:"p-2 border border-slate-600 text-right w-32",children:"Amount (1 Screen)"}),d.jsxs("th",{className:"p-2 border border-slate-600 text-right w-32",children:["Amount (",oe," Screens)"]})]})}),d.jsxs("tbody",{children:[lr.map((Ft,bn)=>d.jsxs("tr",{children:[d.jsx("td",{className:"p-2 border border-slate-300 text-center",children:bn+1}),d.jsx("td",{className:"p-2 border border-slate-300 font-bold",children:Ft.name}),d.jsx("td",{className:"p-2 border border-slate-300 text-right",children:Le(Ft.rate,t)}),d.jsx("td",{className:"p-2 border border-slate-300 text-right font-bold",children:Le(Ft.rate*oe,t)})]},bn)),d.jsxs("tr",{className:"bg-slate-100",children:[d.jsx("td",{colSpan:"3",className:"p-2 border border-slate-300 text-right font-bold uppercase",children:"Subtotal (Excl. GST)"}),d.jsx("td",{className:"p-2 border border-slate-300 text-right font-bold text-sm",children:Le(Z,t)})]})]})]})]})]},M)}),l&&d.jsx("div",{className:"mb-8 break-inside-avoid print-break-avoid",children:d.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-lg flex justify-between items-center shadow-lg",children:[d.jsx("div",{className:"text-lg font-bold uppercase tracking-wide",children:"Grand Total"}),d.jsxs("div",{className:"text-2xl font-bold",children:[Le(b,t)," ",d.jsx("span",{className:"text-xs font-normal opacity-70",children:"(Excl. GST)"})]})]})}),d.jsxs("div",{className:"mt-8 break-inside-avoid print-break-avoid",children:[d.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mb-2 pb-1",children:"Terms & Conditions"}),d.jsx("div",{className:"text-[10px] text-slate-600 space-y-3",children:d.jsxs("div",{className:"grid grid-cols-[100px_1fr] gap-y-2 gap-x-4",children:[d.jsx("div",{className:"font-bold text-slate-800",children:"PRICE"}),d.jsx("div",{children:m.price}),d.jsx("div",{className:"font-bold text-slate-800",children:"PAYMENT"}),d.jsx("div",{children:(m.payment||[]).map((S,M)=>d.jsxs("span",{children:[S.percent,"% ",S.name,M<(m.payment||[]).length-1?", ":""]},M))}),d.jsx("div",{className:"font-bold text-slate-800",children:"DELIVERY"}),d.jsxs("div",{children:[m.deliveryWeeks," weeks"]}),d.jsx("div",{className:"font-bold text-slate-800",children:"GST"}),d.jsxs("div",{children:["Extra as applicable (currently ",Pt.DEFAULTS.GST_RATE,"%)"]}),d.jsx("div",{className:"font-bold text-slate-800",children:"WARRANTY"}),d.jsx("div",{className:"text-justify leading-snug",children:m.warranty||Pt.TEXT.WARRANTY})]})}),d.jsx("h3",{className:"font-bold text-slate-700 uppercase border-b border-slate-300 mt-4 mb-2 pb-1",children:"Client's Scope"}),d.jsxs("div",{className:"text-[10px] text-slate-600 grid gap-y-2",children:[m.scope?.structure&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Structure:"}),m.scope.structure]}),m.scope?.elec&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Electricity:"}),m.scope.elec]}),m.scope?.net&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Internet:"}),m.scope.net]}),m.scope?.soft&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Software:"}),m.scope.soft]}),m.scope?.perm&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Permissions:"}),m.scope.perm]}),m.scope?.pc&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Computer:"}),m.scope.pc]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-slate-800 block",children:"Validity:"}),m.validity||Pt.TEXT.VALIDITY]})]}),d.jsxs("div",{className:"mt-8 pt-8 border-t border-slate-200 flex justify-between items-end",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"h-12 mb-2"}),d.jsx("p",{className:"text-[10px] font-bold border-t border-slate-400 px-4 pt-1",children:"Client Acceptance"})]}),d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"h-12 mb-2"}),d.jsx("p",{className:"text-[10px] font-bold border-t border-slate-400 px-4 pt-1",children:"For Admire Sign & Display Pvt. Ltd."})]})]})]})]});return d.jsxs(Lt.Fragment,{children:[d.jsx("div",{className:"screen-preview-wrapper",children:E(!1)}),_N.createPortal(d.jsx("div",{className:"print-only-portal",children:E(!0)}),document.body)]})},v3=({user:s,inventory:e,transactions:t,exchangeRate:r,onLoadQuote:a,readOnly:l=!1})=>{const[u,p]=Lt.useState([]),[y,m]=Lt.useState(null);Lt.useEffect(()=>{if(!s)return;const S=On.collection("artifacts").doc(or).collection("public").doc("data").collection("quotes").orderBy("updatedAt","desc").onSnapshot(M=>{p(M.docs.map(z=>({id:z.id,...z.data()})))});return()=>S()},[s]);const b=async S=>{confirm("Are you sure you want to delete this quote?")&&await On.collection("artifacts").doc(or).collection("public").doc("data").collection("quotes").doc(S).delete()},E=S=>{if(S.allScreensData){m({allScreensData:S.allScreensData,client:S.client,project:S.project});return}const M=S.calculatorState;if(M.screens&&M.screens.length>0){const ee=M.screens.map(Q=>{const ae={...M,...Q};return Eo(ae,e,t,r)}).filter(Q=>Q!==null);if(ee.length>0){const Q={totalProjectCost:ee.reduce((ae,se)=>ae+se.totalProjectCost,0),totalProjectSell:ee.reduce((ae,se)=>ae+se.totalProjectSell,0),totalLEDSell:ee.reduce((ae,se)=>ae+se.matrix.led.sell*se.screenQty,0),totalServicesSell:ee.reduce((ae,se)=>ae+(se.matrix.sell.total-se.matrix.led.sell*se.screenQty),0),totalMargin:0,totalScreenQty:ee.reduce((ae,se)=>ae+Number(se.screenQty),0),calculations:ee,screenConfigs:M.screens};Q.totalMargin=Q.totalProjectSell-Q.totalProjectCost,m({allScreensData:Q,client:S.client,project:S.project});return}}const z=Eo(M,e,t,r);z?m({data:z,client:S.client,project:S.project}):alert("Could not calculate quote. Inventory items might be missing.")},I=S=>{let M=[],z=0,ee=0;if(S.allScreensData&&S.allScreensData.calculations)M=S.allScreensData.calculations,z=S.allScreensData.totalProjectSell,ee=S.allScreensData.totalProjectCost;else{const k=S.calculatorState;if(k&&k.screens&&k.screens.length>0)M=k.screens.map(x=>{const R={...k,...x};return Eo(R,e,t,r)}).filter(x=>x!==null);else{const x=Eo(k,e,t,r);x&&(M=[x])}M.length>0&&(ee=M.reduce((x,R)=>x+R.totalProjectCost,0),z=M.reduce((x,R)=>x+R.totalProjectSell,0))}if(M.length===0)return alert("Calculation failed. Inventory items might be missing.");const Q=(S.project||"").replace(/,/g," "),ae=(S.client||"").replace(/,/g," ");let se=`Project,${Q}
Client,${ae}
Date,${new Date().toLocaleDateString()}

`;M.forEach((k,x)=>{se+=`SCREEN CONFIGURATION #${x+1}
`,se+=`Dimensions,${k.finalWidth}m x ${k.finalHeight}m
`,se+=`Quantity,${k.screenQty}
`,se+=`
Bill of Materials (Config #${x+1})
Component,Specification,Qty/Scrn,Total Qty,Rate,Total Amount
`,k.detailedItems.forEach(R=>{const D=(R.name||"").replace(/"/g,'""'),C=(R.spec||"").replace(/"/g,'""'),P=R.qty*k.screenQty,N=R.total*k.screenQty;se+=`"${D}","${C}",${R.qty},${P},${R.unit.toFixed(2)},${N.toFixed(2)}
`}),se+=`
Subtotal (Cost),${k.totalProjectCost.toFixed(2)}
`,se+=`Subtotal (Sell),${k.totalProjectSell.toFixed(2)}
`,se+=`
--------------------------------

`}),se+=`PROJECT SUMMARY
`,se+=`Grand Total Cost,${ee.toFixed(2)}
`,se+=`Grand Total Sell,${z.toFixed(2)}
`,se+=`Net Margin,${(z-ee).toFixed(2)}
`;const xe=new Blob([se],{type:"text/csv;charset=utf-8;"}),oe=window.URL.createObjectURL(xe),Z=document.createElement("a");Z.href=oe,Z.download=`${ae.replace(/[^a-z0-9]/gi,"_")}_${Q.replace(/[^a-z0-9]/gi,"_")}_BOM.csv`,Z.click(),window.URL.revokeObjectURL(oe)};return d.jsxs("div",{className:"p-4 md:p-6 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:[y&&d.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex justify-center items-center p-4",children:d.jsxs("div",{className:"bg-white max-w-4xl w-full h-[90vh] rounded-lg shadow-2xl flex flex-col",children:[d.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-slate-100 rounded-t-lg",children:[d.jsxs("h2",{className:"font-bold text-lg text-slate-800 flex items-center gap-2",children:[d.jsx(O0,{size:20})," View Saved Quote"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 text-slate-600 hover:bg-slate-200 rounded",children:"Close"}),d.jsxs("button",{onClick:()=>{const S=document.title;document.title=`${y.client}_${y.project}_Quote`.replace(/[^a-zA-Z0-9_]/g,"_"),window.print(),document.title=S},className:"px-4 py-2 bg-teal-600 text-white hover:bg-teal-700 rounded flex items-center gap-2",children:[d.jsx(zf,{size:16})," Print / PDF"]})]})]}),d.jsx("div",{className:"flex-1 overflow-auto p-8 bg-slate-200",children:d.jsx(bN,{data:y.data?{...y.data,clientName:y.client,projectName:y.project}:null,allScreensData:y.allScreensData?{...y.allScreensData,clientName:y.client,projectName:y.project}:null,currency:"INR",exchangeRate:r})})]})}),d.jsx("div",{className:"flex justify-between items-center mb-6",children:d.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-slate-800 dark:text-white",children:[d.jsx(M0,{className:"w-5 h-5 text-teal-600 dark:text-teal-400"})," Saved Quotes"]})}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[u.map(S=>{const M=S.calculatorState||{};M.unit;const z=M.selectedPitch||"N/A",ee=M.selectedIndoor==="true";return d.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden flex flex-col",children:[d.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-start mb-2",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-lg text-slate-800 dark:text-white line-clamp-1",title:S.project,children:S.project||"Untitled"}),d.jsx("div",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:S.client||"No Client"})]}),d.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase ${ee?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"}`,children:ee?"Indoor":"Outdoor"})]}),d.jsx("div",{className:"text-xs text-slate-400 mb-4",children:new Date(S.updatedAt?.seconds*1e3).toLocaleString()}),d.jsx("div",{className:"bg-slate-50 dark:bg-slate-700/30 p-2 rounded-lg mb-4 space-y-1.5 flex-1",children:S.allScreensData?.calculations?S.allScreensData.calculations.map((Q,ae)=>d.jsxs("div",{className:"flex justify-between items-center text-xs border-b border-slate-100 dark:border-slate-600 last:border-0 pb-1 last:pb-0",children:[d.jsxs("span",{className:"text-slate-600 dark:text-slate-300 font-medium",children:["Screen #",ae+1," ",d.jsxs("span",{className:"text-slate-400 font-normal",children:["(",Q.finalWidth,"x",Q.finalHeight,"m / ",(Number(Q.finalWidth)*3.28084).toFixed(2),"x",(Number(Q.finalHeight)*3.28084).toFixed(2),"ft ",Q.screenQty,")"]})]}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:Le(Q.totalProjectSell,"INR",!0)})]},ae)):d.jsxs("div",{className:"flex justify-between items-center text-xs",children:[d.jsxs("span",{className:"text-slate-600 dark:text-slate-300 font-medium",children:["Screen #1 ",d.jsxs("span",{className:"text-slate-400 font-normal",children:["(P",z," ",M.screenQty||1,")"]})]}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:Le(S.finalAmount,"INR",!0)})]})}),d.jsxs("div",{className:"flex justify-between items-end pt-2 border-t border-slate-100 dark:border-slate-700 mt-auto",children:[d.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:"Total Estimate"}),d.jsx("span",{className:"text-xl font-bold text-teal-600 dark:text-teal-400",children:Le(S.finalAmount,"INR")})]})]}),d.jsxs("div",{className:`grid ${l?"grid-cols-2":"grid-cols-5"} border-t border-slate-100 dark:border-slate-700 divide-x divide-slate-100 dark:divide-slate-700 bg-slate-50 dark:bg-slate-800`,children:[d.jsxs("button",{onClick:()=>E(S),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-slate-600 dark:text-slate-300 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"View",children:[d.jsx(O0,{size:16})," ",d.jsx("span",{className:"hidden sm:inline",children:"View"})]}),!l&&d.jsxs("button",{onClick:()=>a(S,!1),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-blue-600 dark:text-blue-400 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"Edit",children:[d.jsx(To,{size:16})," ",d.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),d.jsxs("button",{onClick:()=>I(S),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-green-600 dark:text-green-400 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"Excel",children:[d.jsx(gC,{size:16})," ",d.jsx("span",{className:"hidden sm:inline",children:"Excel"})]}),!l&&d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:()=>a(S,!0),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-slate-500 hover:bg-white dark:hover:bg-slate-700 transition-colors",title:"Clone",children:[d.jsx(V0,{size:16})," ",d.jsx("span",{className:"hidden sm:inline",children:"Clone"})]}),d.jsxs("button",{onClick:()=>b(S.id),className:"py-3 flex flex-col items-center justify-center gap-1 text-[10px] font-bold text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",title:"Delete",children:[d.jsx(Os,{size:16})," ",d.jsx("span",{className:"hidden sm:inline",children:"Del"})]})]})]})]},S.id)}),u.length===0&&d.jsx("p",{className:"text-center text-slate-400 py-10 col-span-full",children:"No saved quotes found."})]})]})},x3=({data:s,allScreensData:e,inventory:t=[],transactions:r=[]})=>{if(!s&&!e)return null;const a=e&&e.calculations&&e.calculations.length>1;if(!a&&!s)return null;const l=(a?e.clientName:s?.clientName)||"",u=(a?e.projectName:s?.projectName)||"",p=(b,E,I)=>{const{detailedItems:S,screenQty:M,moduleType:z,cabinetType:ee,finalWidth:Q,finalHeight:ae}=b;return d.jsxs("div",{className:"mb-8 break-inside-avoid print-break-avoid",children:[a&&d.jsxs("div",{className:"bg-teal-50 dark:bg-teal-900/20 p-3 rounded-lg mb-3 border border-teal-200 dark:border-teal-800",children:[d.jsxs("h3",{className:"font-bold text-teal-800 dark:text-teal-300 text-sm",children:["Screen Configuration #",E+1]}),d.jsxs("div",{className:"flex flex-wrap gap-x-8 gap-y-3 mt-3 text-xs text-teal-800 dark:text-teal-300",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Target Size"}),I.targetWidth,"  ",I.targetHeight," ",I.unit||"m"]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Final Dimensions"}),Q,"m  ",ae,"m ",d.jsxs("span",{className:"text-teal-600/70",children:["/ ",(Number(Q)*3.28084).toFixed(2),"ft  ",(Number(ae)*3.28084).toFixed(2),"ft"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Quantity"}),M," Screens"]}),z&&d.jsxs("div",{children:[d.jsx("span",{className:"font-bold uppercase text-[10px] text-teal-600 dark:text-teal-500 tracking-wider block mb-0.5",children:"Type"}),"P",z.pitch," ",z.indoor?"Indoor":"Outdoor"]})]})]}),d.jsxs("table",{className:"w-full border-collapse border border-slate-300 text-[10px]",children:[d.jsx("thead",{className:"bg-slate-100 text-slate-700",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-2 border border-slate-300 text-left w-10",children:"#"}),d.jsx("th",{className:"p-2 border border-slate-300 text-left w-32",children:"Component"}),d.jsx("th",{className:"p-2 border border-slate-300 text-left",children:"Specification / Details"}),d.jsx("th",{className:"p-2 border border-slate-300 text-center w-16",children:"Qty/Scrn"}),d.jsx("th",{className:"p-2 border border-slate-300 text-center w-16",children:"Total Qty"})]})}),d.jsx("tbody",{children:S.map((se,xe)=>{const oe=t.find(k=>k.id===se.inventoryId);let Z=null;return oe&&(oe.type==="module"?Z=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",oe.width,"x",oe.height,"mm"]}),d.jsxs("span",{children:["LED: ",oe.ledType||"-"]}),d.jsxs("span",{children:["Bright: ",oe.brightness," nits"]}),d.jsxs("span",{children:["Ref: ",oe.refreshRate," Hz"]}),d.jsxs("span",{children:["Ang: ",oe.viewAngleH,"/",oe.viewAngleV]}),d.jsxs("span",{children:["IP: ",oe.ipFront,"/",oe.ipBack]}),d.jsxs("span",{children:["Pwr: ",oe.avgPower,"/",oe.maxPower," W"]}),d.jsxs("span",{children:["Wt: ",oe.weight," kg"]})]}):oe.type==="cabinet"?Z=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",oe.width,"x",oe.height,"mm"]}),d.jsxs("span",{children:["Mat: ",oe.material]}),d.jsxs("span",{children:["Weight: ",oe.weight," kg"]})]}):oe.type==="ready"?Z=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",oe.width,"x",oe.height,"mm"]}),d.jsxs("span",{children:["Mat: ",oe.material||"-"]}),d.jsxs("span",{children:["Bright: ",oe.brightness," nits"]}),d.jsxs("span",{children:["Ref: ",oe.refreshRate," Hz"]}),d.jsxs("span",{children:["IP: ",oe.ipFront,"/",oe.ipBack]})]}):oe.type==="card"?Z=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",oe.brand]}),d.jsxs("span",{children:["Model: ",oe.model]}),oe.ports&&d.jsxs("span",{children:["Ports: ",oe.ports]})]}):oe.type==="smps"||oe.type==="psu"?Z=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",oe.brand]}),d.jsxs("span",{children:["Model: ",oe.model]}),oe.amps&&d.jsxs("span",{children:["Amps: ",oe.amps,"A"]})]}):oe.type==="processor"&&(Z=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",oe.brand]}),d.jsxs("span",{children:["Model: ",oe.model]}),oe.ports&&d.jsxs("span",{children:["Ports: ",oe.ports]})]}))),d.jsxs("tr",{children:[d.jsx("td",{className:"p-2 border border-slate-300 text-center",children:xe+1}),d.jsx("td",{className:"p-2 border border-slate-300 font-bold align-top",children:se.name}),d.jsxs("td",{className:"p-2 border border-slate-300 align-top",children:[d.jsx("div",{className:"font-semibold",children:se.spec}),Z]}),d.jsx("td",{className:"p-2 border border-slate-300 text-center align-top",children:se.qty}),d.jsx("td",{className:"p-2 border border-slate-300 text-center font-bold align-top",children:se.qty*M})]},xe)})})]})]},E)},y=()=>{if(!a)return null;const b={},E=S=>r?r.filter(M=>M.itemId===S).reduce((M,z)=>M+(z.type==="in"?Number(z.qty):-Number(z.qty)),0):0;e.calculations.forEach((S,M)=>{S.detailedItems.forEach(z=>{const ee=z.inventoryId?z.inventoryId:`${z.name}_${z.spec}`;b[ee]||(b[ee]={name:z.name,spec:z.spec,inventoryId:z.inventoryId,id:z.id,totalQty:0});const Q=z.qty*S.screenQty;b[ee].totalQty+=Q})});const I=Object.values(b);return d.jsxs("div",{className:"mt-8 break-inside-avoid print-break-avoid border-t-4 border-slate-800 pt-6",children:[d.jsx("div",{className:"bg-slate-800 text-white p-3 rounded-t-lg mb-0 flex justify-between items-center",children:d.jsxs("div",{children:[d.jsx("h3",{className:"font-bold text-lg uppercase tracking-wide",children:"Consolidated Bill of Materials"}),d.jsx("p",{className:"text-xs text-slate-300 mt-1",children:"Combined quantities across all screen configurations"})]})}),d.jsxs("table",{className:"w-full border-collapse border border-slate-300 text-[10px]",children:[d.jsx("thead",{className:"bg-slate-700 text-white",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-2 border border-slate-600 text-left w-10",children:"#"}),d.jsx("th",{className:"p-2 border border-slate-600 text-left w-32",children:"Component"}),d.jsx("th",{className:"p-2 border border-slate-600 text-left",children:"Specification"}),d.jsx("th",{className:"p-2 border border-slate-600 text-center w-16",children:"Stock"}),d.jsx("th",{className:"p-2 border border-slate-600 text-center w-16",children:"Required"}),d.jsx("th",{className:"p-2 border border-slate-600 text-center w-16",children:"Balance"})]})}),d.jsx("tbody",{children:I.map((S,M)=>{const z=S.inventoryId?E(S.inventoryId):0,ee=z-S.totalQty,Q=S.inventoryId?t.find(se=>se.id===S.inventoryId):null;let ae=null;return Q&&(Q.type==="module"?ae=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",Q.width,"x",Q.height,"mm"]}),d.jsxs("span",{children:["LED: ",Q.ledType||"-"]}),d.jsxs("span",{children:["Bright: ",Q.brightness," nits"]}),d.jsxs("span",{children:["Ref: ",Q.refreshRate," Hz"]}),d.jsxs("span",{children:["Ang: ",Q.viewAngleH,"/",Q.viewAngleV]}),d.jsxs("span",{children:["IP: ",Q.ipFront,"/",Q.ipBack]}),d.jsxs("span",{children:["Pwr: ",Q.avgPower,"/",Q.maxPower," W"]}),d.jsxs("span",{children:["Wt: ",Q.weight," kg"]})]}):Q.type==="cabinet"?ae=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",Q.width,"x",Q.height,"mm"]}),d.jsxs("span",{children:["Mat: ",Q.material]}),d.jsxs("span",{children:["Weight: ",Q.weight," kg"]})]}):Q.type==="ready"?ae=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Size: ",Q.width,"x",Q.height,"mm"]}),d.jsxs("span",{children:["Mat: ",Q.material||"-"]}),d.jsxs("span",{children:["Bright: ",Q.brightness," nits"]}),d.jsxs("span",{children:["Ref: ",Q.refreshRate," Hz"]}),d.jsxs("span",{children:["IP: ",Q.ipFront,"/",Q.ipBack]})]}):Q.type==="card"?ae=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",Q.brand]}),d.jsxs("span",{children:["Model: ",Q.model]}),Q.ports&&d.jsxs("span",{children:["Ports: ",Q.ports]})]}):Q.type==="smps"||Q.type==="psu"?ae=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",Q.brand]}),d.jsxs("span",{children:["Model: ",Q.model]}),Q.amps&&d.jsxs("span",{children:["Amps: ",Q.amps,"A"]})]}):Q.type==="processor"&&(ae=d.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 mt-1 text-[9px] text-slate-500",children:[d.jsxs("span",{children:["Brand: ",Q.brand]}),d.jsxs("span",{children:["Model: ",Q.model]}),Q.ports&&d.jsxs("span",{children:["Ports: ",Q.ports]})]}))),d.jsxs("tr",{className:M%2===0?"bg-slate-50":"bg-white",children:[d.jsx("td",{className:"p-2 border border-slate-300 text-center",children:M+1}),d.jsx("td",{className:"p-2 border border-slate-300 font-bold align-top",children:S.name}),d.jsxs("td",{className:"p-2 border border-slate-300 align-top",children:[d.jsx("div",{className:"font-semibold",children:S.spec}),ae]}),d.jsx("td",{className:"p-2 border border-slate-300 text-center font-medium text-slate-600 align-top",children:S.inventoryId?z:"-"}),d.jsx("td",{className:"p-2 border border-slate-300 text-center font-bold align-top text-slate-800",children:S.totalQty}),d.jsx("td",{className:`p-2 border border-slate-300 text-center font-bold align-top ${ee>=0?"text-green-600":"text-red-600"}`,children:S.inventoryId?ee:"-"})]},M)})})]}),d.jsx("div",{className:"mt-4 p-3 bg-teal-50 dark:bg-teal-900/20 rounded-lg border border-teal-200 dark:border-teal-800",children:d.jsxs("div",{className:"grid grid-cols-3 gap-4 text-xs",children:[d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-teal-800 dark:text-teal-300",children:"Total Configurations:"}),d.jsx("span",{className:"ml-2 font-bold text-lg text-teal-600 dark:text-teal-400",children:e.calculations.length})]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-teal-800 dark:text-teal-300",children:"Total Screens:"}),d.jsx("span",{className:"ml-2 font-bold text-lg text-teal-600 dark:text-teal-400",children:e.totalScreenQty})]}),d.jsxs("div",{children:[d.jsx("span",{className:"font-bold text-teal-800 dark:text-teal-300",children:"Unique Components:"}),d.jsx("span",{className:"ml-2 font-bold text-lg text-teal-600 dark:text-teal-400",children:I.length})]})]})})]})},m=b=>d.jsxs("div",{className:`p-8 max-w-[210mm] mx-auto bg-white min-h-screen text-slate-800 font-sans text-xs ${b?"print-version-container p-0 w-full":""}`,children:[d.jsxs("div",{className:"flex justify-between items-start mb-6 border-b-2 border-slate-800 pb-4",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("img",{src:"/AdmireLED/logo.png",alt:"Logo",className:"h-12 w-auto"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-slate-900 uppercase tracking-wide",children:"Bill of Materials"}),d.jsxs("div",{className:"mt-1 space-y-0.5",children:[d.jsxs("p",{className:"text-sm font-bold text-slate-700",children:["Project: ",d.jsx("span",{className:"font-normal",children:u})]}),d.jsxs("p",{className:"text-sm font-bold text-slate-700",children:["Client: ",d.jsx("span",{className:"font-normal",children:l})]}),a&&d.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[e.calculations.length," Configs  ",e.totalScreenQty," Screens"]}),!a&&s.moduleType&&d.jsxs("p",{className:"text-xs text-slate-500 mt-1 font-medium flex items-center gap-2",children:[d.jsxs("span",{className:"inline-block bg-slate-100 px-2 py-0.5 rounded text-slate-700 font-bold border border-slate-200",children:["P",s.moduleType.pitch," ",s.moduleType.indoor?"Indoor":"Outdoor"]}),d.jsxs("span",{children:[s.finalWidth,"m x ",s.finalHeight,"m ",d.jsxs("span",{className:"text-slate-400",children:["/ ",(Number(s.finalWidth)*3.28084).toFixed(2),"ft x ",(Number(s.finalHeight)*3.28084).toFixed(2),"ft"]})]}),d.jsxs("span",{className:"font-bold text-slate-700 border-l border-slate-300 pl-2 ml-1",children:[s.screenQty," Screens"]})]})]})]})]}),d.jsx("div",{className:"text-right",children:d.jsx("p",{className:"text-xs text-slate-500",children:new Date().toLocaleDateString()})})]}),a?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mb-6",children:d.jsx("h2",{className:"text-sm font-bold text-slate-700 uppercase mb-3 pb-2 border-b border-slate-300",children:"Individual Screen Configurations"})}),e.calculations.map((E,I)=>p(E,I,e.screenConfigs?e.screenConfigs[I]:{})),y()]}):p(s,0,{}),d.jsx("div",{className:"mt-8 text-[10px] text-slate-400 border-t border-slate-200 pt-2 text-center",children:"Internal Document  Generated by Admire Sign LED Calculator"})]});return d.jsxs(Lt.Fragment,{children:[d.jsx("div",{className:"screen-preview-wrapper",children:m(!1)}),_N.createPortal(d.jsx("div",{className:"print-only-portal",children:m(!0)}),document.body)]})},w3=(s,e)=>{const[t,r]=Lt.useState(s);return Lt.useEffect(()=>{const a=setTimeout(()=>{r(s)},e);return()=>{clearTimeout(a)}},[s,e]),t},E3=({calculation:s,state:e,updateState:t,updateExtra:r,updateScreenProp:a,inventory:l,getStock:u,overrides:p,onOverride:y,editingRow:m,setEditingRow:b,onClearOverride:E})=>{const I=e.screens[e.activeScreenIndex],{screenQty:S,selectedPitch:M,selectedModuleId:z,selectedCabinetId:ee,selectedCardId:Q,selectedSMPSId:ae,selectedProcId:se,extraComponents:xe,extras:oe,commercials:Z}=I,{assemblyMode:k,selectedIndoor:x}=e,R=()=>Math.random().toString(36).substr(2,9).toUpperCase(),D=x==="true",C=l.filter(Y=>Y.type==="module"&&Y.indoor===D),P=[...new Set(C.map(Y=>Y.pitch))].sort((Y,Se)=>Y-Se),N=M?C.filter(Y=>Y.pitch==M):[],we=l.find(Y=>Y.id===z),Ye=l.filter(Y=>Y.type!=="cabinet"?!1:we?Y.width%we.width===0&&Y.height%we.height===0:!0),K=l.filter(Y=>Y.type==="ready"&&Y.indoor===D),me=Y=>{const Se=(ue,Dt)=>a(e.activeScreenIndex,ue,Dt);if(Y.id==="modules")return d.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[d.jsxs("select",{value:M,onChange:ue=>{Se("selectedPitch",ue.target.value),Se("selectedModuleId","")},className:"w-full md:w-20 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Pitch"}),P.map(ue=>d.jsxs("option",{value:ue,children:["P",ue]},ue))]}),d.jsxs("select",{value:z,onChange:ue=>Se("selectedModuleId",ue.target.value),disabled:!M,className:"w-full md:flex-1 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white disabled:opacity-50",children:[d.jsx("option",{value:"",children:"Select Module..."}),N.map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (",u(ue.id),")"]},ue.id))]})]});if(Y.id==="cabinets")return d.jsxs("select",{value:ee,onChange:ue=>Se("selectedCabinetId",ue.target.value),disabled:!we,className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white disabled:opacity-50",children:[d.jsx("option",{value:"",children:"Select Cabinet..."}),Ye.map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (",ue.width,"x",ue.height,") - Stock: ",u(ue.id)]},ue.id))]});if(Y.id==="cards")return d.jsxs("select",{value:Q,onChange:ue=>Se("selectedCardId",ue.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select Card..."}),l.filter(ue=>ue.type==="card").map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (",u(ue.id),")"]},ue.id))]});if(Y.id==="smps")return d.jsxs("select",{value:ae,onChange:ue=>Se("selectedSMPSId",ue.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select SMPS..."}),l.filter(ue=>ue.type==="smps").map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (",u(ue.id),")"]},ue.id))]});if(Y.id==="processor")return d.jsxs("div",{className:"flex flex-col gap-2 md:gap-1",children:[d.jsxs("select",{value:se,onChange:ue=>Se("selectedProcId",ue.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select Processor..."}),l.filter(ue=>ue.type==="processor").map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (",u(ue.id),")"]},ue.id))]}),d.jsxs("div",{className:"flex items-center gap-2 md:gap-1",children:[d.jsx("span",{className:"text-xs md:text-[10px] text-green-600 font-bold",children:"Sell:"}),d.jsx("input",{type:"number",className:"flex-1 md:w-20 p-2 md:p-0.5 text-xs border border-green-200 rounded bg-green-50 text-green-800",value:Z.processor?.val||0,onChange:ue=>a(e.activeScreenIndex,"commercials",{...Z,processor:{...Z.processor,val:ue.target.value}})})]})]});if(Y.id==="ready")return d.jsxs("select",{value:I.readyId,onChange:ue=>Se("readyId",ue.target.value),className:"w-full p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select Screen Model..."}),K.map(ue=>d.jsxs("option",{value:ue.id,children:[ue.brand," ",ue.model," (P",ue.pitch,")"]},ue.id))]});const qe=xe?xe.findIndex(ue=>ue.id===Y.id):-1;return qe!==-1?d.jsxs("div",{className:"flex gap-1 items-center",children:[d.jsxs("select",{value:xe[qe].componentId,onChange:ue=>{const Dt=[...xe];Dt[qe].componentId=ue.target.value,Se("extraComponents",Dt)},className:"flex-1 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"",children:"Select..."}),["module","cabinet","card","smps"].map(ue=>{const Dt=l.filter(vn=>vn.type===ue).sort((vn,Wt)=>(vn.brand+" "+vn.model).localeCompare(Wt.brand+" "+Wt.model));return Dt.length===0?null:d.jsx("optgroup",{label:ue==="smps"?"SMPS":ue.toUpperCase(),children:Dt.map(vn=>d.jsxs("option",{value:vn.id,children:[vn.brand," ",vn.model]},vn.id))},ue)})]}),d.jsxs("select",{value:xe[qe].type,onChange:ue=>{const Dt=[...xe];Dt[qe].type=ue.target.value,Se("extraComponents",Dt)},className:"w-16 p-2 md:p-1 text-xs border rounded bg-white dark:bg-slate-700 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"screen",children:"/Scrn"}),d.jsx("option",{value:"cabinet",children:"/Cab"})]}),d.jsx("button",{type:"button",onClick:()=>Se("extraComponents",xe.filter((ue,Dt)=>Dt!==qe)),className:"text-red-400 hover:text-red-600",children:d.jsx(Os,{size:16})})]}):d.jsxs("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:[Y.name," ",d.jsxs("span",{className:"text-[10px] text-slate-400 font-normal",children:["(",Y.spec,")"]})]})},Ee=Y=>s?.calculatedExtras?.[Y]||0,Me=s?.matrix?.sqft?.perScreen||1;let ke=s?s.detailedItems:k==="assembled"?[{id:"modules",type:"led",name:"Modules",qty:0,unit:0,total:0},{id:"cabinets",type:"led",name:"Cabinets",qty:0,unit:0,total:0},{id:"cards",type:"led",name:"Receiving Cards",qty:0,unit:0,total:0},{id:"smps",type:"led",name:"SMPS",qty:0,unit:0,total:0},{id:"processor",type:"service",name:"Processor",qty:1,unit:0,total:0}]:[{id:"ready",type:"led",name:"Ready Unit",qty:0,unit:0,total:0},{id:"processor",type:"service",name:"Processor",qty:1,unit:0,total:0}];!s&&xe?.length>0&&(ke=[...ke,...xe.map(Y=>({id:Y.id,type:"led",name:"Extra",spec:"Select...",qty:Y.qty,unit:0,total:0}))]);const V=ke.filter(Y=>Y.type==="led"),te=(Array.isArray(oe)?oe:[]).reduce((Y,Se)=>Y+Ee(Se.id),0),G=V.reduce((Y,Se)=>Y+Se.total*S,0)+te*S,le=G/(S||1),de=le/Me,pe=ke.filter(Y=>Y.type!=="led"),Re=Ee("install"),nt=Ee("structure"),Ft=pe.reduce((Y,Se)=>Y+Se.total*S,0)+(Re+nt)*S,bn=Ft/(S||1),Er=bn/Me,cn=G+Ft,Kn=cn/(S||1),Cn=Kn/Me,$n=()=>{const Y={id:R(),name:"New Cost",val:0,type:"abs"};a(e.activeScreenIndex,"extras",[...oe||[],Y])},Yn=Y=>{const Se=[...oe];Se.splice(Y,1),a(e.activeScreenIndex,"extras",Se)},We=(Y,Se,qe)=>{const ue=[...oe];ue[Y]={...ue[Y],[Se]:qe},a(e.activeScreenIndex,"extras",ue)},wt=Y=>d.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors ${Y.isOverridden?"bg-amber-50 dark:bg-amber-900/20":""}`,children:[d.jsx("td",{className:"p-2 pl-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("div",{className:"flex-1",children:me(Y)}),s&&d.jsxs(d.Fragment,{children:[d.jsx("button",{type:"button",onClick:()=>b(m===Y.id?null:Y.id),className:`p-1 rounded ${m===Y.id?"bg-teal-100 text-teal-700":"text-slate-300 hover:text-teal-600"}`,children:d.jsx(To,{size:12})}),Y.isOverridden&&d.jsx("button",{type:"button",onClick:()=>E(Y.id),className:"text-amber-500 hover:text-red-500",children:d.jsx(L0,{size:12})})]})]})}),d.jsx("td",{className:"p-2 text-right w-24",children:m===Y.id?d.jsx("input",{type:"number",className:"w-full p-1 text-right text-xs border rounded",value:p[Y.id]?.rate??Y.unit,onChange:Se=>y(Y.id,"rate",Se.target.value)}):Le(Y.unit,"INR",!1)}),d.jsx("td",{className:"p-2 text-center border-l border-slate-100 dark:border-slate-700 w-16",children:m===Y.id?d.jsx("input",{type:"number",className:"w-full p-1 text-center text-xs border rounded",value:p[Y.id]?.qty??Y.qty,onChange:Se=>y(Y.id,"qty",Se.target.value)}):Y.qty}),d.jsx("td",{className:"p-2 text-right text-slate-500 w-24",children:Le(Y.total,"INR",!1)}),d.jsx("td",{className:"p-2 text-right font-medium border-l border-slate-100 dark:border-slate-700 w-28",children:Le(Y.total*S,"INR",!1)})]},Y.id),kn=Y=>d.jsxs("div",{className:`bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 mb-3 shadow-sm ${Y.isOverridden?"ring-1 ring-amber-400 bg-amber-50 dark:bg-amber-900/10":""}`,children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("span",{className:"text-xs font-bold uppercase text-slate-500",children:Y.name}),s&&d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{type:"button",onClick:()=>b(m===Y.id?null:Y.id),className:`p-1 rounded ${m===Y.id?"bg-teal-100 text-teal-700":"text-slate-300 hover:text-teal-600"}`,children:d.jsx(To,{size:14})}),Y.isOverridden&&d.jsx("button",{type:"button",onClick:()=>E(Y.id),className:"text-amber-500 hover:text-red-500",children:d.jsx(L0,{size:14})})]})]}),d.jsx("div",{className:"mb-3",children:me(Y)}),d.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs bg-slate-50 dark:bg-slate-700/50 p-2 rounded",children:[d.jsxs("div",{children:[d.jsx("span",{className:"block text-[9px] uppercase text-slate-400 font-bold mb-1",children:"Rate"}),m===Y.id?d.jsx("input",{type:"number",className:"w-full p-1 text-right text-xs border rounded",value:p[Y.id]?.rate??Y.unit,onChange:Se=>y(Y.id,"rate",Se.target.value)}):d.jsx("span",{className:"block font-medium dark:text-slate-200",children:Le(Y.unit,"INR",!1)})]}),d.jsxs("div",{className:"text-center border-l border-slate-200 dark:border-slate-600",children:[d.jsx("span",{className:"block text-[9px] uppercase text-slate-400 font-bold mb-1",children:"Qty"}),m===Y.id?d.jsx("input",{type:"number",className:"w-full p-1 text-center text-xs border rounded",value:p[Y.id]?.qty??Y.qty,onChange:Se=>y(Y.id,"qty",Se.target.value)}):d.jsx("span",{className:"block font-medium dark:text-slate-200",children:Y.qty})]}),d.jsxs("div",{className:"text-right border-l border-slate-200 dark:border-slate-600",children:[d.jsx("span",{className:"block text-[9px] uppercase text-slate-400 font-bold mb-1",children:"Total"}),d.jsx("span",{className:"block font-bold text-teal-600 dark:text-teal-400",children:Le(Y.total*S,"INR",!1)})]})]})]},Y.id);return d.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[d.jsx("div",{className:"hidden md:block overflow-x-auto",children:d.jsxs("table",{className:"w-full text-xs text-left border-collapse",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 font-bold",children:[d.jsx("th",{className:"p-2",children:"Component Selection"}),d.jsx("th",{className:"p-2 text-right",children:"Rate (Cost)"}),d.jsx("th",{className:"p-2 text-center border-l border-slate-200 dark:border-slate-700",children:"Qty/Scrn"}),d.jsx("th",{className:"p-2 text-right",children:"Cost/Scrn"}),d.jsx("th",{className:"p-2 text-right border-l border-slate-200 dark:border-slate-700",children:"Total Cost"})]})}),d.jsxs("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:[d.jsx("tr",{className:"bg-slate-50 dark:bg-slate-800/50",children:d.jsx("td",{colSpan:"5",className:"p-2 font-bold text-teal-700 dark:text-teal-400 uppercase tracking-wider text-[10px]",children:"A. LED Panel & Logistics"})}),V.map(wt),d.jsx("tr",{className:"bg-white dark:bg-slate-900",children:d.jsx("td",{colSpan:"5",className:"p-2 text-center",children:d.jsxs("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"extraComponents",[...xe||[],{id:R(),componentId:"",qty:1,type:"screen"}]),className:"text-[10px] text-teal-600 hover:underline flex items-center justify-center gap-1 w-full",children:[d.jsx(aa,{size:10})," Add Component to Panel"]})})}),(Array.isArray(oe)?oe:[]).map((Y,Se)=>d.jsxs("tr",{className:"text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700/50 group",children:[d.jsx("td",{className:"p-2 pl-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>Yn(Se),className:"text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:d.jsx(Os,{size:12})}),d.jsx("input",{type:"text",value:Y.name,onChange:qe=>We(Se,"name",qe.target.value),className:"text-xs border-b border-transparent hover:border-slate-300 focus:border-teal-500 bg-transparent outline-none w-full text-slate-600 dark:text-slate-300 font-medium"})]})}),d.jsx("td",{className:"p-2 text-right",children:d.jsxs("div",{className:"flex items-center justify-end gap-1",children:[d.jsx("input",{type:"number",value:Y.val,onChange:qe=>We(Se,"val",qe.target.value),className:"w-16 p-1 text-right text-xs border rounded bg-white dark:bg-slate-800 dark:border-slate-600"}),d.jsx("button",{type:"button",onClick:()=>We(Se,"type",Y.type==="abs"?"pct":"abs"),className:"px-1 text-[10px] font-bold border rounded bg-slate-100 dark:bg-slate-700",children:Y.type==="abs"?"":"%"})]})}),d.jsx("td",{className:"p-2 text-center border-l border-slate-100 dark:border-slate-700 text-[10px] text-slate-400",children:Y.type==="pct"?`${Y.val}%`:"-"}),d.jsx("td",{className:"p-2 text-right",children:Le(Ee(Y.id),"INR",!1)}),d.jsx("td",{className:"p-2 text-right border-l border-slate-100 dark:border-slate-700",children:Le(Ee(Y.id)*S,"INR",!1)})]},Y.id)),d.jsx("tr",{className:"bg-slate-50 dark:bg-slate-800/20",children:d.jsx("td",{colSpan:"5",className:"p-1 text-center",children:d.jsxs("button",{onClick:$n,className:"text-[10px] text-blue-600 hover:text-blue-700 font-bold uppercase tracking-wider flex items-center justify-center gap-1 py-1 w-full hover:bg-slate-100 dark:hover:bg-slate-700 rounded transition-colors",children:[d.jsx(aa,{size:10})," Add Extra Cost"]})})}),d.jsxs("tr",{className:"bg-teal-50 dark:bg-teal-900/20 font-bold border-t border-teal-100 dark:border-teal-800",children:[d.jsx("td",{className:"p-2 text-right text-teal-800 dark:text-teal-300",children:"Sub-total (LED Panel)"}),d.jsxs("td",{className:"p-2 text-right text-teal-700 dark:text-teal-400 text-[10px] font-normal",children:[Le(de,"INR"),"/sqft"]}),d.jsx("td",{className:"p-2 text-center border-l border-teal-100 dark:border-teal-800",children:"-"}),d.jsx("td",{className:"p-2 text-right text-teal-800 dark:text-teal-300",children:Le(le,"INR",!1)}),d.jsx("td",{className:"p-2 text-right text-teal-800 dark:text-teal-300 border-l border-teal-100 dark:border-teal-800",children:Le(G,"INR",!1)})]}),d.jsx("tr",{className:"bg-slate-50 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-700",children:d.jsx("td",{colSpan:"5",className:"p-2 font-bold text-blue-700 dark:text-blue-400 uppercase tracking-wider text-[10px]",children:"B. Additional Costs"})}),pe.map(wt),["installation","structure"].map(Y=>{const Se=Y==="installation"?"install":"structure",qe=Y==="installation"?"Installation":"Structure";return d.jsxs("tr",{className:"text-slate-600 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[d.jsx("td",{className:"p-2 pl-4",children:d.jsxs("div",{className:"flex flex-col gap-1",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-xs font-medium",children:qe}),d.jsxs("select",{value:Z[Y]?.unit||"sqft",onChange:ue=>a(e.activeScreenIndex,"commercials",{...Z,[Y]:{...Z[Y],unit:ue.target.value}}),className:"text-[10px] p-0.5 border rounded bg-slate-50 dark:bg-slate-700",children:[d.jsx("option",{value:"sqft",children:"/Sq.Ft"}),d.jsx("option",{value:"screen",children:"/Screen"})]})]}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("span",{className:"text-[10px] text-green-600 font-bold",children:"Sell:"}),d.jsx("input",{type:"number",className:"w-20 p-0.5 text-xs border border-green-200 rounded bg-green-50 text-green-800",value:Z[Y]?.val||0,onChange:ue=>a(e.activeScreenIndex,"commercials",{...Z,[Y]:{...Z[Y],val:ue.target.value}})})]})]})}),d.jsx("td",{className:"p-2 text-right",children:d.jsxs("div",{className:"flex items-center justify-end gap-1",children:[d.jsx("span",{className:"text-[10px] text-slate-400 mr-1",children:"Cost:"}),d.jsx("input",{type:"number",value:Z[Y]?.cost||0,onChange:ue=>a(e.activeScreenIndex,"commercials",{...Z,[Y]:{...Z[Y],cost:ue.target.value}}),className:"w-16 p-1 text-right text-xs border rounded bg-white dark:bg-slate-800 dark:border-slate-600"}),d.jsx("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"commercials",{...Z,[Y]:{...Z[Y],costType:Z[Y]?.costType==="abs"?"pct":"abs"}}),className:"px-1 text-[10px] font-bold border rounded bg-slate-100 dark:bg-slate-700",children:Z[Y]?.costType==="abs"?"":"%"})]})}),d.jsx("td",{className:"p-2 text-center border-l border-slate-100 dark:border-slate-700 text-xs",children:Z[Y]?.unit==="sqft"?s?.matrix.sqft.perScreen.toFixed(1)||"-":"1"}),d.jsx("td",{className:"p-2 text-right",children:Le(Ee(Se),"INR",!1)}),d.jsx("td",{className:"p-2 text-right border-l border-slate-100 dark:border-slate-700",children:Le(Ee(Se)*S,"INR",!1)})]},Y)}),d.jsxs("tr",{className:"bg-blue-50 dark:bg-blue-900/20 font-bold border-t border-blue-100 dark:border-blue-800",children:[d.jsx("td",{className:"p-2 text-right text-blue-800 dark:text-blue-300",children:"Sub-total (Additional)"}),d.jsxs("td",{className:"p-2 text-right text-blue-700 dark:text-blue-400 text-[10px] font-normal",children:[Le(Er,"INR"),"/sqft"]}),d.jsx("td",{className:"p-2 text-center border-l border-blue-100 dark:border-blue-800",children:"-"}),d.jsx("td",{className:"p-2 text-right text-blue-800 dark:text-blue-300",children:Le(bn,"INR",!1)}),d.jsx("td",{className:"p-2 text-right text-blue-800 dark:text-blue-300 border-l border-blue-100 dark:border-blue-800",children:Le(Ft,"INR",!1)})]}),d.jsxs("tr",{className:"bg-slate-800 text-white font-bold border-t-2 border-slate-900 text-sm",children:[d.jsx("td",{className:"p-3 text-right uppercase",children:"Grand Total (Cost)"}),d.jsxs("td",{className:"p-3 text-right text-slate-300 text-xs font-normal",children:[Le(Cn,"INR"),"/sqft"]}),d.jsx("td",{className:"p-3 text-center border-l border-slate-600",children:"-"}),d.jsx("td",{className:"p-3 text-right border-l border-slate-600",children:Le(Kn,"INR",!1)}),d.jsx("td",{className:"p-3 text-right border-l border-slate-600",children:Le(cn,"INR",!1)})]})]})]})}),d.jsxs("div",{className:"md:hidden bg-slate-50 dark:bg-slate-800/20 p-3",children:[d.jsx("div",{className:"mb-2 font-bold text-teal-700 text-xs uppercase tracking-wider",children:"A. LED Panel & Logistics"}),V.map(kn),d.jsxs("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"extraComponents",[...xe||[],{id:R(),componentId:"",qty:1,type:"screen"}]),className:"w-full py-2 mb-4 bg-white dark:bg-slate-800 border border-teal-200 dark:border-teal-700 text-teal-600 dark:text-teal-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2",children:[d.jsx(aa,{size:14})," Add Component"]}),(Array.isArray(oe)?oe:[]).map((Y,Se)=>d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 mb-3 shadow-sm flex items-center justify-between",children:[d.jsx("div",{className:"flex-1",children:d.jsx("input",{type:"text",value:Y.name,onChange:qe=>We(Se,"name",qe.target.value),className:"text-xs font-bold border-b border-transparent focus:border-teal-500 bg-transparent outline-none w-full text-slate-600 dark:text-slate-300"})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("input",{type:"number",value:Y.val,onChange:qe=>We(Se,"val",qe.target.value),className:"w-12 p-1 text-right text-xs border rounded bg-slate-50 dark:bg-slate-700"}),d.jsx("button",{type:"button",onClick:()=>We(Se,"type",Y.type==="abs"?"pct":"abs"),className:"px-1 text-[10px] font-bold border rounded bg-slate-100 dark:bg-slate-600",children:Y.type==="abs"?"":"%"}),d.jsx("button",{onClick:()=>Yn(Se),className:"text-red-400 p-1",children:d.jsx(Os,{size:14})})]})]},Y.id)),d.jsxs("button",{onClick:$n,className:"w-full py-2 mb-4 bg-white dark:bg-slate-800 border border-blue-200 dark:border-blue-700 text-blue-600 dark:text-blue-400 rounded-lg text-xs font-bold flex items-center justify-center gap-2",children:[d.jsx(aa,{size:14})," Add Overhead Cost"]}),d.jsxs("div",{className:"bg-teal-50 dark:bg-teal-900/20 p-3 rounded-lg border border-teal-100 dark:border-teal-800 mb-6",children:[d.jsxs("div",{className:"flex justify-between items-center text-xs font-bold text-teal-800 dark:text-teal-300",children:[d.jsx("span",{children:"Sub-total (LED Panel)"}),d.jsx("span",{children:Le(G,"INR",!1)})]}),d.jsxs("div",{className:"text-[10px] text-right text-teal-600 dark:text-teal-400 mt-1",children:[Le(de,"INR"),"/sqft"]})]}),d.jsx("div",{className:"mb-2 font-bold text-blue-700 text-xs uppercase tracking-wider",children:"B. Additional Costs"}),pe.map(kn),["installation","structure"].map(Y=>{const Se=Y==="installation"?"install":"structure",qe=Y==="installation"?"Installation":"Structure";return d.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 rounded-lg border border-slate-200 dark:border-slate-700 mb-3 shadow-sm",children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("span",{className:"text-xs font-bold uppercase text-slate-500",children:qe}),d.jsxs("select",{value:Z[Y]?.unit||"sqft",onChange:ue=>a(e.activeScreenIndex,"commercials",{...Z,[Y]:{...Z[Y],unit:ue.target.value}}),className:"text-[10px] p-0.5 border rounded bg-slate-50 dark:bg-slate-700",children:[d.jsx("option",{value:"sqft",children:"/Sq.Ft"}),d.jsx("option",{value:"screen",children:"/Screen"})]})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[d.jsxs("div",{className:"flex items-center gap-1 bg-green-50 p-1 rounded border border-green-100",children:[d.jsx("span",{className:"text-[10px] text-green-600 font-bold",children:"Sell:"}),d.jsx("input",{type:"number",className:"w-full p-0.5 text-xs bg-transparent outline-none text-green-800 font-bold",value:Z[Y]?.val||0,onChange:ue=>a(e.activeScreenIndex,"commercials",{...Z,[Y]:{...Z[Y],val:ue.target.value}})})]}),d.jsxs("div",{className:"flex items-center gap-1 bg-slate-50 p-1 rounded border border-slate-100",children:[d.jsx("span",{className:"text-[10px] text-slate-400",children:"Cost:"}),d.jsx("input",{type:"number",className:"w-full p-0.5 text-xs bg-transparent outline-none",value:Z[Y]?.cost||0,onChange:ue=>a(e.activeScreenIndex,"commercials",{...Z,[Y]:{...Z[Y],cost:ue.target.value}})}),d.jsx("button",{type:"button",onClick:()=>a(e.activeScreenIndex,"commercials",{...Z,[Y]:{...Z[Y],costType:Z[Y]?.costType==="abs"?"pct":"abs"}}),className:"px-1 text-[10px] font-bold",children:Z[Y]?.costType==="abs"?"":"%"})]})]}),d.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-slate-100 dark:border-slate-700",children:[d.jsx("span",{className:"text-[10px] text-slate-400 font-bold",children:"Total Cost"}),d.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-300",children:Le(Ee(Se)*S,"INR",!1)})]})]},Y)}),d.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-100 dark:border-blue-800 mb-6",children:d.jsxs("div",{className:"flex justify-between items-center text-xs font-bold text-blue-800 dark:text-blue-300",children:[d.jsx("span",{children:"Sub-total (Additional)"}),d.jsx("span",{children:Le(Ft,"INR",!1)})]})}),d.jsxs("div",{className:"bg-slate-900 p-4 rounded-lg text-white shadow-lg",children:[d.jsxs("div",{className:"flex justify-between items-end mb-1",children:[d.jsx("span",{className:"text-xs uppercase text-slate-400 font-bold",children:"Grand Total (Cost)"}),d.jsx("span",{className:"text-lg font-bold",children:Le(cn,"INR",!1)})]}),d.jsxs("div",{className:"text-[10px] text-right text-slate-500",children:[Le(Cn,"INR"),"/sqft"]})]})]})]})},T3=({user:s,inventory:e,transactions:t,state:r,setState:a,exchangeRate:l,setExchangeRate:u,onSaveQuote:p,readOnly:y=!1})=>{const{client:m,project:b,screenQty:E,targetWidth:I,targetHeight:S,unit:M,selectedIndoor:z,assemblyMode:ee,sizingMode:Q,margin:ae,extras:se,overrides:xe,editingRow:oe}=r,[Z,k]=Lt.useState(null),[x,R]=Lt.useState(null),[D,C]=Lt.useState(!1),[P,N]=Lt.useState(!1),we=w3(r,300),Ye=B=>t?t.filter(G=>G.itemId===B).reduce((G,le)=>G+(le.type==="in"?Number(le.qty):-Number(le.qty)),0):0,K=(B,G)=>a(le=>({...le,[B]:G})),me=(B,G,le)=>{const de=r.activeScreenIndex;a(pe=>{const Re=[...pe.screens];return Re[de]={...Re[de],extras:{...Re[de].extras,[B]:{...Re[de].extras[B],[G]:le}}},{...pe,screens:Re}})},Ee=()=>{confirm("Reset calculator to defaults?")&&a({client:"",project:"",unit:"ft",screens:[{id:Ny(),screenQty:0,targetWidth:0,targetHeight:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",extraComponents:[],overrides:{},editingRow:null,extras:[],commercials:{processor:{val:0,unit:"screen",cost:0,costType:"abs"},installation:{val:0,unit:"sqft",cost:0,costType:"abs"},structure:{val:0,unit:"sqft",cost:0,costType:"abs"}}}],activeScreenIndex:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",margin:0,pricingMode:"margin",targetSellPrice:0,extraComponents:[],commercials:{processor:{val:0,unit:"screen"},installation:{val:0,unit:"sqft"},structure:{val:0,unit:"sqft"}},terms:{price:Pt.DEFAULTS.PRICE_BASIS,deliveryWeeks:Pt.DEFAULTS.DELIVERY_WEEKS,payment:Pt.DEFAULTS.PAYMENT_TERMS},extras:[],overrides:{},editingRow:null})},Me=()=>{const B={id:Ny(),screenQty:1,targetWidth:0,targetHeight:0,selectedIndoor:r.selectedIndoor,assemblyMode:r.assemblyMode,selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedPSUId:"",selectedProcId:"",sizingMode:"closest",readyId:"",extraComponents:[],overrides:{},editingRow:null,extras:[],commercials:{processor:{val:0,unit:"screen",cost:0,costType:"abs"},installation:{val:0,unit:"sqft",cost:0,costType:"abs"},structure:{val:0,unit:"sqft",cost:0,costType:"abs"}}};a(G=>({...G,screens:[...G.screens,B],activeScreenIndex:G.screens.length}))},ke=(B,G,le)=>{a(de=>{const pe=[...de.screens];return pe[B]={...pe[B],[G]:le},{...de,screens:pe}})},V=(B,G,le)=>{const de=r.screens[r.activeScreenIndex];ke(r.activeScreenIndex,"overrides",{...de.overrides,[B]:{...de.overrides[B],[G]:le}})},te=B=>{const le={...r.screens[r.activeScreenIndex].overrides};delete le[B],ke(r.activeScreenIndex,"overrides",le),ke(r.activeScreenIndex,"editingRow",null)};return Lt.useEffect(()=>{if(!we.screens||we.screens.length===0){k(null);return}const B=we.screens[we.activeScreenIndex];if(!B){k(null);return}const G={...we,...B},le=Eo(G,e,t,l);k(le)},[we,e,l]),Lt.useEffect(()=>{const G=(()=>{if(!we.screens||we.screens.length===0)return null;const le=we.screens.map(pe=>{const Re={...we,...pe};return Eo(Re,e,t,l)}).filter(pe=>pe!==null);if(le.length===0)return null;const de={totalProjectCost:le.reduce((pe,Re)=>pe+Re.totalProjectCost,0),totalProjectSell:le.reduce((pe,Re)=>pe+Re.totalProjectSell,0),totalLEDSell:le.reduce((pe,Re)=>pe+Re.matrix.led.sell*Re.screenQty,0),totalServicesSell:le.reduce((pe,Re)=>pe+(Re.matrix.sell.total-Re.matrix.led.sell*Re.screenQty),0),totalMargin:0,totalScreenQty:le.reduce((pe,Re)=>pe+Number(Re.screenQty),0),calculations:le,screenConfigs:we.screens};return de.totalMargin=de.totalProjectSell-de.totalProjectCost,de})();R(G)},[we,e,l]),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6 relative items-start",children:[P&&(Z||x)&&d.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex justify-center items-center p-4",children:d.jsxs("div",{className:"bg-white dark:bg-slate-900 max-w-5xl w-full h-[90vh] rounded-lg shadow-2xl flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center bg-slate-50 dark:bg-slate-800",children:[d.jsx("div",{className:"flex items-center gap-4",children:d.jsxs("h2",{className:"font-bold text-lg text-slate-800 dark:text-white flex items-center gap-2",children:[d.jsx(M0,{size:20,className:"text-teal-600"})," BOM"]})}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 rounded text-sm font-bold",children:"Close"}),d.jsxs("button",{onClick:()=>{const B=document.title;document.title=`${m}_${b}_BOM`.replace(/[^a-zA-Z0-9_]/g,"_"),window.print(),document.title=B},className:"px-4 py-2 bg-slate-800 text-white hover:bg-slate-700 rounded flex items-center gap-2 text-sm font-bold",children:[d.jsx(zf,{size:16})," Print"]})]})]}),d.jsx("div",{className:"flex-1 overflow-auto bg-slate-100 dark:bg-slate-800 p-8 flex justify-center",children:d.jsx(x3,{data:Z?{...Z,clientName:m,projectName:b}:null,allScreensData:x?{...x,clientName:m,projectName:b,screenConfigs:r.screens.map(B=>({targetWidth:B.targetWidth,targetHeight:B.targetHeight,unit:M}))}:null,inventory:e,transactions:t})})]})}),D&&(Z||x)&&d.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 flex justify-center items-center p-4",children:d.jsxs("div",{className:"bg-white max-w-4xl w-full h-[90vh] rounded-lg shadow-2xl flex flex-col",children:[d.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-slate-100 rounded-t-lg",children:[d.jsxs("h2",{className:"font-bold text-lg text-slate-800 flex items-center gap-2",children:[d.jsx(O0,{size:20})," Print Preview"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("button",{onClick:()=>C(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-200 rounded",children:"Close"}),d.jsxs("button",{onClick:()=>{const B=document.title;document.title=`${m}_${b}_Quote`.replace(/[^a-zA-Z0-9_]/g,"_"),window.print(),document.title=B},className:"px-4 py-2 bg-teal-600 text-white hover:bg-teal-700 rounded flex items-center gap-2",children:[d.jsx(zf,{size:16})," Print / Save PDF"]})]})]}),d.jsx("div",{className:"flex-1 overflow-auto p-8 bg-slate-200",children:d.jsx(bN,{data:Z?{...Z,clientName:m,projectName:b,margin:ae}:null,allScreensData:x?{...x,clientName:m,projectName:b}:null,currency:"INR",exchangeRate:l})})]})}),d.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[d.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden",children:[d.jsxs("div",{className:"bg-slate-50/50 dark:bg-slate-800/50 px-4 py-3 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center",children:[d.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2 text-sm",children:[d.jsx(jC,{className:"w-4 h-4 text-teal-600"})," Project Specs"]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("button",{onClick:Ee,className:"text-[10px] font-bold text-red-500 hover:text-red-700 uppercase hover:bg-red-50 dark:hover:bg-red-900/20 px-2 py-1 rounded transition-colors mr-2 flex items-center gap-1",children:[d.jsx(L0,{size:10})," Reset"]}),d.jsxs("div",{className:"flex bg-slate-200 dark:bg-slate-700 rounded-md p-0.5",children:[d.jsx("button",{onClick:()=>K("unit","m"),className:`px-2 py-0.5 text-[10px] font-bold rounded transition-all ${M==="m"?"bg-white dark:bg-slate-600 shadow text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400"}`,children:"M"}),d.jsx("button",{onClick:()=>K("unit","ft"),className:`px-2 py-0.5 text-[10px] font-bold rounded transition-all ${M==="ft"?"bg-white dark:bg-slate-600 shadow text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400"}`,children:"FT"})]})]})]}),d.jsxs("div",{className:"p-4 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsxs("div",{className:"relative group",children:[d.jsx("label",{className:"absolute -top-1.5 left-2 bg-white dark:bg-slate-800 px-1 text-[10px] font-bold text-teal-600 dark:text-teal-400",children:"CLIENT"}),d.jsx("input",{value:m,onChange:B=>K("client",B.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded text-sm outline-none focus:border-teal-500 focus:ring-1 focus:ring-teal-500 dark:text-white transition-all",placeholder:"Client Name"})]}),d.jsxs("div",{className:"relative group",children:[d.jsx("label",{className:"absolute -top-1.5 left-2 bg-white dark:bg-slate-800 px-1 text-[10px] font-bold text-teal-600 dark:text-teal-400",children:"PROJECT"}),d.jsx("input",{value:b,onChange:B=>K("project",B.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded text-sm outline-none focus:border-teal-500 focus:ring-1 focus:ring-teal-500 dark:text-white transition-all",placeholder:"Project Ref"})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsxs("div",{className:"flex items-center border border-slate-200 dark:border-slate-600 rounded-md overflow-hidden h-8",children:[d.jsx("div",{className:"bg-slate-100 dark:bg-slate-700 px-3 h-full flex items-center border-r border-slate-200 dark:border-slate-600 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase w-20 justify-center",children:"Type"}),d.jsxs("div",{className:"flex-1 flex p-0.5 bg-slate-50 dark:bg-slate-800 h-full",children:[d.jsx("button",{onClick:()=>{K("selectedIndoor","true"),ke(r.activeScreenIndex,"selectedIndoor","true")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${z==="true"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Indoor"}),d.jsx("button",{onClick:()=>{K("selectedIndoor","false"),ke(r.activeScreenIndex,"selectedIndoor","false")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${z==="false"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Outdoor"})]})]}),d.jsxs("div",{className:"flex items-center border border-slate-200 dark:border-slate-600 rounded-md overflow-hidden h-8",children:[d.jsx("div",{className:"bg-slate-100 dark:bg-slate-700 px-3 h-full flex items-center border-r border-slate-200 dark:border-slate-600 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase w-20 justify-center",children:"Supply"}),d.jsxs("div",{className:"flex-1 flex p-0.5 bg-slate-50 dark:bg-slate-800 h-full",children:[d.jsx("button",{onClick:()=>{K("assemblyMode","assembled"),ke(r.activeScreenIndex,"assemblyMode","assembled")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${ee==="assembled"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Assm"}),d.jsx("button",{onClick:()=>{K("assemblyMode","ready"),ke(r.activeScreenIndex,"assemblyMode","ready")},className:`flex-1 text-[10px] font-bold rounded-sm transition-all ${ee==="ready"?"bg-white dark:bg-slate-600 shadow text-teal-700 dark:text-teal-300":"text-slate-400 hover:text-slate-600"}`,children:"Ready"})]})]})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Screen Configurations"}),d.jsxs("button",{onClick:Me,className:"text-[10px] font-bold text-teal-600 dark:text-teal-400 hover:text-teal-700 dark:hover:text-teal-300 flex items-center gap-1 bg-teal-50 dark:bg-teal-900/30 px-2 py-1 rounded transition-colors border border-teal-100 dark:border-teal-800",children:[d.jsx(aa,{size:12})," Add Size"]})]}),d.jsxs("div",{className:"grid grid-cols-4 md:grid-cols-12 gap-2 mb-1 px-2 text-[9px] font-bold text-slate-400 uppercase tracking-wider hidden md:grid",children:[d.jsx("div",{className:"col-span-1 text-center",children:"#"}),d.jsxs("div",{className:"col-span-3",children:["Width (",M,")"]}),d.jsxs("div",{className:"col-span-3",children:["Height (",M,")"]}),d.jsx("div",{className:"col-span-2 text-center",children:"Qty"}),d.jsx("div",{className:"col-span-2",children:"Sizing"}),d.jsx("div",{className:"col-span-1 text-right",children:"Actions"})]}),d.jsx("div",{className:"space-y-1 max-h-[300px] overflow-y-auto pr-1 custom-scrollbar",children:r.screens.map((B,G)=>d.jsxs("div",{onClick:()=>a({...r,activeScreenIndex:G}),className:`grid grid-cols-4 md:grid-cols-12 gap-3 items-start p-3 rounded-lg border transition-all cursor-pointer ${r.activeScreenIndex===G?"border-teal-500 ring-1 ring-teal-500 bg-teal-50/50 dark:bg-teal-900/10":"border-slate-200 dark:border-slate-700 hover:border-teal-300"}`,children:[d.jsxs("div",{className:"col-span-4 md:col-span-1 flex justify-between md:justify-center items-center border-b md:border-b-0 pb-2 md:pb-0 mb-1 md:mb-0",children:[d.jsxs("span",{className:"text-xs font-bold text-slate-500 bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded",children:["#",G+1]}),d.jsxs("div",{className:"md:hidden flex gap-3",children:[d.jsx("button",{onClick:le=>{le.stopPropagation();const de=[...r.screens],pe=Math.random().toString(36).substr(2,9);de.splice(G+1,0,{...de[G],id:pe}),a({...r,screens:de,activeScreenIndex:G+1})},className:"text-blue-500 hover:text-blue-700 bg-blue-50 p-1.5 rounded",children:d.jsx(V0,{size:16})}),r.screens.length>1&&d.jsx("button",{onClick:le=>{le.stopPropagation();const de=r.screens.filter((pe,Re)=>Re!==G);a({...r,screens:de,activeScreenIndex:Math.max(0,G-1)})},className:"text-red-400 hover:text-red-600 bg-red-50 p-1.5 rounded",children:d.jsx(Os,{size:16})})]})]}),d.jsxs("div",{className:"col-span-2 md:col-span-3",children:[d.jsxs("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:["Width (",r.unit,")"]}),d.jsx("input",{type:"number",value:B.targetWidth,onChange:le=>ke(G,"targetWidth",le.target.value),className:"w-full p-2 text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white focus:border-teal-500 outline-none",placeholder:"W"})]}),d.jsxs("div",{className:"col-span-2 md:col-span-3",children:[d.jsxs("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:["Height (",r.unit,")"]}),d.jsx("input",{type:"number",value:B.targetHeight,onChange:le=>ke(G,"targetHeight",le.target.value),className:"w-full p-2 text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white focus:border-teal-500 outline-none",placeholder:"H"})]}),d.jsxs("div",{className:"col-span-2 md:col-span-2",children:[d.jsx("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:"Qty"}),d.jsx("input",{type:"number",value:B.screenQty,onChange:le=>ke(G,"screenQty",le.target.value),className:"w-full p-2 text-center text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white focus:border-teal-500 outline-none",placeholder:"Qty"})]}),d.jsxs("div",{className:"col-span-2 md:col-span-2",children:[d.jsx("label",{className:"md:hidden text-[10px] font-bold text-slate-400 mb-1 block uppercase",children:"Sizing"}),d.jsxs("select",{value:B.sizingMode,onChange:le=>ke(G,"sizingMode",le.target.value),className:"w-full p-2 text-sm border rounded dark:bg-slate-700 dark:border-slate-600 dark:text-white bg-white outline-none",children:[d.jsx("option",{value:"closest",children:"Closest"}),d.jsx("option",{value:"up",children:"Round Up"}),d.jsx("option",{value:"down",children:"Round Down"})]})]}),d.jsxs("div",{className:"hidden md:flex col-span-1 justify-end gap-1",children:[d.jsx("button",{onClick:le=>{le.stopPropagation();const de=[...r.screens],pe=Math.random().toString(36).substr(2,9);de.splice(G+1,0,{...de[G],id:pe}),a({...r,screens:de,activeScreenIndex:G+1})},className:"p-1.5 text-slate-400 hover:text-blue-500 hover:bg-blue-50 rounded transition-colors",title:"Duplicate",children:d.jsx(V0,{size:14})}),r.screens.length>1&&d.jsx("button",{onClick:le=>{le.stopPropagation();const de=r.screens.filter((pe,Re)=>Re!==G);a({...r,screens:de,activeScreenIndex:Math.max(0,G-1)})},className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Remove",children:d.jsx(Os,{size:14})})]})]},B.id))})]})]})]}),d.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:d.jsxs("details",{className:"group p-4",open:!0,children:[d.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[d.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[d.jsx(sI,{className:"w-4 h-4 text-teal-600"})," Hardware & Cost Breakdown",r.screens.length>1&&d.jsxs("span",{className:"text-xs font-normal text-slate-500 dark:text-slate-400",children:["(Screen #",r.activeScreenIndex+1," of ",r.screens.length,")"]})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-teal-600 text-xs font-bold group-open:hidden",children:"Show Table"}),d.jsx("span",{className:"text-slate-400 text-xs hidden group-open:block",children:"Hide Table"})]})]}),d.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100 dark:border-slate-700",children:[r.screens.length>1&&d.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:r.screens.map((B,G)=>{const le=r.activeScreenIndex===G,de=B.targetWidth&&B.targetHeight?`${B.targetWidth}${B.targetHeight}${M} (${B.screenQty})`:`Screen #${G+1}`;return d.jsx("button",{onClick:()=>K("activeScreenIndex",G),className:`flex-shrink-0 px-4 py-2 rounded-lg text-xs font-bold transition-all ${le?"bg-teal-600 text-white shadow-lg":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("span",{children:["#",G+1]}),d.jsx("span",{className:"text-[10px] opacity-75",children:de})]})},B.id)})}),r.screens[r.activeScreenIndex]&&d.jsx("div",{className:"mb-4 p-3 bg-slate-50 dark:bg-slate-700/30 rounded-lg border border-slate-200 dark:border-slate-600",children:d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Dimensions:"}),d.jsxs("span",{className:"ml-2 font-bold text-slate-800 dark:text-white",children:[r.screens[r.activeScreenIndex].targetWidth||0,"  ",r.screens[r.activeScreenIndex].targetHeight||0," ",M]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Quantity:"}),d.jsxs("span",{className:"ml-2 font-bold text-teal-600 dark:text-teal-400",children:[r.screens[r.activeScreenIndex].screenQty||0," screens"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Sizing:"}),d.jsx("span",{className:"ml-2 font-bold text-slate-800 dark:text-white capitalize",children:r.screens[r.activeScreenIndex].sizingMode})]}),Z&&d.jsxs("div",{children:[d.jsx("span",{className:"text-slate-500 dark:text-slate-400 font-semibold",children:"Final Size:"}),d.jsxs("span",{className:"ml-2 font-bold text-slate-800 dark:text-white",children:[Z.finalWidth,"  ",Z.finalHeight," m"]})]})]})}),d.jsx(E3,{calculation:Z,state:r,updateState:K,updateExtra:me,updateScreenProp:ke,inventory:e,getStock:Ye,overrides:r.screens[r.activeScreenIndex]?.overrides||{},onOverride:V,editingRow:r.screens[r.activeScreenIndex]?.editingRow,setEditingRow:B=>ke(r.activeScreenIndex,"editingRow",B),onClearOverride:te})]})]})}),d.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700",children:d.jsxs("details",{className:"group p-4",children:[d.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[d.jsx("span",{className:"text-sm font-bold text-slate-600 dark:text-slate-300",children:"Terms & Conditions"}),d.jsx("span",{className:"text-teal-600 text-xs group-open:hidden",children:"Show Details"})]}),d.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-slate-100 dark:border-slate-700",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Price Basis"}),d.jsx("input",{value:r.terms?.price,onChange:B=>a(G=>({...G,terms:{...G.terms,price:B.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Delivery Weeks"}),d.jsx("input",{type:"number",value:r.terms?.deliveryWeeks,onChange:B=>a(G=>({...G,terms:{...G.terms,deliveryWeeks:B.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),d.jsxs("div",{className:"col-span-1 md:col-span-2",children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 block mb-2",children:"Payment Milestones"}),(r.terms?.payment||[]).map((B,G)=>d.jsxs("div",{className:"flex gap-2 mb-2",children:[d.jsx("input",{value:B.name,onChange:le=>{const de=[...r.terms.payment];de[G].name=le.target.value,a(pe=>({...pe,terms:{...pe.terms,payment:de}}))},className:"flex-1 p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white",placeholder:"Milestone Name"}),d.jsx("input",{type:"number",value:B.percent,onChange:le=>{const de=[...r.terms.payment];de[G].percent=Number(le.target.value),a(pe=>({...pe,terms:{...pe.terms,payment:de}}))},className:"w-16 p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white",placeholder:"%"}),d.jsx("button",{onClick:()=>{const le=r.terms.payment.filter((de,pe)=>pe!==G);a(de=>({...de,terms:{...de.terms,payment:le}}))},className:"text-red-400",children:d.jsx(nm,{size:14})})]},G)),d.jsx("button",{onClick:()=>a(B=>({...B,terms:{...B.terms,payment:[...B.terms.payment||[],{name:"",percent:0}]}})),className:"text-xs text-teal-600 font-bold",children:"+ Add Milestone"})]}),d.jsxs("div",{className:"col-span-1 md:col-span-2 space-y-4 pt-4 border-t border-slate-100 dark:border-slate-700",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Validity"}),d.jsx("input",{value:r.terms?.validity,onChange:B=>a(G=>({...G,terms:{...G.terms,validity:B.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400",children:"Warranty Terms"}),d.jsx("textarea",{rows:4,value:r.terms?.warranty,onChange:B=>a(G=>({...G,terms:{...G.terms,warranty:B.target.value}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-[10px] uppercase font-bold text-teal-600 dark:text-teal-400 mb-2 block",children:"Client Scope of Work"}),d.jsx("div",{className:"grid grid-cols-1 gap-2",children:Object.entries(r.terms?.scope||{}).map(([B,G])=>d.jsxs("div",{children:[d.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase",children:B==="elec"?"Electricity":B==="net"?"Internet":B==="soft"?"Software":B==="perm"?"Permissions":B==="pc"?"Computer":B}),d.jsx("textarea",{rows:2,value:G,onChange:le=>a(de=>({...de,terms:{...de.terms,scope:{...de.terms.scope,[B]:le.target.value}}})),className:"w-full p-2 border rounded text-xs dark:bg-slate-700 dark:border-slate-600 dark:text-white"})]},B))})]})]})]})]})}),d.jsx("div",{className:"h-10"})]}),d.jsxs("div",{className:"lg:col-span-4 space-y-6 lg:sticky lg:top-24",children:[d.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-lg border border-slate-200 dark:border-slate-700 overflow-hidden",children:[d.jsxs("div",{className:"p-5 bg-gradient-to-br from-slate-50 to-white dark:from-slate-700 dark:to-slate-800",children:[r.screens.length>1&&x&&d.jsxs("div",{className:"mb-4 pb-4 border-b border-slate-200 dark:border-slate-600",children:[d.jsx("div",{className:"text-[10px] uppercase font-bold text-slate-400 mb-2",children:"Project Summary"}),d.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[d.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-2 rounded",children:[d.jsx("div",{className:"text-[10px] text-blue-600 dark:text-blue-400 font-semibold",children:"Screen Types"}),d.jsx("div",{className:"font-bold text-blue-800 dark:text-blue-300",children:r.screens.length})]}),d.jsxs("div",{className:"bg-teal-50 dark:bg-teal-900/20 p-2 rounded",children:[d.jsx("div",{className:"text-[10px] text-teal-600 dark:text-teal-400 font-semibold",children:"Total Qty"}),d.jsx("div",{className:"font-bold text-teal-800 dark:text-teal-300",children:x.totalScreenQty})]})]})]}),d.jsxs("div",{className:"flex justify-between items-center mb-2",children:[d.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Margin Strategy"}),d.jsxs("select",{value:r.pricingMode||"margin",onChange:B=>{const G=B.target.value;if(K("pricingMode",G),G!=="margin"&&Z){let le=0;G==="screen"?le=Z.matrix.sell.unit:G==="sqft"?le=Z.matrix.sell.sqft:G==="sqm"&&(le=Z.matrix.sell.sqft*10.7639),K("targetSellPrice",Math.round(le))}},className:"text-xs border-none bg-transparent font-bold text-teal-600 dark:text-teal-400 focus:ring-0 cursor-pointer outline-none",children:[d.jsx("option",{value:"margin",children:"Margin %"}),d.jsx("option",{value:"sqft",children:"Price / Sq.Ft"}),d.jsx("option",{value:"sqm",children:"Price / Sq.Mtr"}),d.jsx("option",{value:"screen",children:"Price / Screen"})]})]}),d.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[d.jsx("input",{type:"number",value:r.pricingMode==="margin"?ae:r.targetSellPrice,onChange:B=>{const G=parseFloat(B.target.value)||0;r.pricingMode==="margin"?K("margin",G):K("targetSellPrice",G)},className:"w-24 text-center text-xl font-bold p-2 border rounded-lg bg-white dark:bg-slate-600 dark:border-slate-500 shadow-sm focus:ring-2 focus:ring-teal-500/50 outline-none dark:text-white"}),d.jsx("span",{className:"text-lg font-bold text-slate-400",children:r.pricingMode==="margin"?"%":""}),d.jsxs("div",{className:"flex-1 text-right",children:[d.jsx("div",{className:"text-[10px] text-slate-400 uppercase font-bold",children:r.screens.length>1?"Total Profit":"Est. Profit"}),d.jsx("div",{className:`text-sm font-bold ${(x?x.totalMargin:Z?.matrix.margin.total||0)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:x?Le(x.totalMargin,"INR"):Z?Le(Z.matrix.margin.total,"INR"):"-"})]})]}),d.jsx("div",{className:"space-y-3 pt-4 border-t border-slate-100 dark:border-slate-600",children:r.screens.length>1?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex justify-between items-end",children:[d.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"LED Panels (All)"}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:x?Le(x.totalLEDSell,"INR"):"-"})]}),d.jsxs("div",{className:"flex justify-between items-end",children:[d.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Services & Extras"}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:x?Le(x.totalServicesSell,"INR"):"-"})]}),d.jsxs("details",{className:"group",children:[d.jsx("summary",{className:"text-[10px] text-teal-600 dark:text-teal-400 font-bold uppercase cursor-pointer hover:underline",children:"View Screen Breakdown"}),d.jsx("div",{className:"mt-2 space-y-2 pl-2 border-l-2 border-slate-200 dark:border-slate-600",children:x?.calculations.map((B,G)=>d.jsx("div",{className:"text-xs",children:d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("span",{className:"text-slate-500 dark:text-slate-400",children:["Screen #",G+1,d.jsxs("span",{className:"text-[10px] ml-1",children:["(",r.screens[G].targetWidth,"",r.screens[G].targetHeight,M," ",B.screenQty,")"]})]}),d.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-300",children:Le(B.totalProjectSell,"INR")})]})},G))})]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex justify-between items-end",children:[d.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"LED Panel Price"}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:Z?Le(Z.matrix.led.sell*Z.screenQty,"INR"):"-"})]}),d.jsxs("div",{className:"flex justify-between items-end",children:[d.jsx("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Services & Extras"}),d.jsx("span",{className:"font-bold text-slate-800 dark:text-white",children:Z?Le(Z.matrix.sell.total-Z.matrix.led.sell*Z.screenQty,"INR"):"-"})]}),d.jsxs("div",{className:"flex justify-between items-end pt-2 mt-2 border-t border-dashed border-slate-200 dark:border-slate-600",children:[d.jsx("span",{className:"text-sm font-bold text-slate-600 dark:text-slate-300",children:"Rate / Sq.Ft"}),d.jsx("span",{className:"font-bold text-slate-500 dark:text-slate-400",children:Z?Le(Z.matrix.sell.sqft,"INR"):"-"})]})]})})]}),d.jsxs("div",{className:"bg-slate-900 p-5 text-white",children:[d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsx("span",{className:"text-sm text-slate-400",children:"Grand Total (Ex. GST)"}),r.screens.length>1&&d.jsxs("span",{className:"text-xs text-teal-400 font-bold",children:[x?.totalScreenQty||0," screens"]})]}),d.jsx("div",{className:"flex justify-between items-baseline",children:d.jsx("span",{className:"text-3xl font-bold tracking-tight",children:x?Le(x.totalProjectSell,"INR"):Z?Le(Z.totalProjectSell,"INR"):"-"})}),d.jsxs("div",{className:"flex gap-2 mt-4",children:[d.jsxs("button",{onClick:()=>N(!0),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 transition-colors border border-slate-700 py-2",children:[d.jsx(M0,{size:16,className:"text-blue-400"})," BOM"]}),d.jsxs("button",{onClick:()=>C(!0),className:"flex-1 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-xs font-bold flex flex-col items-center justify-center gap-1 transition-colors border border-slate-700 py-2",children:[d.jsx(zf,{size:16})," Print"]}),!y&&d.jsxs("button",{onClick:()=>p(x?x.totalProjectSell:Z?.totalProjectSell),className:"flex-[2] bg-teal-600 hover:bg-teal-500 text-white font-bold rounded-lg shadow-lg shadow-teal-900/20 transition-all flex justify-center items-center gap-2 py-2",children:[d.jsx(DC,{size:18})," Save"]})]})]})]}),d.jsx("div",{className:"bg-slate-900 rounded-xl shadow-lg p-6 text-white overflow-hidden relative min-h-[250px] flex items-center justify-center",children:Z?d.jsx("div",{className:"w-full h-full flex items-center justify-center p-4",children:d.jsx(b3,{cols:Z.gridCols,rows:Z.gridRows,module:Z.moduleType,cabinet:Z.cabinetType,unit:M})}):d.jsxs("div",{className:"text-slate-500 flex flex-col items-center",children:[d.jsx(IC,{size:32,className:"mb-2 opacity-50"}),d.jsx("span",{children:"Enter dimensions"})]})})]})]})},I3=()=>{const[s,e]=bt.useState([]),[t,r]=bt.useState({username:"",password:"",role:"labour"}),[a,l]=bt.useState(!1);bt.useEffect(()=>{const y=On.collection("artifacts").doc(or).collection("public").doc("data").collection("user_roles").onSnapshot(m=>{e(m.docs.map(b=>({id:b.id,...b.data()})))});return()=>y()},[]);const u=async()=>{if(!t.username||!t.password)return alert("Missing fields");l(!0);const y=ts.initializeApp(p3.options,"Secondary");try{const m=`${t.username.trim().toLowerCase()}@admire.internal`;await y.auth().createUserWithEmailAndPassword(m,t.password),await On.collection("artifacts").doc(or).collection("public").doc("data").collection("user_roles").doc(t.username.trim().toLowerCase()).set({role:t.role,createdAt:new Date().toISOString()}),r({username:"",password:"",role:"labour"}),alert("User created successfully")}catch(m){console.error(m),alert("Error: "+m.message)}finally{y.auth().signOut(),y.delete(),l(!1)}},p=async y=>{confirm(`Remove access for ${y}? (Note: This removes their role. To fully delete login access, use Firebase Console)`)&&await On.collection("artifacts").doc(or).collection("public").doc("data").collection("user_roles").doc(y).delete()};return d.jsxs("div",{className:"p-6 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[d.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 mb-6 text-slate-800 dark:text-white",children:[d.jsx(OC,{className:"text-teal-600"})," User Management"]}),d.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/30 p-4 rounded-lg border border-slate-200 dark:border-slate-700 mb-8",children:[d.jsx("h3",{className:"text-xs font-bold uppercase text-slate-500 mb-3",children:"Create New User"}),d.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.jsx("input",{placeholder:"Username",value:t.username,onChange:y=>r({...t,username:y.target.value}),className:"flex-1 min-w-[150px] p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"}),d.jsx("input",{type:"password",placeholder:"Password",value:t.password,onChange:y=>r({...t,password:y.target.value}),className:"flex-1 min-w-[150px] p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white"}),d.jsxs("select",{value:t.role,onChange:y=>r({...t,role:y.target.value}),className:"p-2 text-sm border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white",children:[d.jsx("option",{value:"labour",children:"Labour (Read Only)"}),d.jsx("option",{value:"supervisor",children:"Supervisor (Stock Write)"}),d.jsx("option",{value:"manager",children:"Manager (Full Access)"}),d.jsx("option",{value:"super_admin",children:"Super Admin"})]}),d.jsx("button",{onClick:u,disabled:a,className:"bg-teal-600 text-white px-4 py-2 rounded font-bold hover:bg-teal-700 disabled:opacity-50 text-sm",children:a?"...":d.jsx(aa,{size:18})})]})]}),d.jsx("div",{className:"overflow-hidden rounded-lg border border-slate-200 dark:border-slate-700",children:d.jsxs("table",{className:"w-full text-left text-sm",children:[d.jsx("thead",{className:"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 uppercase font-bold text-xs",children:d.jsxs("tr",{children:[d.jsx("th",{className:"p-3",children:"Username"}),d.jsx("th",{className:"p-3",children:"Role"}),d.jsx("th",{className:"p-3 text-right",children:"Action"})]})}),d.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700 bg-white dark:bg-slate-800",children:s.map(y=>d.jsxs("tr",{children:[d.jsx("td",{className:"p-3 font-medium dark:text-white",children:y.id}),d.jsx("td",{className:"p-3",children:d.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${y.role==="super_admin"?"bg-purple-100 text-purple-700":y.role==="manager"?"bg-blue-100 text-blue-700":y.role==="supervisor"?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-700"}`,children:y.role})}),d.jsx("td",{className:"p-3 text-right",children:d.jsx("button",{onClick:()=>p(y.id),className:"text-red-400 hover:text-red-600 p-1 hover:bg-red-50 rounded",children:d.jsx(Os,{size:16})})})]},y.id))})]})})]})},S3=()=>{const[s,e]=bt.useState({username:"",password:""}),[t,r]=bt.useState(""),a=async l=>{l.preventDefault(),r("");try{const u=`${s.username.trim().toLowerCase()}@admire.internal`;await Ay.signInWithEmailAndPassword(u,s.password)}catch(u){console.error(u),r("Invalid credentials")}};return d.jsx("div",{className:"min-h-screen bg-slate-100 flex items-center justify-center p-4 font-sans",children:d.jsxs("div",{className:"bg-white p-8 rounded-xl shadow-lg w-full max-w-sm border border-slate-200",children:[d.jsxs("div",{className:"flex flex-col items-center mb-6",children:[d.jsx("img",{src:"/AdmireLED/logo.png",alt:"Logo",className:"h-12 mb-4"}),d.jsx("h1",{className:"text-xl font-bold text-slate-800",children:"Staff Portal"}),d.jsx("p",{className:"text-slate-500 text-xs",children:"Please log in to continue"})]}),d.jsxs("form",{onSubmit:a,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Username"}),d.jsxs("div",{className:"relative",children:[d.jsx(qC,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),d.jsx("input",{type:"text",className:"w-full pl-10 p-2 text-sm border rounded focus:ring-2 focus:ring-teal-500 outline-none",placeholder:"Enter username",value:s.username,onChange:l=>e({...s,username:l.target.value})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold text-slate-500 uppercase mb-1",children:"Password"}),d.jsxs("div",{className:"relative",children:[d.jsx(xC,{className:"absolute left-3 top-2.5 text-slate-400",size:16}),d.jsx("input",{type:"password",className:"w-full pl-10 p-2 text-sm border rounded focus:ring-2 focus:ring-teal-500 outline-none",placeholder:"Enter password",value:s.password,onChange:l=>e({...s,password:l.target.value})})]})]}),t&&d.jsx("div",{className:"text-red-500 text-xs text-center font-bold bg-red-50 p-2 rounded",children:t}),d.jsx("button",{type:"submit",className:"w-full bg-teal-600 text-white py-2 rounded-lg font-bold hover:bg-teal-700 transition shadow-sm text-sm",children:"Login"})]})]})})},A3=()=>{const[s,e]=bt.useState(null),[t,r]=bt.useState(null),[a,l]=bt.useState("quote"),[u,p]=bt.useState(!0),[y,m]=bt.useState([]),[b,E]=bt.useState([]),[I,S]=bt.useState(!1),[M,z]=bt.useState(Pt.DEFAULTS.EXCHANGE_RATE),ee={client:"",project:"",unit:"m",screens:[{id:Ny(),screenQty:0,targetWidth:0,targetHeight:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",extraComponents:[],overrides:{},editingRow:null,extras:[],commercials:{processor:{val:0,unit:"screen",cost:0,costType:"abs"},installation:{val:0,unit:"sqft",cost:0,costType:"abs"},structure:{val:0,unit:"sqft",cost:0,costType:"abs"}}}],activeScreenIndex:0,selectedIndoor:"true",assemblyMode:"assembled",selectedPitch:"",selectedModuleId:"",selectedCabinetId:"",selectedCardId:"",selectedSMPSId:"",selectedProcId:"",sizingMode:"closest",readyId:"",margin:0,targetSellPrice:0,pricingMode:"margin",commercials:{processor:{val:0,unit:"screen"},installation:{val:0,unit:"sqft"},structure:{val:0,unit:"sqft"}},terms:{price:Pt.DEFAULTS.PRICE_BASIS,deliveryWeeks:Pt.DEFAULTS.DELIVERY_WEEKS,payment:Pt.DEFAULTS.PAYMENT_TERMS,validity:Pt.TEXT.VALIDITY,warranty:Pt.TEXT.WARRANTY,scope:{structure:Pt.TEXT.SCOPE_STRUCTURE,elec:Pt.TEXT.SCOPE_ELEC,net:Pt.TEXT.SCOPE_NET,soft:Pt.TEXT.SCOPE_SOFT,perm:Pt.TEXT.SCOPE_PERM,pc:Pt.TEXT.SCOPE_PC}},extraComponents:[],extras:[],overrides:{},editingRow:null},[Q,ae]=bt.useState(ee);bt.useEffect(()=>{const D=Ay.onAuthStateChanged(async C=>{if(C){const P=C.email.split("@")[0].toLowerCase();e({...C,username:P});const N=await On.collection("artifacts").doc(or).collection("public").doc("data").collection("user_roles").doc(P).get();N.exists?r(N.data().role):r(P==="admin"?"super_admin":"labour")}else e(null),r(null);p(!1)});return()=>D()},[]),bt.useEffect(()=>{if(!s||!On)return;const D=On.collection("artifacts").doc(or).collection("public").doc("data").collection("inventory").onSnapshot(P=>m(P.docs.map(N=>({id:N.id,...N.data()})))),C=On.collection("artifacts").doc(or).collection("public").doc("data").collection("transactions").onSnapshot(P=>E(P.docs.map(N=>({id:N.id,...N.data()}))));return()=>{D(),C()}},[s]),bt.useEffect(()=>{document.documentElement.classList.toggle("dark",I)},[I]);const se=()=>Ay.signOut(),xe=async D=>{if(!Q.client||!Q.project)return alert("Please enter Client and Project names.");let C=null;if(Q.screens&&Q.screens.length>0){const P=Q.screens.map(N=>{const we={...Q,...N};return Eo(we,y,b,M)}).filter(N=>N!==null);P.length>0&&(C={totalProjectCost:P.reduce((N,we)=>N+we.totalProjectCost,0),totalProjectSell:P.reduce((N,we)=>N+we.totalProjectSell,0),totalLEDSell:P.reduce((N,we)=>N+we.matrix.led.sell*we.screenQty,0),totalServicesSell:P.reduce((N,we)=>N+(we.matrix.sell.total-we.matrix.led.sell*we.screenQty),0),totalMargin:0,totalScreenQty:P.reduce((N,we)=>N+we.screenQty,0),calculations:P,screenConfigs:Q.screens},C.totalMargin=C.totalProjectSell-C.totalProjectCost)}try{await On.collection("artifacts").doc(or).collection("public").doc("data").collection("quotes").add({client:Q.client,project:Q.project,calculatorState:Q,finalAmount:D||0,screenCount:Q.screens.length,totalScreenQty:C?.totalScreenQty||0,allScreensData:C,updatedAt:new Date}),alert("Quote Saved Successfully!")}catch(P){console.error(P),alert("Error saving quote.")}},oe=(D,C)=>{const P={...ee,...D.calculatorState};P.terms={...ee.terms,...D.calculatorState.terms||{},scope:{...ee.terms.scope,...D.calculatorState.terms?.scope||{}}},C&&(P.client=P.client+" (Copy)",P.project=P.project+" (Copy)"),ae(P),l("quote")};if(u)return d.jsx("div",{className:"h-screen flex items-center justify-center bg-slate-50 dark:bg-slate-900",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})});if(!s)return d.jsx(S3,{});const Z=["super_admin"].includes(t),k=["labour","supervisor"].includes(t),x=["labour","supervisor"].includes(t),R=["labour"].includes(t);return d.jsxs("div",{className:"min-h-screen no-print pb-20 bg-slate-50 dark:bg-slate-900 transition-colors font-sans text-slate-900 dark:text-slate-100",children:[d.jsxs("nav",{className:"bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-0 z-50 px-4 md:px-6 h-16 flex items-center justify-between shadow-sm",children:[d.jsx("div",{className:"flex items-center gap-3",children:d.jsx("img",{src:"/AdmireLED/logo.png",alt:"Logo",className:"h-10 w-auto"})}),d.jsxs("div",{className:"flex gap-4 items-center",children:[d.jsxs("div",{className:"hidden md:flex gap-1 bg-slate-100 dark:bg-slate-700 p-1 rounded-lg",children:[d.jsx("button",{onClick:()=>l("quote"),className:`px-4 py-1.5 rounded-md text-sm font-semibold transition-all ${a==="quote"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Calculator"}),d.jsx("button",{onClick:()=>l("inventory"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${a==="inventory"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Components"}),d.jsx("button",{onClick:()=>l("ledger"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${a==="ledger"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Stock"}),d.jsx("button",{onClick:()=>l("saved"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${a==="saved"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Quotes"}),Z&&d.jsx("button",{onClick:()=>l("users"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${a==="users"?"bg-white dark:bg-slate-600 shadow-sm text-teal-600 dark:text-teal-400":"text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white"}`,children:"Users"})]}),d.jsxs("div",{className:"flex items-center gap-2 pl-4 border-l border-slate-200 dark:border-slate-700",children:[d.jsxs("div",{className:"text-right mr-2 hidden lg:block",children:[d.jsx("div",{className:"text-[10px] font-bold text-teal-600 dark:text-teal-400 uppercase",children:t?.replace("_"," ")}),d.jsx("div",{className:"text-[10px] text-slate-400",children:s.username})]}),d.jsx("button",{onClick:se,className:"p-2 bg-slate-100 dark:bg-slate-700 hover:bg-red-50 dark:hover:bg-red-900/20 text-slate-500 dark:text-slate-400 hover:text-red-500 rounded-lg transition-colors",children:d.jsx(EC,{size:18})}),d.jsx("button",{onClick:()=>S(!I),className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-500 dark:text-slate-400 transition-colors",children:I?d.jsx(UC,{size:18}):d.jsx(AC,{size:18})})]})]})]}),d.jsxs("div",{className:"md:hidden bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 sticky top-16 z-40 flex shadow-sm overflow-x-auto",children:[d.jsx("button",{onClick:()=>l("quote"),className:`flex-1 py-3 px-2 text-xs font-bold whitespace-nowrap border-b-2 ${a==="quote"?"border-teal-600 text-teal-600":"border-transparent text-slate-500"}`,children:"Calculator"}),d.jsx("button",{onClick:()=>l("inventory"),className:`flex-1 py-3 px-2 text-xs font-bold whitespace-nowrap border-b-2 ${a==="inventory"?"border-teal-600 text-teal-600":"border-transparent text-slate-500"}`,children:"Components"}),d.jsx("button",{onClick:()=>l("ledger"),className:`flex-1 py-3 px-2 text-xs font-bold whitespace-nowrap border-b-2 ${a==="ledger"?"border-teal-600 text-teal-600":"border-transparent text-slate-500"}`,children:"Stock"}),d.jsx("button",{onClick:()=>l("saved"),className:`flex-1 py-3 px-2 text-xs font-bold whitespace-nowrap border-b-2 ${a==="saved"?"border-teal-600 text-teal-600":"border-transparent text-slate-500"}`,children:"Quotes"}),Z&&d.jsx("button",{onClick:()=>l("users"),className:`flex-1 py-3 px-2 text-xs font-bold whitespace-nowrap border-b-2 ${a==="users"?"border-teal-600 text-teal-600":"border-transparent text-slate-500"}`,children:"Users"})]}),d.jsxs("main",{className:"max-w-[1600px] mx-auto p-4 md:p-6",children:[a==="inventory"&&d.jsx(g3,{user:s,transactions:b,readOnly:x}),a==="ledger"&&d.jsx(y3,{user:s,inventory:y,transactions:b,readOnly:R}),a==="saved"&&d.jsx(v3,{user:s,inventory:y,transactions:b,exchangeRate:M,onLoadQuote:oe,readOnly:k}),a==="users"&&Z&&d.jsx(I3,{}),a==="quote"&&d.jsx(T3,{user:s,inventory:y,transactions:b,state:Q,setState:ae,exchangeRate:M,setExchangeRate:z,onSaveQuote:xe,readOnly:k})]})]})};iC.createRoot(document.getElementById("root")).render(d.jsx(Lt.StrictMode,{children:d.jsx(A3,{})}));
